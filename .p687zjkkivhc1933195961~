(function(){var bo,cv=function(){return dc.__string_rec(this,"")};function dX(ec,ea){var eb=function(){return eb.method.apply(eb.scope,arguments)};eb.scope=ec;eb.method=ea;return eb}window.js=js={_Boot:{}};window.zpp_nape=zpp_nape={shape:{},constraint:{},geom:{},phys:{},dynamics:{},callbacks:{},util:{},space:{}};window.sandbox=sandbox={};window.nape=nape={shape:{},constraint:{},geom:{},phys:{},dynamics:{},callbacks:{},space:{},util:{}};var bm=bm=function(){};bm.__name__=["Reflect"];bm.field=function(ec,eb){try{return ec[eb]}catch(ea){return null}};bm.fields=function(ed){var ea=[];if(ed!=null){var ec=Object.prototype.hasOwnProperty;for(var eb in ed){if(eb!="__id__"&&eb!="hx__closures__"&&ec.call(ed,eb)){ea.push(eb)}}}return ea};bm.copy=function(ee){var ea={};var ed=0;var ec=bm.fields(ee);while(ed<ec.length){var eb=ec[ed];++ed;ea[eb]=bm.field(ee,eb)}return ea};bm.prototype.__class__=bm;var ag=ag=function(){};ag.__name__=["Std"];ag.string=function(ea){return dc.__string_rec(ea,"")};ag.prototype.__class__=ag;var aY=aY=function(){};aY.__name__=["StringTools"];aY.hex=function(ec,eb){var ea="";while(true){ea="0123456789ABCDEF".charAt(ec&15)+ea;ec>>>=4;if(!(ec>0)){break}}if(eb!=null){while(ea.length<eb){ea="0"+ea}}return ea};aY.prototype.__class__=aY;var cE=js._Boot.HaxeError=function(ea){Error.call(this);this.val=ea;this.message=String(ea);if(Error.captureStackTrace){Error.captureStackTrace(this,cE)}};cE.__name__=["js","_Boot","HaxeError"];cE.__super__=Error;cE.prototype=Object.create(Error.prototype);cE.wrap=function(ea){if((ea instanceof Error)){return ea}else{return new cE(ea)}};cE.prototype.val=null;cE.prototype.__class__=cE;var dc=js.Boot=function(){};dc.__name__=["js","Boot"];dc.getClass=function(ec){if((ec instanceof Array)&&ec.__enum__==null){return Array}else{var ea=ec.__class__;if(ea!=null){return ea}var eb=dc.__nativeClassName(ec);if(eb!=null){return dc.__resolveNativeClass(eb)}return null}};dc.__string_rec=function(ei,ef){if(ei==null){return"null"}if(ef.length>=5){return"<...>"}var ee=typeof(ei);if(ee=="function"&&(ei.__name__||ei.__ename__)){ee="object"}switch(ee){case"function":return"<function>";case"object":if(ei instanceof Array){if(ei.__enum__){if(ei.length==2){return ei[0]}var ej=ei[0]+"(";ef+="\t";var eh=2;var ed=ei.length;while(eh<ed){var eo=eh++;if(eo!=2){ej+=","+dc.__string_rec(ei[eo],ef)}else{ej+=dc.__string_rec(ei[eo],ef)}}return ej+")"}var em=ei.length;var el;var eb="[";ef+="\t";var ep=0;var eg=em;while(ep<eg){var ek=ep++;eb+=(ek>0?",":"")+dc.__string_rec(ei[ek],ef)}eb+="]";return eb}var eq;try{eq=ei.toString}catch(er){return"???"}if(eq!=null&&eq!=Object.toString&&typeof(eq)=="function"){var ec=ei.toString();if(ec!="[object Object]"){return ec}}var en=null;var ea="{\n";ef+="\t";var es=ei.hasOwnProperty!=null;for(var en in ei){if(es&&!ei.hasOwnProperty(en)){continue}if(en=="prototype"||en=="__class__"||en=="__super__"||en=="__interfaces__"||en=="__properties__"){continue}if(ea.length!=2){ea+=", \n"}ea+=ef+en+" : "+dc.__string_rec(ei[en],ef)}ef=ef.substring(1);ea+="\n"+ef+"}";return ea;case"string":return ei;default:return String(ei)}};dc.__interfLoop=function(ef,eb){if(ef==null){return false}if(ef==eb){return true}var ea=ef.__interfaces__;if(ea!=null){var ed=0;var ee=ea.length;while(ed<ee){var ec=ea[ed++];if(ec==eb||dc.__interfLoop(ec,eb)){return true}}}return dc.__interfLoop(ef.__super__,eb)};dc.__instanceof=function(eb,ea){if(ea==null){return false}switch(ea){case Array:if((eb instanceof Array)){return eb.__enum__==null}else{return false}break;case dh:return typeof(eb)=="boolean";case dH:return true;case aj:return typeof(eb)=="number";case dR:if(typeof(eb)=="number"){return(eb|0)===eb}else{return false}break;case String:return typeof(eb)=="string";default:if(eb!=null){if(typeof(ea)=="function"){if(eb instanceof ea){return true}if(dc.__interfLoop(dc.getClass(eb),ea)){return true}}else{if(typeof(ea)=="object"&&dc.__isNativeObj(ea)){if(eb instanceof ea){return true}}}}else{return false}if(ea==aq&&eb.__name__!=null){return true}if(ea==aJ&&eb.__ename__!=null){return true}return eb.__enum__==ea}};dc.__nativeClassName=function(eb){var ea=dc.__toStr.call(eb).slice(8,-1);if(ea=="Object"||ea=="Function"||ea=="Math"||ea=="JSON"){return null}return ea};dc.__isNativeObj=function(ea){return dc.__nativeClassName(ea)!=null};dc.__resolveNativeClass=function(ea){return $global[ea]};dc.prototype.__class__=dc;var P=nape.Config=function(){};P.__name__=["nape","Config"];P.prototype.__class__=P;var bP=nape.callbacks.Callback=function(){this.zpp_inner=null};bP.__name__=["nape","callbacks","Callback"];bP.prototype.zpp_inner=null;bP.prototype.get_event=function(){return cc.events[this.zpp_inner.event]};bP.prototype.get_listener=function(){return this.zpp_inner.listener.outer};bP.prototype.toString=function(){return""};Object.defineProperty(bP.prototype,"event",{get:bP.prototype.get_event});Object.defineProperty(bP.prototype,"listener",{get:bP.prototype.get_listener});bP.prototype.__class__=bP;var dN=nape.callbacks.BodyCallback=function(){bP.call(this)};dN.__name__=["nape","callbacks","BodyCallback"];dN.__super__=bP;dN.prototype=Object.create(bP.prototype);dN.prototype.get_body=function(){return this.zpp_inner.body.outer};dN.prototype.toString=function(){var ea="Cb:";ea="Cb:"+["WAKE","SLEEP"][this.zpp_inner.event-2];ea+=":"+this.zpp_inner.body.outer.toString();ea+=" : listener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(dN.prototype,"body",{get:dN.prototype.get_body});dN.prototype.__class__=dN;var cN=nape.callbacks.Listener=function(){this.zpp_inner=null};cN.__name__=["nape","callbacks","Listener"];cN.prototype.zpp_inner=null;cN.prototype.get_type=function(){return cc.types[this.zpp_inner.type]};cN.prototype.get_event=function(){return cc.events[this.zpp_inner.event]};cN.prototype.set_event=function(ea){if(cc.events[this.zpp_inner.event]!=ea){var eb;if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}if(ea==br.CbEvent_BEGIN){eb=0}else{if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}if(ea==br.CbEvent_ONGOING){eb=6}else{if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}if(ea==br.CbEvent_END){eb=1}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(ea==br.CbEvent_SLEEP){eb=3}else{if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(ea==br.CbEvent_WAKE){eb=2}else{if(br.CbEvent_PRE==null){br.internal=true;br.CbEvent_PRE=new bU();br.internal=false}if(ea==br.CbEvent_PRE){eb=5}else{eb=4}}}}}}this.zpp_inner.swapEvent(eb)}return cc.events[this.zpp_inner.event]};cN.prototype.get_precedence=function(){return this.zpp_inner.precedence};cN.prototype.set_precedence=function(ea){if(this.zpp_inner.precedence!=ea){this.zpp_inner.precedence=ea;this.zpp_inner.invalidate_precedence()}return this.zpp_inner.precedence};cN.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cN.prototype.set_space=function(ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if(this.zpp_inner.space!=null){this.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_listeners;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}else{this.zpp_inner.space=null}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cN.prototype.toString=function(){var eb=["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];if(this.zpp_inner.type==0){return"BodyListener{"+eb+"::"+ag.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}"}else{if(this.zpp_inner.type==1){return"ConstraintListener{"+eb+"::"+ag.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}"}else{var ea=this.zpp_inner.interaction;var ec;switch(ea.itype){case 1:ec="COLLISION";break;case 2:ec="SENSOR";break;case 4:ec="FLUID";break;default:ec="ALL"}return(this.zpp_inner.type==2?"InteractionListener{"+eb+"#"+ec+"::"+ag.string(ea.outer_zni.zpp_inner_zn.options1.outer)+":"+ag.string(ea.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+ec+"::"+ag.string(ea.outer_znp.zpp_inner_zn.options1.outer)+":"+ag.string(ea.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence}}};Object.defineProperty(cN.prototype,"type",{get:cN.prototype.get_type});Object.defineProperty(cN.prototype,"event",{get:cN.prototype.get_event,set:cN.prototype.set_event});Object.defineProperty(cN.prototype,"precedence",{get:cN.prototype.get_precedence,set:cN.prototype.set_precedence});Object.defineProperty(cN.prototype,"space",{get:cN.prototype.get_space,set:cN.prototype.set_space});cN.prototype.__class__=cN;var dj=nape.callbacks.BodyListener=function(ed,eb,ec,ea){if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);var ee=-1;if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(ed==br.CbEvent_WAKE){ee=2}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(ed==br.CbEvent_SLEEP){ee=3}}this.zpp_inner_zn=new bW(cP.argument(eb),ee,ec);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner.precedence=ea};dj.__name__=["nape","callbacks","BodyListener"];dj.__super__=cN;dj.prototype=Object.create(cN.prototype);dj.prototype.zpp_inner_zn=null;dj.prototype.get_options=function(){return this.zpp_inner_zn.options.outer};dj.prototype.set_options=function(ea){this.zpp_inner_zn.options.set(ea.zpp_inner);return this.zpp_inner_zn.options.outer};dj.prototype.get_handler=function(){return this.zpp_inner_zn.handler};dj.prototype.set_handler=function(ea){this.zpp_inner_zn.handler=ea;return this.zpp_inner_zn.handler};Object.defineProperty(dj.prototype,"options",{get:dj.prototype.get_options,set:dj.prototype.set_options});Object.defineProperty(dj.prototype,"handler",{get:dj.prototype.get_handler,set:dj.prototype.set_handler});dj.prototype.__class__=dj;var bU=nape.callbacks.CbEvent=function(){};bU.__name__=["nape","callbacks","CbEvent"];bU.BEGIN=null;bU.get_BEGIN=function(){if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}return br.CbEvent_BEGIN};bU.ONGOING=null;bU.get_ONGOING=function(){if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}return br.CbEvent_ONGOING};bU.END=null;bU.get_END=function(){if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}return br.CbEvent_END};bU.WAKE=null;bU.get_WAKE=function(){if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}return br.CbEvent_WAKE};bU.SLEEP=null;bU.get_SLEEP=function(){if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}return br.CbEvent_SLEEP};bU.BREAK=null;bU.get_BREAK=function(){if(br.CbEvent_BREAK==null){br.internal=true;br.CbEvent_BREAK=new bU();br.internal=false}return br.CbEvent_BREAK};bU.PRE=null;bU.get_PRE=function(){if(br.CbEvent_PRE==null){br.internal=true;br.CbEvent_PRE=new bU();br.internal=false}return br.CbEvent_PRE};bU.prototype.toString=function(){if(br.CbEvent_PRE==null){br.internal=true;br.CbEvent_PRE=new bU();br.internal=false}if(this==br.CbEvent_PRE){return"PRE"}else{if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}if(this==br.CbEvent_BEGIN){return"BEGIN"}else{if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}if(this==br.CbEvent_ONGOING){return"ONGOING"}else{if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}if(this==br.CbEvent_END){return"END"}else{if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(this==br.CbEvent_WAKE){return"WAKE"}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(this==br.CbEvent_SLEEP){return"SLEEP"}else{if(br.CbEvent_BREAK==null){br.internal=true;br.CbEvent_BREAK=new bU();br.internal=false}if(this==br.CbEvent_BREAK){return"BREAK"}else{return""}}}}}}}};Object.defineProperty(bU,"BEGIN",{get:bU.get_BEGIN});Object.defineProperty(bU,"ONGOING",{get:bU.get_ONGOING});Object.defineProperty(bU,"END",{get:bU.get_END});Object.defineProperty(bU,"WAKE",{get:bU.get_WAKE});Object.defineProperty(bU,"SLEEP",{get:bU.get_SLEEP});Object.defineProperty(bU,"BREAK",{get:bU.get_BREAK});Object.defineProperty(bU,"PRE",{get:bU.get_PRE});bU.prototype.__class__=bU;var dk=nape.callbacks.CbType=function(){this.zpp_inner=null;this.zpp_inner=new db();this.zpp_inner.outer=this};dk.__name__=["nape","callbacks","CbType"];dk.ANY_BODY=null;dk.get_ANY_BODY=function(){return db.ANY_BODY};dk.ANY_CONSTRAINT=null;dk.get_ANY_CONSTRAINT=function(){return db.ANY_CONSTRAINT};dk.ANY_SHAPE=null;dk.get_ANY_SHAPE=function(){return db.ANY_SHAPE};dk.ANY_COMPOUND=null;dk.get_ANY_COMPOUND=function(){return db.ANY_COMPOUND};dk.prototype.zpp_inner=null;dk.prototype.get_id=function(){return this.zpp_inner.id};dk.prototype.including=function(ea){return new R(this).including(ea)};dk.prototype.excluding=function(ea){return new R(this).excluding(ea)};dk.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};dk.prototype.get_interactors=function(){if(this.zpp_inner.wrap_interactors==null){this.zpp_inner.wrap_interactors=i.get(this.zpp_inner.interactors,true)}return this.zpp_inner.wrap_interactors};dk.prototype.get_constraints=function(){if(this.zpp_inner.wrap_constraints==null){this.zpp_inner.wrap_constraints=aZ.get(this.zpp_inner.constraints,true)}return this.zpp_inner.wrap_constraints};dk.prototype.toString=function(){if(this==db.ANY_BODY){return"ANY_BODY"}else{if(this==db.ANY_SHAPE){return"ANY_SHAPE"}else{if(this==db.ANY_COMPOUND){return"ANY_COMPOUND"}else{if(this==db.ANY_CONSTRAINT){return"ANY_CONSTRAINT"}else{return"CbType#"+this.zpp_inner.id}}}}};Object.defineProperty(dk,"ANY_BODY",{get:dk.get_ANY_BODY});Object.defineProperty(dk,"ANY_CONSTRAINT",{get:dk.get_ANY_CONSTRAINT});Object.defineProperty(dk,"ANY_SHAPE",{get:dk.get_ANY_SHAPE});Object.defineProperty(dk,"ANY_COMPOUND",{get:dk.get_ANY_COMPOUND});Object.defineProperty(dk.prototype,"id",{get:dk.prototype.get_id});Object.defineProperty(dk.prototype,"userData",{get:dk.prototype.get_userData});Object.defineProperty(dk.prototype,"interactors",{get:dk.prototype.get_interactors});Object.defineProperty(dk.prototype,"constraints",{get:dk.prototype.get_constraints});dk.prototype.__class__=dk;var Y=nape.callbacks.CbTypeIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};Y.__name__=["nape","callbacks","CbTypeIterator"];Y.get=function(ec){var ea;if(Y.zpp_pool==null){cy.internal=true;var ed=new Y();cy.internal=false;ea=ed}else{var eb=Y.zpp_pool;Y.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};Y.prototype.zpp_inner=null;Y.prototype.zpp_i=null;Y.prototype.zpp_critical=null;Y.prototype.zpp_next=null;Y.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=Y.zpp_pool;Y.zpp_pool=this;this.zpp_inner=null;return false}};Y.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};Y.prototype.__class__=Y;var C=nape.callbacks.CbTypeList=function(){this.zpp_inner=null;this.zpp_inner=new cy();this.zpp_inner.outer=this};C.__name__=["nape","callbacks","CbTypeList"];C.fromArray=function(ed){var ea=new C();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};C.prototype.zpp_inner=null;C.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};C.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};C.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};C.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};C.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};C.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};C.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};C.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};C.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};C.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};C.prototype.empty=function(){return this.zpp_inner.inner.head==null};C.prototype.iterator=function(){this.zpp_inner.valmod();return Y.get(this)};C.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new C();this.zpp_inner.valmod();var ef=Y.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=Y.zpp_pool;Y.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};C.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=Y.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=Y.zpp_pool;Y.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};C.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=Y.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=Y.zpp_pool;Y.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};C.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=Y.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=Y.zpp_pool;Y.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=Y.zpp_pool;Y.zpp_pool=ec;ec.zpp_inner=null;break}}return this};C.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(C.prototype,"length",{get:C.prototype.get_length});C.prototype.__class__=C;var dm=nape.callbacks.ConstraintCallback=function(){bP.call(this)};dm.__name__=["nape","callbacks","ConstraintCallback"];dm.__super__=bP;dm.prototype=Object.create(bP.prototype);dm.prototype.get_constraint=function(){return this.zpp_inner.constraint.outer};dm.prototype.toString=function(){var ea="Cb:";ea="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-2];ea+=":"+this.zpp_inner.constraint.outer.toString();ea+=" : listener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(dm.prototype,"constraint",{get:dm.prototype.get_constraint});dm.prototype.__class__=dm;var d1=nape.callbacks.ConstraintListener=function(ed,eb,ec,ea){if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);var ee=-1;if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(ed==br.CbEvent_WAKE){ee=2}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(ed==br.CbEvent_SLEEP){ee=3}else{if(br.CbEvent_BREAK==null){br.internal=true;br.CbEvent_BREAK=new bU();br.internal=false}if(ed==br.CbEvent_BREAK){ee=4}}}this.zpp_inner_zn=new O(cP.argument(eb),ee,ec);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner.precedence=ea};d1.__name__=["nape","callbacks","ConstraintListener"];d1.__super__=cN;d1.prototype=Object.create(cN.prototype);d1.prototype.zpp_inner_zn=null;d1.prototype.get_options=function(){return this.zpp_inner_zn.options.outer};d1.prototype.set_options=function(ea){this.zpp_inner_zn.options.set(ea.zpp_inner);return this.zpp_inner_zn.options.outer};d1.prototype.get_handler=function(){return this.zpp_inner_zn.handler};d1.prototype.set_handler=function(ea){this.zpp_inner_zn.handler=ea;return this.zpp_inner_zn.handler};Object.defineProperty(d1.prototype,"options",{get:d1.prototype.get_options,set:d1.prototype.set_options});Object.defineProperty(d1.prototype,"handler",{get:d1.prototype.get_handler,set:d1.prototype.set_handler});d1.prototype.__class__=d1;var ay=nape.callbacks.InteractionCallback=function(){bP.call(this)};ay.__name__=["nape","callbacks","InteractionCallback"];ay.__super__=bP;ay.prototype=Object.create(bP.prototype);ay.prototype.get_int1=function(){return this.zpp_inner.int1.outer_i};ay.prototype.get_int2=function(){return this.zpp_inner.int2.outer_i};ay.prototype.get_arbiters=function(){return this.zpp_inner.wrap_arbiters};ay.prototype.toString=function(){var ea="Cb:";ea="Cb:"+["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event];ea+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();ea+=" : "+this.zpp_inner.wrap_arbiters.toString();ea+=" : listener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(ay.prototype,"int1",{get:ay.prototype.get_int1});Object.defineProperty(ay.prototype,"int2",{get:ay.prototype.get_int2});Object.defineProperty(ay.prototype,"arbiters",{get:ay.prototype.get_arbiters});ay.prototype.__class__=ay;var bp=nape.callbacks.InteractionListener=function(eb,ec,ek,ei,ej,ea){if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);var eh=-1;if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}if(eb==br.CbEvent_BEGIN){eh=0}else{if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}if(eb==br.CbEvent_END){eh=1}else{if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}if(eb==br.CbEvent_ONGOING){eh=6}}}this.zpp_inner_zn=new c1(cP.argument(ek),cP.argument(ei),eh,2);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zni=this;this.zpp_inner.precedence=ea;this.zpp_inner_zn.handleri=ej;var ef=this.zpp_inner_zn.itype;var ee;if(ef==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}ee=br.InteractionType_COLLISION}else{if(ef==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}ee=br.InteractionType_SENSOR}else{if(ef==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}ee=br.InteractionType_FLUID}else{if(ef==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}ee=br.InteractionType_ANY}else{ee=null}}}}if(ee!=ec){var ed;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(ec==br.InteractionType_COLLISION){ed=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(ec==br.InteractionType_SENSOR){ed=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(ec==br.InteractionType_FLUID){ed=4}else{ed=7}}}this.zpp_inner_zn.itype=ed}var eg=this.zpp_inner_zn.itype;if(eg==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}}else{if(eg==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}}else{if(eg==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}}else{if(eg==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}}}}}};bp.__name__=["nape","callbacks","InteractionListener"];bp.__super__=cN;bp.prototype=Object.create(cN.prototype);bp.prototype.zpp_inner_zn=null;bp.prototype.get_options1=function(){return this.zpp_inner_zn.options1.outer};bp.prototype.set_options1=function(ea){this.zpp_inner_zn.options1.set(ea.zpp_inner);return this.zpp_inner_zn.options1.outer};bp.prototype.get_options2=function(){return this.zpp_inner_zn.options2.outer};bp.prototype.set_options2=function(ea){this.zpp_inner_zn.options2.set(ea.zpp_inner);return this.zpp_inner_zn.options2.outer};bp.prototype.get_interactionType=function(){var ea=this.zpp_inner_zn.itype;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};bp.prototype.set_interactionType=function(ec){var ea=this.zpp_inner_zn.itype;var eb;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}eb=br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}eb=br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}eb=br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}eb=br.InteractionType_ANY}else{eb=null}}}}if(eb!=ec){var ee;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(ec==br.InteractionType_COLLISION){ee=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(ec==br.InteractionType_SENSOR){ee=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(ec==br.InteractionType_FLUID){ee=4}else{ee=7}}}this.zpp_inner_zn.itype=ee}var ed=this.zpp_inner_zn.itype;if(ed==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ed==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ed==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ed==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};bp.prototype.get_handler=function(){return this.zpp_inner_zn.handleri};bp.prototype.set_handler=function(ea){this.zpp_inner_zn.handleri=ea;return this.zpp_inner_zn.handleri};bp.prototype.get_allowSleepingCallbacks=function(){return this.zpp_inner_zn.allowSleepingCallbacks};bp.prototype.set_allowSleepingCallbacks=function(ea){this.zpp_inner_zn.allowSleepingCallbacks=ea;return this.zpp_inner_zn.allowSleepingCallbacks};Object.defineProperty(bp.prototype,"options1",{get:bp.prototype.get_options1,set:bp.prototype.set_options1});Object.defineProperty(bp.prototype,"options2",{get:bp.prototype.get_options2,set:bp.prototype.set_options2});Object.defineProperty(bp.prototype,"interactionType",{get:bp.prototype.get_interactionType,set:bp.prototype.set_interactionType});Object.defineProperty(bp.prototype,"handler",{get:bp.prototype.get_handler,set:bp.prototype.set_handler});Object.defineProperty(bp.prototype,"allowSleepingCallbacks",{get:bp.prototype.get_allowSleepingCallbacks,set:bp.prototype.set_allowSleepingCallbacks});bp.prototype.__class__=bp;var b3=nape.callbacks.InteractionType=function(){};b3.__name__=["nape","callbacks","InteractionType"];b3.COLLISION=null;b3.get_COLLISION=function(){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION};b3.SENSOR=null;b3.get_SENSOR=function(){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR};b3.FLUID=null;b3.get_FLUID=function(){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID};b3.ANY=null;b3.get_ANY=function(){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY};b3.prototype.toString=function(){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(this==br.InteractionType_COLLISION){return"COLLISION"}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(this==br.InteractionType_SENSOR){return"SENSOR"}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(this==br.InteractionType_FLUID){return"FLUID"}else{if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}if(this==br.InteractionType_ANY){return"ANY"}else{return""}}}}};Object.defineProperty(b3,"COLLISION",{get:b3.get_COLLISION});Object.defineProperty(b3,"SENSOR",{get:b3.get_SENSOR});Object.defineProperty(b3,"FLUID",{get:b3.get_FLUID});Object.defineProperty(b3,"ANY",{get:b3.get_ANY});b3.prototype.__class__=b3;var cV=nape.callbacks.ListenerIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};cV.__name__=["nape","callbacks","ListenerIterator"];cV.get=function(ec){var ea;if(cV.zpp_pool==null){a1.internal=true;var ed=new cV();a1.internal=false;ea=ed}else{var eb=cV.zpp_pool;cV.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};cV.prototype.zpp_inner=null;cV.prototype.zpp_i=null;cV.prototype.zpp_critical=null;cV.prototype.zpp_next=null;cV.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=cV.zpp_pool;cV.zpp_pool=this;this.zpp_inner=null;return false}};cV.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};cV.prototype.__class__=cV;var ci=nape.callbacks.ListenerList=function(){this.zpp_inner=null;this.zpp_inner=new a1();this.zpp_inner.outer=this};ci.__name__=["nape","callbacks","ListenerList"];ci.fromArray=function(ed){var ea=new ci();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};ci.prototype.zpp_inner=null;ci.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};ci.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};ci.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};ci.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};ci.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};ci.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};ci.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};ci.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};ci.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};ci.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};ci.prototype.empty=function(){return this.zpp_inner.inner.head==null};ci.prototype.iterator=function(){this.zpp_inner.valmod();return cV.get(this)};ci.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new ci();this.zpp_inner.valmod();var ef=cV.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cV.zpp_pool;cV.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};ci.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=cV.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=cV.zpp_pool;cV.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};ci.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=cV.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cV.zpp_pool;cV.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};ci.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=cV.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=cV.zpp_pool;cV.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=cV.zpp_pool;cV.zpp_pool=ec;ec.zpp_inner=null;break}}return this};ci.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(ci.prototype,"length",{get:ci.prototype.get_length});ci.prototype.__class__=ci;var dZ=nape.callbacks.ListenerType=function(){};dZ.__name__=["nape","callbacks","ListenerType"];dZ.BODY=null;dZ.get_BODY=function(){if(br.ListenerType_BODY==null){br.internal=true;br.ListenerType_BODY=new dZ();br.internal=false}return br.ListenerType_BODY};dZ.CONSTRAINT=null;dZ.get_CONSTRAINT=function(){if(br.ListenerType_CONSTRAINT==null){br.internal=true;br.ListenerType_CONSTRAINT=new dZ();br.internal=false}return br.ListenerType_CONSTRAINT};dZ.INTERACTION=null;dZ.get_INTERACTION=function(){if(br.ListenerType_INTERACTION==null){br.internal=true;br.ListenerType_INTERACTION=new dZ();br.internal=false}return br.ListenerType_INTERACTION};dZ.PRE=null;dZ.get_PRE=function(){if(br.ListenerType_PRE==null){br.internal=true;br.ListenerType_PRE=new dZ();br.internal=false}return br.ListenerType_PRE};dZ.prototype.toString=function(){if(br.ListenerType_BODY==null){br.internal=true;br.ListenerType_BODY=new dZ();br.internal=false}if(this==br.ListenerType_BODY){return"BODY"}else{if(br.ListenerType_CONSTRAINT==null){br.internal=true;br.ListenerType_CONSTRAINT=new dZ();br.internal=false}if(this==br.ListenerType_CONSTRAINT){return"CONSTRAINT"}else{if(br.ListenerType_INTERACTION==null){br.internal=true;br.ListenerType_INTERACTION=new dZ();br.internal=false}if(this==br.ListenerType_INTERACTION){return"INTERACTION"}else{if(br.ListenerType_PRE==null){br.internal=true;br.ListenerType_PRE=new dZ();br.internal=false}if(this==br.ListenerType_PRE){return"PRE"}else{return""}}}}};Object.defineProperty(dZ,"BODY",{get:dZ.get_BODY});Object.defineProperty(dZ,"CONSTRAINT",{get:dZ.get_CONSTRAINT});Object.defineProperty(dZ,"INTERACTION",{get:dZ.get_INTERACTION});Object.defineProperty(dZ,"PRE",{get:dZ.get_PRE});dZ.prototype.__class__=dZ;var R=nape.callbacks.OptionType=function(ea,eb){this.zpp_inner=null;this.zpp_inner=new cP();this.zpp_inner.outer=this;if(ea!=null){this.including(ea)}if(eb!=null){this.excluding(eb)}};R.__name__=["nape","callbacks","OptionType"];R.prototype.zpp_inner=null;R.prototype.get_includes=function(){if(this.zpp_inner.wrap_includes==null){this.zpp_inner.setup_includes()}return this.zpp_inner.wrap_includes};R.prototype.get_excludes=function(){if(this.zpp_inner.wrap_excludes==null){this.zpp_inner.setup_excludes()}return this.zpp_inner.wrap_excludes};R.prototype.including=function(ea){this.zpp_inner.append(this.zpp_inner.includes,ea);return this};R.prototype.excluding=function(ea){this.zpp_inner.append(this.zpp_inner.excludes,ea);return this};R.prototype.toString=function(){if(this.zpp_inner.wrap_includes==null){this.zpp_inner.setup_includes()}var ea=this.zpp_inner.wrap_includes.toString();if(this.zpp_inner.wrap_excludes==null){this.zpp_inner.setup_excludes()}return"@{"+ea+" excluding "+this.zpp_inner.wrap_excludes.toString()+"}"};Object.defineProperty(R.prototype,"includes",{get:R.prototype.get_includes});Object.defineProperty(R.prototype,"excludes",{get:R.prototype.get_excludes});R.prototype.__class__=R;var a9=nape.callbacks.PreCallback=function(){bP.call(this)};a9.__name__=["nape","callbacks","PreCallback"];a9.__super__=bP;a9.prototype=Object.create(bP.prototype);a9.prototype.get_arbiter=function(){return this.zpp_inner.pre_arbiter.wrapper()};a9.prototype.get_int1=function(){return this.zpp_inner.int1.outer_i};a9.prototype.get_int2=function(){return this.zpp_inner.int2.outer_i};a9.prototype.get_swapped=function(){return this.zpp_inner.pre_swapped};a9.prototype.toString=function(){var ea="Cb:PRE:";ea="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());ea+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();ea+=" : listnener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(a9.prototype,"arbiter",{get:a9.prototype.get_arbiter});Object.defineProperty(a9.prototype,"int1",{get:a9.prototype.get_int1});Object.defineProperty(a9.prototype,"int2",{get:a9.prototype.get_int2});Object.defineProperty(a9.prototype,"swapped",{get:a9.prototype.get_swapped});a9.prototype.__class__=a9;var bq=nape.callbacks.PreFlag=function(){};bq.__name__=["nape","callbacks","PreFlag"];bq.ACCEPT=null;bq.get_ACCEPT=function(){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}return br.PreFlag_ACCEPT};bq.IGNORE=null;bq.get_IGNORE=function(){if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}return br.PreFlag_IGNORE};bq.ACCEPT_ONCE=null;bq.get_ACCEPT_ONCE=function(){if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}return br.PreFlag_ACCEPT_ONCE};bq.IGNORE_ONCE=null;bq.get_IGNORE_ONCE=function(){if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}return br.PreFlag_IGNORE_ONCE};bq.prototype.toString=function(){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}if(this==br.PreFlag_ACCEPT){return"ACCEPT"}else{if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}if(this==br.PreFlag_IGNORE){return"IGNORE"}else{if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}if(this==br.PreFlag_ACCEPT_ONCE){return"ACCEPT_ONCE"}else{if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}if(this==br.PreFlag_IGNORE_ONCE){return"IGNORE_ONCE"}else{return""}}}}};Object.defineProperty(bq,"ACCEPT",{get:bq.get_ACCEPT});Object.defineProperty(bq,"IGNORE",{get:bq.get_IGNORE});Object.defineProperty(bq,"ACCEPT_ONCE",{get:bq.get_ACCEPT_ONCE});Object.defineProperty(bq,"IGNORE_ONCE",{get:bq.get_IGNORE_ONCE});bq.prototype.__class__=bq;var b2=nape.callbacks.PreListener=function(eb,ej,eh,ei,ea,ec){if(ec==null){ec=false}if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);this.zpp_inner_zn=new c1(cP.argument(ej),cP.argument(eh),5,3);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_znp=this;this.zpp_inner.precedence=ea;this.zpp_inner_zn.pure=ec;this.zpp_inner_zn.handlerp=ei;var ef=this.zpp_inner_zn.itype;var ee;if(ef==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}ee=br.InteractionType_COLLISION}else{if(ef==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}ee=br.InteractionType_SENSOR}else{if(ef==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}ee=br.InteractionType_FLUID}else{if(ef==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}ee=br.InteractionType_ANY}else{ee=null}}}}if(ee!=eb){var ed;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(eb==br.InteractionType_COLLISION){ed=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(eb==br.InteractionType_SENSOR){ed=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(eb==br.InteractionType_FLUID){ed=4}else{ed=7}}}this.zpp_inner_zn.itype=ed}var eg=this.zpp_inner_zn.itype;if(eg==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}}else{if(eg==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}}else{if(eg==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}}else{if(eg==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}}}}}};b2.__name__=["nape","callbacks","PreListener"];b2.__super__=cN;b2.prototype=Object.create(cN.prototype);b2.prototype.zpp_inner_zn=null;b2.prototype.get_options1=function(){return this.zpp_inner_zn.options1.outer};b2.prototype.set_options1=function(ea){this.zpp_inner_zn.options1.set(ea.zpp_inner);return this.zpp_inner_zn.options1.outer};b2.prototype.get_options2=function(){return this.zpp_inner_zn.options2.outer};b2.prototype.set_options2=function(ea){this.zpp_inner_zn.options2.set(ea.zpp_inner);return this.zpp_inner_zn.options2.outer};b2.prototype.get_handler=function(){return this.zpp_inner_zn.handlerp};b2.prototype.set_handler=function(ea){this.zpp_inner_zn.handlerp=ea;this.zpp_inner_zn.wake();return this.zpp_inner_zn.handlerp};b2.prototype.get_pure=function(){return this.zpp_inner_zn.pure};b2.prototype.set_pure=function(ea){if(!ea){this.zpp_inner_zn.wake()}this.zpp_inner_zn.pure=ea;return this.zpp_inner_zn.pure};b2.prototype.get_interactionType=function(){var ea=this.zpp_inner_zn.itype;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};b2.prototype.set_interactionType=function(ec){var ea=this.zpp_inner_zn.itype;var eb;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}eb=br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}eb=br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}eb=br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}eb=br.InteractionType_ANY}else{eb=null}}}}if(eb!=ec){var ee;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(ec==br.InteractionType_COLLISION){ee=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(ec==br.InteractionType_SENSOR){ee=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(ec==br.InteractionType_FLUID){ee=4}else{ee=7}}}this.zpp_inner_zn.itype=ee}var ed=this.zpp_inner_zn.itype;if(ed==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ed==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ed==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ed==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};Object.defineProperty(b2.prototype,"options1",{get:b2.prototype.get_options1,set:b2.prototype.set_options1});Object.defineProperty(b2.prototype,"options2",{get:b2.prototype.get_options2,set:b2.prototype.set_options2});Object.defineProperty(b2.prototype,"handler",{get:b2.prototype.get_handler,set:b2.prototype.set_handler});Object.defineProperty(b2.prototype,"pure",{get:b2.prototype.get_pure,set:b2.prototype.set_pure});Object.defineProperty(b2.prototype,"interactionType",{get:b2.prototype.get_interactionType,set:b2.prototype.set_interactionType});b2.prototype.__class__=b2;var cK=nape.constraint.Constraint=function(){this.debugDraw=true;this.zpp_inner.insert_cbtype(db.ANY_CONSTRAINT.zpp_inner)};cK.__name__=["nape","constraint","Constraint"];cK.prototype.zpp_inner=null;cK.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};cK.prototype.debugDraw=null;cK.prototype.get_compound=function(){if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};cK.prototype.set_compound=function(ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=null){(this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_constraints;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};cK.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cK.prototype.set_space=function(ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if(this.zpp_inner.component!=null){this.zpp_inner.component.woken=false}this.zpp_inner.clearcache();if(this.zpp_inner.space!=null){this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_constraints;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}else{this.zpp_inner.space=null}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cK.prototype.get_isSleeping=function(){return this.zpp_inner.component.sleeping};cK.prototype.get_active=function(){return this.zpp_inner.active};cK.prototype.set_active=function(ea){if(this.zpp_inner.active!=ea){if(this.zpp_inner.component!=null){this.zpp_inner.component.woken=false}this.zpp_inner.clearcache();if(ea){this.zpp_inner.active=ea;this.zpp_inner.activate();if(this.zpp_inner.space!=null){if(this.zpp_inner.component!=null){this.zpp_inner.component.sleeping=true}this.zpp_inner.space.wake_constraint(this.zpp_inner,true)}}else{if(this.zpp_inner.space!=null){this.zpp_inner.wake();this.zpp_inner.space.live_constraints.remove(this.zpp_inner)}this.zpp_inner.active=ea;this.zpp_inner.deactivate()}}return this.zpp_inner.active};cK.prototype.get_ignore=function(){return this.zpp_inner.ignore};cK.prototype.set_ignore=function(ea){if(this.zpp_inner.ignore!=ea){this.zpp_inner.ignore=ea;this.zpp_inner.wake()}return this.zpp_inner.ignore};cK.prototype.get_stiff=function(){return this.zpp_inner.stiff};cK.prototype.set_stiff=function(ea){if(this.zpp_inner.stiff!=ea){this.zpp_inner.stiff=ea;this.zpp_inner.wake()}return this.zpp_inner.stiff};cK.prototype.get_frequency=function(){return this.zpp_inner.frequency};cK.prototype.set_frequency=function(ea){if(this.zpp_inner.frequency!=ea){this.zpp_inner.frequency=ea;if(!this.zpp_inner.stiff){this.zpp_inner.wake()}}return this.zpp_inner.frequency};cK.prototype.get_damping=function(){return this.zpp_inner.damping};cK.prototype.set_damping=function(ea){if(this.zpp_inner.damping!=ea){this.zpp_inner.damping=ea;if(!this.zpp_inner.stiff){this.zpp_inner.wake()}}return this.zpp_inner.damping};cK.prototype.get_maxForce=function(){return this.zpp_inner.maxForce};cK.prototype.set_maxForce=function(ea){if(this.zpp_inner.maxForce!=ea){this.zpp_inner.maxForce=ea;this.zpp_inner.wake()}return this.zpp_inner.maxForce};cK.prototype.get_maxError=function(){return this.zpp_inner.maxError};cK.prototype.set_maxError=function(ea){if(this.zpp_inner.maxError!=ea){this.zpp_inner.maxError=ea;this.zpp_inner.wake()}return this.zpp_inner.maxError};cK.prototype.get_breakUnderForce=function(){return this.zpp_inner.breakUnderForce};cK.prototype.set_breakUnderForce=function(ea){if(this.zpp_inner.breakUnderForce!=ea){this.zpp_inner.breakUnderForce=ea;this.zpp_inner.wake()}return this.zpp_inner.breakUnderForce};cK.prototype.get_breakUnderError=function(){return this.zpp_inner.breakUnderError};cK.prototype.set_breakUnderError=function(ea){if(this.zpp_inner.breakUnderError!=ea){this.zpp_inner.breakUnderError=ea;this.zpp_inner.wake()}return this.zpp_inner.breakUnderError};cK.prototype.get_removeOnBreak=function(){return this.zpp_inner.removeOnBreak};cK.prototype.set_removeOnBreak=function(ea){this.zpp_inner.removeOnBreak=ea;return this.zpp_inner.removeOnBreak};cK.prototype.impulse=function(){return null};cK.prototype.bodyImpulse=function(ea){return null};cK.prototype.visitBodies=function(ea){};cK.prototype.get_cbTypes=function(){if(this.zpp_inner.wrap_cbTypes==null){this.zpp_inner.setupcbTypes()}return this.zpp_inner.wrap_cbTypes};cK.prototype.toString=function(){return"{Constraint}"};cK.prototype.copy=function(){return this.zpp_inner.copy()};Object.defineProperty(cK.prototype,"userData",{get:cK.prototype.get_userData});Object.defineProperty(cK.prototype,"compound",{get:cK.prototype.get_compound,set:cK.prototype.set_compound});Object.defineProperty(cK.prototype,"space",{get:cK.prototype.get_space,set:cK.prototype.set_space});Object.defineProperty(cK.prototype,"isSleeping",{get:cK.prototype.get_isSleeping});Object.defineProperty(cK.prototype,"active",{get:cK.prototype.get_active,set:cK.prototype.set_active});Object.defineProperty(cK.prototype,"ignore",{get:cK.prototype.get_ignore,set:cK.prototype.set_ignore});Object.defineProperty(cK.prototype,"stiff",{get:cK.prototype.get_stiff,set:cK.prototype.set_stiff});Object.defineProperty(cK.prototype,"frequency",{get:cK.prototype.get_frequency,set:cK.prototype.set_frequency});Object.defineProperty(cK.prototype,"damping",{get:cK.prototype.get_damping,set:cK.prototype.set_damping});Object.defineProperty(cK.prototype,"maxForce",{get:cK.prototype.get_maxForce,set:cK.prototype.set_maxForce});Object.defineProperty(cK.prototype,"maxError",{get:cK.prototype.get_maxError,set:cK.prototype.set_maxError});Object.defineProperty(cK.prototype,"breakUnderForce",{get:cK.prototype.get_breakUnderForce,set:cK.prototype.set_breakUnderForce});Object.defineProperty(cK.prototype,"breakUnderError",{get:cK.prototype.get_breakUnderError,set:cK.prototype.set_breakUnderError});Object.defineProperty(cK.prototype,"removeOnBreak",{get:cK.prototype.get_removeOnBreak,set:cK.prototype.set_removeOnBreak});Object.defineProperty(cK.prototype,"cbTypes",{get:cK.prototype.get_cbTypes});cK.prototype.__class__=cK;var aA=nape.constraint.AngleJoint=function(ec,ea,eg,ef,ee){if(ee==null){ee=1}this.zpp_inner_zn=null;this.zpp_inner_zn=new dt();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var ed=ec==null?null:ec.zpp_inner;if(ed!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=ed;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ed!=null&&this.zpp_inner_zn.b2!=ed){if(ed!=null){ed.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ed!=null){ed.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}this.zpp_inner.immutable_midstep("AngleJoint::jointMin");if(this.zpp_inner_zn.jointMin!=eg){this.zpp_inner_zn.jointMin=eg;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("AngleJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ef){this.zpp_inner_zn.jointMax=ef;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("AngleJoint::ratio");if(this.zpp_inner_zn.ratio!=ee){this.zpp_inner_zn.ratio=ee;this.zpp_inner.wake()}};aA.__name__=["nape","constraint","AngleJoint"];aA.__super__=cK;aA.prototype=Object.create(cK.prototype);aA.prototype.zpp_inner_zn=null;aA.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aA.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aA.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aA.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aA.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};aA.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("AngleJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};aA.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};aA.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("AngleJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};aA.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio};aA.prototype.set_ratio=function(ea){this.zpp_inner.immutable_midstep("AngleJoint::ratio");if(this.zpp_inner_zn.ratio!=ea){this.zpp_inner_zn.ratio=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.ratio};aA.prototype.isSlack=function(){var ec=this.zpp_inner_zn;var ea;var eb=ec.ratio*ec.b2.rot-ec.b1.rot;if(ec.equal){ea=false;ec.scale=1}else{if(eb<ec.jointMin){ec.scale=-1;ea=false}else{if(eb>ec.jointMax){eb-=ec.jointMax;ec.scale=1;ea=false}else{ec.scale=0;eb=0;ea=true}}}return ea};aA.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};aA.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get(0,0,0)}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};aA.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(aA.prototype,"body1",{get:aA.prototype.get_body1,set:aA.prototype.set_body1});Object.defineProperty(aA.prototype,"body2",{get:aA.prototype.get_body2,set:aA.prototype.set_body2});Object.defineProperty(aA.prototype,"jointMin",{get:aA.prototype.get_jointMin,set:aA.prototype.set_jointMin});Object.defineProperty(aA.prototype,"jointMax",{get:aA.prototype.get_jointMax,set:aA.prototype.set_jointMax});Object.defineProperty(aA.prototype,"ratio",{get:aA.prototype.get_ratio,set:aA.prototype.set_ratio});aA.prototype.__class__=aA;var bO=nape.constraint.ConstraintIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};bO.__name__=["nape","constraint","ConstraintIterator"];bO.get=function(ec){var ea;if(bO.zpp_pool==null){aZ.internal=true;var ed=new bO();aZ.internal=false;ea=ed}else{var eb=bO.zpp_pool;bO.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};bO.prototype.zpp_inner=null;bO.prototype.zpp_i=null;bO.prototype.zpp_critical=null;bO.prototype.zpp_next=null;bO.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=bO.zpp_pool;bO.zpp_pool=this;this.zpp_inner=null;return false}};bO.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};bO.prototype.__class__=bO;var bg=nape.constraint.ConstraintList=function(){this.zpp_inner=null;this.zpp_inner=new aZ();this.zpp_inner.outer=this};bg.__name__=["nape","constraint","ConstraintList"];bg.fromArray=function(ed){var ea=new bg();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};bg.prototype.zpp_inner=null;bg.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};bg.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};bg.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};bg.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};bg.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};bg.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};bg.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};bg.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};bg.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};bg.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};bg.prototype.empty=function(){return this.zpp_inner.inner.head==null};bg.prototype.iterator=function(){this.zpp_inner.valmod();return bO.get(this)};bg.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new bg();this.zpp_inner.valmod();var ef=bO.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bO.zpp_pool;bO.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};bg.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=bO.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=bO.zpp_pool;bO.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};bg.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=bO.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bO.zpp_pool;bO.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};bg.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=bO.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=bO.zpp_pool;bO.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=bO.zpp_pool;bO.zpp_pool=ec;ec.zpp_inner=null;break}}return this};bg.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(bg.prototype,"length",{get:bg.prototype.get_length});bg.prototype.__class__=bg;var dx=nape.constraint.DistanceJoint=function(ee,ec,eB,ez,es,ex){this.zpp_inner_zn=null;this.zpp_inner_zn=new J();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var el=ee==null?null:ee.zpp_inner;if(el!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=el;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&el!=null&&this.zpp_inner_zn.b2!=el){if(el!=null){el.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(el!=null){el.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ei=ec==null?null:ec.zpp_inner;if(ei!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ei;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ei!=null&&this.zpp_inner_zn.b1!=ei){if(ei!=null){ei.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ei!=null){ei.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var eo=this.zpp_inner_zn.wrap_a1;var ew=eB.zpp_inner;if(ew._validate!=null){ew._validate()}var ed=eB.zpp_inner.x;var ev=eB.zpp_inner;if(ev._validate!=null){ev._validate()}var eb=eB.zpp_inner.y;var ey;var et=eo.zpp_inner;if(et._validate!=null){et._validate()}if(eo.zpp_inner.x==ed){var er=eo.zpp_inner;if(er._validate!=null){er._validate()}ey=eo.zpp_inner.y==eb}else{ey=false}if(!ey){eo.zpp_inner.x=ed;eo.zpp_inner.y=eb;var eq=eo.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}}if(eB.zpp_inner.weak){var eA=eB.zpp_inner;eB.zpp_inner.outer=null;eB.zpp_inner=null;eB.zpp_pool=au.poolVec2;au.poolVec2=eB;if(eA.outer!=null){eA.outer.zpp_inner=null;eA.outer=null}eA._isimmutable=null;eA._validate=null;eA._invalidate=null;eA.next=bB.zpp_pool;bB.zpp_pool=eA}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var en=this.zpp_inner_zn.wrap_a2;var ek=ez.zpp_inner;if(ek._validate!=null){ek._validate()}var eu=ez.zpp_inner.x;var eh=ez.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ez.zpp_inner.y;var eg;var ef=en.zpp_inner;if(ef._validate!=null){ef._validate()}if(en.zpp_inner.x==eu){var em=en.zpp_inner;if(em._validate!=null){em._validate()}eg=en.zpp_inner.y==ea}else{eg=false}if(!eg){en.zpp_inner.x=eu;en.zpp_inner.y=ea;var ej=en.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}if(ez.zpp_inner.weak){var ep=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;ez.zpp_pool=au.poolVec2;au.poolVec2=ez;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");if(this.zpp_inner_zn.jointMin!=es){this.zpp_inner_zn.jointMin=es;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ex){this.zpp_inner_zn.jointMax=ex;this.zpp_inner.wake()}};dx.__name__=["nape","constraint","DistanceJoint"];dx.__super__=cK;dx.prototype=Object.create(cK.prototype);dx.prototype.zpp_inner_zn=null;dx.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dx.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dx.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dx.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dx.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dx.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dx.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dx.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dx.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};dx.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};dx.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};dx.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};dx.prototype.isSlack=function(){return this.zpp_inner_zn.slack};dx.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};dx.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};dx.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(dx.prototype,"body1",{get:dx.prototype.get_body1,set:dx.prototype.set_body1});Object.defineProperty(dx.prototype,"body2",{get:dx.prototype.get_body2,set:dx.prototype.set_body2});Object.defineProperty(dx.prototype,"anchor1",{get:dx.prototype.get_anchor1,set:dx.prototype.set_anchor1});Object.defineProperty(dx.prototype,"anchor2",{get:dx.prototype.get_anchor2,set:dx.prototype.set_anchor2});Object.defineProperty(dx.prototype,"jointMin",{get:dx.prototype.get_jointMin,set:dx.prototype.set_jointMin});Object.defineProperty(dx.prototype,"jointMax",{get:dx.prototype.get_jointMax,set:dx.prototype.set_jointMax});dx.prototype.__class__=dx;var aO=nape.constraint.LineJoint=function(ee,ed,eb,ea,eh,eK,ek){this.zpp_inner_zn=null;this.zpp_inner_zn=new bR();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var eg=ee==null?null:ee.zpp_inner;if(eg!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eg;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eg!=null&&this.zpp_inner_zn.b2!=eg){if(eg!=null){eg.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eg!=null){eg.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ef=ed==null?null:ed.zpp_inner;if(ef!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ef;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ef!=null&&this.zpp_inner_zn.b1!=ef){if(ef!=null){ef.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ef!=null){ef.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ec=this.zpp_inner_zn.wrap_a1;var ew=eb.zpp_inner;if(ew._validate!=null){ew._validate()}var es=eb.zpp_inner.x;var ev=eb.zpp_inner;if(ev._validate!=null){ev._validate()}var eq=eb.zpp_inner.y;var ey;var eu=ec.zpp_inner;if(eu._validate!=null){eu._validate()}if(ec.zpp_inner.x==es){var et=ec.zpp_inner;if(et._validate!=null){et._validate()}ey=ec.zpp_inner.y==eq}else{ey=false}if(!ey){ec.zpp_inner.x=es;ec.zpp_inner.y=eq;var er=ec.zpp_inner;if(er._invalidate!=null){er._invalidate(er)}}if(eb.zpp_inner.weak){var el=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(el.outer!=null){el.outer.zpp_inner=null;el.outer=null}el._isimmutable=null;el._validate=null;el._invalidate=null;el.next=bB.zpp_pool;bB.zpp_pool=el}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ep=this.zpp_inner_zn.wrap_a2;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ej=ea.zpp_inner.x;var en=ea.zpp_inner;if(en._validate!=null){en._validate()}var eM=ea.zpp_inner.y;var eJ;var em=ep.zpp_inner;if(em._validate!=null){em._validate()}if(ep.zpp_inner.x==ej){var eH=ep.zpp_inner;if(eH._validate!=null){eH._validate()}eJ=ep.zpp_inner.y==eM}else{eJ=false}if(!eJ){ep.zpp_inner.x=ej;ep.zpp_inner.y=eM;var eG=ep.zpp_inner;if(eG._invalidate!=null){eG._invalidate(eG)}}if(ea.zpp_inner.weak){var ez=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}var eF=this.zpp_inner_zn.wrap_n;var eE=eh.zpp_inner;if(eE._validate!=null){eE._validate()}var ei=eh.zpp_inner.x;var eD=eh.zpp_inner;if(eD._validate!=null){eD._validate()}var eL=eh.zpp_inner.y;var eI;var eC=eF.zpp_inner;if(eC._validate!=null){eC._validate()}if(eF.zpp_inner.x==ei){var eB=eF.zpp_inner;if(eB._validate!=null){eB._validate()}eI=eF.zpp_inner.y==eL}else{eI=false}if(!eI){eF.zpp_inner.x=ei;eF.zpp_inner.y=eL;var eA=eF.zpp_inner;if(eA._invalidate!=null){eA._invalidate(eA)}}if(eh.zpp_inner.weak){var ex=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ex.outer!=null){ex.outer.zpp_inner=null;ex.outer=null}ex._isimmutable=null;ex._validate=null;ex._invalidate=null;ex.next=bB.zpp_pool;bB.zpp_pool=ex}if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}this.zpp_inner.immutable_midstep("LineJoint::jointMin");if(this.zpp_inner_zn.jointMin!=eK){this.zpp_inner_zn.jointMin=eK;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("LineJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ek){this.zpp_inner_zn.jointMax=ek;this.zpp_inner.wake()}};aO.__name__=["nape","constraint","LineJoint"];aO.__super__=cK;aO.prototype=Object.create(cK.prototype);aO.prototype.zpp_inner_zn=null;aO.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aO.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aO.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aO.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aO.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};aO.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};aO.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};aO.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};aO.prototype.get_direction=function(){if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}return this.zpp_inner_zn.wrap_n};aO.prototype.set_direction=function(ei){if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}var ed=this.zpp_inner_zn.wrap_n;var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=ei.zpp_inner.x;var ef=ei.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ei.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ei.zpp_inner.weak){var ek=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}return this.zpp_inner_zn.wrap_n};aO.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};aO.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("LineJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};aO.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};aO.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("LineJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};aO.prototype.impulse=function(){var ea=new bY(2,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAccx;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccy;return ea};aO.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};aO.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(aO.prototype,"body1",{get:aO.prototype.get_body1,set:aO.prototype.set_body1});Object.defineProperty(aO.prototype,"body2",{get:aO.prototype.get_body2,set:aO.prototype.set_body2});Object.defineProperty(aO.prototype,"anchor1",{get:aO.prototype.get_anchor1,set:aO.prototype.set_anchor1});Object.defineProperty(aO.prototype,"anchor2",{get:aO.prototype.get_anchor2,set:aO.prototype.set_anchor2});Object.defineProperty(aO.prototype,"direction",{get:aO.prototype.get_direction,set:aO.prototype.set_direction});Object.defineProperty(aO.prototype,"jointMin",{get:aO.prototype.get_jointMin,set:aO.prototype.set_jointMin});Object.defineProperty(aO.prototype,"jointMax",{get:aO.prototype.get_jointMax,set:aO.prototype.set_jointMax});aO.prototype.__class__=aO;var bQ=nape.constraint.MotorJoint=function(ec,ea,ef,ee){if(ee==null){ee=1}if(ef==null){ef=0}this.zpp_inner_zn=null;this.zpp_inner_zn=new y();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var ed=ec==null?null:ec.zpp_inner;if(ed!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=ed;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ed!=null&&this.zpp_inner_zn.b2!=ed){if(ed!=null){ed.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ed!=null){ed.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}this.zpp_inner.immutable_midstep("MotorJoint::rate");if(this.zpp_inner_zn.rate!=ef){this.zpp_inner_zn.rate=ef;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("MotorJoint::ratio");if(this.zpp_inner_zn.ratio!=ee){this.zpp_inner_zn.ratio=ee;this.zpp_inner.wake()}};bQ.__name__=["nape","constraint","MotorJoint"];bQ.__super__=cK;bQ.prototype=Object.create(cK.prototype);bQ.prototype.zpp_inner_zn=null;bQ.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bQ.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bQ.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bQ.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bQ.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio};bQ.prototype.set_ratio=function(ea){this.zpp_inner.immutable_midstep("MotorJoint::ratio");if(this.zpp_inner_zn.ratio!=ea){this.zpp_inner_zn.ratio=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.ratio};bQ.prototype.get_rate=function(){return this.zpp_inner_zn.rate};bQ.prototype.set_rate=function(ea){this.zpp_inner.immutable_midstep("MotorJoint::rate");if(this.zpp_inner_zn.rate!=ea){this.zpp_inner_zn.rate=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.rate};bQ.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};bQ.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};bQ.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(bQ.prototype,"body1",{get:bQ.prototype.get_body1,set:bQ.prototype.set_body1});Object.defineProperty(bQ.prototype,"body2",{get:bQ.prototype.get_body2,set:bQ.prototype.set_body2});Object.defineProperty(bQ.prototype,"ratio",{get:bQ.prototype.get_ratio,set:bQ.prototype.set_ratio});Object.defineProperty(bQ.prototype,"rate",{get:bQ.prototype.get_rate,set:bQ.prototype.set_rate});bQ.prototype.__class__=bQ;var bV=nape.constraint.PivotJoint=function(ee,ec,ez,ex){this.zpp_inner_zn=null;this.zpp_inner_zn=new D();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var el=ee==null?null:ee.zpp_inner;if(el!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=el;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&el!=null&&this.zpp_inner_zn.b2!=el){if(el!=null){el.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(el!=null){el.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ei=ec==null?null:ec.zpp_inner;if(ei!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ei;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ei!=null&&this.zpp_inner_zn.b1!=ei){if(ei!=null){ei.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ei!=null){ei.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var en=this.zpp_inner_zn.wrap_a1;var ev=ez.zpp_inner;if(ev._validate!=null){ev._validate()}var ed=ez.zpp_inner.x;var eu=ez.zpp_inner;if(eu._validate!=null){eu._validate()}var eb=ez.zpp_inner.y;var ew;var es=en.zpp_inner;if(es._validate!=null){es._validate()}if(en.zpp_inner.x==ed){var er=en.zpp_inner;if(er._validate!=null){er._validate()}ew=en.zpp_inner.y==eb}else{ew=false}if(!ew){en.zpp_inner.x=ed;en.zpp_inner.y=eb;var eq=en.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}}if(ez.zpp_inner.weak){var ey=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;ez.zpp_pool=au.poolVec2;au.poolVec2=ez;if(ey.outer!=null){ey.outer.zpp_inner=null;ey.outer=null}ey._isimmutable=null;ey._validate=null;ey._invalidate=null;ey.next=bB.zpp_pool;bB.zpp_pool=ey}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var eo=this.zpp_inner_zn.wrap_a2;var ek=ex.zpp_inner;if(ek._validate!=null){ek._validate()}var et=ex.zpp_inner.x;var eh=ex.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ex.zpp_inner.y;var eg;var ef=eo.zpp_inner;if(ef._validate!=null){ef._validate()}if(eo.zpp_inner.x==et){var em=eo.zpp_inner;if(em._validate!=null){em._validate()}eg=eo.zpp_inner.y==ea}else{eg=false}if(!eg){eo.zpp_inner.x=et;eo.zpp_inner.y=ea;var ej=eo.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}if(ex.zpp_inner.weak){var ep=ex.zpp_inner;ex.zpp_inner.outer=null;ex.zpp_inner=null;ex.zpp_pool=au.poolVec2;au.poolVec2=ex;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}};bV.__name__=["nape","constraint","PivotJoint"];bV.__super__=cK;bV.prototype=Object.create(cK.prototype);bV.prototype.zpp_inner_zn=null;bV.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bV.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bV.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bV.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bV.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};bV.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};bV.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};bV.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};bV.prototype.impulse=function(){var ea=new bY(2,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAccx;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccy;return ea};bV.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};bV.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(bV.prototype,"body1",{get:bV.prototype.get_body1,set:bV.prototype.set_body1});Object.defineProperty(bV.prototype,"body2",{get:bV.prototype.get_body2,set:bV.prototype.set_body2});Object.defineProperty(bV.prototype,"anchor1",{get:bV.prototype.get_anchor1,set:bV.prototype.set_anchor1});Object.defineProperty(bV.prototype,"anchor2",{get:bV.prototype.get_anchor2,set:bV.prototype.set_anchor2});bV.prototype.__class__=bV;var dy=nape.constraint.PulleyJoint=function(ek,ei,eg,ef,ed,ec,eb,ea,eZ,eq,eF){if(eF==null){eF=1}this.zpp_inner_zn=null;this.zpp_inner_zn=new N();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var em=ek==null?null:ek.zpp_inner;if(em!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=em;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&em!=null&&this.zpp_inner_zn.b2!=em&&this.zpp_inner_zn.b3!=em&&this.zpp_inner_zn.b4!=em){if(em!=null){em.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(em!=null){em.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var el=ei==null?null:ei.zpp_inner;if(el!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=el;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&el!=null&&this.zpp_inner_zn.b1!=el&&this.zpp_inner_zn.b3!=el&&this.zpp_inner_zn.b4!=el){if(el!=null){el.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(el!=null){el.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body3");var ej=eg==null?null:eg.zpp_inner;if(ej!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b3.wake()}}this.zpp_inner_zn.b3=ej;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ej!=null&&this.zpp_inner_zn.b1!=ej&&this.zpp_inner_zn.b2!=ej&&this.zpp_inner_zn.b4!=ej){if(ej!=null){ej.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ej!=null){ej.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body4");var eh=ef==null?null:ef.zpp_inner;if(eh!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b4.wake()}}this.zpp_inner_zn.b4=eh;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eh!=null&&this.zpp_inner_zn.b1!=eh&&this.zpp_inner_zn.b2!=eh&&this.zpp_inner_zn.b3!=eh){if(eh!=null){eh.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eh!=null){eh.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ee=this.zpp_inner_zn.wrap_a1;var eH=ed.zpp_inner;if(eH._validate!=null){eH._validate()}var eC=ed.zpp_inner.x;var eG=ed.zpp_inner;if(eG._validate!=null){eG._validate()}var eA=ed.zpp_inner.y;var eK;var eE=ee.zpp_inner;if(eE._validate!=null){eE._validate()}if(ee.zpp_inner.x==eC){var eD=ee.zpp_inner;if(eD._validate!=null){eD._validate()}eK=ee.zpp_inner.y==eA}else{eK=false}if(!eK){ee.zpp_inner.x=eC;ee.zpp_inner.y=eA;var eB=ee.zpp_inner;if(eB._invalidate!=null){eB._invalidate(eB)}}if(ed.zpp_inner.weak){var er=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(er.outer!=null){er.outer.zpp_inner=null;er.outer=null}er._isimmutable=null;er._validate=null;er._invalidate=null;er.next=bB.zpp_pool;bB.zpp_pool=er}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ez=this.zpp_inner_zn.wrap_a2;var ey=ec.zpp_inner;if(ey._validate!=null){ey._validate()}var ep=ec.zpp_inner.x;var ex=ec.zpp_inner;if(ex._validate!=null){ex._validate()}var e2=ec.zpp_inner.y;var eY;var ew=ez.zpp_inner;if(ew._validate!=null){ew._validate()}if(ez.zpp_inner.x==ep){var eX=ez.zpp_inner;if(eX._validate!=null){eX._validate()}eY=ez.zpp_inner.y==e2}else{eY=false}if(!eY){ez.zpp_inner.x=ep;ez.zpp_inner.y=e2;var eV=ez.zpp_inner;if(eV._invalidate!=null){eV._invalidate(eV)}}if(ec.zpp_inner.weak){var eM=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(eM.outer!=null){eM.outer.zpp_inner=null;eM.outer=null}eM._isimmutable=null;eM._validate=null;eM._invalidate=null;eM.next=bB.zpp_pool;bB.zpp_pool=eM}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}var eT=this.zpp_inner_zn.wrap_a3;var eS=eb.zpp_inner;if(eS._validate!=null){eS._validate()}var eo=eb.zpp_inner.x;var eR=eb.zpp_inner;if(eR._validate!=null){eR._validate()}var e1=eb.zpp_inner.y;var eW;var eQ=eT.zpp_inner;if(eQ._validate!=null){eQ._validate()}if(eT.zpp_inner.x==eo){var eP=eT.zpp_inner;if(eP._validate!=null){eP._validate()}eW=eT.zpp_inner.y==e1}else{eW=false}if(!eW){eT.zpp_inner.x=eo;eT.zpp_inner.y=e1;var eO=eT.zpp_inner;if(eO._invalidate!=null){eO._invalidate(eO)}}if(eb.zpp_inner.weak){var eJ=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(eJ.outer!=null){eJ.outer.zpp_inner=null;eJ.outer=null}eJ._isimmutable=null;eJ._validate=null;eJ._invalidate=null;eJ.next=bB.zpp_pool;bB.zpp_pool=eJ}if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}var eN=this.zpp_inner_zn.wrap_a4;var eL=ea.zpp_inner;if(eL._validate!=null){eL._validate()}var en=ea.zpp_inner.x;var ev=ea.zpp_inner;if(ev._validate!=null){ev._validate()}var e0=ea.zpp_inner.y;var eU;var eu=eN.zpp_inner;if(eu._validate!=null){eu._validate()}if(eN.zpp_inner.x==en){var et=eN.zpp_inner;if(et._validate!=null){et._validate()}eU=eN.zpp_inner.y==e0}else{eU=false}if(!eU){eN.zpp_inner.x=en;eN.zpp_inner.y=e0;var es=eN.zpp_inner;if(es._invalidate!=null){es._invalidate(es)}}if(ea.zpp_inner.weak){var eI=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eI.outer!=null){eI.outer.zpp_inner=null;eI.outer=null}eI._isimmutable=null;eI._validate=null;eI._invalidate=null;eI.next=bB.zpp_pool;bB.zpp_pool=eI}if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}this.zpp_inner.immutable_midstep("PulleyJoint::ratio");if(this.zpp_inner_zn.ratio!=eF){this.zpp_inner_zn.ratio=eF;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");if(this.zpp_inner_zn.jointMin!=eZ){this.zpp_inner_zn.jointMin=eZ;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");if(this.zpp_inner_zn.jointMax!=eq){this.zpp_inner_zn.jointMax=eq;this.zpp_inner.wake()}};dy.__name__=["nape","constraint","PulleyJoint"];dy.__super__=cK;dy.prototype=Object.create(cK.prototype);dy.prototype.zpp_inner_zn=null;dy.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dy.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb&&this.zpp_inner_zn.b3!=eb&&this.zpp_inner_zn.b4!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dy.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dy.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb&&this.zpp_inner_zn.b3!=eb&&this.zpp_inner_zn.b4!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dy.prototype.get_body3=function(){if(this.zpp_inner_zn.b3==null){return null}else{return this.zpp_inner_zn.b3.outer}};dy.prototype.set_body3=function(ea){this.zpp_inner.immutable_midstep("Constraint::body3");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b3.wake()}}this.zpp_inner_zn.b3=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb&&this.zpp_inner_zn.b2!=eb&&this.zpp_inner_zn.b4!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b3==null){return null}else{return this.zpp_inner_zn.b3.outer}};dy.prototype.get_body4=function(){if(this.zpp_inner_zn.b4==null){return null}else{return this.zpp_inner_zn.b4.outer}};dy.prototype.set_body4=function(ea){this.zpp_inner.immutable_midstep("Constraint::body4");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b4.wake()}}this.zpp_inner_zn.b4=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb&&this.zpp_inner_zn.b2!=eb&&this.zpp_inner_zn.b3!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b4==null){return null}else{return this.zpp_inner_zn.b4.outer}};dy.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dy.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dy.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dy.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dy.prototype.get_anchor3=function(){if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}return this.zpp_inner_zn.wrap_a3};dy.prototype.set_anchor3=function(ej){if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}var ed=this.zpp_inner_zn.wrap_a3;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}return this.zpp_inner_zn.wrap_a3};dy.prototype.get_anchor4=function(){if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}return this.zpp_inner_zn.wrap_a4};dy.prototype.set_anchor4=function(ej){if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}var ed=this.zpp_inner_zn.wrap_a4;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}return this.zpp_inner_zn.wrap_a4};dy.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};dy.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};dy.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};dy.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};dy.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio};dy.prototype.set_ratio=function(ea){this.zpp_inner.immutable_midstep("PulleyJoint::ratio");if(this.zpp_inner_zn.ratio!=ea){this.zpp_inner_zn.ratio=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.ratio};dy.prototype.isSlack=function(){return this.zpp_inner_zn.slack};dy.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};dy.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};dy.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}if((this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)!=null&&(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)&&(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)!=(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)){ea(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)}if((this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=null&&(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)&&(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)&&(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)){ea(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)}};Object.defineProperty(dy.prototype,"body1",{get:dy.prototype.get_body1,set:dy.prototype.set_body1});Object.defineProperty(dy.prototype,"body2",{get:dy.prototype.get_body2,set:dy.prototype.set_body2});Object.defineProperty(dy.prototype,"body3",{get:dy.prototype.get_body3,set:dy.prototype.set_body3});Object.defineProperty(dy.prototype,"body4",{get:dy.prototype.get_body4,set:dy.prototype.set_body4});Object.defineProperty(dy.prototype,"anchor1",{get:dy.prototype.get_anchor1,set:dy.prototype.set_anchor1});Object.defineProperty(dy.prototype,"anchor2",{get:dy.prototype.get_anchor2,set:dy.prototype.set_anchor2});Object.defineProperty(dy.prototype,"anchor3",{get:dy.prototype.get_anchor3,set:dy.prototype.set_anchor3});Object.defineProperty(dy.prototype,"anchor4",{get:dy.prototype.get_anchor4,set:dy.prototype.set_anchor4});Object.defineProperty(dy.prototype,"jointMin",{get:dy.prototype.get_jointMin,set:dy.prototype.set_jointMin});Object.defineProperty(dy.prototype,"jointMax",{get:dy.prototype.get_jointMax,set:dy.prototype.set_jointMax});Object.defineProperty(dy.prototype,"ratio",{get:dy.prototype.get_ratio,set:dy.prototype.set_ratio});dy.prototype.__class__=dy;var aU=nape.constraint.UserConstraint=function(eb,ea){if(ea==null){ea=false}this.zpp_inner_zn=null;this.zpp_inner_zn=new b4(eb,ea);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this)};aU.__name__=["nape","constraint","UserConstraint"];aU.__super__=cK;aU.prototype=Object.create(cK.prototype);aU.prototype.zpp_inner_zn=null;aU.prototype.__bindVec2=function(){var ea=new r();ea.zpp_inner._inuse=true;ea.zpp_inner._invalidate=(bo=this.zpp_inner_zn,dX(bo,bo.bindVec2_invalidate));return ea};aU.prototype.__copy=function(){return null};aU.prototype.__broken=function(){};aU.prototype.__validate=function(){};aU.prototype.__draw=function(ea){};aU.prototype.__prepare=function(){};aU.prototype.__position=function(ea){};aU.prototype.__velocity=function(ea){};aU.prototype.__eff_mass=function(ea){};aU.prototype.__clamp=function(ea){};aU.prototype.__impulse=function(ec,ea,eb){};aU.prototype.impulse=function(){var ea=new bY(this.zpp_inner_zn.dim,1);var ec=0;var ed=this.zpp_inner_zn.dim;while(ec<ed){var eb=ec++;ea.zpp_inner.x[eb*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc[eb]}return ea};aU.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};aU.prototype.visitBodies=function(eb){var ed=0;var ec=this.zpp_inner_zn.bodies.length;while(ed<ec){var ea=this.zpp_inner_zn.bodies[ed];if(ea.body!=null){var ef=false;var ee=ed+1;while(ee<ec){if(this.zpp_inner_zn.bodies[ee++].body==ea.body){ef=true;break}}if(!ef){eb(ea.body.outer)}}++ed}};aU.prototype.__invalidate=function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()");if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake()}};aU.prototype.__registerBody=function(ea,eb){this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)");if(ea!=eb){if(ea!=null){this.zpp_inner_zn.remBody(ea.zpp_inner);if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){ea.zpp_inner.wake()}}if(eb!=null){this.zpp_inner_zn.addBody(eb.zpp_inner)}this.zpp_inner.wake();if(eb!=null){eb.zpp_inner.wake()}}return eb};aU.prototype.__class__=aU;var cX=nape.constraint.WeldJoint=function(ef,ed,eA,ey,eb){if(eb==null){eb=0}this.zpp_inner_zn=null;this.zpp_inner_zn=new aC();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var em=ef==null?null:ef.zpp_inner;if(em!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=em;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&em!=null&&this.zpp_inner_zn.b2!=em){if(em!=null){em.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(em!=null){em.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ej=ed==null?null:ed.zpp_inner;if(ej!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ej;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ej!=null&&this.zpp_inner_zn.b1!=ej){if(ej!=null){ej.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ej!=null){ej.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ep=this.zpp_inner_zn.wrap_a1;var ew=eA.zpp_inner;if(ew._validate!=null){ew._validate()}var ee=eA.zpp_inner.x;var ev=eA.zpp_inner;if(ev._validate!=null){ev._validate()}var ec=eA.zpp_inner.y;var ex;var et=ep.zpp_inner;if(et._validate!=null){et._validate()}if(ep.zpp_inner.x==ee){var es=ep.zpp_inner;if(es._validate!=null){es._validate()}ex=ep.zpp_inner.y==ec}else{ex=false}if(!ex){ep.zpp_inner.x=ee;ep.zpp_inner.y=ec;var er=ep.zpp_inner;if(er._invalidate!=null){er._invalidate(er)}}if(eA.zpp_inner.weak){var ez=eA.zpp_inner;eA.zpp_inner.outer=null;eA.zpp_inner=null;eA.zpp_pool=au.poolVec2;au.poolVec2=eA;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var eo=this.zpp_inner_zn.wrap_a2;var el=ey.zpp_inner;if(el._validate!=null){el._validate()}var eu=ey.zpp_inner.x;var ei=ey.zpp_inner;if(ei._validate!=null){ei._validate()}var ea=ey.zpp_inner.y;var eh;var eg=eo.zpp_inner;if(eg._validate!=null){eg._validate()}if(eo.zpp_inner.x==eu){var en=eo.zpp_inner;if(en._validate!=null){en._validate()}eh=eo.zpp_inner.y==ea}else{eh=false}if(!eh){eo.zpp_inner.x=eu;eo.zpp_inner.y=ea;var ek=eo.zpp_inner;if(ek._invalidate!=null){ek._invalidate(ek)}}if(ey.zpp_inner.weak){var eq=ey.zpp_inner;ey.zpp_inner.outer=null;ey.zpp_inner=null;ey.zpp_pool=au.poolVec2;au.poolVec2=ey;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}this.zpp_inner.immutable_midstep("WeldJoint::phase");if(this.zpp_inner_zn.phase!=eb){this.zpp_inner_zn.phase=eb;this.zpp_inner.wake()}};cX.__name__=["nape","constraint","WeldJoint"];cX.__super__=cK;cX.prototype=Object.create(cK.prototype);cX.prototype.zpp_inner_zn=null;cX.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};cX.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};cX.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};cX.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};cX.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};cX.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};cX.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};cX.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};cX.prototype.get_phase=function(){return this.zpp_inner_zn.phase};cX.prototype.set_phase=function(ea){this.zpp_inner.immutable_midstep("WeldJoint::phase");if(this.zpp_inner_zn.phase!=ea){this.zpp_inner_zn.phase=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.phase};cX.prototype.impulse=function(){var ea=new bY(3,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAccx;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccy;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccz;return ea};cX.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};cX.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(cX.prototype,"body1",{get:cX.prototype.get_body1,set:cX.prototype.set_body1});Object.defineProperty(cX.prototype,"body2",{get:cX.prototype.get_body2,set:cX.prototype.set_body2});Object.defineProperty(cX.prototype,"anchor1",{get:cX.prototype.get_anchor1,set:cX.prototype.set_anchor1});Object.defineProperty(cX.prototype,"anchor2",{get:cX.prototype.get_anchor2,set:cX.prototype.set_anchor2});Object.defineProperty(cX.prototype,"phase",{get:cX.prototype.get_phase,set:cX.prototype.set_phase});cX.prototype.__class__=cX;var aD=nape.dynamics.Arbiter=function(){this.zpp_inner=null};aD.__name__=["nape","dynamics","Arbiter"];aD.prototype.zpp_inner=null;aD.prototype.get_isSleeping=function(){return this.zpp_inner.sleeping};aD.prototype.get_type=function(){return j.types[this.zpp_inner.type]};aD.prototype.isCollisionArbiter=function(){return this.zpp_inner.type==j.COL};aD.prototype.isFluidArbiter=function(){return this.zpp_inner.type==j.FLUID};aD.prototype.isSensorArbiter=function(){return this.zpp_inner.type==j.SENSOR};aD.prototype.get_collisionArbiter=function(){if(this.zpp_inner.type==j.COL){return this.zpp_inner.colarb.outer_zn}else{return null}};aD.prototype.get_fluidArbiter=function(){if(this.zpp_inner.type==j.FLUID){return this.zpp_inner.fluidarb.outer_zn}else{return null}};aD.prototype.get_shape1=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.ws2.outer}else{return this.zpp_inner.ws1.outer}};aD.prototype.get_shape2=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.ws1.outer}else{return this.zpp_inner.ws2.outer}};aD.prototype.get_body1=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.b2.outer}else{return this.zpp_inner.b1.outer}};aD.prototype.get_body2=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.b1.outer}else{return this.zpp_inner.b2.outer}};aD.prototype.get_state=function(){var ea=this.zpp_inner.immState;if(ea==5){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}return br.PreFlag_ACCEPT}else{if(ea==1){if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}return br.PreFlag_ACCEPT_ONCE}else{if(ea==6){if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}return br.PreFlag_IGNORE}else{if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}return br.PreFlag_IGNORE_ONCE}}}};aD.prototype.totalImpulse=function(ea,eb){if(eb==null){eb=false}return q.get(0,0,0)};aD.prototype.toString=function(){var ea=this.zpp_inner.type==j.COL?"CollisionArbiter":this.zpp_inner.type==j.FLUID?"FluidArbiter":"SensorArbiter";if(this.zpp_inner.cleared){return ea+"(object-pooled)"}else{var eb=ea+"("+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|"+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==j.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-";var ed=this.zpp_inner.immState;var ec;if(ed==5){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}ec=br.PreFlag_ACCEPT}else{if(ed==1){if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}ec=br.PreFlag_ACCEPT_ONCE}else{if(ed==6){if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}ec=br.PreFlag_IGNORE}else{if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}ec=br.PreFlag_IGNORE_ONCE}}}return eb+ec.toString()}};Object.defineProperty(aD.prototype,"isSleeping",{get:aD.prototype.get_isSleeping});Object.defineProperty(aD.prototype,"type",{get:aD.prototype.get_type});Object.defineProperty(aD.prototype,"collisionArbiter",{get:aD.prototype.get_collisionArbiter});Object.defineProperty(aD.prototype,"fluidArbiter",{get:aD.prototype.get_fluidArbiter});Object.defineProperty(aD.prototype,"shape1",{get:aD.prototype.get_shape1});Object.defineProperty(aD.prototype,"shape2",{get:aD.prototype.get_shape2});Object.defineProperty(aD.prototype,"body1",{get:aD.prototype.get_body1});Object.defineProperty(aD.prototype,"body2",{get:aD.prototype.get_body2});Object.defineProperty(aD.prototype,"state",{get:aD.prototype.get_state});aD.prototype.__class__=aD;var d0=nape.dynamics.ArbiterIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};d0.__name__=["nape","dynamics","ArbiterIterator"];d0.get=function(ec){var ea;if(d0.zpp_pool==null){U.internal=true;var ed=new d0();U.internal=false;ea=ed}else{var eb=d0.zpp_pool;d0.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};d0.prototype.zpp_inner=null;d0.prototype.zpp_i=null;d0.prototype.zpp_critical=null;d0.prototype.zpp_next=null;d0.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var ea=this.zpp_inner.zpp_gl();this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=d0.zpp_pool;d0.zpp_pool=this;this.zpp_inner=null;return false}};d0.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};d0.prototype.__class__=d0;var dD=nape.dynamics.ArbiterList=function(){this.zpp_inner=null;this.zpp_inner=new U();this.zpp_inner.outer=this};dD.__name__=["nape","dynamics","ArbiterList"];dD.fromArray=function(ed){var ea=new dD();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};dD.prototype.zpp_inner=null;dD.prototype.get_length=function(){return this.zpp_gl()};dD.prototype.zpp_gl=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ea=this.zpp_inner.inner.head;while(ea!=null){if(ea.elt.active){this.zpp_inner.user_length++}ea=ea.next}}return this.zpp_inner.user_length};dD.prototype.zpp_vm=function(){this.zpp_inner.valmod()};dD.prototype.has=function(ea){this.zpp_vm();return this.zpp_inner.inner.has(ea.zpp_inner)};dD.prototype.at=function(ea){this.zpp_vm();if(this.zpp_inner.reverse_flag){ea=this.zpp_gl()-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=0;this.zpp_inner.at_ite=this.zpp_inner.inner.head;while(!this.zpp_inner.at_ite.elt.active){this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;while(!this.zpp_inner.at_ite.elt.active){this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.wrapper()};dD.prototype.push=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(eb.zpp_inner)}else{if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};dD.prototype.unshift=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}else{this.zpp_inner.inner.add(eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};dD.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.wrapper()};dD.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.wrapper()};dD.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};dD.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_vm();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};dD.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(!this.empty()){this.pop()}}else{while(!this.empty()){this.shift()}}};dD.prototype.empty=function(){return this.zpp_gl()==0};dD.prototype.iterator=function(){this.zpp_vm();return d0.get(this)};dD.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new dD();var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ee=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};dD.prototype.merge=function(eb){var ee=eb.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){this.add(ea)}}};dD.prototype.toString=function(){var eb="[";var ea=true;var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ee=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};dD.prototype.foreach=function(ea){var ec=this.iterator();while(true){ec.zpp_inner.zpp_inner.valmod();var ed=ec.zpp_inner.zpp_gl();ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=d0.zpp_pool;d0.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=d0.zpp_pool;d0.zpp_pool=ec;ec.zpp_inner=null;break}}return this};dD.prototype.filter=function(eb){var ec=0;while(ec<this.zpp_gl()){var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(dD.prototype,"length",{get:dD.prototype.get_length});dD.prototype.__class__=dD;var av=nape.dynamics.ArbiterType=function(){};av.__name__=["nape","dynamics","ArbiterType"];av.COLLISION=null;av.get_COLLISION=function(){if(br.ArbiterType_COLLISION==null){br.internal=true;br.ArbiterType_COLLISION=new av();br.internal=false}return br.ArbiterType_COLLISION};av.SENSOR=null;av.get_SENSOR=function(){if(br.ArbiterType_SENSOR==null){br.internal=true;br.ArbiterType_SENSOR=new av();br.internal=false}return br.ArbiterType_SENSOR};av.FLUID=null;av.get_FLUID=function(){if(br.ArbiterType_FLUID==null){br.internal=true;br.ArbiterType_FLUID=new av();br.internal=false}return br.ArbiterType_FLUID};av.prototype.toString=function(){if(br.ArbiterType_COLLISION==null){br.internal=true;br.ArbiterType_COLLISION=new av();br.internal=false}if(this==br.ArbiterType_COLLISION){return"COLLISION"}else{if(br.ArbiterType_SENSOR==null){br.internal=true;br.ArbiterType_SENSOR=new av();br.internal=false}if(this==br.ArbiterType_SENSOR){return"SENSOR"}else{if(br.ArbiterType_FLUID==null){br.internal=true;br.ArbiterType_FLUID=new av();br.internal=false}if(this==br.ArbiterType_FLUID){return"FLUID"}else{return""}}}};Object.defineProperty(av,"COLLISION",{get:av.get_COLLISION});Object.defineProperty(av,"SENSOR",{get:av.get_SENSOR});Object.defineProperty(av,"FLUID",{get:av.get_FLUID});av.prototype.__class__=av;var ak=nape.dynamics.CollisionArbiter=function(){aD.call(this)};ak.__name__=["nape","dynamics","CollisionArbiter"];ak.__super__=aD;ak.prototype=Object.create(aD.prototype);ak.prototype.get_contacts=function(){if(this.zpp_inner.colarb.wrap_contacts==null){this.zpp_inner.colarb.setupcontacts()}return this.zpp_inner.colarb.wrap_contacts};ak.prototype.get_normal=function(){if(this.zpp_inner.colarb.wrap_normal==null){this.zpp_inner.colarb.getnormal()}return this.zpp_inner.colarb.wrap_normal};ak.prototype.get_radius=function(){return this.zpp_inner.colarb.radius};ak.prototype.get_referenceEdge1=function(){var ea=this.zpp_inner.colarb.__ref_edge1;if(ea!=null&&((this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).zpp_inner.type!=1||(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).zpp_inner!=ea.polygon)){ea=this.zpp_inner.colarb.__ref_edge2}if(ea==null){return null}else{return ea.wrapper()}};ak.prototype.get_referenceEdge2=function(){var ea=this.zpp_inner.colarb.__ref_edge1;if(ea!=null&&((this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).zpp_inner.type!=1||(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).zpp_inner!=ea.polygon)){ea=this.zpp_inner.colarb.__ref_edge2}if(ea==null){return null}else{return ea.wrapper()}};ak.prototype.firstVertex=function(){if(this.zpp_inner.colarb.__ref_edge1!=null!=(this.zpp_inner.colarb.__ref_edge2!=null)){return this.zpp_inner.colarb.__ref_vertex==-1}else{return false}};ak.prototype.secondVertex=function(){if(this.zpp_inner.colarb.__ref_edge1!=null!=(this.zpp_inner.colarb.__ref_edge2!=null)){return this.zpp_inner.colarb.__ref_vertex==1}else{return false}};ak.prototype.normalImpulse=function(ef,eb){if(eb==null){eb=false}var em=0;var ek=0;var ei=0;var en=this.zpp_inner.colarb;if(!eb||en.oc1.fresh){var ea=en.oc1.wrapper().normalImpulse(ef);var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}em+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ek+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ei+=ea.zpp_inner.z;ea.dispose()}if(en.hc2){if(!eb||en.oc2.fresh){var ec=en.oc2.wrapper().normalImpulse(ef);var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}em+=ec.zpp_inner.x;var ee=ec.zpp_inner;if(ee._validate!=null){ee._validate()}ek+=ec.zpp_inner.y;var ed=ec.zpp_inner;if(ed._validate!=null){ed._validate()}ei+=ec.zpp_inner.z;ec.dispose()}}return q.get(em,ek,ei)};ak.prototype.tangentImpulse=function(ef,eb){if(eb==null){eb=false}var em=0;var ek=0;var ei=0;var en=this.zpp_inner.colarb;if(!eb||en.oc1.fresh){var ea=en.oc1.wrapper().tangentImpulse(ef);var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}em+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ek+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ei+=ea.zpp_inner.z;ea.dispose()}if(en.hc2){if(!eb||en.oc2.fresh){var ec=en.oc2.wrapper().tangentImpulse(ef);var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}em+=ec.zpp_inner.x;var ee=ec.zpp_inner;if(ee._validate!=null){ee._validate()}ek+=ec.zpp_inner.y;var ed=ec.zpp_inner;if(ed._validate!=null){ed._validate()}ei+=ec.zpp_inner.z;ec.dispose()}}return q.get(em,ek,ei)};ak.prototype.totalImpulse=function(ef,eb){if(eb==null){eb=false}var em=0;var ek=0;var ei=0;var en=this.zpp_inner.colarb;if(!eb||en.oc1.fresh){var ea=en.oc1.wrapper().totalImpulse(ef);var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}em+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ek+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ei+=ea.zpp_inner.z;ea.dispose()}if(en.hc2){if(!eb||en.oc2.fresh){var ec=en.oc2.wrapper().totalImpulse(ef);var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}em+=ec.zpp_inner.x;var ee=ec.zpp_inner;if(ee._validate!=null){ee._validate()}ek+=ec.zpp_inner.y;var ed=ec.zpp_inner;if(ed._validate!=null){ed._validate()}ei+=ec.zpp_inner.z;ec.dispose()}}return q.get(em,ek,ei)};ak.prototype.rollingImpulse=function(ea,eb){if(eb==null){eb=false}var ec=this.zpp_inner.colarb;if(!eb||ec.oc1.fresh){return ec.oc1.wrapper().rollingImpulse(ea)}else{return 0}};ak.prototype.get_elasticity=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.restitution};ak.prototype.set_elasticity=function(eb){var ea=this.zpp_inner.colarb;ea.restitution=eb;ea.userdef_restitution=true;var ec=this.zpp_inner.colarb;if(ec.invalidated){ec.invalidated=false;if(!ec.userdef_restitution){if(ec.s1.material.elasticity<=-Infinity||ec.s2.material.elasticity<=-Infinity){ec.restitution=0}else{if(ec.s1.material.elasticity>=Infinity||ec.s2.material.elasticity>=Infinity){ec.restitution=1}else{ec.restitution=(ec.s1.material.elasticity+ec.s2.material.elasticity)/2}}if(ec.restitution<0){ec.restitution=0}if(ec.restitution>1){ec.restitution=1}}if(!ec.userdef_dyn_fric){ec.dyn_fric=Math.sqrt(ec.s1.material.dynamicFriction*ec.s2.material.dynamicFriction)}if(!ec.userdef_stat_fric){ec.stat_fric=Math.sqrt(ec.s1.material.staticFriction*ec.s2.material.staticFriction)}if(!ec.userdef_rfric){ec.rfric=Math.sqrt(ec.s1.material.rollingFriction*ec.s2.material.rollingFriction)}}return ec.restitution};ak.prototype.get_dynamicFriction=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.dyn_fric};ak.prototype.set_dynamicFriction=function(ea){var eb=this.zpp_inner.colarb;eb.dyn_fric=ea;eb.userdef_dyn_fric=true;var ec=this.zpp_inner.colarb;if(ec.invalidated){ec.invalidated=false;if(!ec.userdef_restitution){if(ec.s1.material.elasticity<=-Infinity||ec.s2.material.elasticity<=-Infinity){ec.restitution=0}else{if(ec.s1.material.elasticity>=Infinity||ec.s2.material.elasticity>=Infinity){ec.restitution=1}else{ec.restitution=(ec.s1.material.elasticity+ec.s2.material.elasticity)/2}}if(ec.restitution<0){ec.restitution=0}if(ec.restitution>1){ec.restitution=1}}if(!ec.userdef_dyn_fric){ec.dyn_fric=Math.sqrt(ec.s1.material.dynamicFriction*ec.s2.material.dynamicFriction)}if(!ec.userdef_stat_fric){ec.stat_fric=Math.sqrt(ec.s1.material.staticFriction*ec.s2.material.staticFriction)}if(!ec.userdef_rfric){ec.rfric=Math.sqrt(ec.s1.material.rollingFriction*ec.s2.material.rollingFriction)}}return ec.dyn_fric};ak.prototype.get_staticFriction=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.stat_fric};ak.prototype.set_staticFriction=function(ec){var ea=this.zpp_inner.colarb;ea.stat_fric=ec;ea.userdef_stat_fric=true;var eb=this.zpp_inner.colarb;if(eb.invalidated){eb.invalidated=false;if(!eb.userdef_restitution){if(eb.s1.material.elasticity<=-Infinity||eb.s2.material.elasticity<=-Infinity){eb.restitution=0}else{if(eb.s1.material.elasticity>=Infinity||eb.s2.material.elasticity>=Infinity){eb.restitution=1}else{eb.restitution=(eb.s1.material.elasticity+eb.s2.material.elasticity)/2}}if(eb.restitution<0){eb.restitution=0}if(eb.restitution>1){eb.restitution=1}}if(!eb.userdef_dyn_fric){eb.dyn_fric=Math.sqrt(eb.s1.material.dynamicFriction*eb.s2.material.dynamicFriction)}if(!eb.userdef_stat_fric){eb.stat_fric=Math.sqrt(eb.s1.material.staticFriction*eb.s2.material.staticFriction)}if(!eb.userdef_rfric){eb.rfric=Math.sqrt(eb.s1.material.rollingFriction*eb.s2.material.rollingFriction)}}return eb.stat_fric};ak.prototype.get_rollingFriction=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.rfric};ak.prototype.set_rollingFriction=function(ec){var ea=this.zpp_inner.colarb;ea.rfric=ec;ea.userdef_rfric=true;var eb=this.zpp_inner.colarb;if(eb.invalidated){eb.invalidated=false;if(!eb.userdef_restitution){if(eb.s1.material.elasticity<=-Infinity||eb.s2.material.elasticity<=-Infinity){eb.restitution=0}else{if(eb.s1.material.elasticity>=Infinity||eb.s2.material.elasticity>=Infinity){eb.restitution=1}else{eb.restitution=(eb.s1.material.elasticity+eb.s2.material.elasticity)/2}}if(eb.restitution<0){eb.restitution=0}if(eb.restitution>1){eb.restitution=1}}if(!eb.userdef_dyn_fric){eb.dyn_fric=Math.sqrt(eb.s1.material.dynamicFriction*eb.s2.material.dynamicFriction)}if(!eb.userdef_stat_fric){eb.stat_fric=Math.sqrt(eb.s1.material.staticFriction*eb.s2.material.staticFriction)}if(!eb.userdef_rfric){eb.rfric=Math.sqrt(eb.s1.material.rollingFriction*eb.s2.material.rollingFriction)}}return eb.rfric};Object.defineProperty(ak.prototype,"contacts",{get:ak.prototype.get_contacts});Object.defineProperty(ak.prototype,"normal",{get:ak.prototype.get_normal});Object.defineProperty(ak.prototype,"radius",{get:ak.prototype.get_radius});Object.defineProperty(ak.prototype,"referenceEdge1",{get:ak.prototype.get_referenceEdge1});Object.defineProperty(ak.prototype,"referenceEdge2",{get:ak.prototype.get_referenceEdge2});Object.defineProperty(ak.prototype,"elasticity",{get:ak.prototype.get_elasticity,set:ak.prototype.set_elasticity});Object.defineProperty(ak.prototype,"dynamicFriction",{get:ak.prototype.get_dynamicFriction,set:ak.prototype.set_dynamicFriction});Object.defineProperty(ak.prototype,"staticFriction",{get:ak.prototype.get_staticFriction,set:ak.prototype.set_staticFriction});Object.defineProperty(ak.prototype,"rollingFriction",{get:ak.prototype.get_rollingFriction,set:ak.prototype.set_rollingFriction});ak.prototype.__class__=ak;var d8=nape.dynamics.Contact=function(){this.zpp_inner=null};d8.__name__=["nape","dynamics","Contact"];d8.prototype.zpp_inner=null;d8.prototype.get_arbiter=function(){if(this.zpp_inner.arbiter==null){return null}else{var ea=this.zpp_inner.arbiter.outer;if(ea.zpp_inner.type==j.COL){return ea.zpp_inner.colarb.outer_zn}else{return null}}};d8.prototype.get_penetration=function(){return -this.zpp_inner.dist};d8.prototype.get_position=function(){if(this.zpp_inner.wrap_position==null){this.zpp_inner.getposition()}return this.zpp_inner.wrap_position};d8.prototype.get_fresh=function(){return this.zpp_inner.fresh};d8.prototype.normalImpulse=function(eb){var ed=this.zpp_inner.arbiter.colarb;var ea=this.zpp_inner.inner;var ec=ea.jnAcc;if(eb==null){return q.get(ed.nx*ec,ed.ny*ec)}else{if(eb==ed.b1.outer){return q.get(ed.nx*-ec,ed.ny*-ec,-(ed.ny*ea.r1x-ed.nx*ea.r1y)*ec)}else{return q.get(ed.nx*ec,ed.ny*ec,(ed.ny*ea.r2x-ed.nx*ea.r2y)*ec)}}};d8.prototype.tangentImpulse=function(eb){var ed=this.zpp_inner.arbiter.colarb;var ea=this.zpp_inner.inner;var ec=ea.jtAcc;if(eb==null){return q.get(-ed.ny*ec,ed.nx*ec)}else{if(eb==ed.b1.outer){return q.get(ed.ny*ec,-ed.nx*ec,-(ea.r1x*ed.nx+ea.r1y*ed.ny)*ec)}else{return q.get(-ed.ny*ec,ed.nx*ec,(ea.r2x*ed.nx+ea.r2y*ed.ny)*ec)}}};d8.prototype.rollingImpulse=function(eb){var ec=this.zpp_inner.arbiter.colarb;var ea=this.zpp_inner.arbiter.colarb.jrAcc;if(eb==null){return ea}else{if(eb==ec.b1.outer){return -ea}else{return ea}}};d8.prototype.totalImpulse=function(ec){var eh=this.zpp_inner.arbiter.colarb;var eb=this.zpp_inner.inner;var ed=eb.jnAcc;var eg=eb.jtAcc;var ea=eh.jrAcc;if(ec==null){return q.get(eh.nx*ed-eh.ny*eg,eh.ny*ed+eh.nx*eg,ea)}else{var ef=eh.nx*ed-eh.ny*eg;var ee=eh.ny*ed+eh.nx*eg;if(ec==eh.b1.outer){return q.get(-ef,-ee,-(ee*eb.r1x-ef*eb.r1y)-ea)}else{return q.get(ef,ee,ee*eb.r2x-ef*eb.r2y+ea)}}};d8.prototype.get_friction=function(){return this.zpp_inner.inner.friction};d8.prototype.toString=function(){if(this.zpp_inner.arbiter==null||this.zpp_inner.arbiter.cleared){return"{object-pooled}"}else{return"{Contact}"}};Object.defineProperty(d8.prototype,"arbiter",{get:d8.prototype.get_arbiter});Object.defineProperty(d8.prototype,"penetration",{get:d8.prototype.get_penetration});Object.defineProperty(d8.prototype,"position",{get:d8.prototype.get_position});Object.defineProperty(d8.prototype,"fresh",{get:d8.prototype.get_fresh});Object.defineProperty(d8.prototype,"friction",{get:d8.prototype.get_friction});d8.prototype.__class__=d8;var d5=nape.dynamics.ContactIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};d5.__name__=["nape","dynamics","ContactIterator"];d5.get=function(ec){var ea;if(d5.zpp_pool==null){aB.internal=true;var ed=new d5();aB.internal=false;ea=ed}else{var eb=d5.zpp_pool;d5.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};d5.prototype.zpp_inner=null;d5.prototype.zpp_i=null;d5.prototype.zpp_critical=null;d5.prototype.zpp_next=null;d5.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var ed=this.zpp_inner;ed.zpp_inner.valmod();if(ed.zpp_inner.zip_length){ed.zpp_inner.zip_length=false;ed.zpp_inner.user_length=0;var eb=ed.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){ed.zpp_inner.user_length++}eb=eb.next}}var ec=ed.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ec){return true}else{this.zpp_next=d5.zpp_pool;d5.zpp_pool=this;this.zpp_inner=null;return false}};d5.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};d5.prototype.__class__=d5;var d7=nape.dynamics.ContactList=function(){this.zpp_inner=null;this.zpp_inner=new aB();this.zpp_inner.outer=this};d7.__name__=["nape","dynamics","ContactList"];d7.fromArray=function(ed){var ea=new d7();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};d7.prototype.zpp_inner=null;d7.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var eb=this.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){this.zpp_inner.user_length++}eb=eb.next}}return this.zpp_inner.user_length};d7.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};d7.prototype.at=function(ec){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ee=this.zpp_inner.inner.next;while(ee!=null){var ed=ee;if(ed.active&&ed.arbiter.active){this.zpp_inner.user_length++}ee=ee.next}}ec=this.zpp_inner.user_length-1-ec}if(ec<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=0;this.zpp_inner.at_ite=this.zpp_inner.inner.next;while(true){var ea=this.zpp_inner.at_ite;if(ea.active&&ea.arbiter.active){break}this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}while(this.zpp_inner.at_index!=ec){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;while(true){var eb=this.zpp_inner.at_ite;if(eb.active&&eb.arbiter.active){break}this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.wrapper()};d7.prototype.push=function(eg){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eg):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(eg.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var ed;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ec=this.zpp_inner.inner.next;while(ec!=null){var eb=ec;if(eb.active&&eb.arbiter.active){this.zpp_inner.user_length++}ec=ec.next}}if(this.zpp_inner.user_length==0){ed=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}ed=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=ed}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eg.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eg)}}return ea};d7.prototype.unshift=function(eg){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eg):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var ed;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ec=this.zpp_inner.inner.next;while(ec!=null){var eb=ec;if(eb.active&&eb.arbiter.active){this.zpp_inner.user_length++}ec=ec.next}}if(this.zpp_inner.user_length==0){ed=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}ed=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=ed}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eg.zpp_inner)}else{this.zpp_inner.inner.add(eg.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eg)}}return ea};d7.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.next;var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var eg;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ed=this.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){this.zpp_inner.user_length++}ed=ed.next}}if(this.zpp_inner.user_length==1){eg=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}eg=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(eg==null){eb=this.zpp_inner.inner.next}else{eb=eg.next}var eh=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(eh)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(eg)}}this.zpp_inner.invalidate();return eb.wrapper()};d7.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var eg;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ed=this.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){this.zpp_inner.user_length++}ed=ed.next}}if(this.zpp_inner.user_length==1){eg=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}eg=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(eg==null){eb=this.zpp_inner.inner.next}else{eb=eg.next}var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(eg)}}else{eb=this.zpp_inner.inner.next;var eh=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(eh)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.wrapper()};d7.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};d7.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.next;while(eb!=null){if(eb==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};d7.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var eb=this.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){this.zpp_inner.user_length++}eb=eb.next}}if(!(this.zpp_inner.user_length!=0)){break}this.pop()}}else{while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ed=this.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){this.zpp_inner.user_length++}ed=ed.next}}if(!(this.zpp_inner.user_length!=0)){break}this.shift()}}};d7.prototype.empty=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var eb=this.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){this.zpp_inner.user_length++}eb=eb.next}}return this.zpp_inner.user_length==0};d7.prototype.iterator=function(){this.zpp_inner.valmod();return d5.get(this)};d7.prototype.copy=function(ei){if(ei==null){ei=false}var eh=new d7();this.zpp_inner.valmod();var ef=d5.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=0;var eb=eg.zpp_inner.inner.next;while(eb!=null){var ed=eb;if(ed.active&&ed.arbiter.active){eg.zpp_inner.user_length++}eb=eb.next}}var ea=eg.zpp_inner.user_length;ef.zpp_critical=true;var ee;if(ef.zpp_i<ea){ee=true}else{ef.zpp_next=d5.zpp_pool;d5.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eh.push(ei?null:ec)}return eh};d7.prototype.merge=function(eb){eb.zpp_inner.valmod();var eg=d5.get(eb);while(true){eg.zpp_inner.zpp_inner.valmod();var eh=eg.zpp_inner;eh.zpp_inner.valmod();if(eh.zpp_inner.zip_length){eh.zpp_inner.zip_length=false;eh.zpp_inner.user_length=0;var ee=eh.zpp_inner.inner.next;while(ee!=null){var ed=ee;if(ed.active&&ed.arbiter.active){eh.zpp_inner.user_length++}ee=ee.next}}var ef=eh.zpp_inner.user_length;eg.zpp_critical=true;var ec;if(eg.zpp_i<ef){ec=true}else{eg.zpp_next=d5.zpp_pool;d5.zpp_pool=eg;eg.zpp_inner=null;ec=false}if(!ec){break}eg.zpp_critical=false;var ea=eg.zpp_inner.at(eg.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};d7.prototype.toString=function(){var ei="[";var ea=true;this.zpp_inner.valmod();var eg=d5.get(this);while(true){eg.zpp_inner.zpp_inner.valmod();var eh=eg.zpp_inner;eh.zpp_inner.valmod();if(eh.zpp_inner.zip_length){eh.zpp_inner.zip_length=false;eh.zpp_inner.user_length=0;var ec=eh.zpp_inner.inner.next;while(ec!=null){var ee=ec;if(ee.active&&ee.arbiter.active){eh.zpp_inner.user_length++}ec=ec.next}}var eb=eh.zpp_inner.user_length;eg.zpp_critical=true;var ef;if(eg.zpp_i<eb){ef=true}else{eg.zpp_next=d5.zpp_pool;d5.zpp_pool=eg;eg.zpp_inner=null;ef=false}if(!ef){break}eg.zpp_critical=false;var ed=eg.zpp_inner.at(eg.zpp_i++);if(!ea){ei+=","}ei+=ed==null?"NULL":ed.toString();ea=false}return ei+"]"};d7.prototype.foreach=function(ea){this.zpp_inner.valmod();var ee=d5.get(this);while(true){ee.zpp_inner.zpp_inner.valmod();var eh=ee.zpp_inner;eh.zpp_inner.valmod();if(eh.zpp_inner.zip_length){eh.zpp_inner.zip_length=false;eh.zpp_inner.user_length=0;var ed=eh.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){eh.zpp_inner.user_length++}ed=ed.next}}var ef=eh.zpp_inner.user_length;ee.zpp_critical=true;var eb;if(ee.zpp_i<ef){eb=true}else{ee.zpp_next=d5.zpp_pool;d5.zpp_pool=ee;ee.zpp_inner=null;eb=false}if(!eb){break}try{ee.zpp_critical=false;ea(ee.zpp_inner.at(ee.zpp_i++))}catch(eg){ee.zpp_next=d5.zpp_pool;d5.zpp_pool=ee;ee.zpp_inner=null;break}}return this};d7.prototype.filter=function(eb){var ed=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ec=this.zpp_inner.inner.next;while(ec!=null){var ee=ec;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ec=ec.next}}if(!(ed<this.zpp_inner.user_length)){break}var ea=this.at(ed);try{if(eb(ea)){++ed}else{this.remove(ea)}}catch(ef){break}}return this};Object.defineProperty(d7.prototype,"length",{get:d7.prototype.get_length});d7.prototype.__class__=d7;var ab=nape.dynamics.FluidArbiter=function(){aD.call(this)};ab.__name__=["nape","dynamics","FluidArbiter"];ab.__super__=aD;ab.prototype=Object.create(aD.prototype);ab.prototype.get_position=function(){if(this.zpp_inner.fluidarb.wrap_position==null){this.zpp_inner.fluidarb.getposition()}return this.zpp_inner.fluidarb.wrap_position};ab.prototype.set_position=function(ec){if(this.zpp_inner.fluidarb.wrap_position==null){this.zpp_inner.fluidarb.getposition()}var ee=this.zpp_inner.fluidarb.wrap_position;var eh=ec.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ec.zpp_inner.x;var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ec.zpp_inner.y;var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==ei}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ec.zpp_inner.weak){var ek=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.fluidarb.wrap_position==null){this.zpp_inner.fluidarb.getposition()}return this.zpp_inner.fluidarb.wrap_position};ab.prototype.get_overlap=function(){return this.zpp_inner.fluidarb.overlap};ab.prototype.set_overlap=function(ea){this.zpp_inner.fluidarb.overlap=ea;return this.zpp_inner.fluidarb.overlap};ab.prototype.buoyancyImpulse=function(ea){var eb=this.zpp_inner.fluidarb;if(ea==null){return q.get(eb.buoyx,eb.buoyy,0)}else{if(ea.zpp_inner==this.zpp_inner.b2){return q.get(eb.buoyx,eb.buoyy,eb.buoyy*eb.r2x-eb.buoyx*eb.r2y)}else{return q.get(-eb.buoyx,-eb.buoyy,-(eb.buoyy*eb.r1x-eb.buoyx*eb.r1y))}}};ab.prototype.dragImpulse=function(ea){var eb=this.zpp_inner.fluidarb;var ec=ea==null||ea.zpp_inner==this.zpp_inner.b2?1:-1;return q.get(eb.dampx*ec,eb.dampy*ec,eb.adamp*ec)};ab.prototype.totalImpulse=function(ek,ea){if(ea==null){ea=false}var eh=this.buoyancyImpulse(ek);var eo=this.dragImpulse(ek);var em=eo.zpp_inner;if(em._validate!=null){em._validate()}var ee=eo.zpp_inner.x;var ep=eh.zpp_inner;if(ep._validate!=null){ep._validate()}eo.zpp_inner.x=ee+eh.zpp_inner.x;var en=eo.zpp_inner;if(en._validate!=null){en._validate()}var el=eo.zpp_inner;if(el._validate!=null){el._validate()}var ec=eo.zpp_inner.y;var ej=eh.zpp_inner;if(ej._validate!=null){ej._validate()}eo.zpp_inner.y=ec+eh.zpp_inner.y;var ei=eo.zpp_inner;if(ei._validate!=null){ei._validate()}var eg=eo.zpp_inner;if(eg._validate!=null){eg._validate()}var eb=eo.zpp_inner.z;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}eo.zpp_inner.z=eb+eh.zpp_inner.z;var ed=eo.zpp_inner;if(ed._validate!=null){ed._validate()}eh.dispose();return eo};Object.defineProperty(ab.prototype,"position",{get:ab.prototype.get_position,set:ab.prototype.set_position});Object.defineProperty(ab.prototype,"overlap",{get:ab.prototype.get_overlap,set:ab.prototype.set_overlap});ab.prototype.__class__=ab;var G=nape.dynamics.InteractionFilter=function(ef,ee,ec,eb,ed,ea){if(ea==null){ea=-1}if(ed==null){ed=1}if(eb==null){eb=-1}if(ec==null){ec=1}if(ee==null){ee=-1}if(ef==null){ef=1}this.zpp_inner=null;if(cA.zpp_pool==null){this.zpp_inner=new cA()}else{this.zpp_inner=cA.zpp_pool;cA.zpp_pool=this.zpp_inner.next;this.zpp_inner.next=null}this.zpp_inner.outer=this;if(this.zpp_inner.collisionGroup!=ef){this.zpp_inner.collisionGroup=ef;this.zpp_inner.invalidate()}if(this.zpp_inner.collisionMask!=ee){this.zpp_inner.collisionMask=ee;this.zpp_inner.invalidate()}if(this.zpp_inner.sensorGroup!=ec){this.zpp_inner.sensorGroup=ec;this.zpp_inner.invalidate()}if(this.zpp_inner.sensorMask!=eb){this.zpp_inner.sensorMask=eb;this.zpp_inner.invalidate()}if(this.zpp_inner.fluidGroup!=ed){this.zpp_inner.fluidGroup=ed;this.zpp_inner.invalidate()}if(this.zpp_inner.fluidMask!=ea){this.zpp_inner.fluidMask=ea;this.zpp_inner.invalidate()}};G.__name__=["nape","dynamics","InteractionFilter"];G.prototype.zpp_inner=null;G.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};G.prototype.get_shapes=function(){if(this.zpp_inner.wrap_shapes==null){this.zpp_inner.wrap_shapes=aI.get(this.zpp_inner.shapes,true)}return this.zpp_inner.wrap_shapes};G.prototype.get_collisionGroup=function(){return this.zpp_inner.collisionGroup};G.prototype.set_collisionGroup=function(ea){if(this.zpp_inner.collisionGroup!=ea){this.zpp_inner.collisionGroup=ea;this.zpp_inner.invalidate()}return this.zpp_inner.collisionGroup};G.prototype.get_collisionMask=function(){return this.zpp_inner.collisionMask};G.prototype.set_collisionMask=function(ea){if(this.zpp_inner.collisionMask!=ea){this.zpp_inner.collisionMask=ea;this.zpp_inner.invalidate()}return this.zpp_inner.collisionMask};G.prototype.get_sensorGroup=function(){return this.zpp_inner.sensorGroup};G.prototype.set_sensorGroup=function(ea){if(this.zpp_inner.sensorGroup!=ea){this.zpp_inner.sensorGroup=ea;this.zpp_inner.invalidate()}return this.zpp_inner.sensorGroup};G.prototype.get_sensorMask=function(){return this.zpp_inner.sensorMask};G.prototype.set_sensorMask=function(ea){if(this.zpp_inner.sensorMask!=ea){this.zpp_inner.sensorMask=ea;this.zpp_inner.invalidate()}return this.zpp_inner.sensorMask};G.prototype.get_fluidGroup=function(){return this.zpp_inner.fluidGroup};G.prototype.set_fluidGroup=function(ea){if(this.zpp_inner.fluidGroup!=ea){this.zpp_inner.fluidGroup=ea;this.zpp_inner.invalidate()}return this.zpp_inner.fluidGroup};G.prototype.get_fluidMask=function(){return this.zpp_inner.fluidMask};G.prototype.set_fluidMask=function(ea){if(this.zpp_inner.fluidMask!=ea){this.zpp_inner.fluidMask=ea;this.zpp_inner.invalidate()}return this.zpp_inner.fluidMask};G.prototype.shouldCollide=function(eb){var ec=this.zpp_inner;var ea=eb.zpp_inner;if((ec.collisionMask&ea.collisionGroup)!=0){return(ea.collisionMask&ec.collisionGroup)!=0}else{return false}};G.prototype.shouldSense=function(eb){var ec=this.zpp_inner;var ea=eb.zpp_inner;if((ec.sensorMask&ea.sensorGroup)!=0){return(ea.sensorMask&ec.sensorGroup)!=0}else{return false}};G.prototype.shouldFlow=function(eb){var ec=this.zpp_inner;var ea=eb.zpp_inner;if((ec.fluidMask&ea.fluidGroup)!=0){return(ea.fluidMask&ec.fluidGroup)!=0}else{return false}};G.prototype.copy=function(){return new G(this.zpp_inner.collisionGroup,this.zpp_inner.collisionMask,this.zpp_inner.sensorGroup,this.zpp_inner.sensorMask,this.zpp_inner.fluidGroup,this.zpp_inner.fluidMask)};G.prototype.toString=function(){return"{ collision: "+aY.hex(this.zpp_inner.collisionGroup,8)+"~"+aY.hex(this.zpp_inner.collisionMask,8)+" sensor: "+aY.hex(this.zpp_inner.sensorGroup,8)+"~"+aY.hex(this.zpp_inner.sensorMask,8)+" fluid: "+aY.hex(this.zpp_inner.fluidGroup,8)+"~"+aY.hex(this.zpp_inner.fluidMask,8)+" }"};Object.defineProperty(G.prototype,"userData",{get:G.prototype.get_userData});Object.defineProperty(G.prototype,"shapes",{get:G.prototype.get_shapes});Object.defineProperty(G.prototype,"collisionGroup",{get:G.prototype.get_collisionGroup,set:G.prototype.set_collisionGroup});Object.defineProperty(G.prototype,"collisionMask",{get:G.prototype.get_collisionMask,set:G.prototype.set_collisionMask});Object.defineProperty(G.prototype,"sensorGroup",{get:G.prototype.get_sensorGroup,set:G.prototype.set_sensorGroup});Object.defineProperty(G.prototype,"sensorMask",{get:G.prototype.get_sensorMask,set:G.prototype.set_sensorMask});Object.defineProperty(G.prototype,"fluidGroup",{get:G.prototype.get_fluidGroup,set:G.prototype.set_fluidGroup});Object.defineProperty(G.prototype,"fluidMask",{get:G.prototype.get_fluidMask,set:G.prototype.set_fluidMask});G.prototype.__class__=G;var c=nape.dynamics.InteractionGroup=function(ea){if(ea==null){ea=false}this.zpp_inner=null;this.zpp_inner=new ax();this.zpp_inner.outer=this;if(this.zpp_inner.ignore!=ea){this.zpp_inner.invalidate(true);this.zpp_inner.ignore=ea}};c.__name__=["nape","dynamics","InteractionGroup"];c.prototype.zpp_inner=null;c.prototype.get_group=function(){if(this.zpp_inner.group==null){return null}else{return this.zpp_inner.group.outer}};c.prototype.set_group=function(ea){this.zpp_inner.setGroup(ea==null?null:ea.zpp_inner);if(this.zpp_inner.group==null){return null}else{return this.zpp_inner.group.outer}};c.prototype.get_ignore=function(){return this.zpp_inner.ignore};c.prototype.set_ignore=function(ea){if(this.zpp_inner.ignore!=ea){this.zpp_inner.invalidate(true);this.zpp_inner.ignore=ea}return this.zpp_inner.ignore};c.prototype.get_interactors=function(){if(this.zpp_inner.wrap_interactors==null){this.zpp_inner.wrap_interactors=i.get(this.zpp_inner.interactors,true)}return this.zpp_inner.wrap_interactors};c.prototype.get_groups=function(){if(this.zpp_inner.wrap_groups==null){this.zpp_inner.wrap_groups=bt.get(this.zpp_inner.groups,true)}return this.zpp_inner.wrap_groups};c.prototype.toString=function(){var ea="InteractionGroup";if(this.zpp_inner.ignore){ea="InteractionGroup:ignore"}return ea};Object.defineProperty(c.prototype,"group",{get:c.prototype.get_group,set:c.prototype.set_group});Object.defineProperty(c.prototype,"ignore",{get:c.prototype.get_ignore,set:c.prototype.set_ignore});Object.defineProperty(c.prototype,"interactors",{get:c.prototype.get_interactors});Object.defineProperty(c.prototype,"groups",{get:c.prototype.get_groups});c.prototype.__class__=c;var cL=nape.dynamics.InteractionGroupIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};cL.__name__=["nape","dynamics","InteractionGroupIterator"];cL.get=function(ec){var ea;if(cL.zpp_pool==null){bt.internal=true;var ed=new cL();bt.internal=false;ea=ed}else{var eb=cL.zpp_pool;cL.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};cL.prototype.zpp_inner=null;cL.prototype.zpp_i=null;cL.prototype.zpp_critical=null;cL.prototype.zpp_next=null;cL.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=cL.zpp_pool;cL.zpp_pool=this;this.zpp_inner=null;return false}};cL.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};cL.prototype.__class__=cL;var aS=nape.dynamics.InteractionGroupList=function(){this.zpp_inner=null;this.zpp_inner=new bt();this.zpp_inner.outer=this};aS.__name__=["nape","dynamics","InteractionGroupList"];aS.fromArray=function(ed){var ea=new aS();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};aS.prototype.zpp_inner=null;aS.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};aS.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};aS.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};aS.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aS.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aS.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};aS.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};aS.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};aS.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};aS.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};aS.prototype.empty=function(){return this.zpp_inner.inner.head==null};aS.prototype.iterator=function(){this.zpp_inner.valmod();return cL.get(this)};aS.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new aS();this.zpp_inner.valmod();var ef=cL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cL.zpp_pool;cL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};aS.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=cL.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=cL.zpp_pool;cL.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};aS.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=cL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cL.zpp_pool;cL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};aS.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=cL.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=cL.zpp_pool;cL.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=cL.zpp_pool;cL.zpp_pool=ec;ec.zpp_inner=null;break}}return this};aS.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(aS.prototype,"length",{get:aS.prototype.get_length});aS.prototype.__class__=aS;var S=nape.geom.AABB=function(eb,ee,ed,ea){if(ea==null){ea=0}if(ed==null){ed=0}if(ee==null){ee=0}if(eb==null){eb=0}this.zpp_inner=null;var ec;if(bT.zpp_pool==null){ec=new bT()}else{ec=bT.zpp_pool;bT.zpp_pool=ec.next;ec.next=null}ec.minx=eb;ec.miny=ee;ec.maxx=eb+ed;ec.maxy=ee+ea;this.zpp_inner=ec;this.zpp_inner.outer=this};S.__name__=["nape","geom","AABB"];S.prototype.zpp_inner=null;S.prototype.copy=function(){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ed=this.zpp_inner;var eb=ed.minx;var ea=ed.miny;var ef=ed.maxx;var ee=ed.maxy;var ec;if(bT.zpp_pool==null){ec=new bT()}else{ec=bT.zpp_pool;bT.zpp_pool=ec.next;ec.next=null}ec.minx=eb;ec.miny=ea;ec.maxx=ef;ec.maxy=ee;return ec.wrapper()};S.prototype.get_min=function(){return this.zpp_inner.getmin()};S.prototype.set_min=function(ea){var ee=this.zpp_inner.getmin();var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return this.zpp_inner.getmin()};S.prototype.get_max=function(){return this.zpp_inner.getmax()};S.prototype.set_max=function(ei){var ed=this.zpp_inner.getmax();var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=ei.zpp_inner.x;var ef=ei.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ei.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ei.zpp_inner.weak){var ek=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return this.zpp_inner.getmax()};S.prototype.get_x=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.minx};S.prototype.set_x=function(ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}if(this.zpp_inner.minx!=ea){this.zpp_inner.maxx+=ea-this.zpp_inner.minx;this.zpp_inner.minx=ea;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.minx};S.prototype.get_y=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.miny};S.prototype.set_y=function(ed){var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}if(this.zpp_inner.miny!=ed){this.zpp_inner.maxy+=ed-this.zpp_inner.miny;this.zpp_inner.miny=ed;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.miny};S.prototype.get_width=function(){var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=this.zpp_inner;return ea.maxx-ea.minx};S.prototype.set_width=function(ed){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ef=this.zpp_inner;if(ef.maxx-ef.minx!=ed){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.maxx=this.zpp_inner.minx+ed;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=this.zpp_inner;return ea.maxx-ea.minx};S.prototype.get_height=function(){var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=this.zpp_inner;return ea.maxy-ea.miny};S.prototype.set_height=function(ea){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ef=this.zpp_inner;if(ef.maxy-ef.miny!=ea){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.maxy=this.zpp_inner.miny+ea;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}var eb=this.zpp_inner;return eb.maxy-eb.miny};S.prototype.toString=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.toString()};Object.defineProperty(S.prototype,"min",{get:S.prototype.get_min,set:S.prototype.set_min});Object.defineProperty(S.prototype,"max",{get:S.prototype.get_max,set:S.prototype.set_max});Object.defineProperty(S.prototype,"x",{get:S.prototype.get_x,set:S.prototype.set_x});Object.defineProperty(S.prototype,"y",{get:S.prototype.get_y,set:S.prototype.set_y});Object.defineProperty(S.prototype,"width",{get:S.prototype.get_width,set:S.prototype.set_width});Object.defineProperty(S.prototype,"height",{get:S.prototype.get_height,set:S.prototype.set_height});S.prototype.__class__=S;var bJ=nape.geom.ConvexResult=function(){this.zpp_inner=null};bJ.__name__=["nape","geom","ConvexResult"];bJ.prototype.zpp_inner=null;bJ.prototype.get_normal=function(){return this.zpp_inner.normal};bJ.prototype.get_position=function(){return this.zpp_inner.position};bJ.prototype.get_toi=function(){return this.zpp_inner.toiDistance};bJ.prototype.get_shape=function(){return this.zpp_inner.shape};bJ.prototype.dispose=function(){this.zpp_inner.free()};bJ.prototype.toString=function(){return"{ shape: "+ag.string(this.zpp_inner.shape)+" toi: "+this.zpp_inner.toiDistance+" }"};Object.defineProperty(bJ.prototype,"normal",{get:bJ.prototype.get_normal});Object.defineProperty(bJ.prototype,"position",{get:bJ.prototype.get_position});Object.defineProperty(bJ.prototype,"toi",{get:bJ.prototype.get_toi});Object.defineProperty(bJ.prototype,"shape",{get:bJ.prototype.get_shape});bJ.prototype.__class__=bJ;var v=nape.geom.ConvexResultIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};v.__name__=["nape","geom","ConvexResultIterator"];v.get=function(ec){var ea;if(v.zpp_pool==null){dE.internal=true;var ed=new v();dE.internal=false;ea=ed}else{var eb=v.zpp_pool;v.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};v.prototype.zpp_inner=null;v.prototype.zpp_i=null;v.prototype.zpp_critical=null;v.prototype.zpp_next=null;v.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=v.zpp_pool;v.zpp_pool=this;this.zpp_inner=null;return false}};v.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};v.prototype.__class__=v;var cs=nape.geom.ConvexResultList=function(){this.zpp_inner=null;this.zpp_inner=new dE();this.zpp_inner.outer=this};cs.__name__=["nape","geom","ConvexResultList"];cs.fromArray=function(ed){var ea=new cs();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};cs.prototype.zpp_inner=null;cs.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};cs.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea)};cs.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt};cs.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cs.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}else{this.zpp_inner.inner.add(ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cs.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb};cs.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb};cs.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};cs.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec)}this.zpp_inner.invalidate()}return ea};cs.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};cs.prototype.empty=function(){return this.zpp_inner.inner.head==null};cs.prototype.iterator=function(){this.zpp_inner.valmod();return v.get(this)};cs.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new cs();this.zpp_inner.valmod();var ef=v.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=v.zpp_pool;v.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};cs.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=v.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=v.zpp_pool;v.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};cs.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=v.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=v.zpp_pool;v.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};cs.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=v.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=v.zpp_pool;v.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=v.zpp_pool;v.zpp_pool=ec;ec.zpp_inner=null;break}}return this};cs.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(cs.prototype,"length",{get:cs.prototype.get_length});cs.prototype.__class__=cs;var K=nape.geom.Geom=function(){};K.__name__=["nape","geom","Geom"];K.distanceBody=function(eb,ea,ef,ee){var ec=eb.zpp_inner.shapes.head;while(ec!=null){bM.validateShape(ec.elt);ec=ec.next}var ed=ea.zpp_inner.shapes.head;while(ed!=null){bM.validateShape(ed.elt);ed=ed.next}return de.distanceBody(eb.zpp_inner,ea.zpp_inner,ef.zpp_inner,ee.zpp_inner)};K.distance=function(f4,f3,eJ,eH){bM.validateShape(f4.zpp_inner);bM.validateShape(f3.zpp_inner);var eq;if(bB.zpp_pool==null){eq=new bB()}else{eq=bB.zpp_pool;bB.zpp_pool=eq.next;eq.next=null}eq.weak=false;var ep=f4.zpp_inner;var en=f3.zpp_inner;var fp=eJ.zpp_inner;var fo=eH.zpp_inner;var fn;if(ep.type==0&&en.type==0){var f2=ep.circle;var f1=en.circle;var ek;var fE=0;var fC=0;fE=f1.worldCOMx-f2.worldCOMx;fC=f1.worldCOMy-f2.worldCOMy;var fW=Math.sqrt(fE*fE+fC*fC);ek=fW-(f2.radius+f1.radius);if(ek<1e+100){if(fW==0){fE=1;fC=0}else{var ff=1/fW;fE*=ff;fC*=ff}var gg=f2.radius;fp.x=f2.worldCOMx+fE*gg;fp.y=f2.worldCOMy+fC*gg;var gf=-f1.radius;fo.x=f1.worldCOMx+fE*gf;fo.y=f1.worldCOMy+fC*gf;eq.x=fE;eq.y=fC}fn=ek}else{var eZ=false;if(ep.type==0&&en.type==1){var eR=ep;ep=en;en=eR;var eN=fp;fp=fo;fo=eN;eZ=true}if(ep.type==1&&en.type==0){var e6=ep.polygon;var fu=en.circle;var ez=-1e+100;var ea=null;var f0=e6.edges.head;while(f0!=null){var fz=f0.elt;var eX=fz.gnormx*fu.worldCOMx+fz.gnormy*fu.worldCOMy-fz.gprojection-fu.radius;if(eX>1e+100){ez=eX;break}if(eX>0){if(eX>ez){ez=eX;ea=fz}}else{if(ez<0&&eX>ez){ez=eX;ea=fz}}f0=f0.next}if(ez<1e+100){var fR=ea.gp0;var fP=ea.gp1;var eL=fu.worldCOMy*ea.gnormx-fu.worldCOMx*ea.gnormy;if(eL<=fR.y*ea.gnormx-fR.x*ea.gnormy){var f6=0;var fZ=0;f6=fu.worldCOMx-fR.x;fZ=fu.worldCOMy-fR.y;var fG=Math.sqrt(f6*f6+fZ*fZ);ez=fG-fu.radius;if(ez<1e+100){if(fG==0){f6=1;fZ=0}else{var ge=1/fG;f6*=ge;fZ*=ge}fp.x=fR.x+f6*0;fp.y=fR.y+fZ*0;var gd=-fu.radius;fo.x=fu.worldCOMx+f6*gd;fo.y=fu.worldCOMy+fZ*gd;eq.x=f6;eq.y=fZ}}else{if(eL>=fP.y*ea.gnormx-fP.x*ea.gnormy){var f5=0;var fX=0;f5=fu.worldCOMx-fP.x;fX=fu.worldCOMy-fP.y;var fF=Math.sqrt(f5*f5+fX*fX);ez=fF-fu.radius;if(ez<1e+100){if(fF==0){f5=1;fX=0}else{var gc=1/fF;f5*=gc;fX*=gc}fp.x=fP.x+f5*0;fp.y=fP.y+fX*0;var gb=-fu.radius;fo.x=fu.worldCOMx+f5*gb;fo.y=fu.worldCOMy+fX*gb;eq.x=f5;eq.y=fX}}else{var f9=-fu.radius;fo.x=fu.worldCOMx+ea.gnormx*f9;fo.y=fu.worldCOMy+ea.gnormy*f9;var f8=-ez;fp.x=fo.x+ea.gnormx*f8;fp.y=fo.y+ea.gnormy*f8;eq.x=ea.gnormx;eq.y=ea.gnormy}}}if(eZ){eq.x=-eq.x;eq.y=-eq.y}fn=ez}else{var fK=ep.polygon;var fI=en.polygon;var fy=-1e+100;var gq=null;var gp=null;var eU=0;var fT=fK.edges.head;while(fT!=null){var go=fT.elt;var gj=1e+100;var fS=fI.gverts.next;while(fS!=null){var fe=fS;var fq=go.gnormx*fe.x+go.gnormy*fe.y;if(fq<gj){gj=fq}fS=fS.next}gj-=go.gprojection;if(gj>1e+100){fy=gj;break}if(gj>0){if(gj>fy){fy=gj;gq=go;eU=1}}else{if(fy<0&&gj>fy){fy=gj;gq=go;eU=1}}fT=fT.next}if(fy<1e+100){var fQ=fI.edges.head;while(fQ!=null){var gn=fQ.elt;var fs=1e+100;var fO=fK.gverts.next;while(fO!=null){var fN=fO;var fd=gn.gnormx*fN.x+gn.gnormy*fN.y;if(fd<fs){fs=fd}fO=fO.next}fs-=gn.gprojection;if(fs>1e+100){fy=fs;break}if(fs>0){if(fs>fy){fy=fs;gp=gn;eU=2}}else{if(fy<0&&fs>fy){fy=fs;gp=gn;eU=2}}fQ=fQ.next}if(fy<1e+100){var fh;var fV;if(eU==1){fh=fI;fV=gq}else{fh=fK;fV=gp;var eM=fp;fp=fo;fo=eM;eZ=!eZ}var fU=null;var fr=1e+100;var fM=fh.edges.head;while(fM!=null){var gl=fM.elt;var fc=fV.gnormx*gl.gnormx+fV.gnormy*gl.gnormy;if(fc<fr){fr=fc;fU=gl}fM=fM.next}if(eZ){eq.x=-fV.gnormx;eq.y=-fV.gnormy}else{eq.x=fV.gnormx;eq.y=fV.gnormy}if(fy>=0){var e5=fV.gp0;var es=fV.gp1;var fk=fU.gp0;var fj=fU.gp1;var e4=0;var e3=0;var ei=0;var eh=0;e4=es.x-e5.x;e3=es.y-e5.y;ei=fj.x-fk.x;eh=fj.y-fk.y;var e9=1/(e4*e4+e3*e3);var eW=1/(ei*ei+eh*eh);var eI=-(e4*(e5.x-fk.x)+e3*(e5.y-fk.y))*e9;var gm=-(e4*(e5.x-fj.x)+e3*(e5.y-fj.y))*e9;var eQ=-(ei*(fk.x-e5.x)+eh*(fk.y-e5.y))*eW;var ed=-(ei*(fk.x-es.x)+eh*(fk.y-es.y))*eW;if(eI<0){eI=0}else{if(eI>1){eI=1}}if(gm<0){gm=0}else{if(gm>1){gm=1}}if(eQ<0){eQ=0}else{if(eQ>1){eQ=1}}if(ed<0){ed=0}else{if(ed>1){ed=1}}var e0=0;var eY=0;var f7=eI;e0=e5.x+e4*f7;eY=e5.y+e3*f7;var el=0;var ej=0;var eK=gm;el=e5.x+e4*eK;ej=e5.y+e3*eK;var eT=0;var eP=0;var eG=eQ;eT=fk.x+ei*eG;eP=fk.y+eh*eG;var ef=0;var ec=0;var eE=ed;ef=fk.x+ei*eE;ec=fk.y+eh*eE;var fw=fk.x;var ft=fk.y;var eF=0;var eD=0;eF=e0-fw;eD=eY-ft;var fB=eF*eF+eD*eD;var eV=fj.x;var eg=fj.y;var eB=0;var gk=0;eB=el-eV;gk=ej-eg;var fA=eB*eB+gk*gk;var eS=e5.x;var ee=e5.y;var ey=0;var gi=0;ey=eT-eS;gi=eP-ee;var fb=ey*ey+gi*gi;var eO=es.x;var eb=es.y;var ew=0;var gh=0;ew=ef-eO;gh=ec-eb;var fa=ew*ew+gh*gh;var fJ=0;var fH=0;var eu=null;if(fB<fA){fJ=e0;fH=eY;eu=fk}else{fJ=el;fH=ej;eu=fj;fB=fA}var fi=0;var fg=0;var er=null;if(fb<fa){fi=eT;fg=eP;er=e5}else{fi=ef;fg=ec;er=es;fb=fa}if(fB<fb){fp.x=fJ;fp.y=fH;fo.x=eu.x;fo.y=eu.y;fy=Math.sqrt(fB)}else{fo.x=fi;fo.y=fg;fp.x=er.x;fp.y=er.y;fy=Math.sqrt(fb)}if(fy!=0){eq.x=fo.x-fp.x;eq.y=fo.y-fp.y;var eC=1/fy;eq.x*=eC;eq.y*=eC;if(eZ){eq.x=-eq.x;eq.y=-eq.y}}fn=fy}else{var fx=0;var fv=0;fx=fU.gp0.x;fv=fU.gp0.y;var e8=0;var e7=0;e8=fU.gp1.x;e7=fU.gp1.y;var eo=0;var em=0;eo=e8-fx;em=e7-fv;var fD=fV.gnormy*fx-fV.gnormx*fv;var fY=fV.gnormy*e8-fV.gnormx*e7;var ga=1/(fY-fD);var eA=(-fV.tp1-fD)*ga;if(eA>P.epsilon){fx+=eo*eA;fv+=em*eA}var ex=(-fV.tp0-fY)*ga;if(ex<-P.epsilon){e8+=eo*ex;e7+=em*ex}var fL=fx*fV.gnormx+fv*fV.gnormy-fV.gprojection;var fl=e8*fV.gnormx+e7*fV.gnormy-fV.gprojection;if(fL<fl){fo.x=fx;fo.y=fv;var ev=-fL;fp.x=fo.x+fV.gnormx*ev;fp.y=fo.y+fV.gnormy*ev;fn=fL}else{fo.x=e8;fo.y=e7;var et=-fl;fp.x=fo.x+fV.gnormx*et;fp.y=fo.y+fV.gnormy*et;fn=fl}}}else{fn=1e+100}}else{fn=1e+100}}}var fm=eq;if(fm.outer!=null){fm.outer.zpp_inner=null;fm.outer=null}fm._isimmutable=null;fm._validate=null;fm._invalidate=null;fm.next=bB.zpp_pool;bB.zpp_pool=fm;return fn};K.intersectsBody=function(ea,ei){var eb=ea.zpp_inner.shapes.head;while(eb!=null){bM.validateShape(eb.elt);eb=eb.next}var eg=ei.zpp_inner.shapes.head;while(eg!=null){bM.validateShape(eg.elt);eg=eg.next}var ec=ea.zpp_inner.aabb;var ef=ei.zpp_inner.aabb;if(!(ef.miny<=ec.maxy&&ec.miny<=ef.maxy&&ef.minx<=ec.maxx&&ec.minx<=ef.maxx)){return false}else{var ee=ea.zpp_inner.shapes.head;while(ee!=null){var eh=ee.elt;var ed=ei.zpp_inner.shapes.head;while(ed!=null){if(b7.testCollide_safe(eh,ed.elt)){return true}ed=ed.next}ee=ee.next}return false}};K.intersects=function(ec,eb){bM.validateShape(ec.zpp_inner);bM.validateShape(eb.zpp_inner);var ed=ec.zpp_inner.aabb;var ea=eb.zpp_inner.aabb;if(ea.miny<=ed.maxy&&ed.miny<=ea.maxy&&ea.minx<=ed.maxx&&ed.minx<=ea.maxx){return b7.testCollide_safe(ec.zpp_inner,eb.zpp_inner)}else{return false}};K.contains=function(eb,ea){bM.validateShape(eb.zpp_inner);bM.validateShape(ea.zpp_inner);return b7.containTest(eb.zpp_inner,ea.zpp_inner)};K.prototype.__class__=K;var a7=nape.geom.GeomPoly=function(eb){this.zpp_inner=null;this.zpp_pool=null;this.zpp_inner=new b5(this);if(eb!=null){if((eb instanceof Array)&&eb.__enum__==null){var ew=eb;var eZ=0;while(eZ<ew.length){var ep=ew[eZ];++eZ;var eN=ep;var ed=eN.zpp_inner;if(ed._validate!=null){ed._validate()}var eJ=eN.zpp_inner.x;var eQ=eN.zpp_inner;if(eQ._validate!=null){eQ._validate()}var eF=eN.zpp_inner.y;var ey;if(dr.zpp_pool==null){ey=new dr()}else{ey=dr.zpp_pool;dr.zpp_pool=ey.next;ey.next=null}ey.forced=false;ey.x=eJ;ey.y=eF;var ea=ey;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ea.prev=ea.next=ea}else{ea.prev=this.zpp_inner.vertices;ea.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ea;this.zpp_inner.vertices.next=ea}this.zpp_inner.vertices=ea}}else{if(dc.__instanceof(eb,aN)){var ev=eb;var eV=ev.iterator();while(true){eV.zpp_inner.zpp_inner.valmod();var er=eV.zpp_inner.zpp_gl();eV.zpp_critical=true;var eS;if(eV.zpp_i<er){eS=true}else{eV.zpp_next=dW.zpp_pool;dW.zpp_pool=eV;eV.zpp_inner=null;eS=false}if(!eS){break}eV.zpp_critical=false;var e4=eV.zpp_inner.at(eV.zpp_i++);var eP=e4.zpp_inner;if(eP._validate!=null){eP._validate()}var eo=e4.zpp_inner.x;var eM=e4.zpp_inner;if(eM._validate!=null){eM._validate()}var e6=e4.zpp_inner.y;var eK;if(dr.zpp_pool==null){eK=new dr()}else{eK=dr.zpp_pool;dr.zpp_pool=eK.next;eK.next=null}eK.forced=false;eK.x=eo;eK.y=e6;var ee=eK;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ee.prev=ee.next=ee}else{ee.prev=this.zpp_inner.vertices;ee.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ee;this.zpp_inner.vertices.next=ee}this.zpp_inner.vertices=ee}}else{if(dc.__instanceof(eb,a7)){var eu=eb;var eX=eu.zpp_inner.vertices;if(eX!=null){var eY=eX;while(true){var en=eY.x;var e5=eY.y;var eG;if(au.poolVec2==null){eG=new r()}else{eG=au.poolVec2;au.poolVec2=eG.zpp_pool;eG.zpp_pool=null}if(eG.zpp_inner==null){var eD;if(bB.zpp_pool==null){eD=new bB()}else{eD=bB.zpp_pool;bB.zpp_pool=eD.next;eD.next=null}eD.weak=false;eD._immutable=false;eD.x=en;eD.y=e5;eG.zpp_inner=eD;eG.zpp_inner.outer=eG}else{var e1;var eL=eG.zpp_inner;if(eL._validate!=null){eL._validate()}if(eG.zpp_inner.x==en){var eI=eG.zpp_inner;if(eI._validate!=null){eI._validate()}e1=eG.zpp_inner.y==e5}else{e1=false}if(!e1){eG.zpp_inner.x=en;eG.zpp_inner.y=e5;var eE=eG.zpp_inner;if(eE._invalidate!=null){eE._invalidate(eE)}}}eG.zpp_inner.weak=false;var e2=eG;eY=eY.next;var eC=e2.zpp_inner;if(eC._validate!=null){eC._validate()}var em=e2.zpp_inner.x;var eB=e2.zpp_inner;if(eB._validate!=null){eB._validate()}var e3=e2.zpp_inner.y;var eA;if(dr.zpp_pool==null){eA=new dr()}else{eA=dr.zpp_pool;dr.zpp_pool=eA.next;eA.next=null}eA.forced=false;eA.x=em;eA.y=e3;var ec=eA;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ec.prev=ec.next=ec}else{ec.prev=this.zpp_inner.vertices;ec.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ec;this.zpp_inner.vertices.next=ec}this.zpp_inner.vertices=ec;var ex=e2.zpp_inner;e2.zpp_inner.outer=null;e2.zpp_inner=null;var eU=e2;eU.zpp_pool=au.poolVec2;au.poolVec2=eU;var ek=ex;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek;if(eY==eX){break}}}}}}this.skipForward(1);if((eb instanceof Array)&&eb.__enum__==null){var et=eb;var eW=0;while(eW<et.length){var ef=et[eW];var e0;if(ef.zpp_inner.weak){var eT=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;var ej=ef;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;var ei=eT;if(ei.outer!=null){ei.outer.zpp_inner=null;ei.outer=null}ei._isimmutable=null;ei._validate=null;ei._invalidate=null;ei.next=bB.zpp_pool;bB.zpp_pool=ei;e0=true}else{e0=false}if(e0){et.splice(eW,1);continue}++eW}}else{if(dc.__instanceof(eb,aN)){var es=eb;if(es.zpp_inner._validate!=null){es.zpp_inner._validate()}var eH=es.zpp_inner.inner;var eO=null;var eq=eH.head;while(eq!=null){var el=eq.elt;if(el.outer.zpp_inner.weak){eq=eH.erase(eO);if(el.outer.zpp_inner.weak){var ez=el.outer;var eR=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;var eh=ez;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;var eg=eR;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg}}else{eO=eq;eq=eq.next}}}}}};a7.__name__=["nape","geom","GeomPoly"];a7.get=function(eb){var ey;if(au.poolGeomPoly==null){ey=new a7()}else{ey=au.poolGeomPoly;au.poolGeomPoly=ey.zpp_pool;ey.zpp_pool=null}if(eb!=null){if((eb instanceof Array)&&eb.__enum__==null){var ew=eb;var e0=0;while(e0<ew.length){var ep=ew[e0];++e0;var eO=ep;var ed=eO.zpp_inner;if(ed._validate!=null){ed._validate()}var eK=eO.zpp_inner.x;var eR=eO.zpp_inner;if(eR._validate!=null){eR._validate()}var eG=eO.zpp_inner.y;var eL;if(dr.zpp_pool==null){eL=new dr()}else{eL=dr.zpp_pool;dr.zpp_pool=eL.next;eL.next=null}eL.forced=false;eL.x=eK;eL.y=eG;var ea=eL;if(ey.zpp_inner.vertices==null){ey.zpp_inner.vertices=ea.prev=ea.next=ea}else{ea.prev=ey.zpp_inner.vertices;ea.next=ey.zpp_inner.vertices.next;ey.zpp_inner.vertices.next.prev=ea;ey.zpp_inner.vertices.next=ea}ey.zpp_inner.vertices=ea}}else{if(dc.__instanceof(eb,aN)){var ev=eb;var eW=ev.iterator();while(true){eW.zpp_inner.zpp_inner.valmod();var er=eW.zpp_inner.zpp_gl();eW.zpp_critical=true;var eT;if(eW.zpp_i<er){eT=true}else{eW.zpp_next=dW.zpp_pool;dW.zpp_pool=eW;eW.zpp_inner=null;eT=false}if(!eT){break}eW.zpp_critical=false;var e5=eW.zpp_inner.at(eW.zpp_i++);var eQ=e5.zpp_inner;if(eQ._validate!=null){eQ._validate()}var eo=e5.zpp_inner.x;var eN=e5.zpp_inner;if(eN._validate!=null){eN._validate()}var e7=e5.zpp_inner.y;var eH;if(dr.zpp_pool==null){eH=new dr()}else{eH=dr.zpp_pool;dr.zpp_pool=eH.next;eH.next=null}eH.forced=false;eH.x=eo;eH.y=e7;var ee=eH;if(ey.zpp_inner.vertices==null){ey.zpp_inner.vertices=ee.prev=ee.next=ee}else{ee.prev=ey.zpp_inner.vertices;ee.next=ey.zpp_inner.vertices.next;ey.zpp_inner.vertices.next.prev=ee;ey.zpp_inner.vertices.next=ee}ey.zpp_inner.vertices=ee}}else{if(dc.__instanceof(eb,a7)){var eu=eb;var eY=eu.zpp_inner.vertices;if(eY!=null){var eZ=eY;while(true){var en=eZ.x;var e6=eZ.y;var eE;if(au.poolVec2==null){eE=new r()}else{eE=au.poolVec2;au.poolVec2=eE.zpp_pool;eE.zpp_pool=null}if(eE.zpp_inner==null){var eC;if(bB.zpp_pool==null){eC=new bB()}else{eC=bB.zpp_pool;bB.zpp_pool=eC.next;eC.next=null}eC.weak=false;eC._immutable=false;eC.x=en;eC.y=e6;eE.zpp_inner=eC;eE.zpp_inner.outer=eE}else{var e2;var eM=eE.zpp_inner;if(eM._validate!=null){eM._validate()}if(eE.zpp_inner.x==en){var eJ=eE.zpp_inner;if(eJ._validate!=null){eJ._validate()}e2=eE.zpp_inner.y==e6}else{e2=false}if(!e2){eE.zpp_inner.x=en;eE.zpp_inner.y=e6;var eF=eE.zpp_inner;if(eF._invalidate!=null){eF._invalidate(eF)}}}eE.zpp_inner.weak=false;var e3=eE;eZ=eZ.next;var eD=e3.zpp_inner;if(eD._validate!=null){eD._validate()}var em=e3.zpp_inner.x;var eB=e3.zpp_inner;if(eB._validate!=null){eB._validate()}var e4=e3.zpp_inner.y;var eA;if(dr.zpp_pool==null){eA=new dr()}else{eA=dr.zpp_pool;dr.zpp_pool=eA.next;eA.next=null}eA.forced=false;eA.x=em;eA.y=e4;var ec=eA;if(ey.zpp_inner.vertices==null){ey.zpp_inner.vertices=ec.prev=ec.next=ec}else{ec.prev=ey.zpp_inner.vertices;ec.next=ey.zpp_inner.vertices.next;ey.zpp_inner.vertices.next.prev=ec;ey.zpp_inner.vertices.next=ec}ey.zpp_inner.vertices=ec;var ex=e3.zpp_inner;e3.zpp_inner.outer=null;e3.zpp_inner=null;var eV=e3;eV.zpp_pool=au.poolVec2;au.poolVec2=eV;var ek=ex;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek;if(!(eZ!=eY)){break}}}}}}ey.skipForward(1);if((eb instanceof Array)&&eb.__enum__==null){var et=eb;var eX=0;while(eX<et.length){var ef=et[eX];var e1;if(ef.zpp_inner.weak){var eU=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;var ej=ef;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;var ei=eU;if(ei.outer!=null){ei.outer.zpp_inner=null;ei.outer=null}ei._isimmutable=null;ei._validate=null;ei._invalidate=null;ei.next=bB.zpp_pool;bB.zpp_pool=ei;e1=true}else{e1=false}if(e1){et.splice(eX,1);continue}++eX}}else{if(dc.__instanceof(eb,aN)){var es=eb;if(es.zpp_inner._validate!=null){es.zpp_inner._validate()}var eI=es.zpp_inner.inner;var eP=null;var eq=eI.head;while(eq!=null){var el=eq.elt;if(el.outer.zpp_inner.weak){eq=eI.erase(eP);if(el.outer.zpp_inner.weak){var ez=el.outer;var eS=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;var eh=ez;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;var eg=eS;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg}}else{eP=eq;eq=eq.next}}}}}return ey};a7.prototype.zpp_pool=null;a7.prototype.zpp_inner=null;a7.prototype.empty=function(){return this.zpp_inner.vertices==null};a7.prototype.size=function(){var eb=0;var ec=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ec!=null){var ed=ec;while(true){++eb;ed=ed.next;if(!(ed!=ea)){break}}}return eb};a7.prototype.iterator=function(){return dn.get(this.zpp_inner.vertices,true)};a7.prototype.forwardIterator=function(){return dn.get(this.zpp_inner.vertices,true)};a7.prototype.backwardsIterator=function(){return dn.get(this.zpp_inner.vertices,false)};a7.prototype.current=function(){var ec=this.zpp_inner.vertices;if(ec.wrap==null){var ei=ec.x;var eg=ec.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ei;eh.y=eg;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ei){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==eg}else{ea=false}if(!ea){ee.zpp_inner.x=ei;ee.zpp_inner.y=eg;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}ee.zpp_inner.weak=false;ec.wrap=ee;ec.wrap.zpp_inner._inuse=true;ec.wrap.zpp_inner._invalidate=dX(ec,ec.modwrap);ec.wrap.zpp_inner._validate=dX(ec,ec.getwrap)}return ec.wrap};a7.prototype.push=function(ee){var eh=ee.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ee.zpp_inner.x;var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}var eg=ee.zpp_inner.y;var ec;if(dr.zpp_pool==null){ec=new dr()}else{ec=dr.zpp_pool;dr.zpp_pool=ec.next;ec.next=null}ec.forced=false;ec.x=ea;ec.y=eg;var ef=ec;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ef.prev=ef.next=ef}else{ef.prev=this.zpp_inner.vertices;ef.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ef;this.zpp_inner.vertices.next=ef}this.zpp_inner.vertices=ef;if(ee.zpp_inner.weak){var eb=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return this};a7.prototype.pop=function(){var ec=this.zpp_inner.vertices;var eb;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;eb=null}else{var ed=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;eb=ed}this.zpp_inner.vertices=eb;if(ec.wrap!=null){ec.wrap.zpp_inner._inuse=false;var ee=ec.wrap;var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;ec.wrap=null}ec.prev=ec.next=null;ec.next=dr.zpp_pool;dr.zpp_pool=ec;return this};a7.prototype.unshift=function(ee){var eh=ee.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ee.zpp_inner.x;var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}var eg=ee.zpp_inner.y;var ec;if(dr.zpp_pool==null){ec=new dr()}else{ec=dr.zpp_pool;dr.zpp_pool=ec.next;ec.next=null}ec.forced=false;ec.x=ea;ec.y=eg;var ef=ec;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ef.prev=ef.next=ef}else{ef.next=this.zpp_inner.vertices;ef.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=ef;this.zpp_inner.vertices.prev=ef}this.zpp_inner.vertices=ef;if(ee.zpp_inner.weak){var eb=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return this};a7.prototype.shift=function(){var ec=this.zpp_inner.vertices;var eb;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;eb=this.zpp_inner.vertices=null}else{var ed=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;eb=ed}this.zpp_inner.vertices=eb;if(ec.wrap!=null){ec.wrap.zpp_inner._inuse=false;var ee=ec.wrap;var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;ec.wrap=null}ec.prev=ec.next=null;ec.next=dr.zpp_pool;dr.zpp_pool=ec;return this};a7.prototype.skipForward=function(ea){if(this.zpp_inner.vertices!=null){if(ea>0){while(ea-->0){this.zpp_inner.vertices=this.zpp_inner.vertices.next}}else{if(ea<0){while(ea++<0){this.zpp_inner.vertices=this.zpp_inner.vertices.prev}}}}return this};a7.prototype.skipBackwards=function(ea){return this.skipForward(-ea)};a7.prototype.erase=function(ef){while(ef!=0&&this.zpp_inner.vertices!=null){var ed=this.zpp_inner.vertices;if(ef>0){var ec;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;ec=this.zpp_inner.vertices=null}else{var eg=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;ec=eg}this.zpp_inner.vertices=ec;--ef}else{if(ef<0){var ee;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;ee=null}else{var eb=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;ee=eb}this.zpp_inner.vertices=ee;++ef}}if(ed.wrap!=null){ed.wrap.zpp_inner._inuse=false;var eh=ed.wrap;var ea=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;ed.wrap=null}ed.prev=ed.next=null;ed.next=dr.zpp_pool;dr.zpp_pool=ed}return this};a7.prototype.clear=function(){while(this.zpp_inner.vertices!=null){var eb=this.zpp_inner.vertices;var ec;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;ec=this.zpp_inner.vertices=null}else{var ed=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;ec=ed}this.zpp_inner.vertices=ec;if(eb.wrap!=null){eb.wrap.zpp_inner._inuse=false;var ee=eb.wrap;var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;eb.wrap=null}eb.prev=eb.next=null;eb.next=dr.zpp_pool;dr.zpp_pool=eb}return this};a7.prototype.copy=function(){var ec=a7.get();var ei=this.zpp_inner.vertices;var ed=this.zpp_inner.vertices;if(ei!=null){var ea=ei;while(true){var eh=ea;var eg=eh.x;var ee=eh.y;var ef;if(dr.zpp_pool==null){ef=new dr()}else{ef=dr.zpp_pool;dr.zpp_pool=ef.next;ef.next=null}ef.forced=false;ef.x=eg;ef.y=ee;var eb=ef;if(ec.zpp_inner.vertices==null){ec.zpp_inner.vertices=eb.prev=eb.next=eb}else{eb.prev=ec.zpp_inner.vertices;eb.next=ec.zpp_inner.vertices.next;ec.zpp_inner.vertices.next.prev=eb;ec.zpp_inner.vertices.next=eb}ec.zpp_inner.vertices=eb;ea=ea.next;if(!(ea!=ed)){break}}}return ec.skipForward(1)};a7.prototype.dispose=function(){this.clear();var ea=this;ea.zpp_pool=au.poolGeomPoly;au.poolGeomPoly=ea};a7.prototype.toString=function(){var ec="GeomPoly[";var ed=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ed!=null){var ee=ed;while(true){var eb=ee;if(eb!=this.zpp_inner.vertices){ec+=","}ec+="{"+eb.x+","+eb.y+"}";ee=ee.next;if(!(ee!=ea)){break}}}return ec+"]"};a7.prototype.area=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return 0}else{var ee=0;var ed=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ed!=null){var ef=ed;while(true){var eb=ef;ee+=eb.x*(eb.next.y-eb.prev.y);ef=ef.next;if(!(ef!=ea)){break}}}var ec=ee*0.5;if(ec<0){return -ec}else{return ec}}};a7.prototype.winding=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}return br.Winding_UNDEFINED}else{var ee=0;var ed=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ed!=null){var ef=ed;while(true){var ec=ef;ee+=ec.x*(ec.next.y-ec.prev.y);ef=ef.next;if(!(ef!=ea)){break}}}var eb=ee*0.5;if(eb>0){if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}return br.Winding_CLOCKWISE}else{if(eb==0){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}return br.Winding_UNDEFINED}else{if(br.Winding_ANTICLOCKWISE==null){br.internal=true;br.Winding_ANTICLOCKWISE=new X();br.internal=false}return br.Winding_ANTICLOCKWISE}}}};a7.prototype.contains=function(ek){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}var ej=ek.zpp_inner.x;var ef=ek.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=ek.zpp_inner.y;var ee=false;var el=this.zpp_inner.vertices;var eg=this.zpp_inner.vertices;if(el!=null){var ec=el;while(true){var eb=ec;var ea=eb.prev;if((eb.y<ei&&ea.y>=ei||ea.y<ei&&eb.y>=ei)&&(eb.x<=ej||ea.x<=ej)){if(eb.x+(ei-eb.y)/(ea.y-eb.y)*(ea.x-eb.x)<ej){ee=!ee}}ec=ec.next;if(!(ec!=eg)){break}}}var eh=ee;if(ek.zpp_inner.weak){var em=ek.zpp_inner;ek.zpp_inner.outer=null;ek.zpp_inner=null;ek.zpp_pool=au.poolVec2;au.poolVec2=ek;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}return eh};a7.prototype.isClockwise=function(){var ea=this.winding();if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}return ea==br.Winding_CLOCKWISE};a7.prototype.isConvex=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{var ec=false;var ei=false;var ee=true;var em=this.zpp_inner.vertices;var eh=this.zpp_inner.vertices;if(em!=null){var ed=em;while(true){var ek=ed;var el=ek.prev;var ej=ek.next;var ea=0;var en=0;ea=ej.x-ek.x;en=ej.y-ek.y;var eg=0;var ef=0;eg=ek.x-el.x;ef=ek.y-el.y;var eb=ef*ea-eg*en;if(eb>0){ei=true}else{if(eb<0){ec=true}}if(ei&&ec){ee=false;break}ed=ed.next;if(!(ed!=eh)){break}}}return ee}};a7.prototype.isSimple=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{return bv.isSimple(this.zpp_inner.vertices)}};a7.prototype.isMonotone=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{return aE.isMonotone(this.zpp_inner.vertices)}};a7.prototype.isDegenerate=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{return this.area()<P.epsilon}};a7.prototype.simplify=function(ec){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return this.copy()}else{var ea=aL.simplify(this.zpp_inner.vertices,ec);var eb=a7.get();eb.zpp_inner.vertices=ea;return eb}};a7.prototype.simpleDecomposition=function(ec){if(a.sharedGVList==null){a.sharedGVList=new dA()}var eb=bv.decompose(this.zpp_inner.vertices,a.sharedGVList);var ed=ec==null?new u():ec;while(eb.head!=null){var ee=eb.pop_unsafe();var ea=a7.get();ea.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(ea)}else{ed.unshift(ea)}}return ed};a7.prototype.monotoneDecomposition=function(ec){if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}var ef=aE.decompose(this.zpp_inner.vertices,aE.sharedPPoly);if(a.sharedGVList==null){a.sharedGVList=new dA()}var eb=ef.extract(a.sharedGVList);var ed=ec==null?new u():ec;while(eb.head!=null){var ee=eb.pop_unsafe();var ea=a7.get();ea.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(ea)}else{ed.unshift(ea)}}return ed};a7.prototype.convexDecomposition=function(ei,eb){if(ei==null){ei=false}if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}var ea=aE.decompose(this.zpp_inner.vertices,aE.sharedPPoly);if(a.sharedPPList==null){a.sharedPPList=new bu()}var eh=ea.extract_partitions(a.sharedPPList);var ed=eb==null?new u():eb;while(eh.head!=null){var ef=eh.pop_unsafe();z.triangulate(ef);if(ei){z.optimise(ef)}an.optimise(ef);if(a.sharedGVList==null){a.sharedGVList=new dA()}var ec=ef.extract(a.sharedGVList);ef.next=a.zpp_pool;a.zpp_pool=ef;while(ec.head!=null){var ee=ec.pop_unsafe();var eg=a7.get();eg.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(eg)}else{ed.unshift(eg)}}}return ed};a7.prototype.triangularDecomposition=function(ei,eb){if(ei==null){ei=false}if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}var ea=aE.decompose(this.zpp_inner.vertices,aE.sharedPPoly);if(a.sharedPPList==null){a.sharedPPList=new bu()}var eh=ea.extract_partitions(a.sharedPPList);var ed=eb==null?new u():eb;while(eh.head!=null){var ef=eh.pop_unsafe();z.triangulate(ef);if(ei){z.optimise(ef)}if(a.sharedGVList==null){a.sharedGVList=new dA()}var ec=ef.extract(a.sharedGVList);ef.next=a.zpp_pool;a.zpp_pool=ef;while(ec.head!=null){var ee=ec.pop_unsafe();var eg=a7.get();eg.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(eg)}else{ed.unshift(eg)}}}return ed};a7.prototype.inflate=function(eF){var ep=a7.get();var eB=this.winding();if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}if(eB==br.Winding_CLOCKWISE){eF=-eF}var ek=this.zpp_inner.vertices;var ej=this.zpp_inner.vertices;if(ek!=null){var eb=ek;while(true){var eC=eb;var el=eC.prev;var ec=eC.next;var ed=0;var ea=0;var ex=0;var ev=0;ed=eC.x-el.x;ea=eC.y-el.y;ex=ec.x-eC.x;ev=ec.y-eC.y;var eJ=0;var eI=0;var eE=0;var eD=0;eJ=ed;eI=ea;var ew=1/Math.sqrt(eJ*eJ+eI*eI);eJ*=ew;eI*=ew;var eA=eJ;eJ=-eI;eI=eA;var er=eF;eJ*=er;eI*=er;eE=ex;eD=ev;var es=1/Math.sqrt(eE*eE+eD*eD);eE*=es;eD*=es;var eq=eE;eE=-eD;eD=eq;var eo=eF;eE*=eo;eD*=eo;var eh=0;var ef=0;eh=eE-eJ;ef=eD-eI;var eH=ev*eh-ex*ef;var en=eH==0?0:eH/(ev*ed-ex*ea);var ei=0;var eg=0;ei=eC.x+eJ;eg=eC.y+eI;var em=en;ei+=ed*em;eg+=ea*em;var eu;if(au.poolVec2==null){eu=new r()}else{eu=au.poolVec2;au.poolVec2=eu.zpp_pool;eu.zpp_pool=null}if(eu.zpp_inner==null){var et;if(bB.zpp_pool==null){et=new bB()}else{et=bB.zpp_pool;bB.zpp_pool=et.next;et.next=null}et.weak=false;et._immutable=false;et.x=ei;et.y=eg;eu.zpp_inner=et;eu.zpp_inner.outer=eu}else{var eG;var ee=eu.zpp_inner;if(ee._validate!=null){ee._validate()}if(eu.zpp_inner.x==ei){var ez=eu.zpp_inner;if(ez._validate!=null){ez._validate()}eG=eu.zpp_inner.y==eg}else{eG=false}if(!eG){eu.zpp_inner.x=ei;eu.zpp_inner.y=eg;var ey=eu.zpp_inner;if(ey._invalidate!=null){ey._invalidate(ey)}}}eu.zpp_inner.weak=false;ep.push(eu);eb=eb.next;if(!(eb!=ej)){break}}}return ep.skipForward(1)};a7.prototype.cut=function(eh,ec,eb,eg,ee){if(eg==null){eg=false}if(eb==null){eb=false}var ef=az.run(this.zpp_inner.vertices,eh,ec,eb,eg,ee);if(eh.zpp_inner.weak){var ed=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ed.outer!=null){ed.outer.zpp_inner=null;ed.outer=null}ed._isimmutable=null;ed._validate=null;ed._invalidate=null;ed.next=bB.zpp_pool;bB.zpp_pool=ed}if(ec.zpp_inner.weak){var ea=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return ef};a7.prototype.transform=function(ec){var ee=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ee!=null){var ef=ee;while(true){var eb=ef;var ed=ec.zpp_inner.a*eb.x+ec.zpp_inner.b*eb.y+ec.zpp_inner.tx;eb.y=ec.zpp_inner.c*eb.x+ec.zpp_inner.d*eb.y+ec.zpp_inner.ty;eb.x=ed;ef=ef.next;if(!(ef!=ea)){break}}}return this};a7.prototype.bounds=function(){var ec=1e+100;var eb=1e+100;var eh=-1e+100;var eg=-1e+100;var ee=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ee!=null){var ef=ee;while(true){var ed=ef;if(ed.x<ec){ec=ed.x}if(ed.y<eb){eb=ed.y}if(ed.x>eh){eh=ed.x}if(ed.y>eg){eg=ed.y}ef=ef.next;if(!(ef!=ea)){break}}}return new S(ec,eb,eh-ec,eg-eb)};a7.prototype.top=function(){var eb=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eh=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.y<eb.y){eb=el}ea=ea.next;if(!(ea!=eh)){break}}}if(eb.wrap==null){var ek=eb.x;var ej=eb.y;var ef;if(au.poolVec2==null){ef=new r()}else{ef=au.poolVec2;au.poolVec2=ef.zpp_pool;ef.zpp_pool=null}if(ef.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=ek;ei.y=ej;ef.zpp_inner=ei;ef.zpp_inner.outer=ef}else{var ec;var ed=ef.zpp_inner;if(ed._validate!=null){ed._validate()}if(ef.zpp_inner.x==ek){var eg=ef.zpp_inner;if(eg._validate!=null){eg._validate()}ec=ef.zpp_inner.y==ej}else{ec=false}if(!ec){ef.zpp_inner.x=ek;ef.zpp_inner.y=ej;var ee=ef.zpp_inner;if(ee._invalidate!=null){ee._invalidate(ee)}}}ef.zpp_inner.weak=false;eb.wrap=ef;eb.wrap.zpp_inner._inuse=true;eb.wrap.zpp_inner._invalidate=dX(eb,eb.modwrap);eb.wrap.zpp_inner._validate=dX(eb,eb.getwrap)}return eb.wrap};a7.prototype.bottom=function(){var ej=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eg=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.y>ej.y){ej=el}ea=ea.next;if(!(ea!=eg)){break}}}if(ej.wrap==null){var ek=ej.x;var ei=ej.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ek;eh.y=ei;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var eb;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==ek){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ek;ee.zpp_inner.y=ei;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=false;ej.wrap=ee;ej.wrap.zpp_inner._inuse=true;ej.wrap.zpp_inner._invalidate=dX(ej,ej.modwrap);ej.wrap.zpp_inner._validate=dX(ej,ej.getwrap)}return ej.wrap};a7.prototype.left=function(){var eb=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eh=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.x<eb.x){eb=el}ea=ea.next;if(!(ea!=eh)){break}}}if(eb.wrap==null){var ek=eb.x;var ej=eb.y;var ef;if(au.poolVec2==null){ef=new r()}else{ef=au.poolVec2;au.poolVec2=ef.zpp_pool;ef.zpp_pool=null}if(ef.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=ek;ei.y=ej;ef.zpp_inner=ei;ef.zpp_inner.outer=ef}else{var ec;var ed=ef.zpp_inner;if(ed._validate!=null){ed._validate()}if(ef.zpp_inner.x==ek){var eg=ef.zpp_inner;if(eg._validate!=null){eg._validate()}ec=ef.zpp_inner.y==ej}else{ec=false}if(!ec){ef.zpp_inner.x=ek;ef.zpp_inner.y=ej;var ee=ef.zpp_inner;if(ee._invalidate!=null){ee._invalidate(ee)}}}ef.zpp_inner.weak=false;eb.wrap=ef;eb.wrap.zpp_inner._inuse=true;eb.wrap.zpp_inner._invalidate=dX(eb,eb.modwrap);eb.wrap.zpp_inner._validate=dX(eb,eb.getwrap)}return eb.wrap};a7.prototype.right=function(){var ej=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eg=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.x>ej.x){ej=el}ea=ea.next;if(!(ea!=eg)){break}}}if(ej.wrap==null){var ek=ej.x;var ei=ej.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ek;eh.y=ei;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var eb;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==ek){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ek;ee.zpp_inner.y=ei;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=false;ej.wrap=ee;ej.wrap.zpp_inner._inuse=true;ej.wrap.zpp_inner._invalidate=dX(ej,ej.modwrap);ej.wrap.zpp_inner._validate=dX(ej,ej.getwrap)}return ej.wrap};a7.prototype.__class__=a7;var bL=nape.geom.GeomPolyIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};bL.__name__=["nape","geom","GeomPolyIterator"];bL.get=function(ec){var ea;if(bL.zpp_pool==null){dl.internal=true;var ed=new bL();dl.internal=false;ea=ed}else{var eb=bL.zpp_pool;bL.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};bL.prototype.zpp_inner=null;bL.prototype.zpp_i=null;bL.prototype.zpp_critical=null;bL.prototype.zpp_next=null;bL.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=bL.zpp_pool;bL.zpp_pool=this;this.zpp_inner=null;return false}};bL.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};bL.prototype.__class__=bL;var u=nape.geom.GeomPolyList=function(){this.zpp_inner=null;this.zpp_inner=new dl();this.zpp_inner.outer=this};u.__name__=["nape","geom","GeomPolyList"];u.fromArray=function(ed){var ea=new u();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};u.prototype.zpp_inner=null;u.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};u.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};u.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};u.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};u.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};u.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};u.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};u.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};u.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};u.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};u.prototype.empty=function(){return this.zpp_inner.inner.head==null};u.prototype.iterator=function(){this.zpp_inner.valmod();return bL.get(this)};u.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new u();this.zpp_inner.valmod();var ef=bL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bL.zpp_pool;bL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};u.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=bL.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=bL.zpp_pool;bL.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};u.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=bL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bL.zpp_pool;bL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};u.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=bL.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=bL.zpp_pool;bL.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=bL.zpp_pool;bL.zpp_pool=ec;ec.zpp_inner=null;break}}return this};u.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(u.prototype,"length",{get:u.prototype.get_length});u.prototype.__class__=u;var cz=nape.geom.GeomVertexIterator=function(){};cz.__name__=["nape","geom","GeomVertexIterator"];cz.prototype.zpp_inner=null;cz.prototype.hasNext=function(){var ea=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;this.zpp_inner.first=false;if(!ea){var eb=this.zpp_inner;eb.outer.zpp_inner=null;eb.ptr=eb.start=null;eb.next=dn.zpp_pool;dn.zpp_pool=eb}return ea};cz.prototype.next=function(){var ec=this.zpp_inner.ptr;if(ec.wrap==null){var ej=ec.x;var eh=ec.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=ej;ei.y=eh;ee.zpp_inner=ei;ee.zpp_inner.outer=ee}else{var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==eh}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=eh;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}ee.zpp_inner.weak=false;ec.wrap=ee;ec.wrap.zpp_inner._inuse=true;ec.wrap.zpp_inner._invalidate=dX(ec,ec.modwrap);ec.wrap.zpp_inner._validate=dX(ec,ec.getwrap)}var eg=ec.wrap;this.zpp_inner.ptr=this.zpp_inner.forward?this.zpp_inner.ptr.next:this.zpp_inner.ptr.prev;return eg};cz.prototype.__class__=cz;var F=nape.geom.MarchingSquares=function(){};F.__name__=["nape","geom","MarchingSquares"];F.run=function(ec,ep,eh,ed,eo,eD,ej){if(eD==null){eD=true}if(ed==null){ed=2}var en=ej!=null?ej:new u();if(eo==null){var eb=ep.zpp_inner;if(eb._validate!=null){eb._validate()}var eE=ep.zpp_inner.minx;var eC=ep.zpp_inner;if(eC._validate!=null){eC._validate()}var eZ=ep.zpp_inner.miny;var eB=ep.zpp_inner.getmax();var eA=eB.zpp_inner;if(eA._validate!=null){eA._validate()}var eY=eB.zpp_inner.x;var ez=ep.zpp_inner.getmax();var ex=ez.zpp_inner;if(ex._validate!=null){ex._validate()}bc.run(ec,eE,eZ,eY,ez.zpp_inner.y,eh,ed,eD,en)}else{var ew=ep.zpp_inner;if(ew._validate!=null){ew._validate()}var eu=ep.zpp_inner;var eV=eu.maxx-eu.minx;var et=eo.zpp_inner;if(et._validate!=null){et._validate()}var eq=eV/eo.zpp_inner.x;var es=ep.zpp_inner;if(es._validate!=null){es._validate()}var eX=ep.zpp_inner;var eT=eX.maxy-eX.miny;var eU=eo.zpp_inner;if(eU._validate!=null){eU._validate()}var eg=eT/eo.zpp_inner.y;var er=eq|0;var ei=eg|0;if(er!=eq){++er}if(ei!=eg){++ei}var eN=0;var eW=er;while(eN<eW){var ey=eN++;var eS=ep.zpp_inner;if(eS._validate!=null){eS._validate()}var eR=ep.zpp_inner.minx;var eQ=eo.zpp_inner;if(eQ._validate!=null){eQ._validate()}var ef=eR+eo.zpp_inner.x*ey;var ee;if(ey==er-1){var eP=ep.zpp_inner.getmax();var eM=eP.zpp_inner;if(eM._validate!=null){eM._validate()}ee=eP.zpp_inner.x}else{var eL=eo.zpp_inner;if(eL._validate!=null){eL._validate()}ee=ef+eo.zpp_inner.x}var eJ=0;var eK=ei;while(eJ<eK){var ev=eJ++;var eI=ep.zpp_inner;if(eI._validate!=null){eI._validate()}var eO=ep.zpp_inner.miny;var eH=eo.zpp_inner;if(eH._validate!=null){eH._validate()}var ea=eO+eo.zpp_inner.y*ev;var e0;if(ev==ei-1){var eG=ep.zpp_inner.getmax();var em=eG.zpp_inner;if(em._validate!=null){em._validate()}e0=eG.zpp_inner.y}else{var el=eo.zpp_inner;if(el._validate!=null){el._validate()}e0=ea+eo.zpp_inner.y}bc.run(ec,ef,ea,ee,e0,eh,ed,eD,en)}}}if(eh.zpp_inner.weak){var ek=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(eo!=null){if(eo.zpp_inner.weak){var eF=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(eF.outer!=null){eF.outer.zpp_inner=null;eF.outer=null}eF._isimmutable=null;eF._validate=null;eF._invalidate=null;eF.next=bB.zpp_pool;bB.zpp_pool=eF}}return en};F.prototype.__class__=F;var cI=nape.geom.Mat23=function(el,ek,ej,eh,eb,ea){if(ea==null){ea=0}if(eb==null){eb=0}if(eh==null){eh=1}if(ej==null){ej=0}if(ek==null){ek=0}if(el==null){el=1}this.zpp_inner=null;this.zpp_inner=cm.get();this.zpp_inner.outer=this;this.zpp_inner.a=el;var ef=this.zpp_inner;if(ef._invalidate!=null){ef._invalidate()}this.zpp_inner.b=ek;var ei=this.zpp_inner;if(ei._invalidate!=null){ei._invalidate()}this.zpp_inner.tx=eb;var eg=this.zpp_inner;if(eg._invalidate!=null){eg._invalidate()}this.zpp_inner.c=ej;var ee=this.zpp_inner;if(ee._invalidate!=null){ee._invalidate()}this.zpp_inner.d=eh;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate()}this.zpp_inner.ty=ea;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate()}};cI.__name__=["nape","geom","Mat23"];cI.rotation=function(ec){var eb=Math.cos(ec);var ea=Math.sin(ec);return new cI(eb,-ea,ea,eb,0,0)};cI.translation=function(eb,ea){return new cI(1,0,0,1,eb,ea)};cI.scale=function(eb,ea){return new cI(eb,0,0,ea,0,0)};cI.prototype.zpp_inner=null;cI.prototype.get_a=function(){return this.zpp_inner.a};cI.prototype.set_a=function(ea){this.zpp_inner.a=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.a};cI.prototype.get_b=function(){return this.zpp_inner.b};cI.prototype.set_b=function(ea){this.zpp_inner.b=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.b};cI.prototype.get_c=function(){return this.zpp_inner.c};cI.prototype.set_c=function(eb){this.zpp_inner.c=eb;var ea=this.zpp_inner;if(ea._invalidate!=null){ea._invalidate()}return this.zpp_inner.c};cI.prototype.get_d=function(){return this.zpp_inner.d};cI.prototype.set_d=function(ea){this.zpp_inner.d=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.d};cI.prototype.get_tx=function(){return this.zpp_inner.tx};cI.prototype.set_tx=function(ea){this.zpp_inner.tx=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.tx};cI.prototype.get_ty=function(){return this.zpp_inner.ty};cI.prototype.set_ty=function(ea){this.zpp_inner.ty=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.ty};cI.prototype.copy=function(){return new cI(this.zpp_inner.a,this.zpp_inner.b,this.zpp_inner.c,this.zpp_inner.d,this.zpp_inner.tx,this.zpp_inner.ty)};cI.prototype.set=function(eb){var ea=eb.zpp_inner;this.zpp_inner.setas(ea.a,ea.b,ea.c,ea.d,ea.tx,ea.ty);var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate()}return this};cI.prototype.setAs=function(ed,eb,eg,ee,ec,ea){if(ea==null){ea=0}if(ec==null){ec=0}if(ee==null){ee=1}if(eg==null){eg=0}if(eb==null){eb=0}if(ed==null){ed=1}this.zpp_inner.setas(ed,eb,eg,ee,ec,ea);var ef=this.zpp_inner;if(ef._invalidate!=null){ef._invalidate()}return this};cI.prototype.reset=function(){return this.setAs()};cI.prototype.get_determinant=function(){return this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c};cI.prototype.singular=function(){var eb=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d;var ea=this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c;if(ea<0){ea=-ea}return eb>P.illConditionedThreshold*ea};cI.prototype.inverse=function(){var ea=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);return new cI(this.zpp_inner.d*ea,-this.zpp_inner.b*ea,-this.zpp_inner.c*ea,this.zpp_inner.a*ea,(this.zpp_inner.b*this.zpp_inner.ty-this.zpp_inner.d*this.zpp_inner.tx)*ea,(this.zpp_inner.c*this.zpp_inner.tx-this.zpp_inner.a*this.zpp_inner.ty)*ea)};cI.prototype.transpose=function(){return new cI(this.zpp_inner.a,this.zpp_inner.c,this.zpp_inner.b,this.zpp_inner.d,-this.zpp_inner.a*this.zpp_inner.tx-this.zpp_inner.c*this.zpp_inner.ty,-this.zpp_inner.b*this.zpp_inner.tx-this.zpp_inner.d*this.zpp_inner.ty)};cI.prototype.concat=function(ea){return new cI(ea.zpp_inner.a*this.zpp_inner.a+ea.zpp_inner.b*this.zpp_inner.c,ea.zpp_inner.a*this.zpp_inner.b+ea.zpp_inner.b*this.zpp_inner.d,ea.zpp_inner.c*this.zpp_inner.a+ea.zpp_inner.d*this.zpp_inner.c,ea.zpp_inner.c*this.zpp_inner.b+ea.zpp_inner.d*this.zpp_inner.d,ea.zpp_inner.a*this.zpp_inner.tx+ea.zpp_inner.b*this.zpp_inner.ty+ea.zpp_inner.tx,ea.zpp_inner.c*this.zpp_inner.tx+ea.zpp_inner.d*this.zpp_inner.ty+ea.zpp_inner.ty)};cI.prototype.transform=function(eu,el,ef){if(ef==null){ef=false}if(el==null){el=false}var eG;if(el){var ex=eu.zpp_inner;if(ex._validate!=null){ex._validate()}var eE=eu.zpp_inner.x*this.zpp_inner.a;var eD=eu.zpp_inner;if(eD._validate!=null){eD._validate()}var eh=eE+eu.zpp_inner.y*this.zpp_inner.b;var eC=eu.zpp_inner;if(eC._validate!=null){eC._validate()}var ep=eu.zpp_inner.x*this.zpp_inner.c;var eA=eu.zpp_inner;if(eA._validate!=null){eA._validate()}var eg=ep+eu.zpp_inner.y*this.zpp_inner.d;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ed;if(bB.zpp_pool==null){ed=new bB()}else{ed=bB.zpp_pool;bB.zpp_pool=ed.next;ed.next=null}ed.weak=false;ed._immutable=false;ed.x=eh;ed.y=eg;ee.zpp_inner=ed;ee.zpp_inner.outer=ee}else{var em;var ez=ee.zpp_inner;if(ez._validate!=null){ez._validate()}if(ee.zpp_inner.x==eh){var ey=ee.zpp_inner;if(ey._validate!=null){ey._validate()}em=ee.zpp_inner.y==eg}else{em=false}if(!em){ee.zpp_inner.x=eh;ee.zpp_inner.y=eg;var ew=ee.zpp_inner;if(ew._invalidate!=null){ew._invalidate(ew)}}}ee.zpp_inner.weak=ef;eG=ee}else{var et=eu.zpp_inner;if(et._validate!=null){et._validate()}var ek=eu.zpp_inner.x*this.zpp_inner.a;var er=eu.zpp_inner;if(er._validate!=null){er._validate()}var eB=ek+eu.zpp_inner.y*this.zpp_inner.b+this.zpp_inner.tx;var eo=eu.zpp_inner;if(eo._validate!=null){eo._validate()}var ej=eu.zpp_inner.x*this.zpp_inner.c;var ev=eu.zpp_inner;if(ev._validate!=null){ev._validate()}var ea=ej+eu.zpp_inner.y*this.zpp_inner.d+this.zpp_inner.ty;var ec;if(au.poolVec2==null){ec=new r()}else{ec=au.poolVec2;au.poolVec2=ec.zpp_pool;ec.zpp_pool=null}if(ec.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=eB;eb.y=ea;ec.zpp_inner=eb;ec.zpp_inner.outer=ec}else{var ei;var es=ec.zpp_inner;if(es._validate!=null){es._validate()}if(ec.zpp_inner.x==eB){var eq=ec.zpp_inner;if(eq._validate!=null){eq._validate()}ei=ec.zpp_inner.y==ea}else{ei=false}if(!ei){ec.zpp_inner.x=eB;ec.zpp_inner.y=ea;var en=ec.zpp_inner;if(en._invalidate!=null){en._invalidate(en)}}}ec.zpp_inner.weak=ef;eG=ec}if(eu.zpp_inner.weak){var eF=eu.zpp_inner;eu.zpp_inner.outer=null;eu.zpp_inner=null;eu.zpp_pool=au.poolVec2;au.poolVec2=eu;if(eF.outer!=null){eF.outer.zpp_inner=null;eF.outer=null}eF._isimmutable=null;eF._validate=null;eF._invalidate=null;eF.next=bB.zpp_pool;bB.zpp_pool=eF}return eG};cI.prototype.inverseTransform=function(es,el,ef){if(ef==null){ef=false}if(el==null){el=false}var eC=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);var eF;if(el){var ev=es.zpp_inner;if(ev._validate!=null){ev._validate()}var eD=es.zpp_inner.x*this.zpp_inner.d;var eB=es.zpp_inner;if(eB._validate!=null){eB._validate()}var eh=(eD-es.zpp_inner.y*this.zpp_inner.b)*eC;var eA=es.zpp_inner;if(eA._validate!=null){eA._validate()}var eo=es.zpp_inner.y*this.zpp_inner.a;var ey=es.zpp_inner;if(ey._validate!=null){ey._validate()}var eg=(eo-es.zpp_inner.x*this.zpp_inner.c)*eC;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ed;if(bB.zpp_pool==null){ed=new bB()}else{ed=bB.zpp_pool;bB.zpp_pool=ed.next;ed.next=null}ed.weak=false;ed._immutable=false;ed.x=eh;ed.y=eg;ee.zpp_inner=ed;ee.zpp_inner.outer=ee}else{var em;var ex=ee.zpp_inner;if(ex._validate!=null){ex._validate()}if(ee.zpp_inner.x==eh){var ew=ee.zpp_inner;if(ew._validate!=null){ew._validate()}em=ee.zpp_inner.y==eg}else{em=false}if(!em){ee.zpp_inner.x=eh;ee.zpp_inner.y=eg;var eu=ee.zpp_inner;if(eu._invalidate!=null){eu._invalidate(eu)}}}ee.zpp_inner.weak=ef;eF=ee}else{var er=es.zpp_inner;if(er._validate!=null){er._validate()}var ej=es.zpp_inner.x-this.zpp_inner.tx;var ep=es.zpp_inner;if(ep._validate!=null){ep._validate()}var ei=es.zpp_inner.y-this.zpp_inner.ty;var ez=(ej*this.zpp_inner.d-ei*this.zpp_inner.b)*eC;var ea=(ei*this.zpp_inner.a-ej*this.zpp_inner.c)*eC;var ec;if(au.poolVec2==null){ec=new r()}else{ec=au.poolVec2;au.poolVec2=ec.zpp_pool;ec.zpp_pool=null}if(ec.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ez;eb.y=ea;ec.zpp_inner=eb;ec.zpp_inner.outer=ec}else{var ek;var en=ec.zpp_inner;if(en._validate!=null){en._validate()}if(ec.zpp_inner.x==ez){var et=ec.zpp_inner;if(et._validate!=null){et._validate()}ek=ec.zpp_inner.y==ea}else{ek=false}if(!ek){ec.zpp_inner.x=ez;ec.zpp_inner.y=ea;var eq=ec.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}}}ec.zpp_inner.weak=ef;eF=ec}if(es.zpp_inner.weak){var eE=es.zpp_inner;es.zpp_inner.outer=null;es.zpp_inner=null;es.zpp_pool=au.poolVec2;au.poolVec2=es;if(eE.outer!=null){eE.outer.zpp_inner=null;eE.outer=null}eE._isimmutable=null;eE._validate=null;eE._invalidate=null;eE.next=bB.zpp_pool;bB.zpp_pool=eE}return eF};cI.prototype.toString=function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+" tx: "+this.zpp_inner.tx+" ty: "+this.zpp_inner.ty+" }"};cI.prototype.equiorthogonal=function(){if(this.singular()){return false}else{var ea=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(ea*ea<P.epsilon){var eb=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-this.zpp_inner.c*this.zpp_inner.c-this.zpp_inner.d*this.zpp_inner.d;return eb*eb<P.epsilon}else{return false}}};cI.prototype.orthogonal=function(){var ea=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(ea*ea<P.epsilon){var ec=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-1;var eb=this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d-1;if(ec*ec<P.epsilon){return eb*eb<P.epsilon}else{return false}}else{return false}};cI.prototype.equiorthogonalise=function(){if(!this.equiorthogonal()){var ef=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c);var ee=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);var en=(ef+ee)/2;ef=en/ef;ee=en/ee;var ec=this;ec.zpp_inner.a=ec.zpp_inner.a*ef;var em=ec.zpp_inner;if(em._invalidate!=null){em._invalidate()}var ei=this;ei.zpp_inner.c=ei.zpp_inner.c*ef;var es=ei.zpp_inner;if(es._invalidate!=null){es._invalidate()}var eh=this;eh.zpp_inner.b=eh.zpp_inner.b*ee;var er=eh.zpp_inner;if(er._invalidate!=null){er._invalidate()}var eg=this;eg.zpp_inner.d=eg.zpp_inner.d*ee;var eq=eg.zpp_inner;if(eq._invalidate!=null){eq._invalidate()}var et=0.25*Math.PI-0.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/(en*en));if(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c>0){et=-et}var ea=Math.sin(et);var eb=Math.cos(et);var eu=this.zpp_inner.a*eb-this.zpp_inner.c*ea;var ed=this.zpp_inner.b*eb+this.zpp_inner.d*ea;this.zpp_inner.c=this.zpp_inner.c*eb+this.zpp_inner.a*ea;var ep=this.zpp_inner;if(ep._invalidate!=null){ep._invalidate()}this.zpp_inner.a=eu;var eo=this.zpp_inner;if(eo._invalidate!=null){eo._invalidate()}this.zpp_inner.d=this.zpp_inner.d*eb-this.zpp_inner.b*ea;var el=this.zpp_inner;if(el._invalidate!=null){el._invalidate()}this.zpp_inner.b=ed;var ek=this.zpp_inner;if(ek._invalidate!=null){ek._invalidate()}var ej=this.zpp_inner;if(ej._invalidate!=null){ej._invalidate()}}return this};cI.prototype.orthogonalise=function(){if(!this.orthogonal()){var ef=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c);var ee=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);ef=1/ef;ee=1/ee;var ec=this;ec.zpp_inner.a=ec.zpp_inner.a*ef;var em=ec.zpp_inner;if(em._invalidate!=null){em._invalidate()}var ei=this;ei.zpp_inner.c=ei.zpp_inner.c*ef;var er=ei.zpp_inner;if(er._invalidate!=null){er._invalidate()}var eh=this;eh.zpp_inner.b=eh.zpp_inner.b*ee;var eq=eh.zpp_inner;if(eq._invalidate!=null){eq._invalidate()}var eg=this;eg.zpp_inner.d=eg.zpp_inner.d*ee;var ep=eg.zpp_inner;if(ep._invalidate!=null){ep._invalidate()}var es=0.25*Math.PI-0.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/1);if(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c>0){es=-es}var ea=Math.sin(es);var eb=Math.cos(es);var et=this.zpp_inner.a*eb-this.zpp_inner.c*ea;var ed=this.zpp_inner.b*eb+this.zpp_inner.d*ea;this.zpp_inner.c=this.zpp_inner.c*eb+this.zpp_inner.a*ea;var eo=this.zpp_inner;if(eo._invalidate!=null){eo._invalidate()}this.zpp_inner.a=et;var en=this.zpp_inner;if(en._invalidate!=null){en._invalidate()}this.zpp_inner.d=this.zpp_inner.d*eb-this.zpp_inner.b*ea;var el=this.zpp_inner;if(el._invalidate!=null){el._invalidate()}this.zpp_inner.b=ed;var ek=this.zpp_inner;if(ek._invalidate!=null){ek._invalidate()}var ej=this.zpp_inner;if(ej._invalidate!=null){ej._invalidate()}}return this};Object.defineProperty(cI.prototype,"a",{get:cI.prototype.get_a,set:cI.prototype.set_a});Object.defineProperty(cI.prototype,"b",{get:cI.prototype.get_b,set:cI.prototype.set_b});Object.defineProperty(cI.prototype,"c",{get:cI.prototype.get_c,set:cI.prototype.set_c});Object.defineProperty(cI.prototype,"d",{get:cI.prototype.get_d,set:cI.prototype.set_d});Object.defineProperty(cI.prototype,"tx",{get:cI.prototype.get_tx,set:cI.prototype.set_tx});Object.defineProperty(cI.prototype,"ty",{get:cI.prototype.get_ty,set:cI.prototype.set_ty});Object.defineProperty(cI.prototype,"determinant",{get:cI.prototype.get_determinant});cI.prototype.__class__=cI;var bY=nape.geom.MatMN=function(ea,eb){this.zpp_inner=null;this.zpp_inner=new bI(ea,eb);this.zpp_inner.outer=this};bY.__name__=["nape","geom","MatMN"];bY.prototype.zpp_inner=null;bY.prototype.get_rows=function(){return this.zpp_inner.m};bY.prototype.get_cols=function(){return this.zpp_inner.n};bY.prototype.x=function(eb,ea){return this.zpp_inner.x[eb*this.zpp_inner.n+ea]};bY.prototype.setx=function(ec,eb,ea){return this.zpp_inner.x[ec*this.zpp_inner.n+eb]=ea};bY.prototype.toString=function(){var eb="{ ";var ea=true;var ef=0;var eg=this.zpp_inner.m;while(ef<eg){var ec=ef++;if(!ea){eb+="; "}ea=false;var ed=0;var ee=this.zpp_inner.n;while(ed<ee){eb+=this.zpp_inner.x[ec*this.zpp_inner.n+ed++]+" "}}eb+="}";return eb};bY.prototype.transpose=function(){var eb=new bY(this.zpp_inner.n,this.zpp_inner.m);var ef=0;var eg=this.zpp_inner.m;while(ef<eg){var ec=ef++;var ed=0;var ee=this.zpp_inner.n;while(ed<ee){var ea=ed++;eb.zpp_inner.x[ea*eb.zpp_inner.n+ec]=this.zpp_inner.x[ec*this.zpp_inner.n+ea]}}return eb};bY.prototype.mul=function(ek){var eh=new bY(this.zpp_inner.m,ek.zpp_inner.n);var ej=0;var ed=this.zpp_inner.m;while(ej<ed){var ec=ej++;var eg=0;var ei=ek.zpp_inner.n;while(eg<ei){var eb=eg++;var el=0;var ee=0;var ef=this.zpp_inner.n;while(ee<ef){var ea=ee++;el+=this.zpp_inner.x[ec*this.zpp_inner.n+ea]*ek.zpp_inner.x[ea*ek.zpp_inner.n+eb]}eh.zpp_inner.x[ec*eh.zpp_inner.n+eb]=el}}return eh};Object.defineProperty(bY.prototype,"rows",{get:bY.prototype.get_rows});Object.defineProperty(bY.prototype,"cols",{get:bY.prototype.get_cols});bY.prototype.__class__=bY;var ad=nape.geom.Ray=function(ev,et){this.zpp_inner=null;this.zpp_inner=new bf();var ej=this.zpp_inner.origin;var er=ev.zpp_inner;if(er._validate!=null){er._validate()}var ec=ev.zpp_inner.x;var ep=ev.zpp_inner;if(ep._validate!=null){ep._validate()}var eb=ev.zpp_inner.y;var es;var eo=ej.zpp_inner;if(eo._validate!=null){eo._validate()}if(ej.zpp_inner.x==ec){var en=ej.zpp_inner;if(en._validate!=null){en._validate()}es=ej.zpp_inner.y==eb}else{es=false}if(!es){ej.zpp_inner.x=ec;ej.zpp_inner.y=eb;var em=ej.zpp_inner;if(em._invalidate!=null){em._invalidate(em)}}if(ev.zpp_inner.weak){var eu=ev.zpp_inner;ev.zpp_inner.outer=null;ev.zpp_inner=null;ev.zpp_pool=au.poolVec2;au.poolVec2=ev;if(eu.outer!=null){eu.outer.zpp_inner=null;eu.outer=null}eu._isimmutable=null;eu._validate=null;eu._invalidate=null;eu.next=bB.zpp_pool;bB.zpp_pool=eu}var ek=this.zpp_inner.direction;var eh=et.zpp_inner;if(eh._validate!=null){eh._validate()}var eq=et.zpp_inner.x;var ef=et.zpp_inner;if(ef._validate!=null){ef._validate()}var ea=et.zpp_inner.y;var ee;var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}if(ek.zpp_inner.x==eq){var ei=ek.zpp_inner;if(ei._validate!=null){ei._validate()}ee=ek.zpp_inner.y==ea}else{ee=false}if(!ee){ek.zpp_inner.x=eq;ek.zpp_inner.y=ea;var eg=ek.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}if(et.zpp_inner.weak){var el=et.zpp_inner;et.zpp_inner.outer=null;et.zpp_inner=null;et.zpp_pool=au.poolVec2;au.poolVec2=et;if(el.outer!=null){el.outer.zpp_inner=null;el.outer=null}el._isimmutable=null;el._validate=null;el._invalidate=null;el.next=bB.zpp_pool;bB.zpp_pool=el}this.zpp_inner.zip_dir=true;this.zpp_inner.maxdist=Infinity};ad.__name__=["nape","geom","Ray"];ad.fromSegment=function(ec,ed){var eh=new ad(ec,ed.sub(ec,true));var ef=ec.zpp_inner;if(ef._validate!=null){ef._validate()}var ea=ec.zpp_inner.x;var ej=ec.zpp_inner;if(ej._validate!=null){ej._validate()}var eo=ec.zpp_inner.y;var eg=ed.zpp_inner;if(eg._validate!=null){eg._validate()}var ek=ed.zpp_inner.x;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}var ei=ed.zpp_inner.y;var en=0;var el=0;en=ea-ek;el=eo-ei;eh.zpp_inner.maxdist=Math.sqrt(en*en+el*el);if(ec.zpp_inner.weak){var em=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}if(ed.zpp_inner.weak){var eb=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return eh};ad.prototype.zpp_inner=null;ad.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};ad.prototype.get_origin=function(){return this.zpp_inner.origin};ad.prototype.set_origin=function(ej){var ed=this.zpp_inner.origin;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return this.zpp_inner.origin};ad.prototype.get_direction=function(){return this.zpp_inner.direction};ad.prototype.set_direction=function(ei){var ed=this.zpp_inner.direction;var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=ei.zpp_inner.x;var ef=ei.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ei.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ei.zpp_inner.weak){var ek=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}this.zpp_inner.zip_dir=true;return this.zpp_inner.direction};ad.prototype.get_maxDistance=function(){return this.zpp_inner.maxdist};ad.prototype.set_maxDistance=function(ea){this.zpp_inner.maxdist=ea;return this.zpp_inner.maxdist};ad.prototype.aabb=function(){return this.zpp_inner.rayAABB().wrapper()};ad.prototype.at=function(ea,ef){if(ef==null){ef=false}this.zpp_inner.validate_dir();var eg=this.zpp_inner.origin;var ek=eg.zpp_inner;if(ek._validate!=null){ek._validate()}var en=eg.zpp_inner.x+ea*this.zpp_inner.dirx;var ej=this.zpp_inner.origin;var eh=ej.zpp_inner;if(eh._validate!=null){eh._validate()}var em=ej.zpp_inner.y+ea*this.zpp_inner.diry;var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var el;if(bB.zpp_pool==null){el=new bB()}else{el=bB.zpp_pool;bB.zpp_pool=el.next;el.next=null}el.weak=false;el._immutable=false;el.x=en;el.y=em;ei.zpp_inner=el;ei.zpp_inner.outer=ei}else{var ec;var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}if(ei.zpp_inner.x==en){var ed=ei.zpp_inner;if(ed._validate!=null){ed._validate()}ec=ei.zpp_inner.y==em}else{ec=false}if(!ec){ei.zpp_inner.x=en;ei.zpp_inner.y=em;var eb=ei.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}ei.zpp_inner.weak=ef;return ei};ad.prototype.copy=function(){var ea=new ad(this.zpp_inner.origin,this.zpp_inner.direction);ea.zpp_inner.maxdist=this.zpp_inner.maxdist;return ea};Object.defineProperty(ad.prototype,"userData",{get:ad.prototype.get_userData});Object.defineProperty(ad.prototype,"origin",{get:ad.prototype.get_origin,set:ad.prototype.set_origin});Object.defineProperty(ad.prototype,"direction",{get:ad.prototype.get_direction,set:ad.prototype.set_direction});Object.defineProperty(ad.prototype,"maxDistance",{get:ad.prototype.get_maxDistance,set:ad.prototype.set_maxDistance});ad.prototype.__class__=ad;var df=nape.geom.RayResult=function(){this.zpp_inner=null};df.__name__=["nape","geom","RayResult"];df.prototype.zpp_inner=null;df.prototype.get_normal=function(){return this.zpp_inner.normal};df.prototype.get_distance=function(){return this.zpp_inner.toiDistance};df.prototype.get_inner=function(){return this.zpp_inner.inner};df.prototype.get_shape=function(){return this.zpp_inner.shape};df.prototype.dispose=function(){this.zpp_inner.free()};df.prototype.toString=function(){return"{ shape: "+ag.string(this.zpp_inner.shape)+" distance: "+this.zpp_inner.toiDistance+" ?inner: "+ag.string(this.zpp_inner.inner)+" }"};Object.defineProperty(df.prototype,"normal",{get:df.prototype.get_normal});Object.defineProperty(df.prototype,"distance",{get:df.prototype.get_distance});Object.defineProperty(df.prototype,"inner",{get:df.prototype.get_inner});Object.defineProperty(df.prototype,"shape",{get:df.prototype.get_shape});df.prototype.__class__=df;var du=nape.geom.RayResultIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};du.__name__=["nape","geom","RayResultIterator"];du.get=function(ec){var ea;if(du.zpp_pool==null){bw.internal=true;var ed=new du();bw.internal=false;ea=ed}else{var eb=du.zpp_pool;du.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};du.prototype.zpp_inner=null;du.prototype.zpp_i=null;du.prototype.zpp_critical=null;du.prototype.zpp_next=null;du.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=du.zpp_pool;du.zpp_pool=this;this.zpp_inner=null;return false}};du.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};du.prototype.__class__=du;var aa=nape.geom.RayResultList=function(){this.zpp_inner=null;this.zpp_inner=new bw();this.zpp_inner.outer=this};aa.__name__=["nape","geom","RayResultList"];aa.fromArray=function(ed){var ea=new aa();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};aa.prototype.zpp_inner=null;aa.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};aa.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea)};aa.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt};aa.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aa.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}else{this.zpp_inner.inner.add(ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aa.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb};aa.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb};aa.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};aa.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec)}this.zpp_inner.invalidate()}return ea};aa.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};aa.prototype.empty=function(){return this.zpp_inner.inner.head==null};aa.prototype.iterator=function(){this.zpp_inner.valmod();return du.get(this)};aa.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new aa();this.zpp_inner.valmod();var ef=du.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=du.zpp_pool;du.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};aa.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=du.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=du.zpp_pool;du.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};aa.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=du.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=du.zpp_pool;du.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};aa.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=du.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=du.zpp_pool;du.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=du.zpp_pool;du.zpp_pool=ec;ec.zpp_inner=null;break}}return this};aa.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(aa.prototype,"length",{get:aa.prototype.get_length});aa.prototype.__class__=aa;var r=nape.geom.Vec2=function(ea,ec){if(ec==null){ec=0}if(ea==null){ea=0}this.zpp_pool=null;this.zpp_inner=null;var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ea;eb.y=ec;this.zpp_inner=eb;this.zpp_inner.outer=this};r.__name__=["nape","geom","Vec2"];r.weak=function(ea,eh){if(eh==null){eh=0}if(ea==null){ea=0}var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=true;return eb};r.get=function(ei,eg,eb){if(eb==null){eb=false}if(eg==null){eg=0}if(ei==null){ei=0}var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ei;eh.y=eg;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var ea;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==ei){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}ea=ee.zpp_inner.y==eg}else{ea=false}if(!ea){ee.zpp_inner.x=ei;ee.zpp_inner.y=eg;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=eb;return ee};r.fromPolar=function(ea,eb,ed){if(ed==null){ed=false}var ek=ea*Math.cos(eb);var ei=ea*Math.sin(eb);var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ec;var ee=eg.zpp_inner;if(ee._validate!=null){ee._validate()}if(eg.zpp_inner.x==ek){var eh=eg.zpp_inner;if(eh._validate!=null){eh._validate()}ec=eg.zpp_inner.y==ei}else{ec=false}if(!ec){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var ef=eg.zpp_inner;if(ef._invalidate!=null){ef._invalidate(ef)}}}eg.zpp_inner.weak=ed;return eg};r.dsq=function(ek,ej){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}var ea=ek.zpp_inner.x;var eh=ek.zpp_inner;if(eh._validate!=null){eh._validate()}var eo=ek.zpp_inner.y;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=ej.zpp_inner.x;var ec=ej.zpp_inner;if(ec._validate!=null){ec._validate()}var eg=ej.zpp_inner.y;var en=0;var el=0;en=ea-ei;el=eo-eg;var ee=en*en+el*el;if(ek.zpp_inner.weak){var em=ek.zpp_inner;ek.zpp_inner.outer=null;ek.zpp_inner=null;ek.zpp_pool=au.poolVec2;au.poolVec2=ek;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}if(ej.zpp_inner.weak){var eb=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ee};r.distance=function(ek,ej){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}var ea=ek.zpp_inner.x;var eh=ek.zpp_inner;if(eh._validate!=null){eh._validate()}var eo=ek.zpp_inner.y;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=ej.zpp_inner.x;var ec=ej.zpp_inner;if(ec._validate!=null){ec._validate()}var eg=ej.zpp_inner.y;var en=0;var el=0;en=ea-ei;el=eo-eg;var ee=Math.sqrt(en*en+el*el);if(ek.zpp_inner.weak){var em=ek.zpp_inner;ek.zpp_inner.outer=null;ek.zpp_inner=null;ek.zpp_pool=au.poolVec2;au.poolVec2=ek;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}if(ej.zpp_inner.weak){var eb=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ee};r.prototype.zpp_inner=null;r.prototype.zpp_pool=null;r.prototype.dispose=function(){var ea=this.zpp_inner;this.zpp_inner.outer=null;this.zpp_inner=null;var eb=this;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea};r.prototype.copy=function(ec){if(ec==null){ec=false}var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ek=this.zpp_inner.x;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=this.zpp_inner.y;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ea;var ef=eg.zpp_inner;if(ef._validate!=null){ef._validate()}if(eg.zpp_inner.x==ek){var ed=eg.zpp_inner;if(ed._validate!=null){ed._validate()}ea=eg.zpp_inner.y==ei}else{ea=false}if(!ea){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var eb=eg.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}eg.zpp_inner.weak=ec;return eg};r.prototype.get_x=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.x};r.prototype.set_x=function(ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}if(this.zpp_inner.x!=ea){this.zpp_inner.x=ea;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.x};r.prototype.get_y=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};r.prototype.set_y=function(ed){var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}if(this.zpp_inner.y!=ed){this.zpp_inner.y=ed;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};r.prototype.get_length=function(){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.x;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var ee=ea*this.zpp_inner.x;var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=this.zpp_inner.y;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return Math.sqrt(ee+ec*this.zpp_inner.y)};r.prototype.set_length=function(eb){var ev=this.zpp_inner;if(ev._validate!=null){ev._validate()}var eC=this.zpp_inner.x;var eB=this.zpp_inner;if(eB._validate!=null){eB._validate()}var ep=eC*this.zpp_inner.x;var eA=this.zpp_inner;if(eA._validate!=null){eA._validate()}var em=this.zpp_inner.y;var ez=this.zpp_inner;if(ez._validate!=null){ez._validate()}var ee=eb/Math.sqrt(ep+em*this.zpp_inner.y);var ea=this;var ey=ea.zpp_inner;if(ey._validate!=null){ey._validate()}var ed=ea.zpp_inner.x*ee;var ex=ea.zpp_inner;if(ex._validate!=null){ex._validate()}if(ea.zpp_inner.x!=ed){ea.zpp_inner.x=ed;var ew=ea.zpp_inner;if(ew._invalidate!=null){ew._invalidate(ew)}}var et=ea.zpp_inner;if(et._validate!=null){et._validate()}var eg=this;var er=eg.zpp_inner;if(er._validate!=null){er._validate()}var ec=eg.zpp_inner.y*ee;var eo=eg.zpp_inner;if(eo._validate!=null){eo._validate()}if(eg.zpp_inner.y!=ec){eg.zpp_inner.y=ec;var eu=eg.zpp_inner;if(eu._invalidate!=null){eu._invalidate(eu)}}var es=eg.zpp_inner;if(es._validate!=null){es._validate()}var eq=this.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}var en=this.zpp_inner;if(en._validate!=null){en._validate()}var ek=this.zpp_inner.x;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ei=ek*this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ef=this.zpp_inner.y;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}return Math.sqrt(ei+ef*this.zpp_inner.y)};r.prototype.lsq=function(){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.x;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var ee=ea*this.zpp_inner.x;var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=this.zpp_inner.y;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return ee+ec*this.zpp_inner.y};r.prototype.set=function(ea){var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}var ej=ea.zpp_inner.x;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=ea.zpp_inner.y;var eb;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(this.zpp_inner.x==ej){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}eb=this.zpp_inner.y==ei}else{eb=false}if(!eb){this.zpp_inner.x=ej;this.zpp_inner.y=ei;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var ef=this;if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return ef};r.prototype.setxy=function(ea,ef){var eb;var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}if(this.zpp_inner.x==ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}eb=this.zpp_inner.y==ef}else{eb=false}if(!eb){this.zpp_inner.x=ea;this.zpp_inner.y=ef;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}return this};r.prototype.get_angle=function(){var eb;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ef=this.zpp_inner.x;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(ef==this.zpp_inner.y){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}eb=this.zpp_inner.x==0}else{eb=false}if(eb){return 0}else{var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=this.zpp_inner.y;var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return Math.atan2(ec,this.zpp_inner.x)}};r.prototype.set_angle=function(ev){var eo=this.zpp_inner;if(eo._validate!=null){eo._validate()}var ew=this.zpp_inner.x;var eu=this.zpp_inner;if(eu._validate!=null){eu._validate()}var ei=ew*this.zpp_inner.x;var et=this.zpp_inner;if(et._validate!=null){et._validate()}var eg=this.zpp_inner.y;var es=this.zpp_inner;if(es._validate!=null){es._validate()}var em=Math.sqrt(ei+eg*this.zpp_inner.y);var eb=em*Math.cos(ev);var ea=em*Math.sin(ev);var ef;var er=this.zpp_inner;if(er._validate!=null){er._validate()}if(this.zpp_inner.x==eb){var eq=this.zpp_inner;if(eq._validate!=null){eq._validate()}ef=this.zpp_inner.y==ea}else{ef=false}if(!ef){this.zpp_inner.x=eb;this.zpp_inner.y=ea;var ep=this.zpp_inner;if(ep._invalidate!=null){ep._invalidate(ep)}}var ee;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ed=this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}if(ed==this.zpp_inner.y){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}ee=this.zpp_inner.x==0}else{ee=false}if(ee){return 0}else{var en=this.zpp_inner;if(en._validate!=null){en._validate()}var ec=this.zpp_inner.y;var ek=this.zpp_inner;if(ek._validate!=null){ek._validate()}return Math.atan2(ec,this.zpp_inner.x)}};r.prototype.rotate=function(ed){if(ed%(Math.PI*2)!=0){var ec=Math.sin(ed);var eb=Math.cos(ed);var ea=eb*this.zpp_inner.x-ec*this.zpp_inner.y;this.zpp_inner.y=this.zpp_inner.x*ec+this.zpp_inner.y*eb;this.zpp_inner.x=ea;var ee=this.zpp_inner;if(ee._invalidate!=null){ee._invalidate(ee)}}return this};r.prototype.reflect=function(ea,ed){if(ed==null){ed=false}var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var en=this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var el=this.zpp_inner.y;var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var em;if(bB.zpp_pool==null){em=new bB()}else{em=bB.zpp_pool;bB.zpp_pool=em.next;em.next=null}em.weak=false;em._immutable=false;em.x=en;em.y=el;ei.zpp_inner=em;ei.zpp_inner.outer=ei}else{var eb;var eh=ei.zpp_inner;if(eh._validate!=null){eh._validate()}if(ei.zpp_inner.x==en){var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}eb=ei.zpp_inner.y==el}else{eb=false}if(!eb){ei.zpp_inner.x=en;ei.zpp_inner.y=el;var ec=ei.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}ei.zpp_inner.weak=true;var eg=ei.normalise();var ek=ea.sub(eg.muleq(2*eg.dot(ea)),ed);if(ea.zpp_inner.weak){var eo=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eo.outer!=null){eo.outer.zpp_inner=null;eo.outer=null}eo._isimmutable=null;eo._validate=null;eo._invalidate=null;eo.next=bB.zpp_pool;bB.zpp_pool=eo}return ek};r.prototype.normalise=function(){var em=this.zpp_inner;if(em._validate!=null){em._validate()}var eu=this.zpp_inner.x;var et=this.zpp_inner;if(et._validate!=null){et._validate()}var eg=eu*this.zpp_inner.x;var es=this.zpp_inner;if(es._validate!=null){es._validate()}var ee=this.zpp_inner.y;var er=this.zpp_inner;if(er._validate!=null){er._validate()}var eq=1/Math.sqrt(eg+ee*this.zpp_inner.y);var ea=this;var ep=ea.zpp_inner;if(ep._validate!=null){ep._validate()}var ec=ea.zpp_inner.x*eq;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}if(ea.zpp_inner.x!=ec){ea.zpp_inner.x=ec;var en=ea.zpp_inner;if(en._invalidate!=null){en._invalidate(en)}}var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}var ed=this;var ei=ed.zpp_inner;if(ei._validate!=null){ei._validate()}var eb=ed.zpp_inner.y*eq;var ef=ed.zpp_inner;if(ef._validate!=null){ef._validate()}if(ed.zpp_inner.y!=eb){ed.zpp_inner.y=eb;var el=ed.zpp_inner;if(el._invalidate!=null){el._invalidate(el)}}var ej=ed.zpp_inner;if(ej._validate!=null){ej._validate()}var eh=this.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}return this};r.prototype.unit=function(eb){if(eb==null){eb=false}var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var eq=this.zpp_inner.x;var ep=this.zpp_inner;if(ep._validate!=null){ep._validate()}var eg=eq*this.zpp_inner.x;var eo=this.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=this.zpp_inner.y;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var es=1/Math.sqrt(eg+ef*this.zpp_inner.y);var em=this.zpp_inner;if(em._validate!=null){em._validate()}var ed=this.zpp_inner.x*es;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ec=this.zpp_inner.y*es;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ea;if(bB.zpp_pool==null){ea=new bB()}else{ea=bB.zpp_pool;bB.zpp_pool=ea.next;ea.next=null}ea.weak=false;ea._immutable=false;ea.x=ed;ea.y=ec;er.zpp_inner=ea;er.zpp_inner.outer=er}else{var ee;var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}if(er.zpp_inner.x==ed){var ei=er.zpp_inner;if(ei._validate!=null){ei._validate()}ee=er.zpp_inner.y==ec}else{ee=false}if(!ee){er.zpp_inner.x=ed;er.zpp_inner.y=ec;var eh=er.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}er.zpp_inner.weak=eb;return er};r.prototype.add=function(ea,ed){if(ed==null){ed=false}var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=this.zpp_inner.x;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=ep+ea.zpp_inner.x;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var eh=this.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var ee=eh+ea.zpp_inner.y;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ec;if(bB.zpp_pool==null){ec=new bB()}else{ec=bB.zpp_pool;bB.zpp_pool=ec.next;ec.next=null}ec.weak=false;ec._immutable=false;ec.x=ef;ec.y=ee;er.zpp_inner=ec;er.zpp_inner.outer=er}else{var eg;var el=er.zpp_inner;if(el._validate!=null){el._validate()}if(er.zpp_inner.x==ef){var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}eg=er.zpp_inner.y==ee}else{eg=false}if(!eg){er.zpp_inner.x=ef;er.zpp_inner.y=ee;var ej=er.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}}er.zpp_inner.weak=ed;var eb=er;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}return eb};r.prototype.addMul=function(ea,es,ed){if(ed==null){ed=false}var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=this.zpp_inner.x;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=ep+ea.zpp_inner.x*es;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var eh=this.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var ee=eh+ea.zpp_inner.y*es;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ec;if(bB.zpp_pool==null){ec=new bB()}else{ec=bB.zpp_pool;bB.zpp_pool=ec.next;ec.next=null}ec.weak=false;ec._immutable=false;ec.x=ef;ec.y=ee;er.zpp_inner=ec;er.zpp_inner.outer=er}else{var eg;var el=er.zpp_inner;if(el._validate!=null){el._validate()}if(er.zpp_inner.x==ef){var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}eg=er.zpp_inner.y==ee}else{eg=false}if(!eg){er.zpp_inner.x=ef;er.zpp_inner.y=ee;var ej=er.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}}er.zpp_inner.weak=ed;var eb=er;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}return eb};r.prototype.sub=function(ea,ed){if(ed==null){ed=false}var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=this.zpp_inner.x;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=ep-ea.zpp_inner.x;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var eh=this.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var ee=eh-ea.zpp_inner.y;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ec;if(bB.zpp_pool==null){ec=new bB()}else{ec=bB.zpp_pool;bB.zpp_pool=ec.next;ec.next=null}ec.weak=false;ec._immutable=false;ec.x=ef;ec.y=ee;er.zpp_inner=ec;er.zpp_inner.outer=er}else{var eg;var el=er.zpp_inner;if(el._validate!=null){el._validate()}if(er.zpp_inner.x==ef){var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}eg=er.zpp_inner.y==ee}else{eg=false}if(!eg){er.zpp_inner.x=ef;er.zpp_inner.y=ee;var ej=er.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}}er.zpp_inner.weak=ed;var eb=er;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}return eb};r.prototype.mul=function(ea,ed){if(ed==null){ed=false}var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var el=this.zpp_inner.x*ea;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ej=this.zpp_inner.y*ea;var eh;if(au.poolVec2==null){eh=new r()}else{eh=au.poolVec2;au.poolVec2=eh.zpp_pool;eh.zpp_pool=null}if(eh.zpp_inner==null){var ek;if(bB.zpp_pool==null){ek=new bB()}else{ek=bB.zpp_pool;bB.zpp_pool=ek.next;ek.next=null}ek.weak=false;ek._immutable=false;ek.x=el;ek.y=ej;eh.zpp_inner=ek;eh.zpp_inner.outer=eh}else{var eb;var eg=eh.zpp_inner;if(eg._validate!=null){eg._validate()}if(eh.zpp_inner.x==el){var ee=eh.zpp_inner;if(ee._validate!=null){ee._validate()}eb=eh.zpp_inner.y==ej}else{eb=false}if(!eb){eh.zpp_inner.x=el;eh.zpp_inner.y=ej;var ec=eh.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}eh.zpp_inner.weak=ed;return eh};r.prototype.addeq=function(ea){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}var em=ee+ea.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=ea.zpp_inner;if(ei._validate!=null){ei._validate()}var el=ec+ea.zpp_inner.y;var eb;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(this.zpp_inner.x==em){var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}eb=this.zpp_inner.y==el}else{eb=false}if(!eb){this.zpp_inner.x=em;this.zpp_inner.y=el;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}if(ea.zpp_inner.weak){var en=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en}return this};r.prototype.subeq=function(ea){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}var em=ee-ea.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=ea.zpp_inner;if(ei._validate!=null){ei._validate()}var el=ec-ea.zpp_inner.y;var eb;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(this.zpp_inner.x==em){var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}eb=this.zpp_inner.y==el}else{eb=false}if(!eb){this.zpp_inner.x=em;this.zpp_inner.y=el;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}if(ea.zpp_inner.weak){var en=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en}return this};r.prototype.muleq=function(ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ei=this.zpp_inner.x*ea;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var eh=this.zpp_inner.y*ea;var eb;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}if(this.zpp_inner.x==ei){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}eb=this.zpp_inner.y==eh}else{eb=false}if(!eb){this.zpp_inner.x=ei;this.zpp_inner.y=eh;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}return this};r.prototype.dot=function(ea){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=this.zpp_inner.x;var ei=ea.zpp_inner;if(ei._validate!=null){ei._validate()}var ec=ed*ea.zpp_inner.x;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var eb=this.zpp_inner.y;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}var eg=ec+eb*ea.zpp_inner.y;if(ea.zpp_inner.weak){var ej=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej}return eg};r.prototype.cross=function(ea){var ee=ea.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=ea.zpp_inner.y;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ec=ed*this.zpp_inner.x;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var eb=ea.zpp_inner.x;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var eg=ec-eb*this.zpp_inner.y;if(ea.zpp_inner.weak){var ej=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej}return eg};r.prototype.perp=function(ec){if(ec==null){ec=false}var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ek=-this.zpp_inner.y;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=this.zpp_inner.x;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ea;var ef=eg.zpp_inner;if(ef._validate!=null){ef._validate()}if(eg.zpp_inner.x==ek){var ed=eg.zpp_inner;if(ed._validate!=null){ed._validate()}ea=eg.zpp_inner.y==ei}else{ea=false}if(!ea){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var eb=eg.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}eg.zpp_inner.weak=ec;return eg};r.prototype.toString=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.toString()};Object.defineProperty(r.prototype,"x",{get:r.prototype.get_x,set:r.prototype.set_x});Object.defineProperty(r.prototype,"y",{get:r.prototype.get_y,set:r.prototype.set_y});Object.defineProperty(r.prototype,"length",{get:r.prototype.get_length,set:r.prototype.set_length});Object.defineProperty(r.prototype,"angle",{get:r.prototype.get_angle,set:r.prototype.set_angle});r.prototype.__class__=r;var dW=nape.geom.Vec2Iterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};dW.__name__=["nape","geom","Vec2Iterator"];dW.get=function(ec){var ea;if(dW.zpp_pool==null){bF.internal=true;var ed=new dW();bF.internal=false;ea=ed}else{var eb=dW.zpp_pool;dW.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};dW.prototype.zpp_inner=null;dW.prototype.zpp_i=null;dW.prototype.zpp_critical=null;dW.prototype.zpp_next=null;dW.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var ea=this.zpp_inner.zpp_gl();this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=dW.zpp_pool;dW.zpp_pool=this;this.zpp_inner=null;return false}};dW.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};dW.prototype.__class__=dW;var aN=nape.geom.Vec2List=function(){this.zpp_inner=null;this.zpp_inner=new bF();this.zpp_inner.outer=this};aN.__name__=["nape","geom","Vec2List"];aN.fromArray=function(ed){var ea=new aN();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};aN.prototype.zpp_inner=null;aN.prototype.get_length=function(){return this.zpp_gl()};aN.prototype.zpp_gl=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};aN.prototype.zpp_vm=function(){this.zpp_inner.valmod()};aN.prototype.has=function(ea){this.zpp_vm();return this.zpp_inner.inner.has(ea.zpp_inner)};aN.prototype.at=function(ea){this.zpp_vm();if(this.zpp_inner.reverse_flag){ea=this.zpp_gl()-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}var ec=this.zpp_inner.at_ite.elt;if(ec.outer==null){ec.outer=new r();var eb=ec.outer.zpp_inner;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ec.outer.zpp_inner=ec}return ec.outer};aN.prototype.push=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(eb.zpp_inner)}else{if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};aN.prototype.unshift=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}else{this.zpp_inner.inner.add(eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};aN.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;if(eb.outer==null){eb.outer=new r();var eg=eb.outer.zpp_inner;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg;eb.outer.zpp_inner=eb}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ee=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ee==null){eb=this.zpp_inner.inner.head.elt}else{eb=ee.next.elt}if(eb.outer==null){eb.outer=new r();var ed=eb.outer.zpp_inner;if(ed.outer!=null){ed.outer.zpp_inner=null;ed.outer=null}ed._isimmutable=null;ed._validate=null;ed._invalidate=null;ed.next=bB.zpp_pool;bB.zpp_pool=ed;eb.outer.zpp_inner=eb}var ef=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ef)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ee)}}this.zpp_inner.invalidate();if(eb.outer==null){eb.outer=new r();var ec=eb.outer.zpp_inner;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec;eb.outer.zpp_inner=eb}return eb.outer};aN.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ee=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ee==null){eb=this.zpp_inner.inner.head.elt}else{eb=ee.next.elt}if(eb.outer==null){eb.outer=new r();var eg=eb.outer.zpp_inner;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg;eb.outer.zpp_inner=eb}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ee)}}else{eb=this.zpp_inner.inner.head.elt;if(eb.outer==null){eb.outer=new r();var ed=eb.outer.zpp_inner;if(ed.outer!=null){ed.outer.zpp_inner=null;ed.outer=null}ed._isimmutable=null;ed._validate=null;ed._invalidate=null;ed.next=bB.zpp_pool;bB.zpp_pool=ed;eb.outer.zpp_inner=eb}var ef=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ef)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();if(eb.outer==null){eb.outer=new r();var ec=eb.outer.zpp_inner;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec;eb.outer.zpp_inner=eb}return eb.outer};aN.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};aN.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_vm();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};aN.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(!this.empty()){this.pop()}}else{while(!this.empty()){this.shift()}}};aN.prototype.empty=function(){return this.zpp_gl()==0};aN.prototype.iterator=function(){this.zpp_vm();return dW.get(this)};aN.prototype.copy=function(eq){if(eq==null){eq=false}var ek=new aN();var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ea=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ea){ed=true}else{ef.zpp_next=dW.zpp_pool;dW.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ee=ef.zpp_inner.at(ef.zpp_i++);var ec;if(eq){var ei=ee.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=ee.zpp_inner.x;var el=ee.zpp_inner;if(el._validate!=null){el._validate()}var eo=ee.zpp_inner.y;var en;if(au.poolVec2==null){en=new r()}else{en=au.poolVec2;au.poolVec2=en.zpp_pool;en.zpp_pool=null}if(en.zpp_inner==null){var em;if(bB.zpp_pool==null){em=new bB()}else{em=bB.zpp_pool;bB.zpp_pool=em.next;em.next=null}em.weak=false;em._immutable=false;em.x=ep;em.y=eo;en.zpp_inner=em;en.zpp_inner.outer=en}else{var eb;var ej=en.zpp_inner;if(ej._validate!=null){ej._validate()}if(en.zpp_inner.x==ep){var eh=en.zpp_inner;if(eh._validate!=null){eh._validate()}eb=en.zpp_inner.y==eo}else{eb=false}if(!eb){en.zpp_inner.x=ep;en.zpp_inner.y=eo;var eg=en.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}}en.zpp_inner.weak=false;ec=en}else{ec=ee}ek.push(ec)}return ek};aN.prototype.merge=function(eb){var ee=eb.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=dW.zpp_pool;dW.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){this.add(ea)}}};aN.prototype.toString=function(){var eb="[";var ea=true;var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ee=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=dW.zpp_pool;dW.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};aN.prototype.foreach=function(ea){var ec=this.iterator();while(true){ec.zpp_inner.zpp_inner.valmod();var ed=ec.zpp_inner.zpp_gl();ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=dW.zpp_pool;dW.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=dW.zpp_pool;dW.zpp_pool=ec;ec.zpp_inner=null;break}}return this};aN.prototype.filter=function(eb){var ec=0;while(ec<this.zpp_gl()){var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(aN.prototype,"length",{get:aN.prototype.get_length});aN.prototype.__class__=aN;var q=nape.geom.Vec3=function(ea,ef,ed){if(ed==null){ed=0}if(ef==null){ef=0}if(ea==null){ea=0}this.zpp_pool=null;this.zpp_inner=null;this.zpp_inner=new bA();this.zpp_inner.outer=this;this.zpp_inner.x=ea;var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.y=ef;var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.z=ed;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}};q.__name__=["nape","geom","Vec3"];q.get=function(ea,ed,ec){if(ec==null){ec=0}if(ed==null){ed=0}if(ea==null){ea=0}var eb;if(au.poolVec3==null){eb=new q()}else{eb=au.poolVec3;au.poolVec3=eb.zpp_pool;eb.zpp_pool=null}eb.setxyz(ea,ed,ec);eb.zpp_inner.immutable=false;eb.zpp_inner._validate=null;return eb};q.prototype.zpp_inner=null;q.prototype.zpp_pool=null;q.prototype.get_x=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.x};q.prototype.set_x=function(ea){this.zpp_inner.x=ea;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.x};q.prototype.get_y=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};q.prototype.set_y=function(eb){this.zpp_inner.y=eb;var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};q.prototype.get_z=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.z};q.prototype.set_z=function(ea){this.zpp_inner.z=ea;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.z};q.prototype.dispose=function(){var ea=this;ea.zpp_pool=au.poolVec3;au.poolVec3=ea};q.prototype.get_length=function(){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=this.zpp_inner;if(ek._validate!=null){ek._validate()}var ed=ee*this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var eb=ed+ec*this.zpp_inner.y;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.z;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}return Math.sqrt(eb+ea*this.zpp_inner.z)};q.prototype.set_length=function(eb){var ez=this.zpp_inner;if(ez._validate!=null){ez._validate()}var eG=this.zpp_inner.x;var eF=this.zpp_inner;if(eF._validate!=null){eF._validate()}var et=eG*this.zpp_inner.x;var eE=this.zpp_inner;if(eE._validate!=null){eE._validate()}var eq=this.zpp_inner.y;var eD=this.zpp_inner;if(eD._validate!=null){eD._validate()}var eo=et+eq*this.zpp_inner.y;var eC=this.zpp_inner;if(eC._validate!=null){eC._validate()}var em=this.zpp_inner.z;var eB=this.zpp_inner;if(eB._validate!=null){eB._validate()}var ef=eb/Math.sqrt(eo+em*this.zpp_inner.z);var ea=this;var eA=ea.zpp_inner;if(eA._validate!=null){eA._validate()}ea.zpp_inner.x=ea.zpp_inner.x*ef;var ex=ea.zpp_inner;if(ex._validate!=null){ex._validate()}var ek=this;var ev=ek.zpp_inner;if(ev._validate!=null){ev._validate()}ek.zpp_inner.y=ek.zpp_inner.y*ef;var es=ek.zpp_inner;if(es._validate!=null){es._validate()}var eh=this;var ey=eh.zpp_inner;if(ey._validate!=null){ey._validate()}eh.zpp_inner.z=eh.zpp_inner.z*ef;var ew=eh.zpp_inner;if(ew._validate!=null){ew._validate()}var eu=this.zpp_inner;if(eu._validate!=null){eu._validate()}var ej=this.zpp_inner.x;var er=this.zpp_inner;if(er._validate!=null){er._validate()}var eg=ej*this.zpp_inner.x;var ep=this.zpp_inner;if(ep._validate!=null){ep._validate()}var ee=this.zpp_inner.y;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var ed=eg+ee*this.zpp_inner.y;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ec=this.zpp_inner.z;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}return Math.sqrt(ed+ec*this.zpp_inner.z)};q.prototype.lsq=function(){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=this.zpp_inner;if(ek._validate!=null){ek._validate()}var ed=ee*this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var eb=ed+ec*this.zpp_inner.y;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.z;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}return eb+ea*this.zpp_inner.z};q.prototype.set=function(ea){var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}var eb=ea.zpp_inner.x;var ee=ea.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=ea.zpp_inner.y;var ec=ea.zpp_inner;if(ec._validate!=null){ec._validate()}return this.setxyz(eb,ed,ea.zpp_inner.z)};q.prototype.setxyz=function(ea,ef,ed){this.zpp_inner.x=ea;var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.y=ef;var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.z=ed;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this};q.prototype.xy=function(ec){if(ec==null){ec=false}var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ek=this.zpp_inner.x;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=this.zpp_inner.y;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ea;var ef=eg.zpp_inner;if(ef._validate!=null){ef._validate()}if(eg.zpp_inner.x==ek){var ed=eg.zpp_inner;if(ed._validate!=null){ed._validate()}ea=eg.zpp_inner.y==ei}else{ea=false}if(!ea){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var eb=eg.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}eg.zpp_inner.weak=ec;return eg};q.prototype.toString=function(){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ea="{ x: "+this.zpp_inner.x+" y: ";var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=ea+this.zpp_inner.y+" z: ";var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return ec+this.zpp_inner.z+" }"};Object.defineProperty(q.prototype,"x",{get:q.prototype.get_x,set:q.prototype.set_x});Object.defineProperty(q.prototype,"y",{get:q.prototype.get_y,set:q.prototype.set_y});Object.defineProperty(q.prototype,"z",{get:q.prototype.get_z,set:q.prototype.set_z});Object.defineProperty(q.prototype,"length",{get:q.prototype.get_length,set:q.prototype.set_length});q.prototype.__class__=q;var X=nape.geom.Winding=function(){};X.__name__=["nape","geom","Winding"];X.UNDEFINED=null;X.get_UNDEFINED=function(){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}return br.Winding_UNDEFINED};X.CLOCKWISE=null;X.get_CLOCKWISE=function(){if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}return br.Winding_CLOCKWISE};X.ANTICLOCKWISE=null;X.get_ANTICLOCKWISE=function(){if(br.Winding_ANTICLOCKWISE==null){br.internal=true;br.Winding_ANTICLOCKWISE=new X();br.internal=false}return br.Winding_ANTICLOCKWISE};X.prototype.toString=function(){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}if(this==br.Winding_UNDEFINED){return"UNDEFINED"}else{if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}if(this==br.Winding_CLOCKWISE){return"CLOCKWISE"}else{if(br.Winding_ANTICLOCKWISE==null){br.internal=true;br.Winding_ANTICLOCKWISE=new X();br.internal=false}if(this==br.Winding_ANTICLOCKWISE){return"ANTICLOCKWISE"}else{return""}}}};Object.defineProperty(X,"UNDEFINED",{get:X.get_UNDEFINED});Object.defineProperty(X,"CLOCKWISE",{get:X.get_CLOCKWISE});Object.defineProperty(X,"ANTICLOCKWISE",{get:X.get_ANTICLOCKWISE});X.prototype.__class__=X;var a6=nape.phys.Interactor=function(){this.zpp_inner_i=null};a6.__name__=["nape","phys","Interactor"];a6.prototype.zpp_inner_i=null;a6.prototype.get_id=function(){return this.zpp_inner_i.id};a6.prototype.get_userData=function(){if(this.zpp_inner_i.userData==null){this.zpp_inner_i.userData={}}return this.zpp_inner_i.userData};a6.prototype.isShape=function(){return this.zpp_inner_i.ishape!=null};a6.prototype.isBody=function(){return this.zpp_inner_i.ibody!=null};a6.prototype.isCompound=function(){return this.zpp_inner_i.icompound!=null};a6.prototype.get_castShape=function(){if(this.zpp_inner_i.ishape!=null){return this.zpp_inner_i.ishape.outer}else{return null}};a6.prototype.get_castBody=function(){if(this.zpp_inner_i.ibody!=null){return this.zpp_inner_i.ibody.outer}else{return null}};a6.prototype.get_castCompound=function(){if(this.zpp_inner_i.icompound!=null){return this.zpp_inner_i.icompound.outer}else{return null}};a6.prototype.get_group=function(){if(this.zpp_inner_i.group==null){return null}else{return this.zpp_inner_i.group.outer}};a6.prototype.set_group=function(ea){this.zpp_inner_i.immutable_midstep("Interactor::group");this.zpp_inner_i.setGroup(ea==null?null:ea.zpp_inner);if(this.zpp_inner_i.group==null){return null}else{return this.zpp_inner_i.group.outer}};a6.prototype.get_cbTypes=function(){if(this.zpp_inner_i.wrap_cbTypes==null){this.zpp_inner_i.setupcbTypes()}return this.zpp_inner_i.wrap_cbTypes};a6.prototype.toString=function(){return""};Object.defineProperty(a6.prototype,"id",{get:a6.prototype.get_id});Object.defineProperty(a6.prototype,"userData",{get:a6.prototype.get_userData});Object.defineProperty(a6.prototype,"castShape",{get:a6.prototype.get_castShape});Object.defineProperty(a6.prototype,"castBody",{get:a6.prototype.get_castBody});Object.defineProperty(a6.prototype,"castCompound",{get:a6.prototype.get_castCompound});Object.defineProperty(a6.prototype,"group",{get:a6.prototype.get_group,set:a6.prototype.set_group});Object.defineProperty(a6.prototype,"cbTypes",{get:a6.prototype.get_cbTypes});a6.prototype.__class__=a6;var at=nape.phys.Body=function(ee,ea){this.debugDraw=true;this.zpp_inner=null;a6.call(this);this.zpp_inner=new cj();this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;if(ea!=null){var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}this.zpp_inner.posx=ea.zpp_inner.x;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}this.zpp_inner.posy=ea.zpp_inner.y}else{this.zpp_inner.posx=0;this.zpp_inner.posy=0}var ec;if(ee==null){if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}ec=br.BodyType_DYNAMIC}else{ec=ee}this.zpp_inner.immutable_midstep("Body::type");if(cj.types[this.zpp_inner.type]!=ec){var ed;if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}if(ec==br.BodyType_DYNAMIC){ed=2}else{if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}if(ec==br.BodyType_KINEMATIC){ed=3}else{ed=1}}if(ed==1&&this.zpp_inner.space!=null){this.zpp_inner.velx=0;this.zpp_inner.vely=0;this.zpp_inner.angvel=0}this.zpp_inner.invalidate_type();if(this.zpp_inner.space!=null){this.zpp_inner.space.transmitType(this.zpp_inner,ed)}else{this.zpp_inner.type=ed}}if(ea!=null){if(ea.zpp_inner.weak){var eb=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}}this.zpp_inner_i.insert_cbtype(db.ANY_BODY.zpp_inner)};at.__name__=["nape","phys","Body"];at.__super__=a6;at.prototype=Object.create(a6.prototype);at.prototype.zpp_inner=null;at.prototype.debugDraw=null;at.prototype.get_type=function(){return cj.types[this.zpp_inner.type]};at.prototype.set_type=function(eb){this.zpp_inner.immutable_midstep("Body::type");if(cj.types[this.zpp_inner.type]!=eb){var ea;if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}if(eb==br.BodyType_DYNAMIC){ea=2}else{if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}if(eb==br.BodyType_KINEMATIC){ea=3}else{ea=1}}if(ea==1&&this.zpp_inner.space!=null){this.zpp_inner.velx=0;this.zpp_inner.vely=0;this.zpp_inner.angvel=0}this.zpp_inner.invalidate_type();if(this.zpp_inner.space!=null){this.zpp_inner.space.transmitType(this.zpp_inner,ea)}else{this.zpp_inner.type=ea}}return cj.types[this.zpp_inner.type]};at.prototype.get_isBullet=function(){return this.zpp_inner.bulletEnabled};at.prototype.set_isBullet=function(ea){this.zpp_inner.bulletEnabled=ea;return this.zpp_inner.bulletEnabled};at.prototype.get_disableCCD=function(){return this.zpp_inner.disableCCD};at.prototype.set_disableCCD=function(ea){this.zpp_inner.disableCCD=ea;return this.zpp_inner.disableCCD};at.prototype.integrate=function(eg){this.zpp_inner.immutable_midstep("Body::space");if(eg==0){return this}var ek=this.zpp_inner;ek.sweepTime=0;ek.sweep_angvel=ek.angvel;var ej=eg-ek.sweepTime;if(ej!=0){ek.sweepTime=eg;ek.posx+=ek.velx*ej;ek.posy+=ek.vely*ej;if(ek.angvel!=0){var ed=ek.sweep_angvel*ej;ek.rot+=ed;if(ed*ed>0.0001){ek.axisx=Math.sin(ek.rot);ek.axisy=Math.cos(ek.rot)}else{var ea=ed*ed;var eb=1-0.5*ea;var ee=1-ea*ea/8;var ef=(eb*ek.axisx+ed*ek.axisy)*ee;ek.axisy=(eb*ek.axisy-ed*ek.axisx)*ee;ek.axisx=ef}}}var ec=ek.shapes.head;while(ec!=null){var el=ec.elt;if(el.type==1){el.polygon.invalidate_gverts();el.polygon.invalidate_gaxi()}el.invalidate_worldCOM();ec=ec.next}ek.zip_worldCOM=true;ek.zip_axis=true;var eh=ek.shapes.head;while(eh!=null){var ei=eh.elt;if(ei.type==1){ei.polygon.invalidate_gverts();ei.polygon.invalidate_gaxi()}ei.invalidate_worldCOM();eh=eh.next}ek.zip_worldCOM=true;ek.sweepTime=0;return this};at.prototype.isStatic=function(){return this.zpp_inner.type==1};at.prototype.isDynamic=function(){return this.zpp_inner.type==2};at.prototype.isKinematic=function(){return this.zpp_inner.type==3};at.prototype.get_shapes=function(){return this.zpp_inner.wrap_shapes};at.prototype.get_compound=function(){if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};at.prototype.set_compound=function(ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=null){(this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_bodies;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};at.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};at.prototype.set_space=function(ea){this.zpp_inner.immutable_midstep("Body::space");if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.component.woken=false}if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){(this.zpp_inner.space==null?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_bodies;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};at.prototype.get_arbiters=function(){if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}return this.zpp_inner.wrap_arbiters};at.prototype.get_isSleeping=function(){return this.zpp_inner.component.sleeping};at.prototype.get_constraints=function(){if(this.zpp_inner.wrap_constraints==null){this.zpp_inner.wrap_constraints=aZ.get(this.zpp_inner.constraints,true)}return this.zpp_inner.wrap_constraints};at.prototype.copy=function(){return this.zpp_inner.copy()};at.prototype.get_position=function(){if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}return this.zpp_inner.wrap_pos};at.prototype.set_position=function(ec){if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var ee=this.zpp_inner.wrap_pos;var eh=ec.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ec.zpp_inner.x;var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ec.zpp_inner.y;var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==ei}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ec.zpp_inner.weak){var ek=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}return this.zpp_inner.wrap_pos};at.prototype.get_velocity=function(){if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}return this.zpp_inner.wrap_vel};at.prototype.set_velocity=function(ea){if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}var ee=this.zpp_inner.wrap_vel;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}return this.zpp_inner.wrap_vel};at.prototype.setVelocityFromTarget=function(ee,ec,el){var eq=1/el;if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}var ej=this.zpp_inner.wrap_vel;if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var ed=ee.sub(this.zpp_inner.wrap_pos,true).muleq(eq);var em=ed.zpp_inner;if(em._validate!=null){em._validate()}var eo=ed.zpp_inner.x;var ek=ed.zpp_inner;if(ek._validate!=null){ek._validate()}var en=ed.zpp_inner.y;var ef;var ei=ej.zpp_inner;if(ei._validate!=null){ei._validate()}if(ej.zpp_inner.x==eo){var eh=ej.zpp_inner;if(eh._validate!=null){eh._validate()}ef=ej.zpp_inner.y==en}else{ef=false}if(!ef){ej.zpp_inner.x=eo;ej.zpp_inner.y=en;var eg=ej.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}if(ed.zpp_inner.weak){var ep=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}var eb=(ec-this.zpp_inner.rot)*eq;if(this.zpp_inner.angvel!=eb){this.zpp_inner.angvel=eb;this.zpp_inner.wake()}if(ee.zpp_inner.weak){var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};at.prototype.get_kinematicVel=function(){if(this.zpp_inner.wrap_kinvel==null){this.zpp_inner.setupkinvel()}return this.zpp_inner.wrap_kinvel};at.prototype.set_kinematicVel=function(eh){if(this.zpp_inner.wrap_kinvel==null){this.zpp_inner.setupkinvel()}var ed=this.zpp_inner.wrap_kinvel;var eg=eh.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=eh.zpp_inner.x;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=eh.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==ei}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=ei;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(eh.zpp_inner.weak){var ek=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_kinvel==null){this.zpp_inner.setupkinvel()}return this.zpp_inner.wrap_kinvel};at.prototype.get_surfaceVel=function(){if(this.zpp_inner.wrap_svel==null){this.zpp_inner.setupsvel()}return this.zpp_inner.wrap_svel};at.prototype.set_surfaceVel=function(ed){if(this.zpp_inner.wrap_svel==null){this.zpp_inner.setupsvel()}var ee=this.zpp_inner.wrap_svel;var eh=ed.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ed.zpp_inner.x;var eg=ed.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ed.zpp_inner.y;var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ee.zpp_inner.y==ei}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ed.zpp_inner.weak){var ek=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_svel==null){this.zpp_inner.setupsvel()}return this.zpp_inner.wrap_svel};at.prototype.get_force=function(){if(this.zpp_inner.wrap_force==null){this.zpp_inner.setupForce()}return this.zpp_inner.wrap_force};at.prototype.set_force=function(ea){if(this.zpp_inner.wrap_force==null){this.zpp_inner.setupForce()}var ee=this.zpp_inner.wrap_force;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_force==null){this.zpp_inner.setupForce()}return this.zpp_inner.wrap_force};at.prototype.get_constraintVelocity=function(){if(this.zpp_inner.wrapcvel==null){this.zpp_inner.setup_cvel()}return this.zpp_inner.wrapcvel};at.prototype.get_rotation=function(){return this.zpp_inner.rot};at.prototype.set_rotation=function(eb){this.zpp_inner.immutable_midstep("Body::rotation");if(this.zpp_inner.rot!=eb){this.zpp_inner.rot=eb;var ed=this.zpp_inner;ed.zip_axis=true;var ea=ed.shapes.head;while(ea!=null){var ec=ea.elt;if(ec.type==1){ec.polygon.invalidate_gverts();ec.polygon.invalidate_gaxi()}ec.invalidate_worldCOM();ea=ea.next}ed.zip_worldCOM=true;this.zpp_inner.wake()}return this.zpp_inner.rot};at.prototype.get_angularVel=function(){return this.zpp_inner.angvel};at.prototype.set_angularVel=function(ea){if(this.zpp_inner.angvel!=ea){this.zpp_inner.angvel=ea;this.zpp_inner.wake()}return this.zpp_inner.angvel};at.prototype.get_kinAngVel=function(){return this.zpp_inner.kinangvel};at.prototype.set_kinAngVel=function(ea){if(this.zpp_inner.kinangvel!=ea){this.zpp_inner.kinangvel=ea;this.zpp_inner.wake()}return this.zpp_inner.kinangvel};at.prototype.get_torque=function(){return this.zpp_inner.torque};at.prototype.set_torque=function(ea){if(this.zpp_inner.torque!=ea){this.zpp_inner.torque=ea;this.zpp_inner.wake()}return this.zpp_inner.torque};at.prototype.get_bounds=function(){return this.zpp_inner.aabb.wrapper()};at.prototype.get_allowMovement=function(){return !this.zpp_inner.nomove};at.prototype.set_allowMovement=function(ea){this.zpp_inner.immutable_midstep("Body::"+(ea==null?"null":""+ea));if(!this.zpp_inner.nomove!=ea){this.zpp_inner.nomove=!ea;this.zpp_inner.invalidate_mass()}return !this.zpp_inner.nomove};at.prototype.get_allowRotation=function(){return !this.zpp_inner.norotate};at.prototype.set_allowRotation=function(ea){this.zpp_inner.immutable_midstep("Body::"+(ea==null?"null":""+ea));if(!this.zpp_inner.norotate!=ea){this.zpp_inner.norotate=!ea;this.zpp_inner.invalidate_inertia()}return !this.zpp_inner.norotate};at.prototype.get_massMode=function(){if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}var ea=br.MassMode_DEFAULT;if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}return[ea,br.MassMode_FIXED][this.zpp_inner.massMode]};at.prototype.set_massMode=function(ea){this.zpp_inner.immutable_midstep("Body::massMode");var eb;if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}if(ea==br.MassMode_DEFAULT){eb=0}else{eb=1}this.zpp_inner.massMode=eb;this.zpp_inner.invalidate_mass();if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}var ec=br.MassMode_DEFAULT;if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}return[ec,br.MassMode_FIXED][this.zpp_inner.massMode]};at.prototype.get_constraintMass=function(){if(!this.zpp_inner.world){this.zpp_inner.validate_mass()}return this.zpp_inner.smass};at.prototype.get_mass=function(){this.zpp_inner.validate_mass();return this.zpp_inner.cmass};at.prototype.set_mass=function(ea){this.zpp_inner.immutable_midstep("Body::mass");this.zpp_inner.massMode=1;this.zpp_inner.cmass=ea;this.zpp_inner.invalidate_mass();this.zpp_inner.validate_mass();return this.zpp_inner.cmass};at.prototype.get_gravMassMode=function(){if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}var ea=br.GravMassMode_DEFAULT;if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}var eb=br.GravMassMode_FIXED;if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}return[ea,eb,br.GravMassMode_SCALED][this.zpp_inner.massMode]};at.prototype.set_gravMassMode=function(ea){this.zpp_inner.immutable_midstep("Body::gravMassMode");var eb;if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}if(ea==br.GravMassMode_SCALED){eb=2}else{if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}if(ea==br.GravMassMode_DEFAULT){eb=0}else{eb=1}}this.zpp_inner.gravMassMode=eb;this.zpp_inner.invalidate_gravMass();if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}var ed=br.GravMassMode_DEFAULT;if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}var ec=br.GravMassMode_FIXED;if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}return[ed,ec,br.GravMassMode_SCALED][this.zpp_inner.massMode]};at.prototype.get_gravMass=function(){this.zpp_inner.validate_gravMass();return this.zpp_inner.gravMass};at.prototype.set_gravMass=function(ea){this.zpp_inner.immutable_midstep("Body::gravMass");this.zpp_inner.gravMassMode=1;this.zpp_inner.gravMass=ea;this.zpp_inner.invalidate_gravMass();this.zpp_inner.validate_gravMass();return this.zpp_inner.gravMass};at.prototype.get_gravMassScale=function(){this.zpp_inner.validate_gravMassScale();return this.zpp_inner.gravMassScale};at.prototype.set_gravMassScale=function(ea){this.zpp_inner.immutable_midstep("Body::gravMassScale");this.zpp_inner.gravMassMode=2;this.zpp_inner.gravMassScale=ea;this.zpp_inner.invalidate_gravMassScale();this.zpp_inner.validate_gravMassScale();return this.zpp_inner.gravMassScale};at.prototype.get_inertiaMode=function(){if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}var ea=br.InertiaMode_DEFAULT;if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}return[ea,br.InertiaMode_FIXED][this.zpp_inner.inertiaMode]};at.prototype.set_inertiaMode=function(ec){this.zpp_inner.immutable_midstep("Body::inertiaMode");var ea;if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}if(ec==br.InertiaMode_FIXED){ea=1}else{ea=0}this.zpp_inner.inertiaMode=ea;this.zpp_inner.invalidate_inertia();if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}var eb=br.InertiaMode_DEFAULT;if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}return[eb,br.InertiaMode_FIXED][this.zpp_inner.inertiaMode]};at.prototype.get_constraintInertia=function(){if(!this.zpp_inner.world){this.zpp_inner.validate_inertia()}return this.zpp_inner.sinertia};at.prototype.get_inertia=function(){this.zpp_inner.validate_inertia();return this.zpp_inner.cinertia};at.prototype.set_inertia=function(ea){this.zpp_inner.immutable_midstep("Body::inertia");this.zpp_inner.inertiaMode=1;this.zpp_inner.cinertia=ea;this.zpp_inner.invalidate_inertia();this.zpp_inner.validate_inertia();return this.zpp_inner.cinertia};at.prototype.connectedBodies=function(eb,ea){if(eb==null){eb=-1}return this.zpp_inner.connectedBodies(eb,ea)};at.prototype.interactingBodies=function(eb,ed,ea){if(ed==null){ed=-1}var ec;if(eb==null){ec=j.COL|j.SENSOR|j.FLUID}else{if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(eb==br.InteractionType_COLLISION){ec=j.COL}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(eb==br.InteractionType_SENSOR){ec=j.SENSOR}else{ec=j.FLUID}}}return this.zpp_inner.interactingBodies(ec,ed,ea)};at.prototype.crushFactor=function(){var ec=0;var ek;if(au.poolVec2==null){ek=new r()}else{ek=au.poolVec2;au.poolVec2=ek.zpp_pool;ek.zpp_pool=null}if(ek.zpp_inner==null){var es;if(bB.zpp_pool==null){es=new bB()}else{es=bB.zpp_pool;bB.zpp_pool=es.next;es.next=null}es.weak=false;es._immutable=false;es.x=0;es.y=0;ek.zpp_inner=es;ek.zpp_inner.outer=ek}else{var ey;var eb=ek.zpp_inner;if(eb._validate!=null){eb._validate()}if(ek.zpp_inner.x==0){var ew=ek.zpp_inner;if(ew._validate!=null){ew._validate()}ey=ek.zpp_inner.y==0}else{ey=false}if(!ey){ek.zpp_inner.x=0;ek.zpp_inner.y=0;var ev=ek.zpp_inner;if(ev._invalidate!=null){ev._invalidate(ev)}}}ek.zpp_inner.weak=false;var eE=ek;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var eQ=this.zpp_inner.wrap_arbiters.iterator();while(true){eQ.zpp_inner.zpp_inner.valmod();var ed=eQ.zpp_inner.zpp_gl();eQ.zpp_critical=true;var eT;if(eQ.zpp_i<ed){eT=true}else{eQ.zpp_next=d0.zpp_pool;d0.zpp_pool=eQ;eQ.zpp_inner=null;eT=false}if(!eT){break}eQ.zpp_critical=false;var ee=eQ.zpp_inner.at(eQ.zpp_i++).totalImpulse(this);var ea=ee.xy();eE.addeq(ea);var eu=ea.zpp_inner;if(eu._validate!=null){eu._validate()}var eS=ea.zpp_inner.x;var et=ea.zpp_inner;if(et._validate!=null){et._validate()}var eP=eS*ea.zpp_inner.x;var er=ea.zpp_inner;if(er._validate!=null){er._validate()}var eN=ea.zpp_inner.y;var eq=ea.zpp_inner;if(eq._validate!=null){eq._validate()}ec+=Math.sqrt(eP+eN*ea.zpp_inner.y);var ei=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ei.outer!=null){ei.outer.zpp_inner=null;ei.outer=null}ei._isimmutable=null;ei._validate=null;ei._invalidate=null;ei.next=bB.zpp_pool;bB.zpp_pool=ei;ee.dispose()}if(this.zpp_inner.wrap_constraints==null){this.zpp_inner.wrap_constraints=aZ.get(this.zpp_inner.constraints,true)}var eo=this.zpp_inner.wrap_constraints;eo.zpp_inner.valmod();var eF=bO.get(eo);while(true){eF.zpp_inner.zpp_inner.valmod();var em=eF.zpp_inner;em.zpp_inner.valmod();if(em.zpp_inner.zip_length){em.zpp_inner.zip_length=false;em.zpp_inner.user_length=em.zpp_inner.inner.length}var en=em.zpp_inner.user_length;eF.zpp_critical=true;var eL;if(eF.zpp_i<en){eL=true}else{eF.zpp_next=bO.zpp_pool;bO.zpp_pool=eF;eF.zpp_inner=null;eL=false}if(!eL){break}eF.zpp_critical=false;var eJ=eF.zpp_inner.at(eF.zpp_i++).bodyImpulse(this);var ef=eJ.xy();eE.addeq(ef);var el=ef.zpp_inner;if(el._validate!=null){el._validate()}var eI=ef.zpp_inner.x;var eR=ef.zpp_inner;if(eR._validate!=null){eR._validate()}var eG=eI*ef.zpp_inner.x;var eO=ef.zpp_inner;if(eO._validate!=null){eO._validate()}var eC=ef.zpp_inner.y;var eM=ef.zpp_inner;if(eM._validate!=null){eM._validate()}ec+=Math.sqrt(eG+eC*ef.zpp_inner.y);var ez=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez;eJ.dispose()}var eK=eE.zpp_inner;if(eK._validate!=null){eK._validate()}var eA=eE.zpp_inner.x;var eH=eE.zpp_inner;if(eH._validate!=null){eH._validate()}var ej=eA*eE.zpp_inner.x;var eD=eE.zpp_inner;if(eD._validate!=null){eD._validate()}var eh=eE.zpp_inner.y;var eB=eE.zpp_inner;if(eB._validate!=null){eB._validate()}var eg=ec-Math.sqrt(ej+eh*eE.zpp_inner.y);this.zpp_inner.validate_mass();var ep=eg/(this.zpp_inner.cmass*(this.zpp_inner.space==null?null:this.zpp_inner.space.outer).zpp_inner.pre_dt);var ex=eE.zpp_inner;eE.zpp_inner.outer=null;eE.zpp_inner=null;eE.zpp_pool=au.poolVec2;au.poolVec2=eE;if(ex.outer!=null){ex.outer.zpp_inner=null;ex.outer=null}ex._isimmutable=null;ex._validate=null;ex._invalidate=null;ex.next=bB.zpp_pool;bB.zpp_pool=ex;return ep};at.prototype.localPointToWorld=function(ej,eb){if(eb==null){eb=false}var el=this.zpp_inner;if(el.zip_axis){el.zip_axis=false;el.axisx=Math.sin(el.rot);el.axisy=Math.cos(el.rot)}var ef=0;var ee=0;var eq=ej.zpp_inner;if(eq._validate!=null){eq._validate()}var er=this.zpp_inner.axisy*ej.zpp_inner.x;var ep=ej.zpp_inner;if(ep._validate!=null){ep._validate()}ef=er-this.zpp_inner.axisx*ej.zpp_inner.y;var eo=ej.zpp_inner;if(eo._validate!=null){eo._validate()}var eh=ej.zpp_inner.x*this.zpp_inner.axisx;var en=ej.zpp_inner;if(en._validate!=null){en._validate()}ee=eh+ej.zpp_inner.y*this.zpp_inner.axisy;if(ej.zpp_inner.weak){var es=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(es.outer!=null){es.outer.zpp_inner=null;es.outer=null}es._isimmutable=null;es._validate=null;es._invalidate=null;es.next=bB.zpp_pool;bB.zpp_pool=es}var ed=ef+this.zpp_inner.posx;var ec=ee+this.zpp_inner.posy;var et;if(au.poolVec2==null){et=new r()}else{et=au.poolVec2;au.poolVec2=et.zpp_pool;et.zpp_pool=null}if(et.zpp_inner==null){var ea;if(bB.zpp_pool==null){ea=new bB()}else{ea=bB.zpp_pool;bB.zpp_pool=ea.next;ea.next=null}ea.weak=false;ea._immutable=false;ea.x=ed;ea.y=ec;et.zpp_inner=ea;et.zpp_inner.outer=et}else{var eg;var em=et.zpp_inner;if(em._validate!=null){em._validate()}if(et.zpp_inner.x==ed){var ek=et.zpp_inner;if(ek._validate!=null){ek._validate()}eg=et.zpp_inner.y==ec}else{eg=false}if(!eg){et.zpp_inner.x=ed;et.zpp_inner.y=ec;var ei=et.zpp_inner;if(ei._invalidate!=null){ei._invalidate(ei)}}}et.zpp_inner.weak=eb;return et};at.prototype.worldPointToLocal=function(eo,ef){if(ef==null){ef=false}var eh=this.zpp_inner;if(eh.zip_axis){eh.zip_axis=false;eh.axisx=Math.sin(eh.rot);eh.axisy=Math.cos(eh.rot)}var eb=0;var ea=0;var em=0;var ek=0;var el=eo.zpp_inner;if(el._validate!=null){el._validate()}em=eo.zpp_inner.x-this.zpp_inner.posx;var ej=eo.zpp_inner;if(ej._validate!=null){ej._validate()}ek=eo.zpp_inner.y-this.zpp_inner.posy;eb=em*this.zpp_inner.axisy+ek*this.zpp_inner.axisx;ea=ek*this.zpp_inner.axisy-em*this.zpp_inner.axisx;if(eo.zpp_inner.weak){var ep=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var en;if(bB.zpp_pool==null){en=new bB()}else{en=bB.zpp_pool;bB.zpp_pool=en.next;en.next=null}en.weak=false;en._immutable=false;en.x=eb;en.y=ea;ei.zpp_inner=en;ei.zpp_inner.outer=ei}else{var ec;var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}if(ei.zpp_inner.x==eb){var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}ec=ei.zpp_inner.y==ea}else{ec=false}if(!ec){ei.zpp_inner.x=eb;ei.zpp_inner.y=ea;var ed=ei.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ei.zpp_inner.weak=ef;return ei};at.prototype.localVectorToWorld=function(ea,ec){if(ec==null){ec=false}var ei=this.zpp_inner;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var ee=0;var ed=0;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ep=this.zpp_inner.axisy*ea.zpp_inner.x;var en=ea.zpp_inner;if(en._validate!=null){en._validate()}ee=ep-this.zpp_inner.axisx*ea.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var eg=ea.zpp_inner.x*this.zpp_inner.axisx;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ed=eg+ea.zpp_inner.y*this.zpp_inner.axisy;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ee;eb.y=ed;er.zpp_inner=eb;er.zpp_inner.outer=er}else{var ef;var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}if(er.zpp_inner.x==ee){var ej=er.zpp_inner;if(ej._validate!=null){ej._validate()}ef=er.zpp_inner.y==ed}else{ef=false}if(!ef){er.zpp_inner.x=ee;er.zpp_inner.y=ed;var eh=er.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}er.zpp_inner.weak=ec;return er};at.prototype.worldVectorToLocal=function(ea,ec){if(ec==null){ec=false}var ei=this.zpp_inner;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var ee=0;var ed=0;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ep=ea.zpp_inner.x*this.zpp_inner.axisy;var en=ea.zpp_inner;if(en._validate!=null){en._validate()}ee=ep+ea.zpp_inner.y*this.zpp_inner.axisx;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var eg=ea.zpp_inner.y*this.zpp_inner.axisy;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ed=eg-ea.zpp_inner.x*this.zpp_inner.axisx;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ee;eb.y=ed;er.zpp_inner=eb;er.zpp_inner.outer=er}else{var ef;var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}if(er.zpp_inner.x==ee){var ej=er.zpp_inner;if(ej._validate!=null){ej._validate()}ef=er.zpp_inner.y==ed}else{ef=false}if(!ef){er.zpp_inner.x=ee;er.zpp_inner.y=ed;var eh=er.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}er.zpp_inner.weak=ec;return er};at.prototype.applyImpulse=function(ee,eo,eg){if(eg==null){eg=false}if(eg&&this.zpp_inner.component.sleeping){if(ee.zpp_inner.weak){var eq=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}if(eo!=null){if(eo.zpp_inner.weak){var ef=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(ef.outer!=null){ef.outer.zpp_inner=null;ef.outer=null}ef._isimmutable=null;ef._validate=null;ef._invalidate=null;ef.next=bB.zpp_pool;bB.zpp_pool=ef}}return this}this.zpp_inner.validate_mass();var ep=this.zpp_inner.imass;var el=ee.zpp_inner;if(el._validate!=null){el._validate()}this.zpp_inner.velx+=ee.zpp_inner.x*ep;var en=ee.zpp_inner;if(en._validate!=null){en._validate()}this.zpp_inner.vely+=ee.zpp_inner.y*ep;if(eo!=null){var ed=0;var ec=0;var em=eo.zpp_inner;if(em._validate!=null){em._validate()}ed=eo.zpp_inner.x-this.zpp_inner.posx;var ek=eo.zpp_inner;if(ek._validate!=null){ek._validate()}ec=eo.zpp_inner.y-this.zpp_inner.posy;this.zpp_inner.validate_inertia();var ej=ee.zpp_inner;if(ej._validate!=null){ej._validate()}var eh=ee.zpp_inner.y*ed;var ei=ee.zpp_inner;if(ei._validate!=null){ei._validate()}this.zpp_inner.angvel+=(eh-ee.zpp_inner.x*ec)*this.zpp_inner.iinertia;if(eo.zpp_inner.weak){var eb=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}}if(!eg){if(this.zpp_inner.type==2){this.zpp_inner.wake()}}if(ee.zpp_inner.weak){var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};at.prototype.applyAngularImpulse=function(eb,ea){if(ea==null){ea=false}if(ea&&this.zpp_inner.component.sleeping){return this}this.zpp_inner.validate_inertia();this.zpp_inner.angvel+=eb*this.zpp_inner.iinertia;if(!ea){if(this.zpp_inner.type==2){this.zpp_inner.wake()}}return this};at.prototype.translateShapes=function(ed){this.zpp_inner.immutable_midstep("Body::translateShapes()");var ec=ed.zpp_inner.weak;ed.zpp_inner.weak=false;var eb=this.zpp_inner.shapes.head;while(eb!=null){eb.elt.outer.translate(ed);eb=eb.next}ed.zpp_inner.weak=ec;if(ed.zpp_inner.weak){var ea=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};at.prototype.rotateShapes=function(eb){this.zpp_inner.immutable_midstep("Body::rotateShapes()");var ea=this.zpp_inner.shapes.head;while(ea!=null){ea.elt.outer.rotate(eb);ea=ea.next}return this};at.prototype.scaleShapes=function(eb,ea){this.zpp_inner.immutable_midstep("Body::scaleShapes()");var ec=this.zpp_inner.shapes.head;while(ec!=null){ec.elt.outer.scale(eb,ea);ec=ec.next}return this};at.prototype.transformShapes=function(ea){this.zpp_inner.immutable_midstep("Body::transformShapes()");var eb=this.zpp_inner.shapes.head;while(eb!=null){eb.elt.outer.transform(ea);eb=eb.next}return this};at.prototype.align=function(){this.zpp_inner.immutable_midstep("Body::align()");this.zpp_inner.validate_localCOM();var ek=-this.zpp_inner.localCOMx;var ei=-this.zpp_inner.localCOMy;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var eb;var ee=eg.zpp_inner;if(ee._validate!=null){ee._validate()}if(eg.zpp_inner.x==ek){var eh=eg.zpp_inner;if(eh._validate!=null){eh._validate()}eb=eg.zpp_inner.y==ei}else{eb=false}if(!eb){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var ef=eg.zpp_inner;if(ef._invalidate!=null){ef._invalidate(ef)}}}eg.zpp_inner.weak=false;var en=eg;this.translateShapes(en);var el=this.localVectorToWorld(en);if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}this.zpp_inner.wrap_pos.subeq(el);if(this.zpp_inner.pre_posx<Infinity){var ed=el.zpp_inner;if(ed._validate!=null){ed._validate()}this.zpp_inner.pre_posx-=el.zpp_inner.x;var ec=el.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.pre_posy-=el.zpp_inner.y}var em=en.zpp_inner;en.zpp_inner.outer=null;en.zpp_inner=null;en.zpp_pool=au.poolVec2;au.poolVec2=en;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em;var ea=el.zpp_inner;el.zpp_inner.outer=null;el.zpp_inner=null;el.zpp_pool=au.poolVec2;au.poolVec2=el;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;return this};at.prototype.rotate=function(eg,es){var eb=eg.zpp_inner.weak;eg.zpp_inner.weak=false;if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var ec=this.zpp_inner.wrap_pos.sub(eg);ec.rotate(es);var ev=eg.add(ec,true);if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var el=this.zpp_inner.wrap_pos;var er=ev.zpp_inner;if(er._validate!=null){er._validate()}var ee=ev.zpp_inner.x;var eq=ev.zpp_inner;if(eq._validate!=null){eq._validate()}var ed=ev.zpp_inner.y;var et;var ep=el.zpp_inner;if(ep._validate!=null){ep._validate()}if(el.zpp_inner.x==ee){var eo=el.zpp_inner;if(eo._validate!=null){eo._validate()}et=el.zpp_inner.y==ed}else{et=false}if(!et){el.zpp_inner.x=ee;el.zpp_inner.y=ed;var em=el.zpp_inner;if(em._invalidate!=null){em._invalidate(em)}}if(ev.zpp_inner.weak){var eu=ev.zpp_inner;ev.zpp_inner.outer=null;ev.zpp_inner=null;ev.zpp_pool=au.poolVec2;au.poolVec2=ev;if(eu.outer!=null){eu.outer.zpp_inner=null;eu.outer=null}eu._isimmutable=null;eu._validate=null;eu._invalidate=null;eu.next=bB.zpp_pool;bB.zpp_pool=eu}if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var en=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en;var ea=this;var ei=ea.zpp_inner.rot+es;ea.zpp_inner.immutable_midstep("Body::rotation");if(ea.zpp_inner.rot!=ei){ea.zpp_inner.rot=ei;var ek=ea.zpp_inner;ek.zip_axis=true;var eh=ek.shapes.head;while(eh!=null){var ef=eh.elt;if(ef.type==1){ef.polygon.invalidate_gverts();ef.polygon.invalidate_gaxi()}ef.invalidate_worldCOM();eh=eh.next}ek.zip_worldCOM=true;ea.zpp_inner.wake()}eg.zpp_inner.weak=eb;if(eg.zpp_inner.weak){var ej=eg.zpp_inner;eg.zpp_inner.outer=null;eg.zpp_inner=null;eg.zpp_pool=au.poolVec2;au.poolVec2=eg;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej}return this};at.prototype.setShapeMaterials=function(eb){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");var ea=this.zpp_inner.shapes.head;while(ea!=null){var ec=ea.elt.outer;ec.zpp_inner.immutable_midstep("Shape::material");ec.zpp_inner.setMaterial(eb.zpp_inner);ec.zpp_inner.material.wrapper();ea=ea.next}return this};at.prototype.setShapeFilters=function(eb){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");var ea=this.zpp_inner.shapes.head;while(ea!=null){var ec=ea.elt.outer;ec.zpp_inner.immutable_midstep("Shape::filter");ec.zpp_inner.setFilter(eb.zpp_inner);ec.zpp_inner.filter.wrapper();ea=ea.next}return this};at.prototype.setShapeFluidProperties=function(ea){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");var eb=this.zpp_inner.shapes.head;while(eb!=null){var ec=eb.elt.outer;ec.zpp_inner.setFluid(ea.zpp_inner);ec.zpp_inner.immutable_midstep("Shape::fluidProperties");if(ec.zpp_inner.fluidProperties==null){ec.zpp_inner.setFluid(new aM().zpp_inner)}ec.zpp_inner.fluidProperties.wrapper();eb=eb.next}return this};at.prototype.get_localCOM=function(){if(this.zpp_inner.wrap_localCOM==null){var ea=this.zpp_inner.localCOMx;var eh=this.zpp_inner.localCOMy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.zpp_inner.wrap_localCOM=eb;this.zpp_inner.wrap_localCOM.zpp_inner._inuse=true;this.zpp_inner.wrap_localCOM.zpp_inner._immutable=true;this.zpp_inner.wrap_localCOM.zpp_inner._validate=(bo=this.zpp_inner,dX(bo,bo.getlocalCOM))}return this.zpp_inner.wrap_localCOM};at.prototype.get_worldCOM=function(){if(this.zpp_inner.wrap_worldCOM==null){var ea=this.zpp_inner.worldCOMx;var eh=this.zpp_inner.worldCOMy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.zpp_inner.wrap_worldCOM=eb;this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=true;this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=true;this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(bo=this.zpp_inner,dX(bo,bo.getworldCOM))}return this.zpp_inner.wrap_worldCOM};at.prototype.normalImpulse=function(eg,eb){if(eb==null){eb=false}var en=0;var el=0;var ej=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ef=this.zpp_inner.wrap_arbiters.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ed=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ee;if(ef.zpp_i<ed){ee=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++).zpp_inner;if(ec.type!=j.COL){continue}if(eg!=null&&ec.b2!=eg.zpp_inner&&ec.b1!=eg.zpp_inner){continue}var ei=ec.wrapper();var ea=(ei.zpp_inner.type==j.COL?ei.zpp_inner.colarb.outer_zn:null).normalImpulse(this,eb);var em=ea.zpp_inner;if(em._validate!=null){em._validate()}en+=ea.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}el+=ea.zpp_inner.y;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}ej+=ea.zpp_inner.z;ea.dispose()}return q.get(en,el,ej)};at.prototype.tangentImpulse=function(eg,eb){if(eb==null){eb=false}var en=0;var el=0;var ej=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ef=this.zpp_inner.wrap_arbiters.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ed=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ee;if(ef.zpp_i<ed){ee=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++).zpp_inner;if(ec.type!=j.COL){continue}if(eg!=null&&ec.b2!=eg.zpp_inner&&ec.b1!=eg.zpp_inner){continue}var ei=ec.wrapper();var ea=(ei.zpp_inner.type==j.COL?ei.zpp_inner.colarb.outer_zn:null).tangentImpulse(this,eb);var em=ea.zpp_inner;if(em._validate!=null){em._validate()}en+=ea.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}el+=ea.zpp_inner.y;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}ej+=ea.zpp_inner.z;ea.dispose()}return q.get(en,el,ej)};at.prototype.totalContactsImpulse=function(eg,eb){if(eb==null){eb=false}var en=0;var el=0;var ej=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ef=this.zpp_inner.wrap_arbiters.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ed=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ee;if(ef.zpp_i<ed){ee=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++).zpp_inner;if(ec.type!=j.COL){continue}if(eg!=null&&ec.b2!=eg.zpp_inner&&ec.b1!=eg.zpp_inner){continue}var ei=ec.wrapper();var ea=(ei.zpp_inner.type==j.COL?ei.zpp_inner.colarb.outer_zn:null).totalImpulse(this,eb);var em=ea.zpp_inner;if(em._validate!=null){em._validate()}en+=ea.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}el+=ea.zpp_inner.y;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}ej+=ea.zpp_inner.z;ea.dispose()}return q.get(en,el,ej)};at.prototype.rollingImpulse=function(ea,eb){if(eb==null){eb=false}var ec=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var eg=this.zpp_inner.wrap_arbiters.iterator();while(true){eg.zpp_inner.zpp_inner.valmod();var ef=eg.zpp_inner.zpp_gl();eg.zpp_critical=true;var ed;if(eg.zpp_i<ef){ed=true}else{eg.zpp_next=d0.zpp_pool;d0.zpp_pool=eg;eg.zpp_inner=null;ed=false}if(!ed){break}eg.zpp_critical=false;var ee=eg.zpp_inner.at(eg.zpp_i++).zpp_inner;if(ee.type!=j.COL){continue}if(ea!=null&&ee.b2!=ea.zpp_inner&&ee.b1!=ea.zpp_inner){continue}var eh=ee.wrapper();ec+=(eh.zpp_inner.type==j.COL?eh.zpp_inner.colarb.outer_zn:null).rollingImpulse(this,eb)}return ec};at.prototype.buoyancyImpulse=function(ef){var em=0;var ek=0;var ei=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ee=this.zpp_inner.wrap_arbiters.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var eb=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;var ec=ee.zpp_inner.at(ee.zpp_i++).zpp_inner;if(ec.type!=j.FLUID){continue}if(ef!=null&&ec.b2!=ef.zpp_inner&&ec.b1!=ef.zpp_inner){continue}var eh=ec.wrapper();var ea=(eh.zpp_inner.type==j.FLUID?eh.zpp_inner.fluidarb.outer_zn:null).buoyancyImpulse(this);var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.x;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.y;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}ei+=ea.zpp_inner.z;ea.dispose()}return q.get(em,ek,ei)};at.prototype.dragImpulse=function(ef){var em=0;var ek=0;var ei=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ee=this.zpp_inner.wrap_arbiters.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var eb=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;var ec=ee.zpp_inner.at(ee.zpp_i++).zpp_inner;if(ec.type!=j.FLUID){continue}if(ef!=null&&ec.b2!=ef.zpp_inner&&ec.b1!=ef.zpp_inner){continue}var eh=ec.wrapper();var ea=(eh.zpp_inner.type==j.FLUID?eh.zpp_inner.fluidarb.outer_zn:null).dragImpulse(this);var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.x;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.y;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}ei+=ea.zpp_inner.z;ea.dispose()}return q.get(em,ek,ei)};at.prototype.totalFluidImpulse=function(ef){var em=0;var ek=0;var ei=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ee=this.zpp_inner.wrap_arbiters.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var eb=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;var ec=ee.zpp_inner.at(ee.zpp_i++).zpp_inner;if(ec.type!=j.FLUID){continue}if(ef!=null&&ec.b2!=ef.zpp_inner&&ec.b1!=ef.zpp_inner){continue}var eh=ec.wrapper();var ea=(eh.zpp_inner.type==j.FLUID?eh.zpp_inner.fluidarb.outer_zn:null).totalImpulse(this);var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.x;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.y;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}ei+=ea.zpp_inner.z;ea.dispose()}return q.get(em,ek,ei)};at.prototype.constraintsImpulse=function(){var ec=0;var eb=0;var ea=0;var ee=this.zpp_inner.constraints.head;while(ee!=null){var ed=ee.elt.outer.bodyImpulse(this);var eh=ed.zpp_inner;if(eh._validate!=null){eh._validate()}ec+=ed.zpp_inner.x;var eg=ed.zpp_inner;if(eg._validate!=null){eg._validate()}eb+=ed.zpp_inner.y;var ef=ed.zpp_inner;if(ef._validate!=null){ef._validate()}ea+=ed.zpp_inner.z;ed.dispose();ee=ee.next}return q.get(ec,eb,ea)};at.prototype.totalImpulse=function(ef,eg){if(eg==null){eg=false}var en=0;var em=0;var ek=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var eb=this.zpp_inner.wrap_arbiters.iterator();while(true){eb.zpp_inner.zpp_inner.valmod();var ec=eb.zpp_inner.zpp_gl();eb.zpp_critical=true;var es;if(eb.zpp_i<ec){es=true}else{eb.zpp_next=d0.zpp_pool;d0.zpp_pool=eb;eb.zpp_inner=null;es=false}if(!es){break}eb.zpp_critical=false;var ee=eb.zpp_inner.at(eb.zpp_i++).zpp_inner;if(ee.type==j.SENSOR){continue}if(ef!=null&&ee.b2!=ef.zpp_inner&&ee.b1!=ef.zpp_inner){continue}var eq=ee.wrapper().totalImpulse(this,eg);var ei=eq.zpp_inner;if(ei._validate!=null){ei._validate()}en+=eq.zpp_inner.x;var er=eq.zpp_inner;if(er._validate!=null){er._validate()}em+=eq.zpp_inner.y;var ep=eq.zpp_inner;if(ep._validate!=null){ep._validate()}ek+=eq.zpp_inner.z;eq.dispose()}var eh=this.zpp_inner.constraints.head;while(eh!=null){var ed=eh.elt;if(ed.active){var ea=ed.outer.bodyImpulse(this);var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}en+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.z;ea.dispose()}eh=eh.next}return q.get(en,em,ek)};at.prototype.contains=function(eb){var ea=eb.zpp_inner.weak;eb.zpp_inner.weak=false;var ee;ee=false;var ed=this.zpp_inner.shapes.head;while(ed!=null){if(ed.elt.outer.contains(eb)){ee=true;break}ed=ed.next}eb.zpp_inner.weak=ea;if(eb.zpp_inner.weak){var ec=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec}return ee};at.prototype.toString=function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==2?"dynamic":this.zpp_inner.type==1?"static":"kinematic"))+")#"+this.zpp_inner_i.id};Object.defineProperty(at.prototype,"type",{get:at.prototype.get_type,set:at.prototype.set_type});Object.defineProperty(at.prototype,"isBullet",{get:at.prototype.get_isBullet,set:at.prototype.set_isBullet});Object.defineProperty(at.prototype,"disableCCD",{get:at.prototype.get_disableCCD,set:at.prototype.set_disableCCD});Object.defineProperty(at.prototype,"shapes",{get:at.prototype.get_shapes});Object.defineProperty(at.prototype,"compound",{get:at.prototype.get_compound,set:at.prototype.set_compound});Object.defineProperty(at.prototype,"space",{get:at.prototype.get_space,set:at.prototype.set_space});Object.defineProperty(at.prototype,"arbiters",{get:at.prototype.get_arbiters});Object.defineProperty(at.prototype,"isSleeping",{get:at.prototype.get_isSleeping});Object.defineProperty(at.prototype,"constraints",{get:at.prototype.get_constraints});Object.defineProperty(at.prototype,"position",{get:at.prototype.get_position,set:at.prototype.set_position});Object.defineProperty(at.prototype,"velocity",{get:at.prototype.get_velocity,set:at.prototype.set_velocity});Object.defineProperty(at.prototype,"kinematicVel",{get:at.prototype.get_kinematicVel,set:at.prototype.set_kinematicVel});Object.defineProperty(at.prototype,"surfaceVel",{get:at.prototype.get_surfaceVel,set:at.prototype.set_surfaceVel});Object.defineProperty(at.prototype,"force",{get:at.prototype.get_force,set:at.prototype.set_force});Object.defineProperty(at.prototype,"constraintVelocity",{get:at.prototype.get_constraintVelocity});Object.defineProperty(at.prototype,"rotation",{get:at.prototype.get_rotation,set:at.prototype.set_rotation});Object.defineProperty(at.prototype,"angularVel",{get:at.prototype.get_angularVel,set:at.prototype.set_angularVel});Object.defineProperty(at.prototype,"kinAngVel",{get:at.prototype.get_kinAngVel,set:at.prototype.set_kinAngVel});Object.defineProperty(at.prototype,"torque",{get:at.prototype.get_torque,set:at.prototype.set_torque});Object.defineProperty(at.prototype,"bounds",{get:at.prototype.get_bounds});Object.defineProperty(at.prototype,"allowMovement",{get:at.prototype.get_allowMovement,set:at.prototype.set_allowMovement});Object.defineProperty(at.prototype,"allowRotation",{get:at.prototype.get_allowRotation,set:at.prototype.set_allowRotation});Object.defineProperty(at.prototype,"massMode",{get:at.prototype.get_massMode,set:at.prototype.set_massMode});Object.defineProperty(at.prototype,"constraintMass",{get:at.prototype.get_constraintMass});Object.defineProperty(at.prototype,"mass",{get:at.prototype.get_mass,set:at.prototype.set_mass});Object.defineProperty(at.prototype,"gravMassMode",{get:at.prototype.get_gravMassMode,set:at.prototype.set_gravMassMode});Object.defineProperty(at.prototype,"gravMass",{get:at.prototype.get_gravMass,set:at.prototype.set_gravMass});Object.defineProperty(at.prototype,"gravMassScale",{get:at.prototype.get_gravMassScale,set:at.prototype.set_gravMassScale});Object.defineProperty(at.prototype,"inertiaMode",{get:at.prototype.get_inertiaMode,set:at.prototype.set_inertiaMode});Object.defineProperty(at.prototype,"constraintInertia",{get:at.prototype.get_constraintInertia});Object.defineProperty(at.prototype,"inertia",{get:at.prototype.get_inertia,set:at.prototype.set_inertia});Object.defineProperty(at.prototype,"localCOM",{get:at.prototype.get_localCOM});Object.defineProperty(at.prototype,"worldCOM",{get:at.prototype.get_worldCOM});at.prototype.__class__=at;var aX=nape.phys.BodyIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};aX.__name__=["nape","phys","BodyIterator"];aX.get=function(ec){var ea;if(aX.zpp_pool==null){b0.internal=true;var ed=new aX();b0.internal=false;ea=ed}else{var eb=aX.zpp_pool;aX.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};aX.prototype.zpp_inner=null;aX.prototype.zpp_i=null;aX.prototype.zpp_critical=null;aX.prototype.zpp_next=null;aX.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=aX.zpp_pool;aX.zpp_pool=this;this.zpp_inner=null;return false}};aX.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};aX.prototype.__class__=aX;var a5=nape.phys.BodyList=function(){this.zpp_inner=null;this.zpp_inner=new b0();this.zpp_inner.outer=this};a5.__name__=["nape","phys","BodyList"];a5.fromArray=function(ed){var ea=new a5();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};a5.prototype.zpp_inner=null;a5.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};a5.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};a5.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};a5.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a5.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a5.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};a5.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};a5.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};a5.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};a5.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};a5.prototype.empty=function(){return this.zpp_inner.inner.head==null};a5.prototype.iterator=function(){this.zpp_inner.valmod();return aX.get(this)};a5.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new a5();this.zpp_inner.valmod();var ef=aX.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=aX.zpp_pool;aX.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};a5.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=aX.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=aX.zpp_pool;aX.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};a5.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=aX.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=aX.zpp_pool;aX.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};a5.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=aX.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=aX.zpp_pool;aX.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=aX.zpp_pool;aX.zpp_pool=ec;ec.zpp_inner=null;break}}return this};a5.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(a5.prototype,"length",{get:a5.prototype.get_length});a5.prototype.__class__=a5;var cU=nape.phys.BodyType=function(){};cU.__name__=["nape","phys","BodyType"];cU.STATIC=null;cU.get_STATIC=function(){if(br.BodyType_STATIC==null){br.internal=true;br.BodyType_STATIC=new cU();br.internal=false}return br.BodyType_STATIC};cU.DYNAMIC=null;cU.get_DYNAMIC=function(){if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}return br.BodyType_DYNAMIC};cU.KINEMATIC=null;cU.get_KINEMATIC=function(){if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}return br.BodyType_KINEMATIC};cU.prototype.toString=function(){if(br.BodyType_STATIC==null){br.internal=true;br.BodyType_STATIC=new cU();br.internal=false}if(this==br.BodyType_STATIC){return"STATIC"}else{if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}if(this==br.BodyType_DYNAMIC){return"DYNAMIC"}else{if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}if(this==br.BodyType_KINEMATIC){return"KINEMATIC"}else{return""}}}};Object.defineProperty(cU,"STATIC",{get:cU.get_STATIC});Object.defineProperty(cU,"DYNAMIC",{get:cU.get_DYNAMIC});Object.defineProperty(cU,"KINEMATIC",{get:cU.get_KINEMATIC});cU.prototype.__class__=cU;var dq=nape.phys.Compound=function(){this.zpp_inner=null;a6.call(this);this.zpp_inner=new cQ();this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;this.zpp_inner.insert_cbtype(db.ANY_COMPOUND.zpp_inner)};dq.__name__=["nape","phys","Compound"];dq.__super__=a6;dq.prototype=Object.create(a6.prototype);dq.prototype.zpp_inner=null;dq.prototype.get_bodies=function(){return this.zpp_inner.wrap_bodies};dq.prototype.get_constraints=function(){return this.zpp_inner.wrap_constraints};dq.prototype.get_compounds=function(){return this.zpp_inner.wrap_compounds};dq.prototype.get_compound=function(){if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};dq.prototype.set_compound=function(ea){this.zpp_inner.immutable_midstep("Compound::compound");if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=null){(this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_compounds;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};dq.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};dq.prototype.set_space=function(ea){this.zpp_inner.immutable_midstep("Compound::space");if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){(this.zpp_inner.space==null?null:this.zpp_inner.space.outer).zpp_inner.wrap_compounds.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_compounds;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};dq.prototype.toString=function(){return"Compound"+this.zpp_inner_i.id};dq.prototype.copy=function(){return this.zpp_inner.copy()};dq.prototype.breakApart=function(){this.zpp_inner.breakApart()};dq.prototype.visitBodies=function(eh){var eg=this.zpp_inner.wrap_bodies;eg.zpp_inner.valmod();var ee=aX.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=aX.zpp_pool;aX.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitBodies(eh)}};dq.prototype.visitConstraints=function(eh){var eg=this.zpp_inner.wrap_constraints;eg.zpp_inner.valmod();var ee=bO.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=bO.zpp_pool;bO.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitConstraints(eh)}};dq.prototype.visitCompounds=function(ea){var eg=this.zpp_inner.wrap_compounds;eg.zpp_inner.valmod();var ee=c4.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner;ed.zpp_inner.valmod();if(ed.zpp_inner.zip_length){ed.zpp_inner.zip_length=false;ed.zpp_inner.user_length=ed.zpp_inner.inner.length}var ec=ed.zpp_inner.user_length;ee.zpp_critical=true;var eb;if(ee.zpp_i<ec){eb=true}else{ee.zpp_next=c4.zpp_pool;c4.zpp_pool=ee;ee.zpp_inner=null;eb=false}if(!eb){break}ee.zpp_critical=false;var ef=ee.zpp_inner.at(ee.zpp_i++);ea(ef);ef.visitCompounds(ea)}};dq.prototype.COM=function(eb){if(eb==null){eb=false}var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=0;ei.y=0;ee.zpp_inner=ei;ee.zpp_inner.outer=ee}else{var ea;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==0){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}ea=ee.zpp_inner.y==0}else{ea=false}if(!ea){ee.zpp_inner.x=0;ee.zpp_inner.y=0;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=eb;var eg=ee;var eh=0;this.visitBodies(function(er){if(er.zpp_inner.wrap_shapes.zpp_inner.inner.head!=null){if(er.zpp_inner.wrap_worldCOM==null){var es=er.zpp_inner.worldCOMx;var eq=er.zpp_inner.worldCOMy;var ep;if(au.poolVec2==null){ep=new r()}else{ep=au.poolVec2;au.poolVec2=ep.zpp_pool;ep.zpp_pool=null}if(ep.zpp_inner==null){var eo;if(bB.zpp_pool==null){eo=new bB()}else{eo=bB.zpp_pool;bB.zpp_pool=eo.next;eo.next=null}eo.weak=false;eo._immutable=false;eo.x=es;eo.y=eq;ep.zpp_inner=eo;ep.zpp_inner.outer=ep}else{var ek;var en=ep.zpp_inner;if(en._validate!=null){en._validate()}if(ep.zpp_inner.x==es){var em=ep.zpp_inner;if(em._validate!=null){em._validate()}ek=ep.zpp_inner.y==eq}else{ek=false}if(!ek){ep.zpp_inner.x=es;ep.zpp_inner.y=eq;var el=ep.zpp_inner;if(el._invalidate!=null){el._invalidate(el)}}}ep.zpp_inner.weak=false;er.zpp_inner.wrap_worldCOM=ep;er.zpp_inner.wrap_worldCOM.zpp_inner._inuse=true;er.zpp_inner.wrap_worldCOM.zpp_inner._immutable=true;er.zpp_inner.wrap_worldCOM.zpp_inner._validate=(bo=er.zpp_inner,dX(bo,bo.getworldCOM))}var ej=er.zpp_inner.wrap_worldCOM;er.zpp_inner.validate_mass();eg.addeq(ej.mul(er.zpp_inner.cmass,true));er.zpp_inner.validate_mass();eh+=er.zpp_inner.cmass}});eg.muleq(1/eh);return eg};dq.prototype.translate=function(ed){var eb=ed.zpp_inner.weak;ed.zpp_inner.weak=false;this.visitBodies(function(ee){if(ee.zpp_inner.wrap_pos==null){ee.zpp_inner.setupPosition()}ee.zpp_inner.wrap_pos.addeq(ed)});ed.zpp_inner.weak=eb;if(ed.zpp_inner.weak){var ea=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;var ec=ed;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};dq.prototype.rotate=function(eb,ee){var ec=eb.zpp_inner.weak;eb.zpp_inner.weak=false;this.visitBodies(function(ef){ef.rotate(eb,ee)});eb.zpp_inner.weak=ec;if(eb.zpp_inner.weak){var ea=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;var ed=eb;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};Object.defineProperty(dq.prototype,"bodies",{get:dq.prototype.get_bodies});Object.defineProperty(dq.prototype,"constraints",{get:dq.prototype.get_constraints});Object.defineProperty(dq.prototype,"compounds",{get:dq.prototype.get_compounds});Object.defineProperty(dq.prototype,"compound",{get:dq.prototype.get_compound,set:dq.prototype.set_compound});Object.defineProperty(dq.prototype,"space",{get:dq.prototype.get_space,set:dq.prototype.set_space});dq.prototype.__class__=dq;var c4=nape.phys.CompoundIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};c4.__name__=["nape","phys","CompoundIterator"];c4.get=function(ec){var ea;if(c4.zpp_pool==null){bj.internal=true;var ed=new c4();bj.internal=false;ea=ed}else{var eb=c4.zpp_pool;c4.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};c4.prototype.zpp_inner=null;c4.prototype.zpp_i=null;c4.prototype.zpp_critical=null;c4.prototype.zpp_next=null;c4.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=c4.zpp_pool;c4.zpp_pool=this;this.zpp_inner=null;return false}};c4.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};c4.prototype.__class__=c4;var cB=nape.phys.CompoundList=function(){this.zpp_inner=null;this.zpp_inner=new bj();this.zpp_inner.outer=this};cB.__name__=["nape","phys","CompoundList"];cB.fromArray=function(ed){var ea=new cB();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};cB.prototype.zpp_inner=null;cB.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};cB.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};cB.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};cB.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cB.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cB.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};cB.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};cB.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};cB.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};cB.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};cB.prototype.empty=function(){return this.zpp_inner.inner.head==null};cB.prototype.iterator=function(){this.zpp_inner.valmod();return c4.get(this)};cB.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new cB();this.zpp_inner.valmod();var ef=c4.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=c4.zpp_pool;c4.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};cB.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=c4.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=c4.zpp_pool;c4.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};cB.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=c4.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=c4.zpp_pool;c4.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};cB.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=c4.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=c4.zpp_pool;c4.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=c4.zpp_pool;c4.zpp_pool=ec;ec.zpp_inner=null;break}}return this};cB.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(cB.prototype,"length",{get:cB.prototype.get_length});cB.prototype.__class__=cB;var aM=nape.phys.FluidProperties=function(ea,eb){if(eb==null){eb=1}if(ea==null){ea=1}this.zpp_inner=null;if(b6.zpp_pool==null){this.zpp_inner=new b6()}else{this.zpp_inner=b6.zpp_pool;b6.zpp_pool=this.zpp_inner.next;this.zpp_inner.next=null}this.zpp_inner.outer=this;if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate()}if(eb!=this.zpp_inner.viscosity){this.zpp_inner.viscosity=eb/1;this.zpp_inner.invalidate()}};aM.__name__=["nape","phys","FluidProperties"];aM.prototype.zpp_inner=null;aM.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};aM.prototype.get_shapes=function(){if(this.zpp_inner.wrap_shapes==null){this.zpp_inner.wrap_shapes=aI.get(this.zpp_inner.shapes,true)}return this.zpp_inner.wrap_shapes};aM.prototype.copy=function(){var ei=new aM(this.zpp_inner.density*1000,this.zpp_inner.viscosity);if(this.zpp_inner.userData!=null){ei.zpp_inner.userData=bm.copy(this.zpp_inner.userData)}var em=this.zpp_inner.wrap_gravity;if(em==null){if(ei.zpp_inner.wrap_gravity!=null){ei.zpp_inner.wrap_gravity.zpp_inner._inuse=false;var ef=ei.zpp_inner.wrap_gravity;var en=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en;ei.zpp_inner.wrap_gravity=null}}else{if(ei.zpp_inner.wrap_gravity==null){ei.zpp_inner.getgravity()}var ej=ei.zpp_inner.wrap_gravity;var eh=em.zpp_inner;if(eh._validate!=null){eh._validate()}var el=em.zpp_inner.x;var eg=em.zpp_inner;if(eg._validate!=null){eg._validate()}var ek=em.zpp_inner.y;var ec;var ee=ej.zpp_inner;if(ee._validate!=null){ee._validate()}if(ej.zpp_inner.x==el){var ed=ej.zpp_inner;if(ed._validate!=null){ed._validate()}ec=ej.zpp_inner.y==ek}else{ec=false}if(!ec){ej.zpp_inner.x=el;ej.zpp_inner.y=ek;var eb=ej.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(em.zpp_inner.weak){var ea=em.zpp_inner;em.zpp_inner.outer=null;em.zpp_inner=null;em.zpp_pool=au.poolVec2;au.poolVec2=em;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}}return ei};aM.prototype.get_density=function(){return this.zpp_inner.density*1000};aM.prototype.set_density=function(ea){if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate()}return this.zpp_inner.density*1000};aM.prototype.get_viscosity=function(){return this.zpp_inner.viscosity};aM.prototype.set_viscosity=function(ea){if(ea!=this.zpp_inner.viscosity){this.zpp_inner.viscosity=ea/1;this.zpp_inner.invalidate()}return this.zpp_inner.viscosity};aM.prototype.get_gravity=function(){return this.zpp_inner.wrap_gravity};aM.prototype.set_gravity=function(el){if(el==null){if(this.zpp_inner.wrap_gravity!=null){this.zpp_inner.wrap_gravity.zpp_inner._inuse=false;var ef=this.zpp_inner.wrap_gravity;var em=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em;this.zpp_inner.wrap_gravity=null}}else{if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}var ei=this.zpp_inner.wrap_gravity;var eh=el.zpp_inner;if(eh._validate!=null){eh._validate()}var ek=el.zpp_inner.x;var eg=el.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=el.zpp_inner.y;var ec;var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}if(ei.zpp_inner.x==ek){var ed=ei.zpp_inner;if(ed._validate!=null){ed._validate()}ec=ei.zpp_inner.y==ej}else{ec=false}if(!ec){ei.zpp_inner.x=ek;ei.zpp_inner.y=ej;var eb=ei.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(el.zpp_inner.weak){var ea=el.zpp_inner;el.zpp_inner.outer=null;el.zpp_inner=null;el.zpp_pool=au.poolVec2;au.poolVec2=el;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}}return this.zpp_inner.wrap_gravity};aM.prototype.toString=function(){return"{ density: "+this.zpp_inner.density*1000+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+ag.string(this.zpp_inner.wrap_gravity)+" }"};Object.defineProperty(aM.prototype,"userData",{get:aM.prototype.get_userData});Object.defineProperty(aM.prototype,"shapes",{get:aM.prototype.get_shapes});Object.defineProperty(aM.prototype,"density",{get:aM.prototype.get_density,set:aM.prototype.set_density});Object.defineProperty(aM.prototype,"viscosity",{get:aM.prototype.get_viscosity,set:aM.prototype.set_viscosity});Object.defineProperty(aM.prototype,"gravity",{get:aM.prototype.get_gravity,set:aM.prototype.set_gravity});aM.prototype.__class__=aM;var cw=nape.phys.GravMassMode=function(){};cw.__name__=["nape","phys","GravMassMode"];cw.DEFAULT=null;cw.get_DEFAULT=function(){if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}return br.GravMassMode_DEFAULT};cw.FIXED=null;cw.get_FIXED=function(){if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}return br.GravMassMode_FIXED};cw.SCALED=null;cw.get_SCALED=function(){if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}return br.GravMassMode_SCALED};cw.prototype.toString=function(){if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}if(this==br.GravMassMode_DEFAULT){return"DEFAULT"}else{if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}if(this==br.GravMassMode_FIXED){return"FIXED"}else{if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}if(this==br.GravMassMode_SCALED){return"SCALED"}else{return""}}}};Object.defineProperty(cw,"DEFAULT",{get:cw.get_DEFAULT});Object.defineProperty(cw,"FIXED",{get:cw.get_FIXED});Object.defineProperty(cw,"SCALED",{get:cw.get_SCALED});cw.prototype.__class__=cw;var be=nape.phys.InertiaMode=function(){};be.__name__=["nape","phys","InertiaMode"];be.DEFAULT=null;be.get_DEFAULT=function(){if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}return br.InertiaMode_DEFAULT};be.FIXED=null;be.get_FIXED=function(){if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}return br.InertiaMode_FIXED};be.prototype.toString=function(){if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}if(this==br.InertiaMode_DEFAULT){return"DEFAULT"}else{if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}if(this==br.InertiaMode_FIXED){return"FIXED"}else{return""}}};Object.defineProperty(be,"DEFAULT",{get:be.get_DEFAULT});Object.defineProperty(be,"FIXED",{get:be.get_FIXED});be.prototype.__class__=be;var ap=nape.phys.InteractorIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};ap.__name__=["nape","phys","InteractorIterator"];ap.get=function(ec){var ea;if(ap.zpp_pool==null){i.internal=true;var ed=new ap();i.internal=false;ea=ed}else{var eb=ap.zpp_pool;ap.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};ap.prototype.zpp_inner=null;ap.prototype.zpp_i=null;ap.prototype.zpp_critical=null;ap.prototype.zpp_next=null;ap.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=ap.zpp_pool;ap.zpp_pool=this;this.zpp_inner=null;return false}};ap.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};ap.prototype.__class__=ap;var dd=nape.phys.InteractorList=function(){this.zpp_inner=null;this.zpp_inner=new i();this.zpp_inner.outer=this};dd.__name__=["nape","phys","InteractorList"];dd.fromArray=function(ed){var ea=new dd();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};dd.prototype.zpp_inner=null;dd.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};dd.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner_i)};dd.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer_i};dd.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner_i)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner_i)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};dd.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner_i)}else{this.zpp_inner.inner.add(ec.zpp_inner_i)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};dd.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer_i};dd.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer_i};dd.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};dd.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner_i){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner_i)}this.zpp_inner.invalidate()}return ea};dd.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};dd.prototype.empty=function(){return this.zpp_inner.inner.head==null};dd.prototype.iterator=function(){this.zpp_inner.valmod();return ap.get(this)};dd.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new dd();this.zpp_inner.valmod();var ef=ap.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=ap.zpp_pool;ap.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};dd.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=ap.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=ap.zpp_pool;ap.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};dd.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=ap.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=ap.zpp_pool;ap.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};dd.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=ap.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=ap.zpp_pool;ap.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=ap.zpp_pool;ap.zpp_pool=ec;ec.zpp_inner=null;break}}return this};dd.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(dd.prototype,"length",{get:dd.prototype.get_length});dd.prototype.__class__=dd;var by=nape.phys.MassMode=function(){};by.__name__=["nape","phys","MassMode"];by.DEFAULT=null;by.get_DEFAULT=function(){if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}return br.MassMode_DEFAULT};by.FIXED=null;by.get_FIXED=function(){if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}return br.MassMode_FIXED};by.prototype.toString=function(){if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}if(this==br.MassMode_DEFAULT){return"DEFAULT"}else{if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}if(this==br.MassMode_FIXED){return"FIXED"}else{return""}}};Object.defineProperty(by,"DEFAULT",{get:by.get_DEFAULT});Object.defineProperty(by,"FIXED",{get:by.get_FIXED});by.prototype.__class__=by;var dg=nape.phys.Material=function(ec,eb,ee,ea,ed){if(ed==null){ed=0.001}if(ea==null){ea=1}if(ee==null){ee=2}if(eb==null){eb=1}if(ec==null){ec=0}this.zpp_inner=null;if(cJ.zpp_pool==null){this.zpp_inner=new cJ()}else{this.zpp_inner=cJ.zpp_pool;cJ.zpp_pool=this.zpp_inner.next;this.zpp_inner.next=null}this.zpp_inner.outer=this;if(ec!=this.zpp_inner.elasticity){this.zpp_inner.elasticity=ec/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}if(eb!=this.zpp_inner.dynamicFriction){this.zpp_inner.dynamicFriction=eb/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ANGDRAG|cJ.ARBITERS)}if(ee!=this.zpp_inner.staticFriction){this.zpp_inner.staticFriction=ee/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate(cJ.WAKE|cJ.PROPS)}if(ed!=this.zpp_inner.rollingFriction){this.zpp_inner.rollingFriction=ed/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}};dg.__name__=["nape","phys","Material"];dg.wood=function(){return new dg(0.4,0.2,0.38,0.7,0.005)};dg.steel=function(){return new dg(0.2,0.57,0.74,7.8,0.001)};dg.ice=function(){return new dg(0.3,0.03,0.1,0.9,0.0001)};dg.rubber=function(){return new dg(0.8,1,1.4,1.5,0.01)};dg.glass=function(){return new dg(0.4,0.4,0.94,2.6,0.002)};dg.sand=function(){return new dg(-1,0.45,0.6,1.6,16)};dg.prototype.zpp_inner=null;dg.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};dg.prototype.get_shapes=function(){if(this.zpp_inner.wrap_shapes==null){this.zpp_inner.wrap_shapes=aI.get(this.zpp_inner.shapes,true)}return this.zpp_inner.wrap_shapes};dg.prototype.copy=function(){var ea=new dg(this.zpp_inner.elasticity,this.zpp_inner.dynamicFriction,this.zpp_inner.staticFriction,this.zpp_inner.density*1000,this.zpp_inner.rollingFriction);if(this.zpp_inner.userData!=null){ea.zpp_inner.userData=bm.copy(this.zpp_inner.userData)}return ea};dg.prototype.get_elasticity=function(){return this.zpp_inner.elasticity};dg.prototype.set_elasticity=function(ea){if(ea!=this.zpp_inner.elasticity){this.zpp_inner.elasticity=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}return this.zpp_inner.elasticity};dg.prototype.get_dynamicFriction=function(){return this.zpp_inner.dynamicFriction};dg.prototype.set_dynamicFriction=function(ea){if(ea!=this.zpp_inner.dynamicFriction){this.zpp_inner.dynamicFriction=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ANGDRAG|cJ.ARBITERS)}return this.zpp_inner.dynamicFriction};dg.prototype.get_staticFriction=function(){return this.zpp_inner.staticFriction};dg.prototype.set_staticFriction=function(ea){if(ea!=this.zpp_inner.staticFriction){this.zpp_inner.staticFriction=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}return this.zpp_inner.staticFriction};dg.prototype.get_density=function(){return this.zpp_inner.density*1000};dg.prototype.set_density=function(ea){if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate(cJ.WAKE|cJ.PROPS)}return this.zpp_inner.density*1000};dg.prototype.get_rollingFriction=function(){return this.zpp_inner.rollingFriction};dg.prototype.set_rollingFriction=function(ea){if(ea!=this.zpp_inner.rollingFriction){this.zpp_inner.rollingFriction=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}return this.zpp_inner.rollingFriction};dg.prototype.toString=function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+this.zpp_inner.density*1000+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"};Object.defineProperty(dg.prototype,"userData",{get:dg.prototype.get_userData});Object.defineProperty(dg.prototype,"shapes",{get:dg.prototype.get_shapes});Object.defineProperty(dg.prototype,"elasticity",{get:dg.prototype.get_elasticity,set:dg.prototype.set_elasticity});Object.defineProperty(dg.prototype,"dynamicFriction",{get:dg.prototype.get_dynamicFriction,set:dg.prototype.set_dynamicFriction});Object.defineProperty(dg.prototype,"staticFriction",{get:dg.prototype.get_staticFriction,set:dg.prototype.set_staticFriction});Object.defineProperty(dg.prototype,"density",{get:dg.prototype.get_density,set:dg.prototype.set_density});Object.defineProperty(dg.prototype,"rollingFriction",{get:dg.prototype.get_rollingFriction,set:dg.prototype.set_rollingFriction});dg.prototype.__class__=dg;var ck=nape.shape.Shape=function(){this.zpp_inner=null;a6.call(this)};ck.__name__=["nape","shape","Shape"];ck.__super__=a6;ck.prototype=Object.create(a6.prototype);ck.prototype.zpp_inner=null;ck.prototype.get_type=function(){return bZ.types[this.zpp_inner.type]};ck.prototype.isCircle=function(){return this.zpp_inner.type==0};ck.prototype.isPolygon=function(){return this.zpp_inner.type==1};ck.prototype.get_body=function(){if(this.zpp_inner.body!=null){return this.zpp_inner.body.outer}else{return null}};ck.prototype.set_body=function(ea){this.zpp_inner.immutable_midstep("Shape::body");if((this.zpp_inner.body!=null?this.zpp_inner.body.outer:null)!=ea){if(this.zpp_inner.body!=null){(this.zpp_inner.body!=null?this.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_shapes;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.body!=null){return this.zpp_inner.body.outer}else{return null}};ck.prototype.get_castCircle=function(){if(this.zpp_inner.type==0){return this.zpp_inner.circle.outer_zn}else{return null}};ck.prototype.get_castPolygon=function(){if(this.zpp_inner.type==1){return this.zpp_inner.polygon.outer_zn}else{return null}};ck.prototype.get_worldCOM=function(){if(this.zpp_inner.wrap_worldCOM==null){var ea=this.zpp_inner.worldCOMx;var eh=this.zpp_inner.worldCOMy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.zpp_inner.wrap_worldCOM=eb;this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=true;this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=true;this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(bo=this.zpp_inner,dX(bo,bo.getworldCOM))}return this.zpp_inner.wrap_worldCOM};ck.prototype.get_localCOM=function(){if(this.zpp_inner.wrap_localCOM==null){if(this.zpp_inner.type==0){this.zpp_inner.circle.setupLocalCOM()}else{this.zpp_inner.polygon.setupLocalCOM()}}return this.zpp_inner.wrap_localCOM};ck.prototype.set_localCOM=function(ea){this.zpp_inner.immutable_midstep("Body::localCOM");if(this.zpp_inner.wrap_localCOM==null){if(this.zpp_inner.type==0){this.zpp_inner.circle.setupLocalCOM()}else{this.zpp_inner.polygon.setupLocalCOM()}}var ee=this.zpp_inner.wrap_localCOM;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_localCOM==null){if(this.zpp_inner.type==0){this.zpp_inner.circle.setupLocalCOM()}else{this.zpp_inner.polygon.setupLocalCOM()}}return this.zpp_inner.wrap_localCOM};ck.prototype.get_area=function(){this.zpp_inner.validate_area_inertia();return this.zpp_inner.area};ck.prototype.get_inertia=function(){this.zpp_inner.validate_area_inertia();return this.zpp_inner.inertia};ck.prototype.get_angDrag=function(){this.zpp_inner.validate_angDrag();return this.zpp_inner.angDrag};ck.prototype.get_material=function(){return this.zpp_inner.material.wrapper()};ck.prototype.set_material=function(ea){this.zpp_inner.immutable_midstep("Shape::material");this.zpp_inner.setMaterial(ea.zpp_inner);return this.zpp_inner.material.wrapper()};ck.prototype.get_filter=function(){return this.zpp_inner.filter.wrapper()};ck.prototype.set_filter=function(ea){this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(ea.zpp_inner);return this.zpp_inner.filter.wrapper()};ck.prototype.get_fluidProperties=function(){this.zpp_inner.immutable_midstep("Shape::fluidProperties");if(this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner)}return this.zpp_inner.fluidProperties.wrapper()};ck.prototype.set_fluidProperties=function(ea){this.zpp_inner.setFluid(ea.zpp_inner);this.zpp_inner.immutable_midstep("Shape::fluidProperties");if(this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner)}return this.zpp_inner.fluidProperties.wrapper()};ck.prototype.get_fluidEnabled=function(){return this.zpp_inner.fluidEnabled};ck.prototype.set_fluidEnabled=function(ea){this.zpp_inner.immutable_midstep("Shape::fluidEnabled");this.zpp_inner.fluidEnabled=ea;if(ea&&this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner);this.zpp_inner.immutable_midstep("Shape::fluidProperties");if(this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner)}this.zpp_inner.fluidProperties.wrapper()}this.zpp_inner.wake();return this.zpp_inner.fluidEnabled};ck.prototype.get_sensorEnabled=function(){return this.zpp_inner.sensorEnabled};ck.prototype.set_sensorEnabled=function(ea){this.zpp_inner.immutable_midstep("Shape::sensorEnabled");this.zpp_inner.sensorEnabled=ea;this.zpp_inner.wake();return this.zpp_inner.sensorEnabled};ck.prototype.get_bounds=function(){return this.zpp_inner.aabb.wrapper()};ck.prototype.translate=function(eh){this.zpp_inner.immutable_midstep("Shape::translate()");if(eh.lsq()>0){if(this.zpp_inner.type==0){var eg=eh.zpp_inner;if(eg._validate!=null){eg._validate()}var eb=eh.zpp_inner.x;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}this.zpp_inner.circle.__translate(eb,eh.zpp_inner.y)}else{var ee=eh.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=eh.zpp_inner.x;var ec=eh.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.polygon.__translate(ed,eh.zpp_inner.y)}}if(eh.zpp_inner.weak){var ea=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};ck.prototype.scale=function(eb,ea){this.zpp_inner.immutable_midstep("Shape::scale()");if(this.zpp_inner.type==0){var ec=eb*eb-ea*ea;if(ec*ec<P.epsilon*P.epsilon){this.zpp_inner.circle.__scale(eb,ea)}}else{this.zpp_inner.polygon.__scale(eb,ea)}return this};ck.prototype.rotate=function(ec){this.zpp_inner.immutable_midstep("Shape::rotate()");if(ec%(2*Math.PI)!=0){var eb=Math.cos(ec);var ea=Math.sin(ec);if(this.zpp_inner.type==0){this.zpp_inner.circle.__rotate(ea,eb)}else{this.zpp_inner.polygon.__rotate(ea,eb)}}return this};ck.prototype.transform=function(ea){this.zpp_inner.immutable_midstep("Shape::transform()");if(this.zpp_inner.type==0){if(ea.equiorthogonal()){this.zpp_inner.circle.__transform(ea)}}else{this.zpp_inner.polygon.__transform(ea)}return this};ck.prototype.contains=function(ea){bM.validateShape(this.zpp_inner);var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=b7.shapeContains(this.zpp_inner,ea.zpp_inner);if(ea.zpp_inner.weak){var eb=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ec};ck.prototype.copy=function(){return this.zpp_inner.copy()};ck.prototype.toString=function(){return(this.zpp_inner.type==0?"Circle":"Polygon")+"#"+this.zpp_inner_i.id};Object.defineProperty(ck.prototype,"type",{get:ck.prototype.get_type});Object.defineProperty(ck.prototype,"body",{get:ck.prototype.get_body,set:ck.prototype.set_body});Object.defineProperty(ck.prototype,"castCircle",{get:ck.prototype.get_castCircle});Object.defineProperty(ck.prototype,"castPolygon",{get:ck.prototype.get_castPolygon});Object.defineProperty(ck.prototype,"worldCOM",{get:ck.prototype.get_worldCOM});Object.defineProperty(ck.prototype,"localCOM",{get:ck.prototype.get_localCOM,set:ck.prototype.set_localCOM});Object.defineProperty(ck.prototype,"area",{get:ck.prototype.get_area});Object.defineProperty(ck.prototype,"inertia",{get:ck.prototype.get_inertia});Object.defineProperty(ck.prototype,"angDrag",{get:ck.prototype.get_angDrag});Object.defineProperty(ck.prototype,"material",{get:ck.prototype.get_material,set:ck.prototype.set_material});Object.defineProperty(ck.prototype,"filter",{get:ck.prototype.get_filter,set:ck.prototype.set_filter});Object.defineProperty(ck.prototype,"fluidProperties",{get:ck.prototype.get_fluidProperties,set:ck.prototype.set_fluidProperties});Object.defineProperty(ck.prototype,"fluidEnabled",{get:ck.prototype.get_fluidEnabled,set:ck.prototype.set_fluidEnabled});Object.defineProperty(ck.prototype,"sensorEnabled",{get:ck.prototype.get_sensorEnabled,set:ck.prototype.set_sensorEnabled});Object.defineProperty(ck.prototype,"bounds",{get:ck.prototype.get_bounds});ck.prototype.__class__=ck;var ds=nape.shape.Circle=function(ea,ec,ee,ed){this.zpp_inner_zn=null;ck.call(this);this.zpp_inner_zn=new di();this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i=this.zpp_inner;this.zpp_inner_i.outer_i=this;this.zpp_inner.immutable_midstep("Circle::radius");if(ea!=this.zpp_inner_zn.radius){this.zpp_inner_zn.radius=ea;this.zpp_inner_zn.invalidate_radius()}if(ec==null){this.zpp_inner.localCOMx=0;this.zpp_inner.localCOMy=0}else{var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}this.zpp_inner.localCOMx=ec.zpp_inner.x;var ef=ec.zpp_inner;if(ef._validate!=null){ef._validate()}this.zpp_inner.localCOMy=ec.zpp_inner.y;if(ec.zpp_inner.weak){var eb=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}}if(ee==null){if(cJ.zpp_pool==null){this.zpp_inner.material=new cJ()}else{this.zpp_inner.material=cJ.zpp_pool;cJ.zpp_pool=this.zpp_inner.material.next;this.zpp_inner.material.next=null}}else{this.zpp_inner.immutable_midstep("Shape::material");this.zpp_inner.setMaterial(ee.zpp_inner);this.zpp_inner.material.wrapper()}if(ed==null){if(cA.zpp_pool==null){this.zpp_inner.filter=new cA()}else{this.zpp_inner.filter=cA.zpp_pool;cA.zpp_pool=this.zpp_inner.filter.next;this.zpp_inner.filter.next=null}}else{this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(ed.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(db.ANY_SHAPE.zpp_inner)};ds.__name__=["nape","shape","Circle"];ds.__super__=ck;ds.prototype=Object.create(ck.prototype);ds.prototype.zpp_inner_zn=null;ds.prototype.get_radius=function(){return this.zpp_inner_zn.radius};ds.prototype.set_radius=function(ea){this.zpp_inner.immutable_midstep("Circle::radius");if(ea!=this.zpp_inner_zn.radius){this.zpp_inner_zn.radius=ea;this.zpp_inner_zn.invalidate_radius()}return this.zpp_inner_zn.radius};Object.defineProperty(ds.prototype,"radius",{get:ds.prototype.get_radius,set:ds.prototype.set_radius});ds.prototype.__class__=ds;var ba=nape.shape.Edge=function(){this.zpp_inner=null};ba.__name__=["nape","shape","Edge"];ba.prototype.zpp_inner=null;ba.prototype.get_polygon=function(){return this.zpp_inner.polygon.outer_zn};ba.prototype.get_localNormal=function(){if(this.zpp_inner.wrap_lnorm==null){this.zpp_inner.getlnorm()}return this.zpp_inner.wrap_lnorm};ba.prototype.get_worldNormal=function(){if(this.zpp_inner.wrap_gnorm==null){this.zpp_inner.getgnorm()}return this.zpp_inner.wrap_gnorm};ba.prototype.get_length=function(){this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.length};ba.prototype.get_localProjection=function(){this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.lprojection};ba.prototype.get_worldProjection=function(){var ee=this.zpp_inner.polygon;if(ee.zip_gaxi){if(ee.body!=null){ee.zip_gaxi=false;ee.validate_laxi();var eh=ee.body;if(eh.zip_axis){eh.zip_axis=false;eh.axisx=Math.sin(eh.rot);eh.axisy=Math.cos(eh.rot)}if(ee.zip_gverts){if(ee.body!=null){ee.zip_gverts=false;ee.validate_lverts();var eg=ee.body;if(eg.zip_axis){eg.zip_axis=false;eg.axisx=Math.sin(eg.rot);eg.axisy=Math.cos(eg.rot)}var el=ee.lverts.next;var eb=ee.gverts.next;while(eb!=null){var ed=eb;var ec=el;el=el.next;ed.x=ee.body.posx+(ee.body.axisy*ec.x-ee.body.axisx*ec.y);ed.y=ee.body.posy+(ec.x*ee.body.axisx+ec.y*ee.body.axisy);eb=eb.next}}}var ea=ee.edges.head;var ej=ee.gverts.next;var em=ej;ej=ej.next;while(ej!=null){var ek=ej;var ef=ea.elt;ea=ea.next;ef.gp0=em;ef.gp1=ek;ef.gnormx=ee.body.axisy*ef.lnormx-ee.body.axisx*ef.lnormy;ef.gnormy=ef.lnormx*ee.body.axisx+ef.lnormy*ee.body.axisy;ef.gprojection=ee.body.posx*ef.gnormx+ee.body.posy*ef.gnormy+ef.lprojection;if(ef.wrap_gnorm!=null){ef.wrap_gnorm.zpp_inner.x=ef.gnormx;ef.wrap_gnorm.zpp_inner.y=ef.gnormy}ef.tp0=ef.gp0.y*ef.gnormx-ef.gp0.x*ef.gnormy;ef.tp1=ef.gp1.y*ef.gnormx-ef.gp1.x*ef.gnormy;em=ek;ej=ej.next}var ei=ea.elt;ei.gp0=em;ei.gp1=ee.gverts.next;ei.gnormx=ee.body.axisy*ei.lnormx-ee.body.axisx*ei.lnormy;ei.gnormy=ei.lnormx*ee.body.axisx+ei.lnormy*ee.body.axisy;ei.gprojection=ee.body.posx*ei.gnormx+ee.body.posy*ei.gnormy+ei.lprojection;if(ei.wrap_gnorm!=null){ei.wrap_gnorm.zpp_inner.x=ei.gnormx;ei.wrap_gnorm.zpp_inner.y=ei.gnormy}ei.tp0=ei.gp0.y*ei.gnormx-ei.gp0.x*ei.gnormy;ei.tp1=ei.gp1.y*ei.gnormx-ei.gp1.x*ei.gnormy}}return this.zpp_inner.gprojection};ba.prototype.get_localVertex1=function(){this.zpp_inner.polygon.validate_laxi();var eb=this.zpp_inner.lp0;if(eb.outer==null){eb.outer=new r();var ea=eb.outer.zpp_inner;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;eb.outer.zpp_inner=eb}return eb.outer};ba.prototype.get_localVertex2=function(){this.zpp_inner.polygon.validate_laxi();var eb=this.zpp_inner.lp1;if(eb.outer==null){eb.outer=new r();var ea=eb.outer.zpp_inner;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;eb.outer.zpp_inner=eb}return eb.outer};ba.prototype.get_worldVertex1=function(){var eg=this.zpp_inner.polygon;if(eg.zip_gaxi){if(eg.body!=null){eg.zip_gaxi=false;eg.validate_laxi();var ej=eg.body;if(ej.zip_axis){ej.zip_axis=false;ej.axisx=Math.sin(ej.rot);ej.axisy=Math.cos(ej.rot)}if(eg.zip_gverts){if(eg.body!=null){eg.zip_gverts=false;eg.validate_lverts();var ei=eg.body;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var en=eg.lverts.next;var ec=eg.gverts.next;while(ec!=null){var ee=ec;var ed=en;en=en.next;ee.x=eg.body.posx+(eg.body.axisy*ed.x-eg.body.axisx*ed.y);ee.y=eg.body.posy+(ed.x*eg.body.axisx+ed.y*eg.body.axisy);ec=ec.next}}}var ea=eg.edges.head;var el=eg.gverts.next;var eo=el;el=el.next;while(el!=null){var em=el;var eh=ea.elt;ea=ea.next;eh.gp0=eo;eh.gp1=em;eh.gnormx=eg.body.axisy*eh.lnormx-eg.body.axisx*eh.lnormy;eh.gnormy=eh.lnormx*eg.body.axisx+eh.lnormy*eg.body.axisy;eh.gprojection=eg.body.posx*eh.gnormx+eg.body.posy*eh.gnormy+eh.lprojection;if(eh.wrap_gnorm!=null){eh.wrap_gnorm.zpp_inner.x=eh.gnormx;eh.wrap_gnorm.zpp_inner.y=eh.gnormy}eh.tp0=eh.gp0.y*eh.gnormx-eh.gp0.x*eh.gnormy;eh.tp1=eh.gp1.y*eh.gnormx-eh.gp1.x*eh.gnormy;eo=em;el=el.next}var ek=ea.elt;ek.gp0=eo;ek.gp1=eg.gverts.next;ek.gnormx=eg.body.axisy*ek.lnormx-eg.body.axisx*ek.lnormy;ek.gnormy=ek.lnormx*eg.body.axisx+ek.lnormy*eg.body.axisy;ek.gprojection=eg.body.posx*ek.gnormx+eg.body.posy*ek.gnormy+ek.lprojection;if(ek.wrap_gnorm!=null){ek.wrap_gnorm.zpp_inner.x=ek.gnormx;ek.wrap_gnorm.zpp_inner.y=ek.gnormy}ek.tp0=ek.gp0.y*ek.gnormx-ek.gp0.x*ek.gnormy;ek.tp1=ek.gp1.y*ek.gnormx-ek.gp1.x*ek.gnormy}}var ef=this.zpp_inner.gp0;if(ef.outer==null){ef.outer=new r();var eb=ef.outer.zpp_inner;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ef.outer.zpp_inner=ef}return ef.outer};ba.prototype.get_worldVertex2=function(){var eg=this.zpp_inner.polygon;if(eg.zip_gaxi){if(eg.body!=null){eg.zip_gaxi=false;eg.validate_laxi();var ej=eg.body;if(ej.zip_axis){ej.zip_axis=false;ej.axisx=Math.sin(ej.rot);ej.axisy=Math.cos(ej.rot)}if(eg.zip_gverts){if(eg.body!=null){eg.zip_gverts=false;eg.validate_lverts();var ei=eg.body;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var en=eg.lverts.next;var ec=eg.gverts.next;while(ec!=null){var ee=ec;var ed=en;en=en.next;ee.x=eg.body.posx+(eg.body.axisy*ed.x-eg.body.axisx*ed.y);ee.y=eg.body.posy+(ed.x*eg.body.axisx+ed.y*eg.body.axisy);ec=ec.next}}}var ea=eg.edges.head;var el=eg.gverts.next;var eo=el;el=el.next;while(el!=null){var em=el;var eh=ea.elt;ea=ea.next;eh.gp0=eo;eh.gp1=em;eh.gnormx=eg.body.axisy*eh.lnormx-eg.body.axisx*eh.lnormy;eh.gnormy=eh.lnormx*eg.body.axisx+eh.lnormy*eg.body.axisy;eh.gprojection=eg.body.posx*eh.gnormx+eg.body.posy*eh.gnormy+eh.lprojection;if(eh.wrap_gnorm!=null){eh.wrap_gnorm.zpp_inner.x=eh.gnormx;eh.wrap_gnorm.zpp_inner.y=eh.gnormy}eh.tp0=eh.gp0.y*eh.gnormx-eh.gp0.x*eh.gnormy;eh.tp1=eh.gp1.y*eh.gnormx-eh.gp1.x*eh.gnormy;eo=em;el=el.next}var ek=ea.elt;ek.gp0=eo;ek.gp1=eg.gverts.next;ek.gnormx=eg.body.axisy*ek.lnormx-eg.body.axisx*ek.lnormy;ek.gnormy=ek.lnormx*eg.body.axisx+ek.lnormy*eg.body.axisy;ek.gprojection=eg.body.posx*ek.gnormx+eg.body.posy*ek.gnormy+ek.lprojection;if(ek.wrap_gnorm!=null){ek.wrap_gnorm.zpp_inner.x=ek.gnormx;ek.wrap_gnorm.zpp_inner.y=ek.gnormy}ek.tp0=ek.gp0.y*ek.gnormx-ek.gp0.x*ek.gnormy;ek.tp1=ek.gp1.y*ek.gnormx-ek.gp1.x*ek.gnormy}}var ef=this.zpp_inner.gp1;if(ef.outer==null){ef.outer=new r();var eb=ef.outer.zpp_inner;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ef.outer.zpp_inner=ef}return ef.outer};ba.prototype.toString=function(){if(this.zpp_inner.polygon==null){return"Edge(object-pooled)"}else{if(this.zpp_inner.polygon.body==null){this.zpp_inner.polygon.validate_laxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }"}else{var ee=this.zpp_inner.polygon;if(ee.zip_gaxi){if(ee.body!=null){ee.zip_gaxi=false;ee.validate_laxi();var eh=ee.body;if(eh.zip_axis){eh.zip_axis=false;eh.axisx=Math.sin(eh.rot);eh.axisy=Math.cos(eh.rot)}if(ee.zip_gverts){if(ee.body!=null){ee.zip_gverts=false;ee.validate_lverts();var eg=ee.body;if(eg.zip_axis){eg.zip_axis=false;eg.axisx=Math.sin(eg.rot);eg.axisy=Math.cos(eg.rot)}var el=ee.lverts.next;var eb=ee.gverts.next;while(eb!=null){var ed=eb;var ec=el;el=el.next;ed.x=ee.body.posx+(ee.body.axisy*ec.x-ee.body.axisx*ec.y);ed.y=ee.body.posy+(ec.x*ee.body.axisx+ec.y*ee.body.axisy);eb=eb.next}}}var ea=ee.edges.head;var ej=ee.gverts.next;var em=ej;ej=ej.next;while(ej!=null){var ek=ej;var ef=ea.elt;ea=ea.next;ef.gp0=em;ef.gp1=ek;ef.gnormx=ee.body.axisy*ef.lnormx-ee.body.axisx*ef.lnormy;ef.gnormy=ef.lnormx*ee.body.axisx+ef.lnormy*ee.body.axisy;ef.gprojection=ee.body.posx*ef.gnormx+ee.body.posy*ef.gnormy+ef.lprojection;if(ef.wrap_gnorm!=null){ef.wrap_gnorm.zpp_inner.x=ef.gnormx;ef.wrap_gnorm.zpp_inner.y=ef.gnormy}ef.tp0=ef.gp0.y*ef.gnormx-ef.gp0.x*ef.gnormy;ef.tp1=ef.gp1.y*ef.gnormx-ef.gp1.x*ef.gnormy;em=ek;ej=ej.next}var ei=ea.elt;ei.gp0=em;ei.gp1=ee.gverts.next;ei.gnormx=ee.body.axisy*ei.lnormx-ee.body.axisx*ei.lnormy;ei.gnormy=ei.lnormx*ee.body.axisx+ei.lnormy*ee.body.axisy;ei.gprojection=ee.body.posx*ei.gnormx+ee.body.posy*ei.gnormy+ei.lprojection;if(ei.wrap_gnorm!=null){ei.wrap_gnorm.zpp_inner.x=ei.gnormx;ei.wrap_gnorm.zpp_inner.y=ei.gnormy}ei.tp0=ei.gp0.y*ei.gnormx-ei.gp0.x*ei.gnormy;ei.tp1=ei.gp1.y*ei.gnormx-ei.gp1.x*ei.gnormy}}return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" }")+" }"}}};Object.defineProperty(ba.prototype,"polygon",{get:ba.prototype.get_polygon});Object.defineProperty(ba.prototype,"localNormal",{get:ba.prototype.get_localNormal});Object.defineProperty(ba.prototype,"worldNormal",{get:ba.prototype.get_worldNormal});Object.defineProperty(ba.prototype,"length",{get:ba.prototype.get_length});Object.defineProperty(ba.prototype,"localProjection",{get:ba.prototype.get_localProjection});Object.defineProperty(ba.prototype,"worldProjection",{get:ba.prototype.get_worldProjection});Object.defineProperty(ba.prototype,"localVertex1",{get:ba.prototype.get_localVertex1});Object.defineProperty(ba.prototype,"localVertex2",{get:ba.prototype.get_localVertex2});Object.defineProperty(ba.prototype,"worldVertex1",{get:ba.prototype.get_worldVertex1});Object.defineProperty(ba.prototype,"worldVertex2",{get:ba.prototype.get_worldVertex2});ba.prototype.__class__=ba;var dJ=nape.shape.EdgeIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};dJ.__name__=["nape","shape","EdgeIterator"];dJ.get=function(ec){var ea;if(dJ.zpp_pool==null){aw.internal=true;var ed=new dJ();aw.internal=false;ea=ed}else{var eb=dJ.zpp_pool;dJ.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};dJ.prototype.zpp_inner=null;dJ.prototype.zpp_i=null;dJ.prototype.zpp_critical=null;dJ.prototype.zpp_next=null;dJ.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=dJ.zpp_pool;dJ.zpp_pool=this;this.zpp_inner=null;return false}};dJ.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};dJ.prototype.__class__=dJ;var a2=nape.shape.EdgeList=function(){this.zpp_inner=null;this.zpp_inner=new aw();this.zpp_inner.outer=this};a2.__name__=["nape","shape","EdgeList"];a2.fromArray=function(ed){var ea=new a2();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};a2.prototype.zpp_inner=null;a2.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};a2.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};a2.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(ea==this.zpp_inner.user_length-1){ea=ea}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-2-ea}}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.wrapper()};a2.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a2.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a2.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.wrapper()};a2.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.wrapper()};a2.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};a2.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};a2.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};a2.prototype.empty=function(){return this.zpp_inner.inner.head==null};a2.prototype.iterator=function(){this.zpp_inner.valmod();return dJ.get(this)};a2.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new a2();this.zpp_inner.valmod();var ef=dJ.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};a2.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=dJ.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};a2.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=dJ.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};a2.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=dJ.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ec;ec.zpp_inner=null;break}}return this};a2.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(a2.prototype,"length",{get:a2.prototype.get_length});a2.prototype.__class__=a2;var Z=nape.shape.Polygon=function(eG,fn,eF){this.zpp_inner_zn=null;ck.call(this);this.zpp_inner_zn=new dQ();this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i=this.zpp_inner;this.zpp_inner_i.outer_i=this;if((eG instanceof Array)&&eG.__enum__==null){var fm=eG;var ea=0;while(ea<fm.length){var eT=fm[ea];++ea;var eI=eT;if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}var ec=this.zpp_inner_zn.wrap_lverts;var ev=eI.zpp_inner;if(ev._validate!=null){ev._validate()}var eD=eI.zpp_inner.x;var eV=eI.zpp_inner;if(eV._validate!=null){eV._validate()}var eH=eI.zpp_inner.y;var eP;if(au.poolVec2==null){eP=new r()}else{eP=au.poolVec2;au.poolVec2=eP.zpp_pool;eP.zpp_pool=null}if(eP.zpp_inner==null){var fk;if(bB.zpp_pool==null){fk=new bB()}else{fk=bB.zpp_pool;bB.zpp_pool=fk.next;fk.next=null}fk.weak=false;fk._immutable=false;fk.x=eD;fk.y=eH;eP.zpp_inner=fk;eP.zpp_inner.outer=eP}else{var ep;var eU=eP.zpp_inner;if(eU._validate!=null){eU._validate()}if(eP.zpp_inner.x==eD){var eS=eP.zpp_inner;if(eS._validate!=null){eS._validate()}ep=eP.zpp_inner.y==eH}else{ep=false}if(!ep){eP.zpp_inner.x=eD;eP.zpp_inner.y=eH;var eR=eP.zpp_inner;if(eR._invalidate!=null){eR._invalidate(eR)}}}eP.zpp_inner.weak=false;ec.push(eP)}}else{if(dc.__instanceof(eG,aN)){var et=eG;var eb=et.iterator();while(true){eb.zpp_inner.zpp_inner.valmod();var ed=eb.zpp_inner.zpp_gl();eb.zpp_critical=true;var eo;if(eb.zpp_i<ed){eo=true}else{eb.zpp_next=dW.zpp_pool;dW.zpp_pool=eb;eb.zpp_inner=null;eo=false}if(!eo){break}eb.zpp_critical=false;var eC=eb.zpp_inner.at(eb.zpp_i++);if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}var en=this.zpp_inner_zn.wrap_lverts;var eQ=eC.zpp_inner;if(eQ._validate!=null){eQ._validate()}var eB=eC.zpp_inner.x;var eO=eC.zpp_inner;if(eO._validate!=null){eO._validate()}var eg=eC.zpp_inner.y;var fi;if(au.poolVec2==null){fi=new r()}else{fi=au.poolVec2;au.poolVec2=fi.zpp_pool;fi.zpp_pool=null}if(fi.zpp_inner==null){var fg;if(bB.zpp_pool==null){fg=new bB()}else{fg=bB.zpp_pool;bB.zpp_pool=fg.next;fg.next=null}fg.weak=false;fg._immutable=false;fg.x=eB;fg.y=eg;fi.zpp_inner=fg;fi.zpp_inner.outer=fi}else{var em;var eM=fi.zpp_inner;if(eM._validate!=null){eM._validate()}if(fi.zpp_inner.x==eB){var eL=fi.zpp_inner;if(eL._validate!=null){eL._validate()}em=fi.zpp_inner.y==eg}else{em=false}if(!em){fi.zpp_inner.x=eB;fi.zpp_inner.y=eg;var eK=fi.zpp_inner;if(eK._invalidate!=null){eK._invalidate(eK)}}}fi.zpp_inner.weak=false;en.push(fi)}}else{if(dc.__instanceof(eG,a7)){var es=eG;var eJ=es.zpp_inner.vertices;if(eJ!=null){var eu=eJ;while(true){var eA=eu.x;var ef=eu.y;var ff;if(au.poolVec2==null){ff=new r()}else{ff=au.poolVec2;au.poolVec2=ff.zpp_pool;ff.zpp_pool=null}if(ff.zpp_inner==null){var fd;if(bB.zpp_pool==null){fd=new bB()}else{fd=bB.zpp_pool;bB.zpp_pool=fd.next;fd.next=null}fd.weak=false;fd._immutable=false;fd.x=eA;fd.y=ef;ff.zpp_inner=fd;ff.zpp_inner.outer=ff}else{var ek;var e6=ff.zpp_inner;if(e6._validate!=null){e6._validate()}if(ff.zpp_inner.x==eA){var e5=ff.zpp_inner;if(e5._validate!=null){e5._validate()}ek=ff.zpp_inner.y==ef}else{ek=false}if(!ek){ff.zpp_inner.x=eA;ff.zpp_inner.y=ef;var e4=ff.zpp_inner;if(e4._invalidate!=null){e4._invalidate(e4)}}}ff.zpp_inner.weak=false;var ez=ff;eu=eu.next;if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}var ej=this.zpp_inner_zn.wrap_lverts;var e3=ez.zpp_inner;if(e3._validate!=null){e3._validate()}var ex=ez.zpp_inner.x;var e2=ez.zpp_inner;if(e2._validate!=null){e2._validate()}var ee=ez.zpp_inner.y;var fb;if(au.poolVec2==null){fb=new r()}else{fb=au.poolVec2;au.poolVec2=fb.zpp_pool;fb.zpp_pool=null}if(fb.zpp_inner==null){var fa;if(bB.zpp_pool==null){fa=new bB()}else{fa=bB.zpp_pool;bB.zpp_pool=fa.next;fa.next=null}fa.weak=false;fa._immutable=false;fa.x=ex;fa.y=ee;fb.zpp_inner=fa;fb.zpp_inner.outer=fb}else{var ei;var e1=fb.zpp_inner;if(e1._validate!=null){e1._validate()}if(fb.zpp_inner.x==ex){var e0=fb.zpp_inner;if(e0._validate!=null){e0._validate()}ei=fb.zpp_inner.y==ee}else{ei=false}if(!ei){fb.zpp_inner.x=ex;fb.zpp_inner.y=ee;var eZ=fb.zpp_inner;if(eZ._invalidate!=null){eZ._invalidate(eZ)}}}fb.zpp_inner.weak=false;ej.push(fb);var e9=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;var eN=ez;eN.zpp_pool=au.poolVec2;au.poolVec2=eN;var fl=e9;if(fl.outer!=null){fl.outer.zpp_inner=null;fl.outer=null}fl._isimmutable=null;fl._validate=null;fl._invalidate=null;fl.next=bB.zpp_pool;bB.zpp_pool=fl;if(eu==eJ){break}}}}}}if((eG instanceof Array)&&eG.__enum__==null){var er=eG;var eW=0;while(eW<er.length){var eE=er[eW];var eh;if(eE.zpp_inner.weak){var e8=eE.zpp_inner;eE.zpp_inner.outer=null;eE.zpp_inner=null;var fj=eE;fj.zpp_pool=au.poolVec2;au.poolVec2=fj;var fh=e8;if(fh.outer!=null){fh.outer.zpp_inner=null;fh.outer=null}fh._isimmutable=null;fh._validate=null;fh._invalidate=null;fh.next=bB.zpp_pool;bB.zpp_pool=fh;eh=true}else{eh=false}if(eh){er.splice(eW,1);continue}++eW}}else{if(dc.__instanceof(eG,aN)){var eq=eG;if(eq.zpp_inner._validate!=null){eq.zpp_inner._validate()}var ey=eq.zpp_inner.inner;var eX=null;var el=ey.head;while(el!=null){var ew=el.elt;if(ew.outer.zpp_inner.weak){el=ey.erase(eX);if(ew.outer.zpp_inner.weak){var eY=ew.outer;var e7=eY.zpp_inner;eY.zpp_inner.outer=null;eY.zpp_inner=null;var fe=eY;fe.zpp_pool=au.poolVec2;au.poolVec2=fe;var fc=e7;if(fc.outer!=null){fc.outer.zpp_inner=null;fc.outer=null}fc._isimmutable=null;fc._validate=null;fc._invalidate=null;fc.next=bB.zpp_pool;bB.zpp_pool=fc}}else{eX=el;el=el.next}}}}if(fn==null){if(cJ.zpp_pool==null){this.zpp_inner.material=new cJ()}else{this.zpp_inner.material=cJ.zpp_pool;cJ.zpp_pool=this.zpp_inner.material.next;this.zpp_inner.material.next=null}}else{this.zpp_inner.immutable_midstep("Shape::material");this.zpp_inner.setMaterial(fn.zpp_inner);this.zpp_inner.material.wrapper()}if(eF==null){if(cA.zpp_pool==null){this.zpp_inner.filter=new cA()}else{this.zpp_inner.filter=cA.zpp_pool;cA.zpp_pool=this.zpp_inner.filter.next;this.zpp_inner.filter.next=null}}else{this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(eF.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(db.ANY_SHAPE.zpp_inner)};Z.__name__=["nape","shape","Polygon"];Z.__super__=ck;Z.prototype=Object.create(ck.prototype);Z.rect=function(et,eq,ea,eb,ef){if(ef==null){ef=false}var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var eu;if(bB.zpp_pool==null){eu=new bB()}else{eu=bB.zpp_pool;bB.zpp_pool=eu.next;eu.next=null}eu.weak=false;eu._immutable=false;eu.x=et;eu.y=eq;eg.zpp_inner=eu;eg.zpp_inner.outer=eg}else{var ez;var ec=eg.zpp_inner;if(ec._validate!=null){ec._validate()}if(eg.zpp_inner.x==et){var ey=eg.zpp_inner;if(ey._validate!=null){ey._validate()}ez=eg.zpp_inner.y==eq}else{ez=false}if(!ez){eg.zpp_inner.x=et;eg.zpp_inner.y=eq;var ex=eg.zpp_inner;if(ex._invalidate!=null){ex._invalidate(ex)}}}eg.zpp_inner.weak=ef;var eH=eg;var ee=et+ea;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var eo;if(bB.zpp_pool==null){eo=new bB()}else{eo=bB.zpp_pool;bB.zpp_pool=eo.next;eo.next=null}eo.weak=false;eo._immutable=false;eo.x=ee;eo.y=eq;er.zpp_inner=eo;er.zpp_inner.outer=er}else{var eG;var ew=er.zpp_inner;if(ew._validate!=null){ew._validate()}if(er.zpp_inner.x==ee){var ev=er.zpp_inner;if(ev._validate!=null){ev._validate()}eG=er.zpp_inner.y==eq}else{eG=false}if(!eG){er.zpp_inner.x=ee;er.zpp_inner.y=eq;var es=er.zpp_inner;if(es._invalidate!=null){es._invalidate(es)}}}er.zpp_inner.weak=ef;var eE=er;var ed=et+ea;var eJ=eq+eb;var em;if(au.poolVec2==null){em=new r()}else{em=au.poolVec2;au.poolVec2=em.zpp_pool;em.zpp_pool=null}if(em.zpp_inner==null){var ek;if(bB.zpp_pool==null){ek=new bB()}else{ek=bB.zpp_pool;bB.zpp_pool=ek.next;ek.next=null}ek.weak=false;ek._immutable=false;ek.x=ed;ek.y=eJ;em.zpp_inner=ek;em.zpp_inner.outer=em}else{var eC;var ep=em.zpp_inner;if(ep._validate!=null){ep._validate()}if(em.zpp_inner.x==ed){var en=em.zpp_inner;if(en._validate!=null){en._validate()}eC=em.zpp_inner.y==eJ}else{eC=false}if(!eC){em.zpp_inner.x=ed;em.zpp_inner.y=eJ;var el=em.zpp_inner;if(el._invalidate!=null){el._invalidate(el)}}}em.zpp_inner.weak=ef;var eB=em;var eI=eq+eb;var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=et;eh.y=eI;ei.zpp_inner=eh;ei.zpp_inner.outer=ei}else{var eA;var ej=ei.zpp_inner;if(ej._validate!=null){ej._validate()}if(ei.zpp_inner.x==et){var eF=ei.zpp_inner;if(eF._validate!=null){eF._validate()}eA=ei.zpp_inner.y==eI}else{eA=false}if(!eA){ei.zpp_inner.x=et;ei.zpp_inner.y=eI;var eD=ei.zpp_inner;if(eD._invalidate!=null){eD._invalidate(eD)}}}ei.zpp_inner.weak=ef;return[eH,eE,eB,ei]};Z.box=function(eb,ea,ec){if(ec==null){ec=false}return Z.rect(-eb/2,-ea/2,eb,ea,ec)};Z.regular=function(ep,ee,ea,eb,ef){if(ef==null){ef=false}if(eb==null){eb=0}var ei=[];var eq=Math.PI*2/ea;var el=0;while(el<ea){var ec=el++*eq+eb;var eo=Math.cos(ec)*ep;var en=Math.sin(ec)*ee;var em;if(au.poolVec2==null){em=new r()}else{em=au.poolVec2;au.poolVec2=em.zpp_pool;em.zpp_pool=null}if(em.zpp_inner==null){var ek;if(bB.zpp_pool==null){ek=new bB()}else{ek=bB.zpp_pool;bB.zpp_pool=ek.next;ek.next=null}ek.weak=false;ek._immutable=false;ek.x=eo;ek.y=en;em.zpp_inner=ek;em.zpp_inner.outer=em}else{var ed;var eg=em.zpp_inner;if(eg._validate!=null){eg._validate()}if(em.zpp_inner.x==eo){var ej=em.zpp_inner;if(ej._validate!=null){ej._validate()}ed=em.zpp_inner.y==en}else{ed=false}if(!ed){em.zpp_inner.x=eo;em.zpp_inner.y=en;var eh=em.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}em.zpp_inner.weak=ef;ei.push(em)}return ei};Z.prototype.zpp_inner_zn=null;Z.prototype.get_localVerts=function(){if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}return this.zpp_inner_zn.wrap_lverts};Z.prototype.get_worldVerts=function(){if(this.zpp_inner_zn.wrap_gverts==null){this.zpp_inner_zn.getgverts()}return this.zpp_inner_zn.wrap_gverts};Z.prototype.get_edges=function(){if(this.zpp_inner_zn.wrap_edges==null){this.zpp_inner_zn.getedges()}return this.zpp_inner_zn.wrap_edges};Z.prototype.validity=function(){return this.zpp_inner_zn.valid()};Object.defineProperty(Z.prototype,"localVerts",{get:Z.prototype.get_localVerts});Object.defineProperty(Z.prototype,"worldVerts",{get:Z.prototype.get_worldVerts});Object.defineProperty(Z.prototype,"edges",{get:Z.prototype.get_edges});Z.prototype.__class__=Z;var bC=nape.shape.ShapeIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};bC.__name__=["nape","shape","ShapeIterator"];bC.get=function(ec){var ea;if(bC.zpp_pool==null){aI.internal=true;var ed=new bC();aI.internal=false;ea=ed}else{var eb=bC.zpp_pool;bC.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};bC.prototype.zpp_inner=null;bC.prototype.zpp_i=null;bC.prototype.zpp_critical=null;bC.prototype.zpp_next=null;bC.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=bC.zpp_pool;bC.zpp_pool=this;this.zpp_inner=null;return false}};bC.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};bC.prototype.__class__=bC;var cZ=nape.shape.ShapeList=function(){this.zpp_inner=null;this.zpp_inner=new aI();this.zpp_inner.outer=this};cZ.__name__=["nape","shape","ShapeList"];cZ.fromArray=function(ed){var ea=new cZ();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};cZ.prototype.zpp_inner=null;cZ.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};cZ.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};cZ.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};cZ.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cZ.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cZ.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};cZ.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};cZ.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};cZ.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};cZ.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};cZ.prototype.empty=function(){return this.zpp_inner.inner.head==null};cZ.prototype.iterator=function(){this.zpp_inner.valmod();return bC.get(this)};cZ.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new cZ();this.zpp_inner.valmod();var ef=bC.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bC.zpp_pool;bC.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};cZ.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=bC.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=bC.zpp_pool;bC.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};cZ.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=bC.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bC.zpp_pool;bC.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};cZ.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=bC.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=bC.zpp_pool;bC.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=bC.zpp_pool;bC.zpp_pool=ec;ec.zpp_inner=null;break}}return this};cZ.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(cZ.prototype,"length",{get:cZ.prototype.get_length});cZ.prototype.__class__=cZ;var H=nape.shape.ShapeType=function(){};H.__name__=["nape","shape","ShapeType"];H.CIRCLE=null;H.get_CIRCLE=function(){if(br.ShapeType_CIRCLE==null){br.internal=true;br.ShapeType_CIRCLE=new H();br.internal=false}return br.ShapeType_CIRCLE};H.POLYGON=null;H.get_POLYGON=function(){if(br.ShapeType_POLYGON==null){br.internal=true;br.ShapeType_POLYGON=new H();br.internal=false}return br.ShapeType_POLYGON};H.prototype.toString=function(){if(br.ShapeType_CIRCLE==null){br.internal=true;br.ShapeType_CIRCLE=new H();br.internal=false}if(this==br.ShapeType_CIRCLE){return"CIRCLE"}else{if(br.ShapeType_POLYGON==null){br.internal=true;br.ShapeType_POLYGON=new H();br.internal=false}if(this==br.ShapeType_POLYGON){return"POLYGON"}else{return""}}};Object.defineProperty(H,"CIRCLE",{get:H.get_CIRCLE});Object.defineProperty(H,"POLYGON",{get:H.get_POLYGON});H.prototype.__class__=H;var al=nape.shape.ValidationResult=function(){};al.__name__=["nape","shape","ValidationResult"];al.VALID=null;al.get_VALID=function(){if(br.ValidationResult_VALID==null){br.internal=true;br.ValidationResult_VALID=new al();br.internal=false}return br.ValidationResult_VALID};al.DEGENERATE=null;al.get_DEGENERATE=function(){if(br.ValidationResult_DEGENERATE==null){br.internal=true;br.ValidationResult_DEGENERATE=new al();br.internal=false}return br.ValidationResult_DEGENERATE};al.CONCAVE=null;al.get_CONCAVE=function(){if(br.ValidationResult_CONCAVE==null){br.internal=true;br.ValidationResult_CONCAVE=new al();br.internal=false}return br.ValidationResult_CONCAVE};al.SELF_INTERSECTING=null;al.get_SELF_INTERSECTING=function(){if(br.ValidationResult_SELF_INTERSECTING==null){br.internal=true;br.ValidationResult_SELF_INTERSECTING=new al();br.internal=false}return br.ValidationResult_SELF_INTERSECTING};al.prototype.toString=function(){if(br.ValidationResult_VALID==null){br.internal=true;br.ValidationResult_VALID=new al();br.internal=false}if(this==br.ValidationResult_VALID){return"VALID"}else{if(br.ValidationResult_DEGENERATE==null){br.internal=true;br.ValidationResult_DEGENERATE=new al();br.internal=false}if(this==br.ValidationResult_DEGENERATE){return"DEGENERATE"}else{if(br.ValidationResult_CONCAVE==null){br.internal=true;br.ValidationResult_CONCAVE=new al();br.internal=false}if(this==br.ValidationResult_CONCAVE){return"CONCAVE"}else{if(br.ValidationResult_SELF_INTERSECTING==null){br.internal=true;br.ValidationResult_SELF_INTERSECTING=new al();br.internal=false}if(this==br.ValidationResult_SELF_INTERSECTING){return"SELF_INTERSECTING"}else{return""}}}}};Object.defineProperty(al,"VALID",{get:al.get_VALID});Object.defineProperty(al,"DEGENERATE",{get:al.get_DEGENERATE});Object.defineProperty(al,"CONCAVE",{get:al.get_CONCAVE});Object.defineProperty(al,"SELF_INTERSECTING",{get:al.get_SELF_INTERSECTING});al.prototype.__class__=al;var aQ=nape.space.Broadphase=function(){};aQ.__name__=["nape","space","Broadphase"];aQ.DYNAMIC_AABB_TREE=null;aQ.get_DYNAMIC_AABB_TREE=function(){if(br.Broadphase_DYNAMIC_AABB_TREE==null){br.internal=true;br.Broadphase_DYNAMIC_AABB_TREE=new aQ();br.internal=false}return br.Broadphase_DYNAMIC_AABB_TREE};aQ.SWEEP_AND_PRUNE=null;aQ.get_SWEEP_AND_PRUNE=function(){if(br.Broadphase_SWEEP_AND_PRUNE==null){br.internal=true;br.Broadphase_SWEEP_AND_PRUNE=new aQ();br.internal=false}return br.Broadphase_SWEEP_AND_PRUNE};aQ.prototype.toString=function(){if(br.Broadphase_DYNAMIC_AABB_TREE==null){br.internal=true;br.Broadphase_DYNAMIC_AABB_TREE=new aQ();br.internal=false}if(this==br.Broadphase_DYNAMIC_AABB_TREE){return"DYNAMIC_AABB_TREE"}else{if(br.Broadphase_SWEEP_AND_PRUNE==null){br.internal=true;br.Broadphase_SWEEP_AND_PRUNE=new aQ();br.internal=false}if(this==br.Broadphase_SWEEP_AND_PRUNE){return"SWEEP_AND_PRUNE"}else{return""}}};Object.defineProperty(aQ,"DYNAMIC_AABB_TREE",{get:aQ.get_DYNAMIC_AABB_TREE});Object.defineProperty(aQ,"SWEEP_AND_PRUNE",{get:aQ.get_SWEEP_AND_PRUNE});aQ.prototype.__class__=aQ;var bk=nape.space.Space=function(ec,eb){this.zpp_inner=null;this.zpp_inner=new a3(ec==null?null:ec.zpp_inner,eb);this.zpp_inner.outer=this;if(ec!=null){if(ec.zpp_inner.weak){var ea=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}}};bk.__name__=["nape","space","Space"];bk.prototype.zpp_inner=null;bk.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};bk.prototype.get_gravity=function(){if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}return this.zpp_inner.wrap_gravity};bk.prototype.set_gravity=function(ej){if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}var ed=this.zpp_inner.wrap_gravity;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}return this.zpp_inner.wrap_gravity};bk.prototype.get_broadphase=function(){if(this.zpp_inner.bphase.is_sweep){if(br.Broadphase_SWEEP_AND_PRUNE==null){br.internal=true;br.Broadphase_SWEEP_AND_PRUNE=new aQ();br.internal=false}return br.Broadphase_SWEEP_AND_PRUNE}else{if(br.Broadphase_DYNAMIC_AABB_TREE==null){br.internal=true;br.Broadphase_DYNAMIC_AABB_TREE=new aQ();br.internal=false}return br.Broadphase_DYNAMIC_AABB_TREE}};bk.prototype.get_sortContacts=function(){return this.zpp_inner.sortcontacts};bk.prototype.set_sortContacts=function(ea){this.zpp_inner.sortcontacts=ea;return this.zpp_inner.sortcontacts};bk.prototype.get_worldAngularDrag=function(){return this.zpp_inner.global_ang_drag};bk.prototype.set_worldAngularDrag=function(ea){this.zpp_inner.global_ang_drag=ea;return this.zpp_inner.global_ang_drag};bk.prototype.get_worldLinearDrag=function(){return this.zpp_inner.global_lin_drag};bk.prototype.set_worldLinearDrag=function(ea){this.zpp_inner.global_lin_drag=ea;return this.zpp_inner.global_lin_drag};bk.prototype.get_compounds=function(){return this.zpp_inner.wrap_compounds};bk.prototype.get_bodies=function(){return this.zpp_inner.wrap_bodies};bk.prototype.get_liveBodies=function(){return this.zpp_inner.wrap_live};bk.prototype.get_constraints=function(){return this.zpp_inner.wrap_constraints};bk.prototype.get_liveConstraints=function(){return this.zpp_inner.wrap_livecon};bk.prototype.visitBodies=function(eh){var eg=this.zpp_inner.wrap_bodies;eg.zpp_inner.valmod();var ee=aX.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=aX.zpp_pool;aX.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitBodies(eh)}};bk.prototype.visitConstraints=function(eh){var eg=this.zpp_inner.wrap_constraints;eg.zpp_inner.valmod();var ee=bO.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=bO.zpp_pool;bO.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitConstraints(eh)}};bk.prototype.visitCompounds=function(ea){var eg=this.zpp_inner.wrap_compounds;eg.zpp_inner.valmod();var ee=c4.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner;ed.zpp_inner.valmod();if(ed.zpp_inner.zip_length){ed.zpp_inner.zip_length=false;ed.zpp_inner.user_length=ed.zpp_inner.inner.length}var ec=ed.zpp_inner.user_length;ee.zpp_critical=true;var eb;if(ee.zpp_i<ec){eb=true}else{ee.zpp_next=c4.zpp_pool;c4.zpp_pool=ee;ee.zpp_inner=null;eb=false}if(!eb){break}ee.zpp_critical=false;var ef=ee.zpp_inner.at(ee.zpp_i++);ea(ef);ef.visitCompounds(ea)}};bk.prototype.get_world=function(){return this.zpp_inner.__static};bk.prototype.get_arbiters=function(){if(this.zpp_inner.wrap_arbiters==null){var ea=new aP();ea.space=this.zpp_inner;this.zpp_inner.wrap_arbiters=ea}return this.zpp_inner.wrap_arbiters};bk.prototype.get_listeners=function(){return this.zpp_inner.wrap_listeners};bk.prototype.clear=function(){this.zpp_inner.clear()};bk.prototype.step=function(ea,ec,eb){if(eb==null){eb=10}if(ec==null){ec=10}this.zpp_inner.step(ea,ec,eb)};bk.prototype.get_timeStamp=function(){return this.zpp_inner.stamp};bk.prototype.get_elapsedTime=function(){return this.zpp_inner.time};bk.prototype.interactionType=function(ec,ea){if((ec.zpp_inner.body!=null?ec.zpp_inner.body.outer:null).zpp_inner.type==1&&(ea.zpp_inner.body!=null?ea.zpp_inner.body.outer:null).zpp_inner.type==1){return null}if((ec.zpp_inner.body!=null?ec.zpp_inner.body.outer:null)==(ea.zpp_inner.body!=null?ea.zpp_inner.body.outer:null)){return null}var ef=ec.zpp_inner;var ee=ea.zpp_inner;var el=ef.body;var ek=ee.body;var ed;ed=false;var es=el.constraints.head;while(es!=null){var ei=es.elt;if(ei.ignore&&ei.pair_exists(el.id,ek.id)){ed=true;break}es=es.next}var eg;var ey;if(!ed){var eh=ef;while(eh!=null&&eh.group==null){if(eh.ishape!=null){eh=eh.ishape.body}else{if(eh.icompound!=null){eh=eh.icompound.compound}else{eh=eh.ibody.compound}}}var eb=eh==null?null:eh.group;var er;if(eb==null){er=false}else{var ej=ee;while(ej!=null&&ej.group==null){if(ej.ishape!=null){ej=ej.ishape.body}else{if(ej.icompound!=null){ej=ej.icompound.compound}else{ej=ej.ibody.compound}}}var eA=ej==null?null:ej.group;if(eA==null){er=false}else{var ez=false;while(eb!=null&&eA!=null){if(eb==eA){ez=eb.ignore;break}if(eb.depth<eA.depth){eA=eA.group}else{eb=eb.group}}er=ez}}ey=!er}else{ey=false}if(ey){var eq;if(ef.sensorEnabled||ee.sensorEnabled){var et=ef.filter;var em=ee.filter;if((et.sensorMask&em.sensorGroup)!=0){eq=(em.sensorMask&et.sensorGroup)!=0}else{eq=false}}else{eq=false}if(eq){eg=2}else{var ep;var eo;if(ef.fluidEnabled||ee.fluidEnabled){var ex=ef.filter;var ew=ee.filter;if((ex.fluidMask&ew.fluidGroup)!=0){eo=(ew.fluidMask&ex.fluidGroup)!=0}else{eo=false}}else{eo=false}if(eo){ep=!(el.imass==0&&ek.imass==0&&el.iinertia==0&&ek.iinertia==0)}else{ep=false}if(ep){eg=0}else{var en;var ev=ef.filter;var eu=ee.filter;if((ev.collisionMask&eu.collisionGroup)!=0&&(eu.collisionMask&ev.collisionGroup)!=0){en=!(el.imass==0&&ek.imass==0&&el.iinertia==0&&ek.iinertia==0)}else{en=false}if(en){eg=1}else{eg=-1}}}}else{eg=-1}switch(eg){case 0:if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID;case 1:if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION;case 2:if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR;default:return null}};bk.prototype.shapesUnderPoint=function(ea,ef,ec){var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ed=this.zpp_inner.shapesUnderPoint(ee,ea.zpp_inner.y,ef==null?null:ef.zpp_inner,ec);if(ea.zpp_inner.weak){var eb=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ed};bk.prototype.bodiesUnderPoint=function(ea,ef,ec){var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ed=this.zpp_inner.bodiesUnderPoint(ee,ea.zpp_inner.y,ef==null?null:ef.zpp_inner,ec);if(ea.zpp_inner.weak){var eb=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ed};bk.prototype.shapesInAABB=function(eb,ee,ea,ed,ec){if(ea==null){ea=true}if(ee==null){ee=false}return this.zpp_inner.shapesInAABB(eb,ea,ee,ed==null?null:ed.zpp_inner,ec)};bk.prototype.bodiesInAABB=function(eb,ee,ea,ed,ec){if(ea==null){ea=true}if(ee==null){ee=false}return this.zpp_inner.bodiesInAABB(eb,ea,ee,ed==null?null:ed.zpp_inner,ec)};bk.prototype.shapesInCircle=function(eb,ea,eg,ef,ed){if(eg==null){eg=false}var ee=this.zpp_inner.shapesInCircle(eb,ea,eg,ef==null?null:ef.zpp_inner,ed);if(eb.zpp_inner.weak){var ec=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec}return ee};bk.prototype.bodiesInCircle=function(eb,ea,eg,ef,ed){if(eg==null){eg=false}var ee=this.zpp_inner.bodiesInCircle(eb,ea,eg,ef==null?null:ef.zpp_inner,ed);if(eb.zpp_inner.weak){var ec=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec}return ee};bk.prototype.shapesInShape=function(eb,ed,ec,ea){if(ed==null){ed=false}return this.zpp_inner.shapesInShape(eb.zpp_inner,ed,ec==null?null:ec.zpp_inner,ea)};bk.prototype.bodiesInShape=function(eb,ed,ec,ea){if(ed==null){ed=false}return this.zpp_inner.bodiesInShape(eb.zpp_inner,ed,ec==null?null:ec.zpp_inner,ea)};bk.prototype.shapesInBody=function(ef,ea,ec){var eh=ec==null?new cZ():ec;var eg=ef.zpp_inner.wrap_shapes;eg.zpp_inner.valmod();var ee=bC.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ei=ee.zpp_inner;ei.zpp_inner.valmod();if(ei.zpp_inner.zip_length){ei.zpp_inner.zip_length=false;ei.zpp_inner.user_length=ei.zpp_inner.inner.length}var eb=ei.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=bC.zpp_pool;bC.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;this.shapesInShape(ee.zpp_inner.at(ee.zpp_i++),false,ea,eh)}return eh};bk.prototype.bodiesInBody=function(ef,ea,ec){var eh=ec==null?new a5():ec;var eg=ef.zpp_inner.wrap_shapes;eg.zpp_inner.valmod();var ee=bC.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ei=ee.zpp_inner;ei.zpp_inner.valmod();if(ei.zpp_inner.zip_length){ei.zpp_inner.zip_length=false;ei.zpp_inner.user_length=ei.zpp_inner.inner.length}var eb=ei.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=bC.zpp_pool;bC.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;this.bodiesInShape(ee.zpp_inner.at(ee.zpp_i++),false,ea,eh)}return eh};bk.prototype.convexCast=function(ec,eb,ea,ed){if(ea==null){ea=false}return this.zpp_inner.convexCast(ec.zpp_inner,eb,ed,ea)};bk.prototype.convexMultiCast=function(ed,ec,eb,ee,ea){if(eb==null){eb=false}return this.zpp_inner.convexMultiCast(ed.zpp_inner,ec,ee,eb,ea)};bk.prototype.rayCast=function(ea,eb,ec){if(eb==null){eb=false}return this.zpp_inner.rayCast(ea,eb,ec)};bk.prototype.rayMultiCast=function(ea,ec,ed,eb){if(ec==null){ec=false}return this.zpp_inner.rayMultiCast(ea,ec,ed,eb)};Object.defineProperty(bk.prototype,"userData",{get:bk.prototype.get_userData});Object.defineProperty(bk.prototype,"gravity",{get:bk.prototype.get_gravity,set:bk.prototype.set_gravity});Object.defineProperty(bk.prototype,"broadphase",{get:bk.prototype.get_broadphase});Object.defineProperty(bk.prototype,"sortContacts",{get:bk.prototype.get_sortContacts,set:bk.prototype.set_sortContacts});Object.defineProperty(bk.prototype,"worldAngularDrag",{get:bk.prototype.get_worldAngularDrag,set:bk.prototype.set_worldAngularDrag});Object.defineProperty(bk.prototype,"worldLinearDrag",{get:bk.prototype.get_worldLinearDrag,set:bk.prototype.set_worldLinearDrag});Object.defineProperty(bk.prototype,"compounds",{get:bk.prototype.get_compounds});Object.defineProperty(bk.prototype,"bodies",{get:bk.prototype.get_bodies});Object.defineProperty(bk.prototype,"liveBodies",{get:bk.prototype.get_liveBodies});Object.defineProperty(bk.prototype,"constraints",{get:bk.prototype.get_constraints});Object.defineProperty(bk.prototype,"liveConstraints",{get:bk.prototype.get_liveConstraints});Object.defineProperty(bk.prototype,"world",{get:bk.prototype.get_world});Object.defineProperty(bk.prototype,"arbiters",{get:bk.prototype.get_arbiters});Object.defineProperty(bk.prototype,"listeners",{get:bk.prototype.get_listeners});Object.defineProperty(bk.prototype,"timeStamp",{get:bk.prototype.get_timeStamp});Object.defineProperty(bk.prototype,"elapsedTime",{get:bk.prototype.get_elapsedTime});bk.prototype.__class__=bk;var cR=nape.util.Debug=function(){};cR.__name__=["nape","util","Debug"];cR.version=function(){return"Nape 2.0.19"};cR.clearObjectPools=function(){while(bO.zpp_pool!=null){var e0=bO.zpp_pool.zpp_next;bO.zpp_pool.zpp_next=null;bO.zpp_pool=e0}while(ap.zpp_pool!=null){var ee=ap.zpp_pool.zpp_next;ap.zpp_pool.zpp_next=null;ap.zpp_pool=ee}while(aX.zpp_pool!=null){var ed=aX.zpp_pool.zpp_next;aX.zpp_pool.zpp_next=null;aX.zpp_pool=ed}while(c4.zpp_pool!=null){var ec=c4.zpp_pool.zpp_next;c4.zpp_pool.zpp_next=null;c4.zpp_pool=ec}while(cV.zpp_pool!=null){var eb=cV.zpp_pool.zpp_next;cV.zpp_pool.zpp_next=null;cV.zpp_pool=eb}while(Y.zpp_pool!=null){var ea=Y.zpp_pool.zpp_next;Y.zpp_pool.zpp_next=null;Y.zpp_pool=ea}while(v.zpp_pool!=null){var fI=v.zpp_pool.zpp_next;v.zpp_pool.zpp_next=null;v.zpp_pool=fI}while(bL.zpp_pool!=null){var fH=bL.zpp_pool.zpp_next;bL.zpp_pool.zpp_next=null;bL.zpp_pool=fH}while(dW.zpp_pool!=null){var fG=dW.zpp_pool.zpp_next;dW.zpp_pool.zpp_next=null;dW.zpp_pool=fG}while(du.zpp_pool!=null){var fF=du.zpp_pool.zpp_next;du.zpp_pool.zpp_next=null;du.zpp_pool=fF}while(bC.zpp_pool!=null){var ff=bC.zpp_pool.zpp_next;bC.zpp_pool.zpp_next=null;bC.zpp_pool=ff}while(dJ.zpp_pool!=null){var fd=dJ.zpp_pool.zpp_next;dJ.zpp_pool.zpp_next=null;dJ.zpp_pool=fd}while(d5.zpp_pool!=null){var fb=d5.zpp_pool.zpp_next;d5.zpp_pool.zpp_next=null;d5.zpp_pool=fb}while(d0.zpp_pool!=null){var e9=d0.zpp_pool.zpp_next;d0.zpp_pool.zpp_next=null;d0.zpp_pool=e9}while(cL.zpp_pool!=null){var e7=cL.zpp_pool.zpp_next;cL.zpp_pool.zpp_next=null;cL.zpp_pool=e7}while(b.zpp_pool!=null){var e5=b.zpp_pool.next;b.zpp_pool.next=null;b.zpp_pool=e5}while(cF.zpp_pool!=null){var e4=cF.zpp_pool.next;cF.zpp_pool.next=null;cF.zpp_pool=e4}while(cJ.zpp_pool!=null){var e3=cJ.zpp_pool.next;cJ.zpp_pool.next=null;cJ.zpp_pool=e3}while(b9.zpp_pool!=null){var e2=b9.zpp_pool.next;b9.zpp_pool.next=null;b9.zpp_pool=e2}while(b6.zpp_pool!=null){var e1=b6.zpp_pool.next;b6.zpp_pool.next=null;b6.zpp_pool=e1}while(bE.zpp_pool!=null){var eU=bE.zpp_pool.next;bE.zpp_pool.next=null;bE.zpp_pool=eU}while(cx.zpp_pool!=null){var eS=cx.zpp_pool.next;cx.zpp_pool.next=null;cx.zpp_pool=eS}while(Q.zpp_pool!=null){var eQ=Q.zpp_pool.next;Q.zpp_pool.next=null;Q.zpp_pool=eQ}while(dL.zpp_pool!=null){var eO=dL.zpp_pool.next;dL.zpp_pool.next=null;dL.zpp_pool=eO}while(dV.zpp_pool!=null){var eM=dV.zpp_pool.next;dV.zpp_pool.next=null;dV.zpp_pool=eM}while(ar.zpp_pool!=null){var eK=ar.zpp_pool.next;ar.zpp_pool.next=null;ar.zpp_pool=eK}while(aF.zpp_pool!=null){var eJ=aF.zpp_pool.next;aF.zpp_pool.next=null;aF.zpp_pool=eJ}while(cO.zpp_pool!=null){var eI=cO.zpp_pool.next;cO.zpp_pool.next=null;cO.zpp_pool=eI}while(g.zpp_pool!=null){var eH=g.zpp_pool.next;g.zpp_pool.next=null;g.zpp_pool=eH}while(aT.zpp_pool!=null){var eG=aT.zpp_pool.next;aT.zpp_pool.next=null;aT.zpp_pool=eG}while(cS.zpp_pool!=null){var eA=cS.zpp_pool.next;cS.zpp_pool.next=null;cS.zpp_pool=eA}while(cC.zpp_pool!=null){var ey=cC.zpp_pool.next;cC.zpp_pool.next=null;cC.zpp_pool=ey}while(cd.zpp_pool!=null){var ew=cd.zpp_pool.next;cd.zpp_pool.next=null;cd.zpp_pool=ew}while(aR.zpp_pool!=null){var ev=aR.zpp_pool.next;aR.zpp_pool.next=null;aR.zpp_pool=ev}while(dr.zpp_pool!=null){var eu=dr.zpp_pool.next;dr.zpp_pool.next=null;dr.zpp_pool=eu}while(dn.zpp_pool!=null){var et=dn.zpp_pool.next;dn.zpp_pool.next=null;dn.zpp_pool=et}while(cm.zpp_pool!=null){var es=cm.zpp_pool.next;cm.zpp_pool.next=null;cm.zpp_pool=es}while(p.zpp_pool!=null){var er=p.zpp_pool.next;p.zpp_pool.next=null;p.zpp_pool=er}while(E.zpp_pool!=null){var eq=E.zpp_pool.next;E.zpp_pool.next=null;E.zpp_pool=eq}while(c3.zpp_pool!=null){var ep=c3.zpp_pool.next;c3.zpp_pool.next=null;c3.zpp_pool=ep}while(d3.zpp_pool!=null){var eo=d3.zpp_pool.next;d3.zpp_pool.next=null;d3.zpp_pool=eo}while(cH.zpp_pool!=null){var en=cH.zpp_pool.next;cH.zpp_pool.next=null;cH.zpp_pool=en}while(bB.zpp_pool!=null){var em=bB.zpp_pool.next;bB.zpp_pool.next=null;bB.zpp_pool=em}while(V.zpp_pool!=null){var el=V.zpp_pool.next;V.zpp_pool.next=null;V.zpp_pool=el}while(ah.zpp_pool!=null){var ek=ah.zpp_pool.next;ah.zpp_pool.next=null;ah.zpp_pool=ek}while(b8.zpp_pool!=null){var ej=b8.zpp_pool.next;b8.zpp_pool.next=null;b8.zpp_pool=ej}while(cD.zpp_pool!=null){var ei=cD.zpp_pool.next;cD.zpp_pool.next=null;cD.zpp_pool=ei}while(cG.zpp_pool!=null){var eh=cG.zpp_pool.next;cG.zpp_pool.next=null;cG.zpp_pool=eh}while(a.zpp_pool!=null){var eg=a.zpp_pool.next;a.zpp_pool.next=null;a.zpp_pool=eg}while(o.zpp_pool!=null){var ef=o.zpp_pool.next;o.zpp_pool.next=null;o.zpp_pool=ef}while(dU.zpp_pool!=null){var fE=dU.zpp_pool.next;dU.zpp_pool.next=null;dU.zpp_pool=fE}while(k.zpp_pool!=null){var fD=k.zpp_pool.next;k.zpp_pool.next=null;k.zpp_pool=fD}while(am.zpp_pool!=null){var fC=am.zpp_pool.next;am.zpp_pool.next=null;am.zpp_pool=fC}while(dS.zpp_pool!=null){var fB=dS.zpp_pool.next;dS.zpp_pool.next=null;dS.zpp_pool=fB}while(bT.zpp_pool!=null){var fA=bT.zpp_pool.next;bT.zpp_pool.next=null;bT.zpp_pool=fA}while(bX.zpp_pool!=null){var fz=bX.zpp_pool.next;bX.zpp_pool.next=null;bX.zpp_pool=fz}while(dG.zpp_pool!=null){var fy=dG.zpp_pool.next;dG.zpp_pool.next=null;dG.zpp_pool=fy}while(co.zpp_pool!=null){var fx=co.zpp_pool.next;co.zpp_pool.next=null;co.zpp_pool=fx}while(bD.zpp_pool!=null){var fw=bD.zpp_pool.next;bD.zpp_pool.next=null;bD.zpp_pool=fw}while(bl.zpp_pool!=null){var fv=bl.zpp_pool.next;bl.zpp_pool.next=null;bl.zpp_pool=fv}while(dI.zpp_pool!=null){var fu=dI.zpp_pool.next;dI.zpp_pool.next=null;dI.zpp_pool=fu}while(ca.zpp_pool!=null){var ft=ca.zpp_pool.next;ca.zpp_pool.next=null;ca.zpp_pool=ft}while(ct.zpp_pool!=null){var fs=ct.zpp_pool.next;ct.zpp_pool.next=null;ct.zpp_pool=fs}while(d6.zpp_pool!=null){var fr=d6.zpp_pool.next;d6.zpp_pool.next=null;d6.zpp_pool=fr}while(dY.zpp_pool!=null){var fq=dY.zpp_pool.next;dY.zpp_pool.next=null;dY.zpp_pool=fq}while(W.zpp_pool!=null){var fp=W.zpp_pool.next;W.zpp_pool.next=null;W.zpp_pool=fp}while(T.zpp_pool!=null){var fo=T.zpp_pool.next;T.zpp_pool.next=null;T.zpp_pool=fo}while(aV.zpp_pool!=null){var fn=aV.zpp_pool.next;aV.zpp_pool.next=null;aV.zpp_pool=fn}while(c8.zpp_pool!=null){var fm=c8.zpp_pool.next;c8.zpp_pool.next=null;c8.zpp_pool=fm}while(cl.zpp_pool!=null){var fl=cl.zpp_pool.next;cl.zpp_pool.next=null;cl.zpp_pool=fl}while(cq.zpp_pool!=null){var fk=cq.zpp_pool.next;cq.zpp_pool.next=null;cq.zpp_pool=fk}while(f.zpp_pool!=null){var fj=f.zpp_pool.next;f.zpp_pool.next=null;f.zpp_pool=fj}while(dz.zpp_pool!=null){var fi=dz.zpp_pool.next;dz.zpp_pool.next=null;dz.zpp_pool=fi}while(bG.zpp_pool!=null){var fh=bG.zpp_pool.next;bG.zpp_pool.next=null;bG.zpp_pool=fh}while(d2.zpp_pool!=null){var fg=d2.zpp_pool.next;d2.zpp_pool.next=null;d2.zpp_pool=fg}while(c2.zpp_pool!=null){var fe=c2.zpp_pool.next;c2.zpp_pool.next=null;c2.zpp_pool=fe}while(dv.zpp_pool!=null){var fc=dv.zpp_pool.next;dv.zpp_pool.next=null;dv.zpp_pool=fc}while(cW.zpp_pool!=null){var fa=cW.zpp_pool.next;cW.zpp_pool.next=null;cW.zpp_pool=fa}while(bx.zpp_pool!=null){var e8=bx.zpp_pool.next;bx.zpp_pool.next=null;bx.zpp_pool=e8}while(cg.zpp_pool!=null){var e6=cg.zpp_pool.next;cg.zpp_pool.next=null;cg.zpp_pool=e6}while(A.zpp_pool!=null){var eZ=A.zpp_pool.next;A.zpp_pool.next=null;A.zpp_pool=eZ}while(dK.zpp_pool!=null){var eY=dK.zpp_pool.next;dK.zpp_pool.next=null;dK.zpp_pool=eY}while(dT.zpp_pool!=null){var eX=dT.zpp_pool.next;dT.zpp_pool.next=null;dT.zpp_pool=eX}while(bb.zpp_pool!=null){var eW=bb.zpp_pool.next;bb.zpp_pool.next=null;bb.zpp_pool=eW}while(d9.zpp_pool!=null){var eV=d9.zpp_pool.next;d9.zpp_pool.next=null;d9.zpp_pool=eV}while(L.zpp_pool!=null){var eT=L.zpp_pool.next;L.zpp_pool.next=null;L.zpp_pool=eT}while(e.zpp_pool!=null){var eR=e.zpp_pool.next;e.zpp_pool.next=null;e.zpp_pool=eR}while(bi.zpp_pool!=null){var eP=bi.zpp_pool.next;bi.zpp_pool.next=null;bi.zpp_pool=eP}while(w.zpp_pool!=null){var eN=w.zpp_pool.next;w.zpp_pool.next=null;w.zpp_pool=eN}while(c5.zpp_pool!=null){var eL=c5.zpp_pool.next;c5.zpp_pool.next=null;c5.zpp_pool=eL}while(cA.zpp_pool!=null){var eF=cA.zpp_pool.next;cA.zpp_pool.next=null;cA.zpp_pool=eF}while(cn.zpp_pool!=null){var eE=cn.zpp_pool.next;cn.zpp_pool.next=null;cn.zpp_pool=eE}while(cM.zpp_pool!=null){var eD=cM.zpp_pool.next;cM.zpp_pool.next=null;cM.zpp_pool=eD}while(dp.zpp_pool!=null){var eC=dp.zpp_pool.next;dp.zpp_pool.next=null;dp.zpp_pool=eC}while(au.poolGeomPoly!=null){var eB=au.poolGeomPoly.zpp_pool;au.poolGeomPoly.zpp_pool=null;au.poolGeomPoly=eB}while(au.poolVec2!=null){var ez=au.poolVec2.zpp_pool;au.poolVec2.zpp_pool=null;au.poolVec2=ez}while(au.poolVec3!=null){var ex=au.poolVec3.zpp_pool;au.poolVec3.zpp_pool=null;au.poolVec3=ex}};cR.prototype.__class__=cR;var aW=sandbox.Main=function(){};aW.__name__=["sandbox","Main"];aW.main=function(){};aW.prototype.__class__=aW;var a0=zpp_nape.ZPP_Const=function(){};a0.__name__=["zpp_nape","ZPP_Const"];a0.POSINF=function(){return Infinity};a0.NEGINF=function(){return -Infinity};a0.prototype.__class__=a0;var cr=zpp_nape.ZPP_ID=function(){};cr.__name__=["zpp_nape","ZPP_ID"];cr.Constraint=function(){return cr._Constraint++};cr.Interactor=function(){return cr._Interactor++};cr.CbType=function(){return cr._CbType++};cr.CbSet=function(){return cr._CbSet++};cr.Listener=function(){return cr._Listener++};cr.ZPP_SimpleVert=function(){return cr._ZPP_SimpleVert++};cr.ZPP_SimpleSeg=function(){return cr._ZPP_SimpleSeg++};cr.Space=function(){return cr._Space++};cr.InteractionGroup=function(){return cr._InteractionGroup++};cr.prototype.__class__=cr;var cS=zpp_nape.callbacks.ZPP_Callback=function(){this.constraint=null;this.body=null;this.pre_swapped=false;this.pre_arbiter=null;this.wrap_arbiters=null;this.set=null;this.int2=null;this.int1=null;this.length=0;this.prev=null;this.next=null;this.index=0;this.space=null;this.listener=null;this.event=0;this.outer_int=null;this.outer_con=null;this.outer_body=null;this.length=0};cS.__name__=["zpp_nape","callbacks","ZPP_Callback"];cS.prototype.outer_body=null;cS.prototype.outer_con=null;cS.prototype.outer_int=null;cS.prototype.wrapper_body=function(){if(this.outer_body==null){this.outer_body=new dN();this.outer_body.zpp_inner=this}return this.outer_body};cS.prototype.wrapper_con=function(){if(this.outer_con==null){this.outer_con=new dm();this.outer_con.zpp_inner=this}return this.outer_con};cS.prototype.wrapper_int=function(){if(this.outer_int==null){this.outer_int=new ay();this.outer_int.zpp_inner=this}if(this.wrap_arbiters==null){this.wrap_arbiters=U.get(this.set.arbiters,true)}else{this.wrap_arbiters.zpp_inner.inner=this.set.arbiters}this.wrap_arbiters.zpp_inner.zip_length=true;this.wrap_arbiters.zpp_inner.at_ite=null;return this.outer_int};cS.prototype.event=null;cS.prototype.listener=null;cS.prototype.space=null;cS.prototype.index=null;cS.prototype.next=null;cS.prototype.prev=null;cS.prototype.length=null;cS.prototype.push=function(ea){if(this.prev!=null){this.prev.next=ea}else{this.next=ea}ea.prev=this.prev;ea.next=null;this.prev=ea;this.length++};cS.prototype.push_rev=function(ea){if(this.next!=null){this.next.prev=ea}else{this.prev=ea}ea.next=this.next;ea.prev=null;this.next=ea;this.length++};cS.prototype.pop=function(){var ea=this.next;this.next=ea.next;if(this.next==null){this.prev=null}else{this.next.prev=null}this.length--;return ea};cS.prototype.pop_rev=function(){var ea=this.prev;this.prev=ea.prev;if(this.prev==null){this.next=null}else{this.prev.next=null}this.length--;return ea};cS.prototype.empty=function(){return this.next==null};cS.prototype.clear=function(){while(!this.empty()){this.pop()}};cS.prototype.splice=function(eb){var ea=eb.next;if(eb.prev==null){this.next=eb.next;if(this.next!=null){this.next.prev=null}else{this.prev=null}}else{eb.prev.next=eb.next;if(eb.next!=null){eb.next.prev=eb.prev}else{this.prev=eb.prev}}this.length--;return ea};cS.prototype.rotateL=function(){this.push(this.pop())};cS.prototype.rotateR=function(){this.push_rev(this.pop_rev())};cS.prototype.cycleNext=function(ea){if(ea.next==null){return this.next}else{return ea.next}};cS.prototype.cyclePrev=function(ea){if(ea.prev==null){return this.prev}else{return ea.prev}};cS.prototype.at=function(eb){var ea=this.next;while(eb--!=0){ea=ea.next}return ea};cS.prototype.rev_at=function(eb){var ea=this.prev;while(eb--!=0){ea=ea.prev}return ea};cS.prototype.free=function(){this.int1=this.int2=null;this.body=null;this.constraint=null;this.listener=null;if(this.wrap_arbiters!=null){this.wrap_arbiters.zpp_inner.inner=null}this.set=null};cS.prototype.alloc=function(){};cS.prototype.int1=null;cS.prototype.int2=null;cS.prototype.set=null;cS.prototype.wrap_arbiters=null;cS.prototype.pre_arbiter=null;cS.prototype.pre_swapped=null;cS.prototype.genarbs=function(){if(this.wrap_arbiters==null){this.wrap_arbiters=U.get(this.set.arbiters,true)}else{this.wrap_arbiters.zpp_inner.inner=this.set.arbiters}this.wrap_arbiters.zpp_inner.zip_length=true;this.wrap_arbiters.zpp_inner.at_ite=null};cS.prototype.body=null;cS.prototype.constraint=null;cS.prototype.__class__=cS;var cC=zpp_nape.callbacks.ZPP_CbSet=function(){this.wrap_constraints=null;this.constraints=null;this.wrap_interactors=null;this.interactors=null;this.zip_conlisteners=false;this.conlisteners=null;this.zip_bodylisteners=false;this.bodylisteners=null;this.zip_listeners=false;this.listeners=null;this.cbpairs=null;this.manager=null;this.id=0;this.next=null;this.count=0;this.cbTypes=null;this.cbTypes=new x();this.listeners=new cp();this.zip_listeners=true;this.bodylisteners=new bh();this.zip_bodylisteners=true;this.conlisteners=new cY();this.zip_conlisteners=true;this.constraints=new m();this.interactors=new bn();this.id=cr.CbSet();this.cbpairs=new aK()};cC.__name__=["zpp_nape","callbacks","ZPP_CbSet"];cC.setlt=function(ed,eb){var ef=ed.cbTypes.head;var ee=eb.cbTypes.head;while(ef!=null&&ee!=null){var ec=ef.elt;var ea=ee.elt;if(ec.id<ea.id){return true}if(ea.id<ec.id){return false}else{ef=ef.next;ee=ee.next}}if(ee!=null){return ef==null}else{return false}};cC.get=function(ee){var eb;if(cC.zpp_pool==null){eb=new cC()}else{eb=cC.zpp_pool;cC.zpp_pool=eb.next;eb.next=null}var ed=null;var ec=ee.head;while(ec!=null){var ea=ec.elt;ed=eb.cbTypes.insert(ed,ea);ea.cbsets.add(eb);ec=ec.next}return eb};cC.compatible=function(eb,ei,eh){var ec;var ee=eb.options1;var ea=ei.cbTypes;if(ee.nonemptyintersection(ea,ee.includes)&&!ee.nonemptyintersection(ea,ee.excludes)){var eg=eb.options2;var el=eh.cbTypes;if(eg.nonemptyintersection(el,eg.includes)){ec=!eg.nonemptyintersection(el,eg.excludes)}else{ec=false}}else{ec=false}if(!ec){var ef=eb.options2;var ek=ei.cbTypes;if(ef.nonemptyintersection(ek,ef.includes)&&!ef.nonemptyintersection(ek,ef.excludes)){var ed=eb.options1;var ej=eh.cbTypes;if(ed.nonemptyintersection(ej,ed.includes)){return !ed.nonemptyintersection(ej,ed.excludes)}else{return false}}else{return false}}else{return true}};cC.empty_intersection=function(eb,ea){var ec=null;var ed=(eb.cbpairs.length<ea.cbpairs.length?eb.cbpairs:ea.cbpairs).head;while(ed!=null){var ef=ed.elt;if(ef.a==eb&&ef.b==ea||ef.a==ea&&ef.b==eb){ec=ef;break}ed=ed.next}if(ec==null){var ee;if(ar.zpp_pool==null){ee=new ar()}else{ee=ar.zpp_pool;ar.zpp_pool=ee.next;ee.next=null}ee.zip_listeners=true;if(cC.setlt(eb,ea)){ee.a=eb;ee.b=ea}else{ee.a=ea;ee.b=eb}ec=ee;eb.cbpairs.add(ec);if(ea!=eb){ea.cbpairs.add(ec)}}if(ec.zip_listeners){ec.zip_listeners=false;ec.__validate()}return ec.listeners.head==null};cC.single_intersection=function(eb,ea,ee){var ec=null;var ed=(eb.cbpairs.length<ea.cbpairs.length?eb.cbpairs:ea.cbpairs).head;while(ed!=null){var eh=ed.elt;if(eh.a==eb&&eh.b==ea||eh.a==ea&&eh.b==eb){ec=eh;break}ed=ed.next}if(ec==null){var eg;if(ar.zpp_pool==null){eg=new ar()}else{eg=ar.zpp_pool;ar.zpp_pool=eg.next;eg.next=null}eg.zip_listeners=true;if(cC.setlt(eb,ea)){eg.a=eb;eg.b=ea}else{eg.a=ea;eg.b=eb}ec=eg;eb.cbpairs.add(ec);if(ea!=eb){ea.cbpairs.add(ec)}}if(ec.zip_listeners){ec.zip_listeners=false;ec.__validate()}var ef=ec.listeners.head;if(ef!=null&&ef.elt==ee){return ef.next==null}else{return false}};cC.find_all=function(ei,eg,ea,ed){var ee=null;var ec=(ei.cbpairs.length<eg.cbpairs.length?ei.cbpairs:eg.cbpairs).head;while(ec!=null){var eb=ec.elt;if(eb.a==ei&&eb.b==eg||eb.a==eg&&eb.b==ei){ee=eb;break}ec=ec.next}if(ee==null){var ef;if(ar.zpp_pool==null){ef=new ar()}else{ef=ar.zpp_pool;ar.zpp_pool=ef.next;ef.next=null}ef.zip_listeners=true;if(cC.setlt(ei,eg)){ef.a=ei;ef.b=eg}else{ef.a=eg;ef.b=ei}ee=ef;ei.cbpairs.add(ee);if(eg!=ei){eg.cbpairs.add(ee)}}if(ee.zip_listeners){ee.zip_listeners=false;ee.__validate()}var ej=ee.listeners.head;while(ej!=null){var eh=ej.elt;if(eh.event==ea){ed(eh)}ej=ej.next}};cC.prototype.cbTypes=null;cC.prototype.count=null;cC.prototype.next=null;cC.prototype.id=null;cC.prototype.manager=null;cC.prototype.cbpairs=null;cC.prototype.increment=function(){this.count++};cC.prototype.decrement=function(){return --this.count==0};cC.prototype.invalidate_pairs=function(){var ea=this.cbpairs.head;while(ea!=null){ea.elt.zip_listeners=true;ea=ea.next}};cC.prototype.listeners=null;cC.prototype.zip_listeners=null;cC.prototype.invalidate_listeners=function(){this.zip_listeners=true;this.invalidate_pairs()};cC.prototype.validate_listeners=function(){if(this.zip_listeners){this.zip_listeners=false;this.realvalidate_listeners()}};cC.prototype.realvalidate_listeners=function(){this.listeners.clear();var eb=this.cbTypes.head;while(eb!=null){var eh=null;var ed=this.listeners.head;var ea=eb.elt.listeners.head;while(ea!=null){var ec=ea.elt;if(ed!=null&&ed.elt==ec){ea=ea.next;eh=ed;ed=ed.next}else{var ee;if(ed!=null){var ei=ed.elt;if(ec.precedence<=ei.precedence){if(ec.precedence==ei.precedence){ee=ec.id>ei.id}else{ee=false}}else{ee=true}}else{ee=true}if(ee){if(ec.space==this.manager.space){var ef=this.listeners;var eg;if(aF.zpp_pool==null){eg=new aF()}else{eg=aF.zpp_pool;aF.zpp_pool=eg.next;eg.next=null}eg.elt=ec;var ej=eg;if(eh==null){ej.next=ef.head;ef.head=ej}else{ej.next=eh.next;eh.next=ej}ef.pushmod=ef.modified=true;ef.length++;eh=ej}ea=ea.next}else{eh=ed;ed=ed.next}}}eb=eb.next}};cC.prototype.bodylisteners=null;cC.prototype.zip_bodylisteners=null;cC.prototype.invalidate_bodylisteners=function(){this.zip_bodylisteners=true};cC.prototype.validate_bodylisteners=function(){if(this.zip_bodylisteners){this.zip_bodylisteners=false;this.realvalidate_bodylisteners()}};cC.prototype.realvalidate_bodylisteners=function(){this.bodylisteners.clear();var eb=this.cbTypes.head;while(eb!=null){var ei=null;var ee=this.bodylisteners.head;var ea=eb.elt.bodylisteners.head;while(ea!=null){var ed=ea.elt;if(ee!=null&&ee.elt==ed){ea=ea.next;ei=ee;ee=ee.next}else{var ef;if(ee!=null){var ek=ee.elt;if(ed.precedence<=ek.precedence){if(ed.precedence==ek.precedence){ef=ed.id>ek.id}else{ef=false}}else{ef=true}}else{ef=true}if(ef){var ec;var eg=ed.options;if(!eg.nonemptyintersection(this.cbTypes,eg.excludes)){ec=ed.space==this.manager.space}else{ec=false}if(ec){var ej=this.bodylisteners;var eh;if(aT.zpp_pool==null){eh=new aT()}else{eh=aT.zpp_pool;aT.zpp_pool=eh.next;eh.next=null}eh.elt=ed;var el=eh;if(ei==null){el.next=ej.head;ej.head=el}else{el.next=ei.next;ei.next=el}ej.pushmod=ej.modified=true;ej.length++;ei=el}ea=ea.next}else{ei=ee;ee=ee.next}}}eb=eb.next}};cC.prototype.conlisteners=null;cC.prototype.zip_conlisteners=null;cC.prototype.invalidate_conlisteners=function(){this.zip_conlisteners=true};cC.prototype.validate_conlisteners=function(){if(this.zip_conlisteners){this.zip_conlisteners=false;this.realvalidate_conlisteners()}};cC.prototype.realvalidate_conlisteners=function(){this.conlisteners.clear();var eb=this.cbTypes.head;while(eb!=null){var ei=null;var ee=this.conlisteners.head;var ea=eb.elt.conlisteners.head;while(ea!=null){var ed=ea.elt;if(ee!=null&&ee.elt==ed){ea=ea.next;ei=ee;ee=ee.next}else{var ef;if(ee!=null){var ek=ee.elt;if(ed.precedence<=ek.precedence){if(ed.precedence==ek.precedence){ef=ed.id>ek.id}else{ef=false}}else{ef=true}}else{ef=true}if(ef){var ec;var eg=ed.options;if(!eg.nonemptyintersection(this.cbTypes,eg.excludes)){ec=ed.space==this.manager.space}else{ec=false}if(ec){var ej=this.conlisteners;var eh;if(aR.zpp_pool==null){eh=new aR()}else{eh=aR.zpp_pool;aR.zpp_pool=eh.next;eh.next=null}eh.elt=ed;var el=eh;if(ei==null){el.next=ej.head;ej.head=el}else{el.next=ei.next;ei.next=el}ej.pushmod=ej.modified=true;ej.length++;ei=el}ea=ea.next}else{ei=ee;ee=ee.next}}}eb=eb.next}};cC.prototype.validate=function(){if(this.zip_listeners){this.zip_listeners=false;this.realvalidate_listeners()}if(this.zip_bodylisteners){this.zip_bodylisteners=false;this.realvalidate_bodylisteners()}if(this.zip_conlisteners){this.zip_conlisteners=false;this.realvalidate_conlisteners()}};cC.prototype.interactors=null;cC.prototype.wrap_interactors=null;cC.prototype.constraints=null;cC.prototype.wrap_constraints=null;cC.prototype.addConstraint=function(ea){this.constraints.add(ea)};cC.prototype.addInteractor=function(ea){this.interactors.add(ea)};cC.prototype.remConstraint=function(ea){this.constraints.remove(ea)};cC.prototype.remInteractor=function(ea){this.interactors.remove(ea)};cC.prototype.free=function(){this.listeners.clear();this.zip_listeners=true;this.bodylisteners.clear();this.zip_bodylisteners=true;this.conlisteners.clear();this.zip_conlisteners=true;while(this.cbTypes.head!=null){this.cbTypes.pop_unsafe().cbsets.remove(this)}};cC.prototype.alloc=function(){};cC.prototype.__class__=cC;var ar=zpp_nape.callbacks.ZPP_CbSetPair=function(){this.listeners=null;this.zip_listeners=false;this.next=null;this.b=null;this.a=null;this.listeners=new cp()};ar.__name__=["zpp_nape","callbacks","ZPP_CbSetPair"];ar.get=function(eb,ea){var ec;if(ar.zpp_pool==null){ec=new ar()}else{ec=ar.zpp_pool;ar.zpp_pool=ec.next;ec.next=null}ec.zip_listeners=true;if(cC.setlt(eb,ea)){ec.a=eb;ec.b=ea}else{ec.a=ea;ec.b=eb}return ec};ar.setlt=function(ea,eb){if(!cC.setlt(ea.a,eb.a)){if(ea.a==eb.a){return cC.setlt(ea.b,eb.b)}else{return false}}else{return true}};ar.prototype.a=null;ar.prototype.b=null;ar.prototype.next=null;ar.prototype.free=function(){this.a=this.b=null;this.listeners.clear()};ar.prototype.alloc=function(){this.zip_listeners=true};ar.prototype.compatible=function(eb){var ec;var ee=eb.options1;var ea=this.a.cbTypes;if(ee.nonemptyintersection(ea,ee.includes)&&!ee.nonemptyintersection(ea,ee.excludes)){var eg=eb.options2;var ej=this.b.cbTypes;if(eg.nonemptyintersection(ej,eg.includes)){ec=!eg.nonemptyintersection(ej,eg.excludes)}else{ec=false}}else{ec=false}if(!ec){var ef=eb.options2;var ei=this.a.cbTypes;if(ef.nonemptyintersection(ei,ef.includes)&&!ef.nonemptyintersection(ei,ef.excludes)){var ed=eb.options1;var eh=this.b.cbTypes;if(ed.nonemptyintersection(eh,ed.includes)){return !ed.nonemptyintersection(eh,ed.excludes)}else{return false}}else{return false}}else{return true}};ar.prototype.zip_listeners=null;ar.prototype.listeners=null;ar.prototype.invalidate=function(){this.zip_listeners=true};ar.prototype.validate=function(){if(this.zip_listeners){this.zip_listeners=false;this.__validate()}};ar.prototype.__validate=function(){this.listeners.clear();var ek=this.a.listeners.head;var ee=this.b.listeners.head;while(ek!=null&&ee!=null){var ea=ek.elt;var ej=ee.elt;if(ea==ej){var ed;var ec;var eg=ea.options1;var eb=this.a.cbTypes;if(eg.nonemptyintersection(eb,eg.includes)&&!eg.nonemptyintersection(eb,eg.excludes)){var ei=ea.options2;var en=this.b.cbTypes;if(ei.nonemptyintersection(en,ei.includes)){ec=!ei.nonemptyintersection(en,ei.excludes)}else{ec=false}}else{ec=false}if(!ec){var eh=ea.options2;var em=this.a.cbTypes;if(eh.nonemptyintersection(em,eh.includes)&&!eh.nonemptyintersection(em,eh.excludes)){var ef=ea.options1;var el=this.b.cbTypes;if(ef.nonemptyintersection(el,ef.includes)){ed=!ef.nonemptyintersection(el,ef.excludes)}else{ed=false}}else{ed=false}}else{ed=true}if(ed){this.listeners.add(ea)}ek=ek.next;ee=ee.next}else{if(ea.precedence>ej.precedence||ea.precedence==ej.precedence&&ea.id>ej.id){ek=ek.next}else{ee=ee.next}}}};ar.prototype.empty_intersection=function(){return this.listeners.head==null};ar.prototype.single_intersection=function(ea){var eb=this.listeners.head;if(eb!=null&&eb.elt==ea){return eb.next==null}else{return false}};ar.prototype.forall=function(ed,eb){var ec=this.listeners.head;while(ec!=null){var ea=ec.elt;if(ea.event==ed){eb(ea)}ec=ec.next}};ar.prototype.__class__=ar;var cp=zpp_nape.util.ZNPList_ZPP_InteractionListener=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};cp.__name__=["zpp_nape","util","ZNPList_ZPP_InteractionListener"];cp.prototype.head=null;cp.prototype.begin=function(){return this.head};cp.prototype.modified=null;cp.prototype.pushmod=null;cp.prototype.length=null;cp.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};cp.prototype.add=function(ec){var eb;if(aF.zpp_pool==null){eb=new aF()}else{eb=aF.zpp_pool;aF.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};cp.prototype.inlined_add=function(ec){var eb;if(aF.zpp_pool==null){eb=new aF()}else{eb=aF.zpp_pool;aF.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};cp.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};cp.prototype.insert=function(ed,ec){var eb;if(aF.zpp_pool==null){eb=new aF()}else{eb=aF.zpp_pool;aF.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};cp.prototype.inlined_insert=function(ed,ec){var eb;if(aF.zpp_pool==null){eb=new aF()}else{eb=aF.zpp_pool;aF.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};cp.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aF.zpp_pool;aF.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};cp.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aF.zpp_pool;aF.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};cp.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};cp.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};cp.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aF.zpp_pool;aF.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};cp.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};cp.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aF.zpp_pool;aF.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};cp.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=aF.zpp_pool;aF.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};cp.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aF.zpp_pool;aF.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};cp.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aF.zpp_pool;aF.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};cp.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};cp.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aF.zpp_pool;aF.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};cp.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aF.zpp_pool;aF.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};cp.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};cp.prototype.empty=function(){return this.head==null};cp.prototype.size=function(){return this.length};cp.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};cp.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};cp.prototype.front=function(){return this.head.elt};cp.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};cp.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};cp.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};cp.prototype.__class__=cp;var bh=zpp_nape.util.ZNPList_ZPP_BodyListener=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};bh.__name__=["zpp_nape","util","ZNPList_ZPP_BodyListener"];bh.prototype.head=null;bh.prototype.begin=function(){return this.head};bh.prototype.modified=null;bh.prototype.pushmod=null;bh.prototype.length=null;bh.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};bh.prototype.add=function(ec){var eb;if(aT.zpp_pool==null){eb=new aT()}else{eb=aT.zpp_pool;aT.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};bh.prototype.inlined_add=function(ec){var eb;if(aT.zpp_pool==null){eb=new aT()}else{eb=aT.zpp_pool;aT.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};bh.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};bh.prototype.insert=function(ed,ec){var eb;if(aT.zpp_pool==null){eb=new aT()}else{eb=aT.zpp_pool;aT.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};bh.prototype.inlined_insert=function(ed,ec){var eb;if(aT.zpp_pool==null){eb=new aT()}else{eb=aT.zpp_pool;aT.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};bh.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aT.zpp_pool;aT.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};bh.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aT.zpp_pool;aT.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};bh.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};bh.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};bh.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aT.zpp_pool;aT.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};bh.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};bh.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aT.zpp_pool;aT.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};bh.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=aT.zpp_pool;aT.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};bh.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aT.zpp_pool;aT.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};bh.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aT.zpp_pool;aT.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};bh.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};bh.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aT.zpp_pool;aT.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};bh.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aT.zpp_pool;aT.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};bh.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};bh.prototype.empty=function(){return this.head==null};bh.prototype.size=function(){return this.length};bh.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};bh.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};bh.prototype.front=function(){return this.head.elt};bh.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};bh.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};bh.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};bh.prototype.__class__=bh;var cY=zpp_nape.util.ZNPList_ZPP_ConstraintListener=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};cY.__name__=["zpp_nape","util","ZNPList_ZPP_ConstraintListener"];cY.prototype.head=null;cY.prototype.begin=function(){return this.head};cY.prototype.modified=null;cY.prototype.pushmod=null;cY.prototype.length=null;cY.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};cY.prototype.add=function(ec){var eb;if(aR.zpp_pool==null){eb=new aR()}else{eb=aR.zpp_pool;aR.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};cY.prototype.inlined_add=function(ec){var eb;if(aR.zpp_pool==null){eb=new aR()}else{eb=aR.zpp_pool;aR.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};cY.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};cY.prototype.insert=function(ed,ec){var eb;if(aR.zpp_pool==null){eb=new aR()}else{eb=aR.zpp_pool;aR.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};cY.prototype.inlined_insert=function(ed,ec){var eb;if(aR.zpp_pool==null){eb=new aR()}else{eb=aR.zpp_pool;aR.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};cY.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aR.zpp_pool;aR.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};cY.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aR.zpp_pool;aR.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};cY.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};cY.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};cY.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aR.zpp_pool;aR.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};cY.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};cY.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aR.zpp_pool;aR.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};cY.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=aR.zpp_pool;aR.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};cY.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aR.zpp_pool;aR.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};cY.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aR.zpp_pool;aR.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};cY.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};cY.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aR.zpp_pool;aR.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};cY.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aR.zpp_pool;aR.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};cY.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};cY.prototype.empty=function(){return this.head==null};cY.prototype.size=function(){return this.length};cY.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};cY.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};cY.prototype.front=function(){return this.head.elt};cY.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};cY.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};cY.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};cY.prototype.__class__=cY;var m=zpp_nape.util.ZNPList_ZPP_Constraint=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};m.__name__=["zpp_nape","util","ZNPList_ZPP_Constraint"];m.prototype.head=null;m.prototype.begin=function(){return this.head};m.prototype.modified=null;m.prototype.pushmod=null;m.prototype.length=null;m.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};m.prototype.add=function(ec){var eb;if(cx.zpp_pool==null){eb=new cx()}else{eb=cx.zpp_pool;cx.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};m.prototype.inlined_add=function(ec){var eb;if(cx.zpp_pool==null){eb=new cx()}else{eb=cx.zpp_pool;cx.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};m.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};m.prototype.insert=function(ed,ec){var eb;if(cx.zpp_pool==null){eb=new cx()}else{eb=cx.zpp_pool;cx.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};m.prototype.inlined_insert=function(ed,ec){var eb;if(cx.zpp_pool==null){eb=new cx()}else{eb=cx.zpp_pool;cx.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};m.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cx.zpp_pool;cx.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};m.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cx.zpp_pool;cx.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};m.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};m.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};m.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=cx.zpp_pool;cx.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};m.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};m.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=cx.zpp_pool;cx.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};m.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=cx.zpp_pool;cx.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};m.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=cx.zpp_pool;cx.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};m.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=cx.zpp_pool;cx.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};m.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};m.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cx.zpp_pool;cx.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};m.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cx.zpp_pool;cx.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};m.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};m.prototype.empty=function(){return this.head==null};m.prototype.size=function(){return this.length};m.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};m.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};m.prototype.front=function(){return this.head.elt};m.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};m.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};m.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};m.prototype.__class__=m;var bn=zpp_nape.util.ZNPList_ZPP_Interactor=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};bn.__name__=["zpp_nape","util","ZNPList_ZPP_Interactor"];bn.prototype.head=null;bn.prototype.begin=function(){return this.head};bn.prototype.modified=null;bn.prototype.pushmod=null;bn.prototype.length=null;bn.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};bn.prototype.add=function(ec){var eb;if(g.zpp_pool==null){eb=new g()}else{eb=g.zpp_pool;g.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};bn.prototype.inlined_add=function(ec){var eb;if(g.zpp_pool==null){eb=new g()}else{eb=g.zpp_pool;g.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};bn.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};bn.prototype.insert=function(ed,ec){var eb;if(g.zpp_pool==null){eb=new g()}else{eb=g.zpp_pool;g.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};bn.prototype.inlined_insert=function(ed,ec){var eb;if(g.zpp_pool==null){eb=new g()}else{eb=g.zpp_pool;g.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};bn.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=g.zpp_pool;g.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};bn.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=g.zpp_pool;g.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};bn.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};bn.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};bn.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=g.zpp_pool;g.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};bn.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};bn.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=g.zpp_pool;g.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};bn.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=g.zpp_pool;g.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};bn.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=g.zpp_pool;g.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};bn.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=g.zpp_pool;g.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};bn.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};bn.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=g.zpp_pool;g.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};bn.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=g.zpp_pool;g.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};bn.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};bn.prototype.empty=function(){return this.head==null};bn.prototype.size=function(){return this.length};bn.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};bn.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};bn.prototype.front=function(){return this.head.elt};bn.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};bn.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};bn.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};bn.prototype.__class__=bn;var af=zpp_nape.util.ZNPList_ZPP_CbSet=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};af.__name__=["zpp_nape","util","ZNPList_ZPP_CbSet"];af.prototype.head=null;af.prototype.begin=function(){return this.head};af.prototype.modified=null;af.prototype.pushmod=null;af.prototype.length=null;af.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};af.prototype.add=function(ec){var eb;if(cO.zpp_pool==null){eb=new cO()}else{eb=cO.zpp_pool;cO.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};af.prototype.inlined_add=function(ec){var eb;if(cO.zpp_pool==null){eb=new cO()}else{eb=cO.zpp_pool;cO.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};af.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};af.prototype.insert=function(ed,ec){var eb;if(cO.zpp_pool==null){eb=new cO()}else{eb=cO.zpp_pool;cO.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};af.prototype.inlined_insert=function(ed,ec){var eb;if(cO.zpp_pool==null){eb=new cO()}else{eb=cO.zpp_pool;cO.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};af.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cO.zpp_pool;cO.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};af.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cO.zpp_pool;cO.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};af.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};af.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};af.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=cO.zpp_pool;cO.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};af.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};af.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=cO.zpp_pool;cO.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};af.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=cO.zpp_pool;cO.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};af.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=cO.zpp_pool;cO.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};af.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=cO.zpp_pool;cO.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};af.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};af.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cO.zpp_pool;cO.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};af.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=cO.zpp_pool;cO.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};af.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};af.prototype.empty=function(){return this.head==null};af.prototype.size=function(){return this.length};af.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};af.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};af.prototype.front=function(){return this.head.elt};af.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};af.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};af.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};af.prototype.__class__=af;var db=zpp_nape.callbacks.ZPP_CbType=function(){this.conlisteners=null;this.bodylisteners=null;this.listeners=null;this.cbsets=null;this.id=0;this.userData=null;this.outer=null;this.id=cr.CbType();this.listeners=new cp();this.bodylisteners=new bh();this.conlisteners=new cY();this.constraints=new m();this.interactors=new bn();this.cbsets=new af()};db.__name__=["zpp_nape","callbacks","ZPP_CbType"];db.setlt=function(eb,ea){return eb.id<ea.id};db.prototype.outer=null;db.prototype.userData=null;db.prototype.id=null;db.prototype.cbsets=null;db.prototype.interactors=null;db.prototype.wrap_interactors=null;db.prototype.constraints=null;db.prototype.wrap_constraints=null;db.prototype.addConstraint=function(ea){this.constraints.add(ea)};db.prototype.addInteractor=function(ea){this.interactors.add(ea)};db.prototype.remConstraint=function(ea){this.constraints.remove(ea)};db.prototype.remInteractor=function(ea){this.interactors.remove(ea)};db.prototype.listeners=null;db.prototype.addint=function(eg){var ec=null;var ea=this.listeners.head;while(ea!=null){var ed=ea.elt;if(eg.precedence>ed.precedence||eg.precedence==ed.precedence&&eg.id>ed.id){break}ec=ea;ea=ea.next}var ee=this.listeners;var ef;if(aF.zpp_pool==null){ef=new aF()}else{ef=aF.zpp_pool;aF.zpp_pool=ef.next;ef.next=null}ef.elt=eg;var ei=ef;if(ec==null){ei.next=ee.head;ee.head=ei}else{ei.next=ec.next;ec.next=ei}ee.pushmod=ee.modified=true;ee.length++;var eh=this.cbsets.head;while(eh!=null){var eb=eh.elt;eb.zip_listeners=true;eb.invalidate_pairs();eh=eh.next}};db.prototype.removeint=function(eb){this.listeners.remove(eb);var ec=this.cbsets.head;while(ec!=null){var ea=ec.elt;ea.zip_listeners=true;ea.invalidate_pairs();ec=ec.next}};db.prototype.invalidateint=function(){var eb=this.cbsets.head;while(eb!=null){var ea=eb.elt;ea.zip_listeners=true;ea.invalidate_pairs();eb=eb.next}};db.prototype.bodylisteners=null;db.prototype.addbody=function(ea){var eg=null;var ee=this.bodylisteners.head;while(ee!=null){var ed=ee.elt;if(ea.precedence>ed.precedence||ea.precedence==ed.precedence&&ea.id>ed.id){break}eg=ee;ee=ee.next}var eh=this.bodylisteners;var ec;if(aT.zpp_pool==null){ec=new aT()}else{ec=aT.zpp_pool;aT.zpp_pool=ec.next;ec.next=null}ec.elt=ea;var eb=ec;if(eg==null){eb.next=eh.head;eh.head=eb}else{eb.next=eg.next;eg.next=eb}eh.pushmod=eh.modified=true;eh.length++;var ef=this.cbsets.head;while(ef!=null){ef.elt.zip_bodylisteners=true;ef=ef.next}};db.prototype.removebody=function(ea){this.bodylisteners.remove(ea);var eb=this.cbsets.head;while(eb!=null){eb.elt.zip_bodylisteners=true;eb=eb.next}};db.prototype.invalidatebody=function(){var ea=this.cbsets.head;while(ea!=null){ea.elt.zip_bodylisteners=true;ea=ea.next}};db.prototype.conlisteners=null;db.prototype.addconstraint=function(ea){var eg=null;var ee=this.conlisteners.head;while(ee!=null){var ed=ee.elt;if(ea.precedence>ed.precedence||ea.precedence==ed.precedence&&ea.id>ed.id){break}eg=ee;ee=ee.next}var eh=this.conlisteners;var ec;if(aR.zpp_pool==null){ec=new aR()}else{ec=aR.zpp_pool;aR.zpp_pool=ec.next;ec.next=null}ec.elt=ea;var eb=ec;if(eg==null){eb.next=eh.head;eh.head=eb}else{eb.next=eg.next;eg.next=eb}eh.pushmod=eh.modified=true;eh.length++;var ef=this.cbsets.head;while(ef!=null){ef.elt.zip_conlisteners=true;ef=ef.next}};db.prototype.removeconstraint=function(ea){this.conlisteners.remove(ea);var eb=this.cbsets.head;while(eb!=null){eb.elt.zip_conlisteners=true;eb=eb.next}};db.prototype.invalidateconstraint=function(){var ea=this.cbsets.head;while(ea!=null){ea.elt.zip_conlisteners=true;ea=ea.next}};db.prototype.__class__=db;var br=zpp_nape.util.ZPP_Flags=function(){};br.__name__=["zpp_nape","util","ZPP_Flags"];br.GravMassMode_DEFAULT=null;br.GravMassMode_FIXED=null;br.GravMassMode_SCALED=null;br.InertiaMode_DEFAULT=null;br.InertiaMode_FIXED=null;br.MassMode_DEFAULT=null;br.MassMode_FIXED=null;br.BodyType_STATIC=null;br.BodyType_DYNAMIC=null;br.BodyType_KINEMATIC=null;br.ListenerType_BODY=null;br.PreFlag_ACCEPT=null;br.ListenerType_CONSTRAINT=null;br.PreFlag_IGNORE=null;br.ListenerType_INTERACTION=null;br.PreFlag_ACCEPT_ONCE=null;br.ListenerType_PRE=null;br.PreFlag_IGNORE_ONCE=null;br.CbEvent_BEGIN=null;br.InteractionType_COLLISION=null;br.CbEvent_ONGOING=null;br.InteractionType_SENSOR=null;br.CbEvent_END=null;br.InteractionType_FLUID=null;br.CbEvent_WAKE=null;br.InteractionType_ANY=null;br.CbEvent_SLEEP=null;br.CbEvent_BREAK=null;br.CbEvent_PRE=null;br.Winding_UNDEFINED=null;br.Winding_CLOCKWISE=null;br.Winding_ANTICLOCKWISE=null;br.ValidationResult_VALID=null;br.ValidationResult_DEGENERATE=null;br.ValidationResult_CONCAVE=null;br.ValidationResult_SELF_INTERSECTING=null;br.ShapeType_CIRCLE=null;br.ShapeType_POLYGON=null;br.Broadphase_DYNAMIC_AABB_TREE=null;br.Broadphase_SWEEP_AND_PRUNE=null;br.ArbiterType_COLLISION=null;br.ArbiterType_SENSOR=null;br.ArbiterType_FLUID=null;br.prototype.__class__=br;var cc=zpp_nape.callbacks.ZPP_Listener=function(){this.space=null;this.interaction=null;this.constraint=null;this.body=null;this.precedence=0;this.event=0;this.type=0;this.id=0;this.outer=null;this.id=cr.Listener()};cc.__name__=["zpp_nape","callbacks","ZPP_Listener"];cc.setlt=function(eb,ea){if(eb.precedence<=ea.precedence){if(eb.precedence==ea.precedence){return eb.id>ea.id}else{return false}}else{return true}};cc.prototype.outer=null;cc.prototype.id=null;cc.prototype.type=null;cc.prototype.event=null;cc.prototype.precedence=null;cc.prototype.body=null;cc.prototype.constraint=null;cc.prototype.interaction=null;cc.prototype.space=null;cc.prototype.swapEvent=function(ea){};cc.prototype.invalidate_precedence=function(){};cc.prototype.addedToSpace=function(){};cc.prototype.removedFromSpace=function(){};cc.prototype.__class__=cc;var bW=zpp_nape.callbacks.ZPP_BodyListener=function(ea,ec,eb){this.handler=null;this.options=null;this.outer_zn=null;cc.call(this);this.event=ec;this.handler=eb;this.body=this;this.type=0;this.options=ea.zpp_inner};bW.__name__=["zpp_nape","callbacks","ZPP_BodyListener"];bW.__super__=cc;bW.prototype=Object.create(cc.prototype);bW.prototype.outer_zn=null;bW.prototype.options=null;bW.prototype.handler=null;bW.prototype.addedToSpace=function(){this.options.handler=dX(this,this.cbtype_change);var ea=this.options.includes.head;while(ea!=null){var ec=ea.elt;var eb=null;var eh=ec.bodylisteners.head;while(eh!=null){var ed=eh.elt;if(this.precedence>ed.precedence||this.precedence==ed.precedence&&this.id>ed.id){break}eb=eh;eh=eh.next}var ee=ec.bodylisteners;var ef;if(aT.zpp_pool==null){ef=new aT()}else{ef=aT.zpp_pool;aT.zpp_pool=ef.next;ef.next=null}ef.elt=this;var ei=ef;if(eb==null){ei.next=ee.head;ee.head=ei}else{ei.next=eb.next;eb.next=ei}ee.pushmod=ee.modified=true;ee.length++;var eg=ec.cbsets.head;while(eg!=null){eg.elt.zip_bodylisteners=true;eg=eg.next}ea=ea.next}};bW.prototype.removedFromSpace=function(){var eb=this.options.includes.head;while(eb!=null){var ea=eb.elt;ea.bodylisteners.remove(this);var ec=ea.cbsets.head;while(ec!=null){ec.elt.zip_bodylisteners=true;ec=ec.next}eb=eb.next}this.options.handler=null};bW.prototype.cbtype_change=function(ee,ei,el){this.removedFromSpace();var ef=this.options;if(ei){if(el){var ed=null;var eb=ef.includes.head;while(eb!=null){if(ee.id<eb.elt.id){break}ed=eb;eb=eb.next}var ej=ef.includes;var eh;if(b.zpp_pool==null){eh=new b()}else{eh=b.zpp_pool;b.zpp_pool=eh.next;eh.next=null}eh.elt=ee;var en=eh;if(ed==null){en.next=ej.head;ej.head=en}else{en.next=ed.next;ed.next=en}ej.pushmod=ej.modified=true;ej.length++}else{ef.includes.remove(ee)}}else{if(el){var ec=null;var em=ef.excludes.head;while(em!=null){if(ee.id<em.elt.id){break}ec=em;em=em.next}var eg=ef.excludes;var ek;if(b.zpp_pool==null){ek=new b()}else{ek=b.zpp_pool;b.zpp_pool=ek.next;ek.next=null}ek.elt=ee;var ea=ek;if(ec==null){ea.next=eg.head;eg.head=ea}else{ea.next=ec.next;ec.next=ea}eg.pushmod=eg.modified=true;eg.length++}else{ef.excludes.remove(ee)}}this.addedToSpace()};bW.prototype.invalidate_precedence=function(){if(this.space!=null){this.removedFromSpace();this.addedToSpace()}};bW.prototype.swapEvent=function(ea){this.removedFromSpace();this.event=ea;this.addedToSpace()};bW.prototype.__class__=bW;var O=zpp_nape.callbacks.ZPP_ConstraintListener=function(ea,ec,eb){this.handler=null;this.options=null;this.outer_zn=null;cc.call(this);this.event=ec;this.handler=eb;this.constraint=this;this.type=1;this.options=ea.zpp_inner};O.__name__=["zpp_nape","callbacks","ZPP_ConstraintListener"];O.__super__=cc;O.prototype=Object.create(cc.prototype);O.prototype.outer_zn=null;O.prototype.options=null;O.prototype.handler=null;O.prototype.addedToSpace=function(){this.options.handler=dX(this,this.cbtype_change);var ea=this.options.includes.head;while(ea!=null){var ec=ea.elt;var eb=null;var eh=ec.conlisteners.head;while(eh!=null){var ed=eh.elt;if(this.precedence>ed.precedence||this.precedence==ed.precedence&&this.id>ed.id){break}eb=eh;eh=eh.next}var ee=ec.conlisteners;var ef;if(aR.zpp_pool==null){ef=new aR()}else{ef=aR.zpp_pool;aR.zpp_pool=ef.next;ef.next=null}ef.elt=this;var ei=ef;if(eb==null){ei.next=ee.head;ee.head=ei}else{ei.next=eb.next;eb.next=ei}ee.pushmod=ee.modified=true;ee.length++;var eg=ec.cbsets.head;while(eg!=null){eg.elt.zip_conlisteners=true;eg=eg.next}ea=ea.next}};O.prototype.removedFromSpace=function(){var eb=this.options.includes.head;while(eb!=null){var ea=eb.elt;ea.conlisteners.remove(this);var ec=ea.cbsets.head;while(ec!=null){ec.elt.zip_conlisteners=true;ec=ec.next}eb=eb.next}this.options.handler=null};O.prototype.cbtype_change=function(ee,ei,el){this.removedFromSpace();var ef=this.options;if(ei){if(el){var ed=null;var eb=ef.includes.head;while(eb!=null){if(ee.id<eb.elt.id){break}ed=eb;eb=eb.next}var ej=ef.includes;var eh;if(b.zpp_pool==null){eh=new b()}else{eh=b.zpp_pool;b.zpp_pool=eh.next;eh.next=null}eh.elt=ee;var en=eh;if(ed==null){en.next=ej.head;ej.head=en}else{en.next=ed.next;ed.next=en}ej.pushmod=ej.modified=true;ej.length++}else{ef.includes.remove(ee)}}else{if(el){var ec=null;var em=ef.excludes.head;while(em!=null){if(ee.id<em.elt.id){break}ec=em;em=em.next}var eg=ef.excludes;var ek;if(b.zpp_pool==null){ek=new b()}else{ek=b.zpp_pool;b.zpp_pool=ek.next;ek.next=null}ek.elt=ee;var ea=ek;if(ec==null){ea.next=eg.head;eg.head=ea}else{ea.next=ec.next;ec.next=ea}eg.pushmod=eg.modified=true;eg.length++}else{ef.excludes.remove(ee)}}this.addedToSpace()};O.prototype.invalidate_precedence=function(){if(this.space!=null){this.removedFromSpace();this.addedToSpace()}};O.prototype.swapEvent=function(ea){this.removedFromSpace();this.event=ea;this.addedToSpace()};O.prototype.__class__=O;var x=zpp_nape.util.ZNPList_ZPP_CbType=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};x.__name__=["zpp_nape","util","ZNPList_ZPP_CbType"];x.prototype.head=null;x.prototype.begin=function(){return this.head};x.prototype.modified=null;x.prototype.pushmod=null;x.prototype.length=null;x.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};x.prototype.add=function(ec){var eb;if(b.zpp_pool==null){eb=new b()}else{eb=b.zpp_pool;b.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};x.prototype.inlined_add=function(ec){var eb;if(b.zpp_pool==null){eb=new b()}else{eb=b.zpp_pool;b.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};x.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};x.prototype.insert=function(ed,ec){var eb;if(b.zpp_pool==null){eb=new b()}else{eb=b.zpp_pool;b.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};x.prototype.inlined_insert=function(ed,ec){var eb;if(b.zpp_pool==null){eb=new b()}else{eb=b.zpp_pool;b.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};x.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=b.zpp_pool;b.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};x.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=b.zpp_pool;b.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};x.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};x.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};x.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=b.zpp_pool;b.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};x.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};x.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=b.zpp_pool;b.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};x.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=b.zpp_pool;b.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};x.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=b.zpp_pool;b.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};x.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=b.zpp_pool;b.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};x.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};x.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=b.zpp_pool;b.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};x.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=b.zpp_pool;b.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};x.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};x.prototype.empty=function(){return this.head==null};x.prototype.size=function(){return this.length};x.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};x.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};x.prototype.front=function(){return this.head.elt};x.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};x.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};x.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};x.prototype.__class__=x;var c1=zpp_nape.callbacks.ZPP_InteractionListener=function(ed,ec,eb,ea){this.handlerp=null;this.pure=false;this.allowSleepingCallbacks=false;this.handleri=null;this.options2=null;this.options1=null;this.itype=0;this.outer_znp=null;this.outer_zni=null;cc.call(this);this.type=ea;this.interaction=this;this.event=eb;this.options1=ed.zpp_inner;this.options2=ec.zpp_inner;this.allowSleepingCallbacks=false};c1.__name__=["zpp_nape","callbacks","ZPP_InteractionListener"];c1.__super__=cc;c1.prototype=Object.create(cc.prototype);c1.prototype.outer_zni=null;c1.prototype.outer_znp=null;c1.prototype.itype=null;c1.prototype.options1=null;c1.prototype.options2=null;c1.prototype.handleri=null;c1.prototype.allowSleepingCallbacks=null;c1.prototype.pure=null;c1.prototype.handlerp=null;c1.prototype.setInteractionType=function(ea){this.itype=ea};c1.prototype.wake=function(){var ee=this.options1.includes.head;var ed=this.options2.includes.head;while(ee!=null&&ed!=null){var ec=ee.elt;var eb=ed.elt;if(ec==eb){var ea=ec.interactors.head;while(ea!=null){ea.elt.wake();ea=ea.next}ee=ee.next;ed=ed.next}else{if(ec.id<eb.id){var ei=ec.interactors.head;while(ei!=null){ei.elt.wake();ei=ei.next}ee=ee.next}else{var eh=eb.interactors.head;while(eh!=null){eh.elt.wake();eh=eh.next}ed=ed.next}}}while(ee!=null){var eg=ee.elt.interactors.head;while(eg!=null){eg.elt.wake();eg=eg.next}ee=ee.next}while(ed!=null){var ef=ed.elt.interactors.head;while(ef!=null){ef.elt.wake();ef=ef.next}ed=ed.next}};c1.prototype.CbSetset=function(em,ek,ej){var ed=c1.UCbSet;var ec=c1.VCbSet;var eb=c1.WCbSet;var eu=em.head;var ea=ek.head;while(eu!=null&&ea!=null){var ex=eu.elt;var ev=ea.elt;if(ex==ev){var ez;if(cO.zpp_pool==null){ez=new cO()}else{ez=cO.zpp_pool;cO.zpp_pool=ez.next;ez.next=null}ez.elt=ex;var et=ez;et.next=eb.head;eb.head=et;eb.modified=true;eb.length++;eu=eu.next;ea=ea.next}else{if(cC.setlt(ex,ev)){var eh;if(cO.zpp_pool==null){eh=new cO()}else{eh=cO.zpp_pool;cO.zpp_pool=eh.next;eh.next=null}eh.elt=ex;var eB=eh;eB.next=ed.head;ed.head=eB;ed.modified=true;ed.length++;eu=eu.next}else{var eg;if(cO.zpp_pool==null){eg=new cO()}else{eg=cO.zpp_pool;cO.zpp_pool=eg.next;eg.next=null}eg.elt=ev;var eA=eg;eA.next=ec.head;ec.head=eA;ec.modified=true;ec.length++;ea=ea.next}}}while(eu!=null){var eo=eu.elt;var ef;if(cO.zpp_pool==null){ef=new cO()}else{ef=cO.zpp_pool;cO.zpp_pool=ef.next;ef.next=null}ef.elt=eo;var ey=ef;ey.next=ed.head;ed.head=ey;ed.modified=true;ed.length++;eu=eu.next}while(ea!=null){var eq=ea.elt;var ee;if(cO.zpp_pool==null){ee=new cO()}else{ee=cO.zpp_pool;cO.zpp_pool=ee.next;ee.next=null}ee.elt=eq;var ew=ee;ew.next=ec.head;ec.head=ew;ec.modified=true;ec.length++;ea=ea.next}while(ed.head!=null){var ei=ed.pop_unsafe();var ep=ek.head;while(ep!=null){ej(ei,ep.elt);ep=ep.next}}while(ec.head!=null){var es=ec.pop_unsafe();var en=eb.head;while(en!=null){ej(es,en.elt);en=en.next}}while(eb.head!=null){var er=eb.pop_unsafe();ej(er,er);var el=eb.head;while(el!=null){ej(er,el.elt);el=el.next}}};c1.prototype.CbTypeset=function(em,ek,ej){var ed=c1.UCbType;var ec=c1.VCbType;var eb=c1.WCbType;var eu=em.head;var ea=ek.head;while(eu!=null&&ea!=null){var ex=eu.elt;var ev=ea.elt;if(ex==ev){var ez;if(b.zpp_pool==null){ez=new b()}else{ez=b.zpp_pool;b.zpp_pool=ez.next;ez.next=null}ez.elt=ex;var et=ez;et.next=eb.head;eb.head=et;eb.modified=true;eb.length++;eu=eu.next;ea=ea.next}else{if(ex.id<ev.id){var eh;if(b.zpp_pool==null){eh=new b()}else{eh=b.zpp_pool;b.zpp_pool=eh.next;eh.next=null}eh.elt=ex;var eB=eh;eB.next=ed.head;ed.head=eB;ed.modified=true;ed.length++;eu=eu.next}else{var eg;if(b.zpp_pool==null){eg=new b()}else{eg=b.zpp_pool;b.zpp_pool=eg.next;eg.next=null}eg.elt=ev;var eA=eg;eA.next=ec.head;ec.head=eA;ec.modified=true;ec.length++;ea=ea.next}}}while(eu!=null){var eo=eu.elt;var ef;if(b.zpp_pool==null){ef=new b()}else{ef=b.zpp_pool;b.zpp_pool=ef.next;ef.next=null}ef.elt=eo;var ey=ef;ey.next=ed.head;ed.head=ey;ed.modified=true;ed.length++;eu=eu.next}while(ea!=null){var eq=ea.elt;var ee;if(b.zpp_pool==null){ee=new b()}else{ee=b.zpp_pool;b.zpp_pool=ee.next;ee.next=null}ee.elt=eq;var ew=ee;ew.next=ec.head;ec.head=ew;ec.modified=true;ec.length++;ea=ea.next}while(ed.head!=null){var ei=ed.pop_unsafe();var ep=ek.head;while(ep!=null){ej(ei,ep.elt);ep=ep.next}}while(ec.head!=null){var es=ec.pop_unsafe();var en=eb.head;while(en!=null){ej(es,en.elt);en=en.next}}while(eb.head!=null){var er=eb.pop_unsafe();ej(er,er);var el=eb.head;while(el!=null){ej(er,el.elt);el=el.next}}};c1.prototype.with_uniquesets=function(gK){var f6=this;var gL;if(p.zpp_pool==null){gL=new p()}else{gL=p.zpp_pool;p.zpp_pool=gL.next;gL.next=null}gL.lt=ar.setlt;var ga=this.options2.includes;var f0=c1.UCbType;var fZ=c1.VCbType;var fY=c1.WCbType;var gw=this.options1.includes.head;var es=ga.head;while(gw!=null&&es!=null){var fM=gw.elt;var fK=es.elt;if(fM==fK){var e8;if(b.zpp_pool==null){e8=new b()}else{e8=b.zpp_pool;b.zpp_pool=e8.next;e8.next=null}e8.elt=fM;var fF=e8;fF.next=fY.head;fY.head=fF;fY.modified=true;fY.length++;gw=gw.next;es=es.next}else{if(fM.id<fK.id){var fX;if(b.zpp_pool==null){fX=new b()}else{fX=b.zpp_pool;b.zpp_pool=fX.next;fX.next=null}fX.elt=fM;var fc=fX;fc.next=f0.head;f0.head=fc;f0.modified=true;f0.length++;gw=gw.next}else{var fW;if(b.zpp_pool==null){fW=new b()}else{fW=b.zpp_pool;b.zpp_pool=fW.next;fW.next=null}fW.elt=fK;var fa=fW;fa.next=fZ.head;fZ.head=fa;fZ.modified=true;fZ.length++;es=es.next}}}while(gw!=null){var fI=gw.elt;var fV;if(b.zpp_pool==null){fV=new b()}else{fV=b.zpp_pool;b.zpp_pool=fV.next;fV.next=null}fV.elt=fI;var e9=fV;e9.next=f0.head;f0.head=e9;f0.modified=true;f0.length++;gw=gw.next}while(es!=null){var gq=es.elt;var fU;if(b.zpp_pool==null){fU=new b()}else{fU=b.zpp_pool;b.zpp_pool=fU.next;fU.next=null}fU.elt=gq;var e7=fU;e7.next=fZ.head;fZ.head=e7;fZ.modified=true;fZ.length++;es=es.next}while(f0.head!=null){var fH=f0.pop_unsafe();var eu=ga.head;while(eu!=null){var fp=eu.elt.cbsets;var gP=c1.UCbSet;var gz=c1.VCbSet;var gc=c1.WCbSet;var eh=fH.cbsets.head;var fT=fp.head;while(eh!=null&&fT!=null){var ed=eh.elt;var gJ=fT.elt;if(ed==gJ){var fS;if(cO.zpp_pool==null){fS=new cO()}else{fS=cO.zpp_pool;cO.zpp_pool=fS.next;fS.next=null}fS.elt=ed;var e6=fS;e6.next=gc.head;gc.head=e6;gc.modified=true;gc.length++;eh=eh.next;fT=fT.next}else{if(cC.setlt(ed,gJ)){var fQ;if(cO.zpp_pool==null){fQ=new cO()}else{fQ=cO.zpp_pool;cO.zpp_pool=fQ.next;fQ.next=null}fQ.elt=ed;var e5=fQ;e5.next=gP.head;gP.head=e5;gP.modified=true;gP.length++;eh=eh.next}else{var fO;if(cO.zpp_pool==null){fO=new cO()}else{fO=cO.zpp_pool;cO.zpp_pool=fO.next;fO.next=null}fO.elt=gJ;var e4=fO;e4.next=gz.head;gz.head=e4;gz.modified=true;gz.length++;fT=fT.next}}}while(eh!=null){var gp=eh.elt;var fL;if(cO.zpp_pool==null){fL=new cO()}else{fL=cO.zpp_pool;cO.zpp_pool=fL.next;fL.next=null}fL.elt=gp;var e3=fL;e3.next=gP.head;gP.head=e3;gP.modified=true;gP.length++;eh=eh.next}while(fT!=null){var go=fT.elt;var fJ;if(cO.zpp_pool==null){fJ=new cO()}else{fJ=cO.zpp_pool;cO.zpp_pool=fJ.next;fJ.next=null}fJ.elt=go;var e2=fJ;e2.next=gz.head;gz.head=e2;gz.modified=true;gz.length++;fT=fT.next}while(gP.head!=null){var eC=gP.pop_unsafe();var eL=fp.head;while(eL!=null){var fG=eL.elt;eC.validate();fG.validate();if(cC.single_intersection(eC,fG,f6)){var fE;if(ar.zpp_pool==null){fE=new ar()}else{fE=ar.zpp_pool;ar.zpp_pool=fE.next;fE.next=null}fE.zip_listeners=true;if(cC.setlt(eC,fG)){fE.a=eC;fE.b=fG}else{fE.a=fG;fE.b=eC}gL.try_insert(fE)}eL=eL.next}}while(gz.head!=null){var eB=gz.pop_unsafe();var eK=gc.head;while(eK!=null){var eq=eK.elt;eB.validate();eq.validate();if(cC.single_intersection(eB,eq,f6)){var fD;if(ar.zpp_pool==null){fD=new ar()}else{fD=ar.zpp_pool;ar.zpp_pool=fD.next;fD.next=null}fD.zip_listeners=true;if(cC.setlt(eB,eq)){fD.a=eB;fD.b=eq}else{fD.a=eq;fD.b=eB}gL.try_insert(fD)}eK=eK.next}}while(gc.head!=null){var eA=gc.pop_unsafe();eA.validate();eA.validate();if(cC.single_intersection(eA,eA,f6)){var fC;if(ar.zpp_pool==null){fC=new ar()}else{fC=ar.zpp_pool;ar.zpp_pool=fC.next;fC.next=null}fC.zip_listeners=true;if(cC.setlt(eA,eA)){fC.a=eA;fC.b=eA}else{fC.a=eA;fC.b=eA}gL.try_insert(fC)}var eJ=gc.head;while(eJ!=null){var ep=eJ.elt;eA.validate();ep.validate();if(cC.single_intersection(eA,ep,f6)){var fB;if(ar.zpp_pool==null){fB=new ar()}else{fB=ar.zpp_pool;ar.zpp_pool=fB.next;fB.next=null}fB.zip_listeners=true;if(cC.setlt(eA,ep)){fB.a=eA;fB.b=ep}else{fB.a=ep;fB.b=eA}gL.try_insert(fB)}eJ=eJ.next}}eu=eu.next}}while(fZ.head!=null){var ez=fZ.pop_unsafe();var eI=fY.head;while(eI!=null){var fo=eI.elt.cbsets;var gO=c1.UCbSet;var gx=c1.VCbSet;var gb=c1.WCbSet;var eg=ez.cbsets.head;var fR=fo.head;while(eg!=null&&fR!=null){var ec=eg.elt;var gI=fR.elt;if(ec==gI){var fA;if(cO.zpp_pool==null){fA=new cO()}else{fA=cO.zpp_pool;cO.zpp_pool=fA.next;fA.next=null}fA.elt=ec;var gF=fA;gF.next=gb.head;gb.head=gF;gb.modified=true;gb.length++;eg=eg.next;fR=fR.next}else{if(cC.setlt(ec,gI)){var fz;if(cO.zpp_pool==null){fz=new cO()}else{fz=cO.zpp_pool;cO.zpp_pool=fz.next;fz.next=null}fz.elt=ec;var gE=fz;gE.next=gO.head;gO.head=gE;gO.modified=true;gO.length++;eg=eg.next}else{var fy;if(cO.zpp_pool==null){fy=new cO()}else{fy=cO.zpp_pool;cO.zpp_pool=fy.next;fy.next=null}fy.elt=gI;var gD=fy;gD.next=gx.head;gx.head=gD;gx.modified=true;gx.length++;fR=fR.next}}}while(eg!=null){var gn=eg.elt;var fx;if(cO.zpp_pool==null){fx=new cO()}else{fx=cO.zpp_pool;cO.zpp_pool=fx.next;fx.next=null}fx.elt=gn;var gC=fx;gC.next=gO.head;gO.head=gC;gO.modified=true;gO.length++;eg=eg.next}while(fR!=null){var gm=fR.elt;var fw;if(cO.zpp_pool==null){fw=new cO()}else{fw=cO.zpp_pool;cO.zpp_pool=fw.next;fw.next=null}fw.elt=gm;var gB=fw;gB.next=gx.head;gx.head=gB;gx.modified=true;gx.length++;fR=fR.next}while(gO.head!=null){var ey=gO.pop_unsafe();var eH=fo.head;while(eH!=null){var eo=eH.elt;ey.validate();eo.validate();if(cC.single_intersection(ey,eo,f6)){var fv;if(ar.zpp_pool==null){fv=new ar()}else{fv=ar.zpp_pool;ar.zpp_pool=fv.next;fv.next=null}fv.zip_listeners=true;if(cC.setlt(ey,eo)){fv.a=ey;fv.b=eo}else{fv.a=eo;fv.b=ey}gL.try_insert(fv)}eH=eH.next}}while(gx.head!=null){var ex=gx.pop_unsafe();var eG=gb.head;while(eG!=null){var en=eG.elt;ex.validate();en.validate();if(cC.single_intersection(ex,en,f6)){var fl;if(ar.zpp_pool==null){fl=new ar()}else{fl=ar.zpp_pool;ar.zpp_pool=fl.next;fl.next=null}fl.zip_listeners=true;if(cC.setlt(ex,en)){fl.a=ex;fl.b=en}else{fl.a=en;fl.b=ex}gL.try_insert(fl)}eG=eG.next}}while(gb.head!=null){var ew=gb.pop_unsafe();ew.validate();ew.validate();if(cC.single_intersection(ew,ew,f6)){var fk;if(ar.zpp_pool==null){fk=new ar()}else{fk=ar.zpp_pool;ar.zpp_pool=fk.next;fk.next=null}fk.zip_listeners=true;if(cC.setlt(ew,ew)){fk.a=ew;fk.b=ew}else{fk.a=ew;fk.b=ew}gL.try_insert(fk)}var eF=gb.head;while(eF!=null){var em=eF.elt;ew.validate();em.validate();if(cC.single_intersection(ew,em,f6)){var fj;if(ar.zpp_pool==null){fj=new ar()}else{fj=ar.zpp_pool;ar.zpp_pool=fj.next;fj.next=null}fj.zip_listeners=true;if(cC.setlt(ew,em)){fj.a=ew;fj.b=em}else{fj.a=em;fj.b=ew}gL.try_insert(fj)}eF=eF.next}}eI=eI.next}}while(fY.head!=null){var ev=fY.pop_unsafe();var fn=ev.cbsets;var gN=c1.UCbSet;var gu=c1.VCbSet;var f8=c1.WCbSet;var ef=ev.cbsets.head;var fP=fn.head;while(ef!=null&&fP!=null){var eb=ef.elt;var gH=fP.elt;if(eb==gH){var fi;if(cO.zpp_pool==null){fi=new cO()}else{fi=cO.zpp_pool;cO.zpp_pool=fi.next;fi.next=null}fi.elt=eb;var gA=fi;gA.next=f8.head;f8.head=gA;f8.modified=true;f8.length++;ef=ef.next;fP=fP.next}else{if(cC.setlt(eb,gH)){var fh;if(cO.zpp_pool==null){fh=new cO()}else{fh=cO.zpp_pool;cO.zpp_pool=fh.next;fh.next=null}fh.elt=eb;var gy=fh;gy.next=gN.head;gN.head=gy;gN.modified=true;gN.length++;ef=ef.next}else{var fg;if(cO.zpp_pool==null){fg=new cO()}else{fg=cO.zpp_pool;cO.zpp_pool=fg.next;fg.next=null}fg.elt=gH;var gv=fg;gv.next=gu.head;gu.head=gv;gu.modified=true;gu.length++;fP=fP.next}}}while(ef!=null){var gl=ef.elt;var ff;if(cO.zpp_pool==null){ff=new cO()}else{ff=cO.zpp_pool;cO.zpp_pool=ff.next;ff.next=null}ff.elt=gl;var gt=ff;gt.next=gN.head;gN.head=gt;gN.modified=true;gN.length++;ef=ef.next}while(fP!=null){var gk=fP.elt;var fe;if(cO.zpp_pool==null){fe=new cO()}else{fe=cO.zpp_pool;cO.zpp_pool=fe.next;fe.next=null}fe.elt=gk;var gr=fe;gr.next=gu.head;gu.head=gr;gu.modified=true;gu.length++;fP=fP.next}while(gN.head!=null){var et=gN.pop_unsafe();var eE=fn.head;while(eE!=null){var el=eE.elt;et.validate();el.validate();if(cC.single_intersection(et,el,f6)){var fd;if(ar.zpp_pool==null){fd=new ar()}else{fd=ar.zpp_pool;ar.zpp_pool=fd.next;fd.next=null}fd.zip_listeners=true;if(cC.setlt(et,el)){fd.a=et;fd.b=el}else{fd.a=el;fd.b=et}gL.try_insert(fd)}eE=eE.next}}while(gu.head!=null){var f5=gu.pop_unsafe();var eD=f8.head;while(eD!=null){var ek=eD.elt;f5.validate();ek.validate();if(cC.single_intersection(f5,ek,f6)){var fb;if(ar.zpp_pool==null){fb=new ar()}else{fb=ar.zpp_pool;ar.zpp_pool=fb.next;fb.next=null}fb.zip_listeners=true;if(cC.setlt(f5,ek)){fb.a=f5;fb.b=ek}else{fb.a=ek;fb.b=f5}gL.try_insert(fb)}eD=eD.next}}while(f8.head!=null){var f4=f8.pop_unsafe();f4.validate();f4.validate();if(cC.single_intersection(f4,f4,f6)){var e1;if(ar.zpp_pool==null){e1=new ar()}else{e1=ar.zpp_pool;ar.zpp_pool=e1.next;e1.next=null}e1.zip_listeners=true;if(cC.setlt(f4,f4)){e1.a=f4;e1.b=f4}else{e1.a=f4;e1.b=f4}gL.try_insert(e1)}var fu=f8.head;while(fu!=null){var ej=fu.elt;f4.validate();ej.validate();if(cC.single_intersection(f4,ej,f6)){var e0;if(ar.zpp_pool==null){e0=new ar()}else{e0=ar.zpp_pool;ar.zpp_pool=e0.next;e0.next=null}e0.zip_listeners=true;if(cC.setlt(f4,ej)){e0.a=f4;e0.b=ej}else{e0.a=ej;e0.b=f4}gL.try_insert(e0)}fu=fu.next}}var ft=fY.head;while(ft!=null){var fm=ft.elt.cbsets;var gM=c1.UCbSet;var gs=c1.VCbSet;var f7=c1.WCbSet;var ee=ev.cbsets.head;var fN=fm.head;while(ee!=null&&fN!=null){var ea=ee.elt;var gG=fN.elt;if(ea==gG){var eZ;if(cO.zpp_pool==null){eZ=new cO()}else{eZ=cO.zpp_pool;cO.zpp_pool=eZ.next;eZ.next=null}eZ.elt=ea;var gh=eZ;gh.next=f7.head;f7.head=gh;f7.modified=true;f7.length++;ee=ee.next;fN=fN.next}else{if(cC.setlt(ea,gG)){var eY;if(cO.zpp_pool==null){eY=new cO()}else{eY=cO.zpp_pool;cO.zpp_pool=eY.next;eY.next=null}eY.elt=ea;var gg=eY;gg.next=gM.head;gM.head=gg;gM.modified=true;gM.length++;ee=ee.next}else{var eX;if(cO.zpp_pool==null){eX=new cO()}else{eX=cO.zpp_pool;cO.zpp_pool=eX.next;eX.next=null}eX.elt=gG;var gf=eX;gf.next=gs.head;gs.head=gf;gs.modified=true;gs.length++;fN=fN.next}}}while(ee!=null){var gj=ee.elt;var eW;if(cO.zpp_pool==null){eW=new cO()}else{eW=cO.zpp_pool;cO.zpp_pool=eW.next;eW.next=null}eW.elt=gj;var ge=eW;ge.next=gM.head;gM.head=ge;gM.modified=true;gM.length++;ee=ee.next}while(fN!=null){var gi=fN.elt;var eV;if(cO.zpp_pool==null){eV=new cO()}else{eV=cO.zpp_pool;cO.zpp_pool=eV.next;eV.next=null}eV.elt=gi;var gd=eV;gd.next=gs.head;gs.head=gd;gs.modified=true;gs.length++;fN=fN.next}while(gM.head!=null){var f3=gM.pop_unsafe();var fs=fm.head;while(fs!=null){var ei=fs.elt;f3.validate();ei.validate();if(cC.single_intersection(f3,ei,f6)){var eU;if(ar.zpp_pool==null){eU=new ar()}else{eU=ar.zpp_pool;ar.zpp_pool=eU.next;eU.next=null}eU.zip_listeners=true;if(cC.setlt(f3,ei)){eU.a=f3;eU.b=ei}else{eU.a=ei;eU.b=f3}gL.try_insert(eU)}fs=fs.next}}while(gs.head!=null){var f2=gs.pop_unsafe();var fr=f7.head;while(fr!=null){var eN=fr.elt;f2.validate();eN.validate();if(cC.single_intersection(f2,eN,f6)){var eT;if(ar.zpp_pool==null){eT=new ar()}else{eT=ar.zpp_pool;ar.zpp_pool=eT.next;eT.next=null}eT.zip_listeners=true;if(cC.setlt(f2,eN)){eT.a=f2;eT.b=eN}else{eT.a=eN;eT.b=f2}gL.try_insert(eT)}fr=fr.next}}while(f7.head!=null){var f1=f7.pop_unsafe();f1.validate();f1.validate();if(cC.single_intersection(f1,f1,f6)){var eS;if(ar.zpp_pool==null){eS=new ar()}else{eS=ar.zpp_pool;ar.zpp_pool=eS.next;eS.next=null}eS.zip_listeners=true;if(cC.setlt(f1,f1)){eS.a=f1;eS.b=f1}else{eS.a=f1;eS.b=f1}gL.try_insert(eS)}var fq=f7.head;while(fq!=null){var eM=fq.elt;f1.validate();eM.validate();if(cC.single_intersection(f1,eM,f6)){var eP;if(ar.zpp_pool==null){eP=new ar()}else{eP=ar.zpp_pool;ar.zpp_pool=eP.next;eP.next=null}eP.zip_listeners=true;if(cC.setlt(f1,eM)){eP.a=f1;eP.b=eM}else{eP.a=eM;eP.b=f1}gL.try_insert(eP)}fq=fq.next}}ft=ft.next}}if(gL.parent!=null){var f9=gL.parent;while(f9!=null){if(f9.prev!=null){f9=f9.prev}else{if(f9.next!=null){f9=f9.next}else{var er=f9.data;if(gK){f6.space.freshListenerType(er.a,er.b)}else{f6.space.nullListenerType(er.a,er.b)}er.a=er.b=null;er.listeners.clear();er.next=ar.zpp_pool;ar.zpp_pool=er;var eO=f9.parent;if(eO!=null){if(f9==eO.prev){eO.prev=null}else{eO.next=null}f9.parent=null}var eR=f9;eR.data=null;eR.lt=null;eR.swapped=null;eR.next=p.zpp_pool;p.zpp_pool=eR;f9=eO}}}gL.parent=null}var eQ=gL;eQ.data=null;eQ.lt=null;eQ.swapped=null;eQ.next=p.zpp_pool;p.zpp_pool=eQ};c1.prototype.with_union=function(ec){var ea=this.options1.includes.head;var ee=this.options2.includes.head;while(ea!=null&&ee!=null){var ed=ea.elt;var eb=ee.elt;if(ed==eb){ec(ed);ea=ea.next;ee=ee.next}else{if(ed.id<eb.id){ec(ed);ea=ea.next}else{ec(eb);ee=ee.next}}}while(ea!=null){ec(ea.elt);ea=ea.next}while(ee!=null){ec(ee.elt);ee=ee.next}};c1.prototype.addedToSpace=function(){var eV=this;var eN=this.type==3;var el=this.options1.includes.head;var ek=this.options2.includes.head;while(el!=null&&ek!=null){var eg=el.elt;var ef=ek.elt;if(eg==ef){var es=null;var ej=eg.listeners.head;while(ej!=null){var eS=ej.elt;if(eV.precedence>eS.precedence||eV.precedence==eS.precedence&&eV.id>eS.id){break}es=ej;ej=ej.next}var eh=eg.listeners;var eA;if(aF.zpp_pool==null){eA=new aF()}else{eA=aF.zpp_pool;aF.zpp_pool=eA.next;eA.next=null}eA.elt=eV;var ei=eA;if(es==null){ei.next=eh.head;eh.head=ei}else{ei.next=es.next;es.next=ei}eh.pushmod=eh.modified=true;eh.length++;var ez=eg.cbsets.head;while(ez!=null){var eB=ez.elt;eB.zip_listeners=true;eB.invalidate_pairs();ez=ez.next}if(eN){var ey=eg.interactors.head;while(ey!=null){ey.elt.wake();ey=ey.next}}el=el.next;ek=ek.next}else{if(eg.id<ef.id){var eq=null;var ex=eg.listeners.head;while(ex!=null){var eU=ex.elt;if(eV.precedence>eU.precedence||eV.precedence==eU.precedence&&eV.id>eU.id){break}eq=ex;ex=ex.next}var eP=eg.listeners;var eG;if(aF.zpp_pool==null){eG=new aF()}else{eG=aF.zpp_pool;aF.zpp_pool=eG.next;eG.next=null}eG.elt=eV;var ee=eG;if(eq==null){ee.next=eP.head;eP.head=ee}else{ee.next=eq.next;eq.next=ee}eP.pushmod=eP.modified=true;eP.length++;var ew=eg.cbsets.head;while(ew!=null){var ed=ew.elt;ed.zip_listeners=true;ed.invalidate_pairs();ew=ew.next}if(eN){var ev=eg.interactors.head;while(ev!=null){ev.elt.wake();ev=ev.next}}el=el.next}else{var eo=null;var eu=ef.listeners.head;while(eu!=null){var eT=eu.elt;if(eV.precedence>eT.precedence||eV.precedence==eT.precedence&&eV.id>eT.id){break}eo=eu;eu=eu.next}var eM=ef.listeners;var eE;if(aF.zpp_pool==null){eE=new aF()}else{eE=aF.zpp_pool;aF.zpp_pool=eE.next;eE.next=null}eE.elt=eV;var ec=eE;if(eo==null){ec.next=eM.head;eM.head=ec}else{ec.next=eo.next;eo.next=ec}eM.pushmod=eM.modified=true;eM.length++;var et=ef.cbsets.head;while(et!=null){var eb=et.elt;eb.zip_listeners=true;eb.invalidate_pairs();et=et.next}if(eN){var er=ef.interactors.head;while(er!=null){er.elt.wake();er=er.next}}ek=ek.next}}}while(el!=null){var e0=el.elt;var en=null;var ep=e0.listeners.head;while(ep!=null){var eR=ep.elt;if(eV.precedence>eR.precedence||eV.precedence==eR.precedence&&eV.id>eR.id){break}en=ep;ep=ep.next}var eK=e0.listeners;var eD;if(aF.zpp_pool==null){eD=new aF()}else{eD=aF.zpp_pool;aF.zpp_pool=eD.next;eD.next=null}eD.elt=eV;var ea=eD;if(en==null){ea.next=eK.head;eK.head=ea}else{ea.next=en.next;en.next=ea}eK.pushmod=eK.modified=true;eK.length++;var eO=e0.cbsets.head;while(eO!=null){var eY=eO.elt;eY.zip_listeners=true;eY.invalidate_pairs();eO=eO.next}if(eN){var eL=e0.interactors.head;while(eL!=null){eL.elt.wake();eL=eL.next}}el=el.next}while(ek!=null){var eX=ek.elt;var em=null;var eJ=eX.listeners.head;while(eJ!=null){var eQ=eJ.elt;if(eV.precedence>eQ.precedence||eV.precedence==eQ.precedence&&eV.id>eQ.id){break}em=eJ;eJ=eJ.next}var eI=eX.listeners;var eC;if(aF.zpp_pool==null){eC=new aF()}else{eC=aF.zpp_pool;aF.zpp_pool=eC.next;eC.next=null}eC.elt=eV;var eZ=eC;if(em==null){eZ.next=eI.head;eI.head=eZ}else{eZ.next=em.next;em.next=eZ}eI.pushmod=eI.modified=true;eI.length++;var eH=eX.cbsets.head;while(eH!=null){var eW=eH.elt;eW.zip_listeners=true;eW.invalidate_pairs();eH=eH.next}if(eN){var eF=eX.interactors.head;while(eF!=null){eF.elt.wake();eF=eF.next}}ek=ek.next}this.options1.handler=dX(this,this.cbtype_change1);this.options2.handler=dX(this,this.cbtype_change2);this.with_uniquesets(true)};c1.prototype.removedFromSpace=function(){var eg=this;this.with_uniquesets(false);var eq=this.type==3;var ef=this.options1.includes.head;var ee=this.options2.includes.head;while(ef!=null&&ee!=null){var ed=ef.elt;var ec=ee.elt;if(ed==ec){ed.listeners.remove(eg);var es=ed.cbsets.head;while(es!=null){var ep=es.elt;ep.zip_listeners=true;ep.invalidate_pairs();es=es.next}if(eq){var er=ed.interactors.head;while(er!=null){er.elt.wake();er=er.next}}ef=ef.next;ee=ee.next}else{if(ed.id<ec.id){ed.listeners.remove(eg);var eo=ed.cbsets.head;while(eo!=null){var eb=eo.elt;eb.zip_listeners=true;eb.invalidate_pairs();eo=eo.next}if(eq){var en=ed.interactors.head;while(en!=null){en.elt.wake();en=en.next}}ef=ef.next}else{ec.listeners.remove(eg);var em=ec.cbsets.head;while(em!=null){var ea=em.elt;ea.zip_listeners=true;ea.invalidate_pairs();em=em.next}if(eq){var el=ec.interactors.head;while(el!=null){el.elt.wake();el=el.next}}ee=ee.next}}}while(ef!=null){var ew=ef.elt;ew.listeners.remove(eg);var ek=ew.cbsets.head;while(ek!=null){var ev=ek.elt;ev.zip_listeners=true;ev.invalidate_pairs();ek=ek.next}if(eq){var ej=ew.interactors.head;while(ej!=null){ej.elt.wake();ej=ej.next}}ef=ef.next}while(ee!=null){var eu=ee.elt;eu.listeners.remove(eg);var ei=eu.cbsets.head;while(ei!=null){var et=ei.elt;et.zip_listeners=true;et.invalidate_pairs();ei=ei.next}if(eq){var eh=eu.interactors.head;while(eh!=null){eh.elt.wake();eh=eh.next}}ee=ee.next}this.options1.handler=null;this.options2.handler=null};c1.prototype.invalidate_precedence=function(){var e4=this;if(this.space!=null){var eT=this.type==3;var el=this.options1.includes.head;var ek=this.options2.includes.head;while(el!=null&&ek!=null){var eg=el.elt;var ef=ek.elt;if(eg==ef){eg.listeners.remove(e4);var ej=eg.cbsets.head;while(ej!=null){var eB=ej.elt;eB.zip_listeners=true;eB.invalidate_pairs();ej=ej.next}var es=null;var ez=eg.listeners.head;while(ez!=null){var e1=ez.elt;if(e4.precedence>e1.precedence||e4.precedence==e1.precedence&&e4.id>e1.id){break}es=ez;ez=ez.next}var eh=eg.listeners;var eA;if(aF.zpp_pool==null){eA=new aF()}else{eA=aF.zpp_pool;aF.zpp_pool=eA.next;eA.next=null}eA.elt=e4;var ei=eA;if(es==null){ei.next=eh.head;eh.head=ei}else{ei.next=es.next;es.next=ei}eh.pushmod=eh.modified=true;eh.length++;var ey=eg.cbsets.head;while(ey!=null){var ed=ey.elt;ed.zip_listeners=true;ed.invalidate_pairs();ey=ey.next}if(eT){var ex=eg.interactors.head;while(ex!=null){ex.elt.wake();ex=ex.next}}el=el.next;ek=ek.next}else{if(eg.id<ef.id){eg.listeners.remove(e4);var ew=eg.cbsets.head;while(ew!=null){var eb=ew.elt;eb.zip_listeners=true;eb.invalidate_pairs();ew=ew.next}var eq=null;var ev=eg.listeners.head;while(ev!=null){var e3=ev.elt;if(e4.precedence>e3.precedence||e4.precedence==e3.precedence&&e4.id>e3.id){break}eq=ev;ev=ev.next}var eW=eg.listeners;var eL;if(aF.zpp_pool==null){eL=new aF()}else{eL=aF.zpp_pool;aF.zpp_pool=eL.next;eL.next=null}eL.elt=e4;var ee=eL;if(eq==null){ee.next=eW.head;eW.head=ee}else{ee.next=eq.next;eq.next=ee}eW.pushmod=eW.modified=true;eW.length++;var eu=eg.cbsets.head;while(eu!=null){var fa=eu.elt;fa.zip_listeners=true;fa.invalidate_pairs();eu=eu.next}if(eT){var et=eg.interactors.head;while(et!=null){et.elt.wake();et=et.next}}el=el.next}else{ef.listeners.remove(e4);var er=ef.cbsets.head;while(er!=null){var e8=er.elt;e8.zip_listeners=true;e8.invalidate_pairs();er=er.next}var eo=null;var ep=ef.listeners.head;while(ep!=null){var e2=ep.elt;if(e4.precedence>e2.precedence||e4.precedence==e2.precedence&&e4.id>e2.id){break}eo=ep;ep=ep.next}var eS=ef.listeners;var eJ;if(aF.zpp_pool==null){eJ=new aF()}else{eJ=aF.zpp_pool;aF.zpp_pool=eJ.next;eJ.next=null}eJ.elt=e4;var ec=eJ;if(eo==null){ec.next=eS.head;eS.head=ec}else{ec.next=eo.next;eo.next=ec}eS.pushmod=eS.modified=true;eS.length++;var eV=ef.cbsets.head;while(eV!=null){var e7=eV.elt;e7.zip_listeners=true;e7.invalidate_pairs();eV=eV.next}if(eT){var eR=ef.interactors.head;while(eR!=null){eR.elt.wake();eR=eR.next}}ek=ek.next}}}while(el!=null){var e6=el.elt;e6.listeners.remove(e4);var eP=e6.cbsets.head;while(eP!=null){var e5=eP.elt;e5.zip_listeners=true;e5.invalidate_pairs();eP=eP.next}var en=null;var eN=e6.listeners.head;while(eN!=null){var e0=eN.elt;if(e4.precedence>e0.precedence||e4.precedence==e0.precedence&&e4.id>e0.id){break}en=eN;eN=eN.next}var eO=e6.listeners;var eH;if(aF.zpp_pool==null){eH=new aF()}else{eH=aF.zpp_pool;aF.zpp_pool=eH.next;eH.next=null}eH.elt=e4;var ea=eH;if(en==null){ea.next=eO.head;eO.head=ea}else{ea.next=en.next;en.next=ea}eO.pushmod=eO.modified=true;eO.length++;var eK=e6.cbsets.head;while(eK!=null){var eY=eK.elt;eY.zip_listeners=true;eY.invalidate_pairs();eK=eK.next}if(eT){var eI=e6.interactors.head;while(eI!=null){eI.elt.wake();eI=eI.next}}el=el.next}while(ek!=null){var eX=ek.elt;eX.listeners.remove(e4);var eG=eX.cbsets.head;while(eG!=null){var eU=eG.elt;eU.zip_listeners=true;eU.invalidate_pairs();eG=eG.next}var em=null;var eF=eX.listeners.head;while(eF!=null){var eZ=eF.elt;if(e4.precedence>eZ.precedence||e4.precedence==eZ.precedence&&e4.id>eZ.id){break}em=eF;eF=eF.next}var eM=eX.listeners;var eE;if(aF.zpp_pool==null){eE=new aF()}else{eE=aF.zpp_pool;aF.zpp_pool=eE.next;eE.next=null}eE.elt=e4;var e9=eE;if(em==null){e9.next=eM.head;eM.head=e9}else{e9.next=em.next;em.next=e9}eM.pushmod=eM.modified=true;eM.length++;var eD=eX.cbsets.head;while(eD!=null){var eQ=eD.elt;eQ.zip_listeners=true;eQ.invalidate_pairs();eD=eD.next}if(eT){var eC=eX.interactors.head;while(eC!=null){eC.elt.wake();eC=eC.next}}ek=ek.next}}};c1.prototype.cbtype_change1=function(ea,ec,eb){this.cbtype_change(this.options1,ea,ec,eb)};c1.prototype.cbtype_change2=function(ea,ec,eb){this.cbtype_change(this.options2,ea,ec,eb)};c1.prototype.cbtype_change=function(en,ee,ei,ek){this.removedFromSpace();if(ei){if(ek){var ed=null;var eb=en.includes.head;while(eb!=null){if(ee.id<eb.elt.id){break}ed=eb;eb=eb.next}var ef=en.includes;var eg;if(b.zpp_pool==null){eg=new b()}else{eg=b.zpp_pool;b.zpp_pool=eg.next;eg.next=null}eg.elt=ee;var em=eg;if(ed==null){em.next=ef.head;ef.head=em}else{em.next=ed.next;ed.next=em}ef.pushmod=ef.modified=true;ef.length++}else{en.includes.remove(ee)}}else{if(ek){var ec=null;var el=en.excludes.head;while(el!=null){if(ee.id<el.elt.id){break}ec=el;el=el.next}var eh=en.excludes;var ej;if(b.zpp_pool==null){ej=new b()}else{ej=b.zpp_pool;b.zpp_pool=ej.next;ej.next=null}ej.elt=ee;var ea=ej;if(ec==null){ea.next=eh.head;eh.head=ea}else{ea.next=ec.next;ec.next=ea}eh.pushmod=eh.modified=true;eh.length++}else{en.excludes.remove(ee)}}this.addedToSpace()};c1.prototype.swapEvent=function(ea){this.removedFromSpace();this.event=ea;this.addedToSpace()};c1.prototype.__class__=c1;var cP=zpp_nape.callbacks.ZPP_OptionType=function(){this.wrap_excludes=null;this.wrap_includes=null;this.excludes=null;this.includes=null;this.handler=null;this.outer=null;this.includes=new x();this.excludes=new x()};cP.__name__=["zpp_nape","callbacks","ZPP_OptionType"];cP.argument=function(ea){if(ea==null){return new R()}else{if(dc.__instanceof(ea,R)){return ea}else{return new R().including(ea)}}};cP.prototype.outer=null;cP.prototype.handler=null;cP.prototype.includes=null;cP.prototype.excludes=null;cP.prototype.wrap_includes=null;cP.prototype.wrap_excludes=null;cP.prototype.setup_includes=function(){this.wrap_includes=cy.get(this.includes,true)};cP.prototype.setup_excludes=function(){this.wrap_excludes=cy.get(this.excludes,true)};cP.prototype.excluded=function(ea){return this.nonemptyintersection(ea,this.excludes)};cP.prototype.included=function(ea){return this.nonemptyintersection(ea,this.includes)};cP.prototype.compatible=function(ea){if(this.nonemptyintersection(ea,this.includes)){return !this.nonemptyintersection(ea,this.excludes)}else{return false}};cP.prototype.nonemptyintersection=function(ed,ef){var ec=false;var eg=ed.head;var ea=ef.head;while(ea!=null&&eg!=null){var ee=ea.elt;var eb=eg.elt;if(ee==eb){ec=true;break}else{if(ee.id<eb.id){ea=ea.next}else{eg=eg.next}}}return ec};cP.prototype.effect_change=function(eb,ei,ek){if(ei){if(ek){var ee=null;var ec=this.includes.head;while(ec!=null){if(eb.id<ec.elt.id){break}ee=ec;ec=ec.next}var ef=this.includes;var eg;if(b.zpp_pool==null){eg=new b()}else{eg=b.zpp_pool;b.zpp_pool=eg.next;eg.next=null}eg.elt=eb;var em=eg;if(ee==null){em.next=ef.head;ef.head=em}else{em.next=ee.next;ee.next=em}ef.pushmod=ef.modified=true;ef.length++}else{this.includes.remove(eb)}}else{if(ek){var ed=null;var el=this.excludes.head;while(el!=null){if(eb.id<el.elt.id){break}ed=el;el=el.next}var eh=this.excludes;var ej;if(b.zpp_pool==null){ej=new b()}else{ej=b.zpp_pool;b.zpp_pool=ej.next;ej.next=null}ej.elt=eb;var ea=ej;if(ed==null){ea.next=eh.head;eh.head=ea}else{ea.next=ed.next;ed.next=ea}eh.pushmod=eh.modified=true;eh.length++}else{this.excludes.remove(eb)}}};cP.prototype.append_type=function(eg,eb){if(eg==this.includes){if(!this.includes.has(eb)){if(!this.excludes.has(eb)){if(this.handler!=null){this.handler(eb,true,true)}else{var ee=null;var ec=this.includes.head;while(ec!=null){if(eb.id<ec.elt.id){break}ee=ec;ec=ec.next}var ef=this.includes;var eh;if(b.zpp_pool==null){eh=new b()}else{eh=b.zpp_pool;b.zpp_pool=eh.next;eh.next=null}eh.elt=eb;var el=eh;if(ee==null){el.next=ef.head;ef.head=el}else{el.next=ee.next;ee.next=el}ef.pushmod=ef.modified=true;ef.length++}}else{if(this.handler!=null){this.handler(eb,false,false)}else{this.excludes.remove(eb)}}}}else{if(!this.excludes.has(eb)){if(!this.includes.has(eb)){if(this.handler!=null){this.handler(eb,false,true)}else{var ed=null;var ek=this.excludes.head;while(ek!=null){if(eb.id<ek.elt.id){break}ed=ek;ek=ek.next}var ei=this.excludes;var ej;if(b.zpp_pool==null){ej=new b()}else{ej=b.zpp_pool;b.zpp_pool=ej.next;ej.next=null}ej.elt=eb;var ea=ej;if(ed==null){ea.next=ei.head;ei.head=ea}else{ea.next=ed.next;ed.next=ea}ei.pushmod=ei.modified=true;ei.length++}}else{if(this.handler!=null){this.handler(eb,true,false)}else{this.includes.remove(eb)}}}}};cP.prototype.set=function(ea){if(ea!=this){while(this.includes.head!=null){this.append_type(this.excludes,this.includes.head.elt)}while(this.excludes.head!=null){this.append_type(this.includes,this.excludes.head.elt)}var eb=ea.excludes.head;while(eb!=null){this.append_type(this.excludes,eb.elt);eb=eb.next}var ec=ea.includes.head;while(ec!=null){this.append_type(this.includes,ec.elt);ec=ec.next}}return this};cP.prototype.append=function(ek,ec){if(dc.__instanceof(ec,dk)){var ee=ec;this.append_type(ek,ee.zpp_inner)}else{if(dc.__instanceof(ec,C)){var eh=ec;eh.zpp_inner.valmod();var ei=Y.get(eh);while(true){ei.zpp_inner.zpp_inner.valmod();var ej=ei.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var ea=ej.zpp_inner.user_length;ei.zpp_critical=true;var eg;if(ei.zpp_i<ea){eg=true}else{ei.zpp_next=Y.zpp_pool;Y.zpp_pool=ei;ei.zpp_inner=null;eg=false}if(!eg){break}ei.zpp_critical=false;this.append_type(ek,ei.zpp_inner.at(ei.zpp_i++).zpp_inner)}}else{if((ec instanceof Array)&&ec.__enum__==null){var ef=ec;var el=0;while(el<ef.length){var ed=ef[el];++el;var eb=ed;this.append_type(ek,eb.zpp_inner)}}}}};cP.prototype.__class__=cP;var b1=zpp_nape.constraint.ZPP_Constraint=function(){this.pre_dt=0;this.wrap_cbTypes=null;this.cbSet=null;this.cbTypes=null;this.__velocity=false;this.ignore=false;this.component=null;this.removeOnBreak=false;this.breakUnderError=false;this.breakUnderForce=false;this.maxError=0;this.maxForce=0;this.damping=0;this.frequency=0;this.stiff=false;this.active=false;this.space=null;this.compound=null;this.userData=null;this.id=0;this.outer=null;this.__velocity=false;this.id=cr.Constraint();this.stiff=true;this.active=true;this.ignore=false;this.frequency=10;this.damping=1;this.maxForce=Infinity;this.maxError=Infinity;this.breakUnderForce=false;this.removeOnBreak=true;this.pre_dt=-1;this.cbTypes=new x()};b1.__name__=["zpp_nape","constraint","ZPP_Constraint"];b1.prototype.outer=null;b1.prototype.clear=function(){};b1.prototype.id=null;b1.prototype.userData=null;b1.prototype.compound=null;b1.prototype.space=null;b1.prototype.active=null;b1.prototype.stiff=null;b1.prototype.frequency=null;b1.prototype.damping=null;b1.prototype.maxForce=null;b1.prototype.maxError=null;b1.prototype.breakUnderForce=null;b1.prototype.breakUnderError=null;b1.prototype.removeOnBreak=null;b1.prototype.component=null;b1.prototype.ignore=null;b1.prototype.__velocity=null;b1.prototype.immutable_midstep=function(ea){};b1.prototype.cbTypes=null;b1.prototype.cbSet=null;b1.prototype.wrap_cbTypes=null;b1.prototype.setupcbTypes=function(){this.wrap_cbTypes=cy.get(this.cbTypes);this.wrap_cbTypes.zpp_inner.adder=dX(this,this.wrap_cbTypes_adder);this.wrap_cbTypes.zpp_inner.subber=dX(this,this.wrap_cbTypes_subber);this.wrap_cbTypes.zpp_inner.dontremove=true};b1.prototype.wrap_cbTypes_subber=function(eb){var ea=eb.zpp_inner;if(this.cbTypes.has(ea)){if(this.space!=null){this.dealloc_cbSet();ea.constraints.remove(this)}this.cbTypes.remove(ea);if(this.space!=null){this.alloc_cbSet();this.wake()}}};b1.prototype.wrap_cbTypes_adder=function(ea){this.insert_cbtype(ea.zpp_inner);return false};b1.prototype.insert_cbtype=function(ea){if(!this.cbTypes.has(ea)){if(this.space!=null){this.dealloc_cbSet();ea.constraints.add(this)}var ee=null;var ed=this.cbTypes.head;while(ed!=null){if(ea.id<ed.elt.id){break}ee=ed;ed=ed.next}var ef=this.cbTypes;var ec;if(b.zpp_pool==null){ec=new b()}else{ec=b.zpp_pool;b.zpp_pool=ec.next;ec.next=null}ec.elt=ea;var eb=ec;if(ee==null){eb.next=ef.head;ef.head=eb}else{eb.next=ee.next;ee.next=eb}ef.pushmod=ef.modified=true;ef.length++;if(this.space!=null){this.alloc_cbSet();this.wake()}}};b1.prototype.alloc_cbSet=function(){if((this.cbSet=this.space.cbsets.get(this.cbTypes))!=null){this.cbSet.count++;this.cbSet.constraints.add(this)}};b1.prototype.dealloc_cbSet=function(){if(this.cbSet!=null){this.cbSet.constraints.remove(this);if(--this.cbSet.count==0){this.space.cbsets.remove(this.cbSet);var ea=this.cbSet;ea.listeners.clear();ea.zip_listeners=true;ea.bodylisteners.clear();ea.zip_bodylisteners=true;ea.conlisteners.clear();ea.zip_conlisteners=true;while(ea.cbTypes.head!=null){ea.cbTypes.pop_unsafe().cbsets.remove(ea)}ea.next=cC.zpp_pool;cC.zpp_pool=ea}this.cbSet=null}};b1.prototype.activate=function(){if(this.space!=null){this.activeInSpace()}};b1.prototype.deactivate=function(){if(this.space!=null){this.inactiveOrOutSpace()}};b1.prototype.addedToSpace=function(){if(this.active){this.activeInSpace()}this.activeBodies();var ea=this.cbTypes.head;while(ea!=null){ea.elt.constraints.add(this);ea=ea.next}};b1.prototype.removedFromSpace=function(){if(this.active){this.inactiveOrOutSpace()}this.inactiveBodies();var ea=this.cbTypes.head;while(ea!=null){ea.elt.constraints.remove(this);ea=ea.next}};b1.prototype.activeInSpace=function(){this.alloc_cbSet();if(bx.zpp_pool==null){this.component=new bx()}else{this.component=bx.zpp_pool;bx.zpp_pool=this.component.next;this.component.next=null}this.component.isBody=false;this.component.constraint=this};b1.prototype.inactiveOrOutSpace=function(){this.dealloc_cbSet();var ea=this.component;ea.body=null;ea.constraint=null;ea.next=bx.zpp_pool;bx.zpp_pool=ea;this.component=null};b1.prototype.activeBodies=function(){};b1.prototype.inactiveBodies=function(){};b1.prototype.clearcache=function(){};b1.prototype.validate=function(){};b1.prototype.wake_connected=function(){};b1.prototype.forest=function(){};b1.prototype.pair_exists=function(eb,ea){return false};b1.prototype.broken=function(){};b1.prototype.warmStart=function(){};b1.prototype.pre_dt=null;b1.prototype.preStep=function(ea){return false};b1.prototype.applyImpulseVel=function(){return false};b1.prototype.applyImpulsePos=function(){return false};b1.prototype.wake=function(){if(this.space!=null){this.space.wake_constraint(this)}};b1.prototype.draw=function(ea){};b1.prototype.copy=function(eb,ea){return null};b1.prototype.copyto=function(er){var eq=this.outer;if(eq.zpp_inner.wrap_cbTypes==null){eq.zpp_inner.setupcbTypes()}var ej=eq.zpp_inner.wrap_cbTypes;ej.zpp_inner.valmod();var eb=Y.get(ej);while(true){eb.zpp_inner.zpp_inner.valmod();var el=eb.zpp_inner;el.zpp_inner.valmod();if(el.zpp_inner.zip_length){el.zpp_inner.zip_length=false;el.zpp_inner.user_length=el.zpp_inner.inner.length}var ed=el.zpp_inner.user_length;eb.zpp_critical=true;var eo;if(eb.zpp_i<ed){eo=true}else{eb.zpp_next=Y.zpp_pool;Y.zpp_pool=eb;eb.zpp_inner=null;eo=false}if(!eo){break}eb.zpp_critical=false;var eh=eb.zpp_inner.at(eb.zpp_i++);if(er.zpp_inner.wrap_cbTypes==null){er.zpp_inner.setupcbTypes()}var ek=er.zpp_inner.wrap_cbTypes;if(ek.zpp_inner.reverse_flag){ek.push(eh)}else{ek.unshift(eh)}}er.zpp_inner.removeOnBreak=eq.zpp_inner.removeOnBreak;var ei=eq.zpp_inner.breakUnderError;if(er.zpp_inner.breakUnderError!=ei){er.zpp_inner.breakUnderError=ei;er.zpp_inner.wake()}var ea=eq.zpp_inner.breakUnderForce;if(er.zpp_inner.breakUnderForce!=ea){er.zpp_inner.breakUnderForce=ea;er.zpp_inner.wake()}var ep=eq.zpp_inner.maxError;if(er.zpp_inner.maxError!=ep){er.zpp_inner.maxError=ep;er.zpp_inner.wake()}var ee=eq.zpp_inner.maxForce;if(er.zpp_inner.maxForce!=ee){er.zpp_inner.maxForce=ee;er.zpp_inner.wake()}var ec=eq.zpp_inner.damping;if(er.zpp_inner.damping!=ec){er.zpp_inner.damping=ec;if(!er.zpp_inner.stiff){er.zpp_inner.wake()}}var eg=eq.zpp_inner.frequency;if(er.zpp_inner.frequency!=eg){er.zpp_inner.frequency=eg;if(!er.zpp_inner.stiff){er.zpp_inner.wake()}}var en=eq.zpp_inner.stiff;if(er.zpp_inner.stiff!=en){er.zpp_inner.stiff=en;er.zpp_inner.wake()}var em=eq.zpp_inner.ignore;if(er.zpp_inner.ignore!=em){er.zpp_inner.ignore=em;er.zpp_inner.wake()}var ef=eq.zpp_inner.active;if(er.zpp_inner.active!=ef){if(er.zpp_inner.component!=null){er.zpp_inner.component.woken=false}er.zpp_inner.clearcache();if(ef){er.zpp_inner.active=ef;er.zpp_inner.activate();if(er.zpp_inner.space!=null){if(er.zpp_inner.component!=null){er.zpp_inner.component.sleeping=true}er.zpp_inner.space.wake_constraint(er.zpp_inner,true)}}else{if(er.zpp_inner.space!=null){er.zpp_inner.wake();er.zpp_inner.space.live_constraints.remove(er.zpp_inner)}er.zpp_inner.active=ef;er.zpp_inner.deactivate()}}};b1.prototype.__class__=b1;var dt=zpp_nape.constraint.ZPP_AngleJoint=function(){this.stepped=false;this.bias=0;this.gamma=0;this.jMax=0;this.jAcc=0;this.kMass=0;this.b2=null;this.b1=null;this.scale=0;this.equal=false;this.slack=false;this.jointMax=0;this.jointMin=0;this.ratio=0;this.outer_zn=null;b1.call(this);this.ratio=1;this.jAcc=0;this.slack=false;this.jMax=Infinity;this.stepped=false};dt.__name__=["zpp_nape","constraint","ZPP_AngleJoint"];dt.__super__=b1;dt.prototype=Object.create(b1.prototype);dt.prototype.outer_zn=null;dt.prototype.ratio=null;dt.prototype.jointMin=null;dt.prototype.jointMax=null;dt.prototype.slack=null;dt.prototype.equal=null;dt.prototype.scale=null;dt.prototype.is_slack=function(){var ea;var eb=this.ratio*this.b2.rot-this.b1.rot;if(this.equal){ea=false;this.scale=1}else{if(eb<this.jointMin){this.scale=-1;ea=false}else{if(eb>this.jointMax){eb-=this.jointMax;this.scale=1;ea=false}else{this.scale=0;eb=0;ea=true}}}return ea};dt.prototype.bodyImpulse=function(ea){if(this.stepped){if(ea==this.b1){return q.get(0,0,-this.scale*this.jAcc)}else{return q.get(0,0,this.ratio*this.scale*this.jAcc)}}else{return q.get(0,0,0)}};dt.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}};dt.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}};dt.prototype.b1=null;dt.prototype.b2=null;dt.prototype.kMass=null;dt.prototype.jAcc=null;dt.prototype.jMax=null;dt.prototype.gamma=null;dt.prototype.bias=null;dt.prototype.stepped=null;dt.prototype.copy=function(ea,eb){var ed=new aA(null,null,this.jointMin,this.jointMax,this.ratio);this.copyto(ed);if(ea!=null&&this.b1!=null){var eh=null;var ec=0;while(ec<ea.length){var ef=ea[ec];++ec;if(ef.id==this.b1.id){eh=ef.bc;break}}if(eh!=null){ed.zpp_inner_zn.b1=eh.zpp_inner}else{eb.push(cu.todo(this.b1.id,function(ej){ed.zpp_inner_zn.b1=ej.zpp_inner}))}}if(ea!=null&&this.b2!=null){var eg=null;var ee=0;while(ee<ea.length){var ei=ea[ee];++ee;if(ei.id==this.b2.id){eg=ei.bc;break}}if(eg!=null){ed.zpp_inner_zn.b2=eg.zpp_inner}else{eb.push(cu.todo(this.b2.id,function(ej){ed.zpp_inner_zn.b2=ej.zpp_inner}))}}return ed};dt.prototype.validate=function(){if(this.b1==null||this.b2==null){throw new cE("Error: AngleJoint cannot be simulated null bodies")}if(this.b1==this.b2){throw new cE("Error: AngleJoint cannot be simulated with body1 == body2")}if(this.b1.space!=this.space||this.b2.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned")}if(this.jointMin>this.jointMax){throw new cE("Error: AngleJoint must have jointMin <= jointMax")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: Constraints cannot have both bodies non-dynamic")}};dt.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}};dt.prototype.forest=function(){if(this.b1.type==2){var en;if(this.b1.component==this.b1.component.parent){en=this.b1.component}else{var eo=this.b1.component;var em=null;while(eo!=eo.parent){var ei=eo.parent;eo.parent=em;em=eo;eo=ei}while(em!=null){var eh=em.parent;em.parent=eo;em=eh}en=eo}var er;if(this.component==this.component.parent){er=this.component}else{var et=this.component;var el=null;while(et!=et.parent){var eg=et.parent;et.parent=el;el=et;et=eg}while(el!=null){var ef=el.parent;el.parent=et;el=ef}er=et}if(en!=er){if(en.rank<er.rank){en.parent=er}else{if(en.rank>er.rank){er.parent=en}else{er.parent=en;en.rank++}}}}if(this.b2.type==2){var ee;if(this.b2.component==this.b2.component.parent){ee=this.b2.component}else{var es=this.b2.component;var ek=null;while(es!=es.parent){var ed=es.parent;es.parent=ek;ek=es;es=ed}while(ek!=null){var ec=ek.parent;ek.parent=es;ek=ec}ee=es}var ep;if(this.component==this.component.parent){ep=this.component}else{var eq=this.component;var ej=null;while(eq!=eq.parent){var eb=eq.parent;eq.parent=ej;ej=eq;eq=eb}while(ej!=null){var ea=ej.parent;ej.parent=eq;ej=ea}ep=eq}if(ee!=ep){if(ee.rank<ep.rank){ee.parent=ep}else{if(ee.rank>ep.rank){ep.parent=ee}else{ep.parent=ee;ee.rank++}}}}};dt.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&this.b2.id==ea)){if(this.b1.id==ea){return this.b2.id==eb}else{return false}}else{return true}};dt.prototype.clearcache=function(){this.jAcc=0;this.pre_dt=-1;this.slack=false};dt.prototype.preStep=function(eb){if(this.pre_dt==-1){this.pre_dt=eb}var ee=eb/this.pre_dt;this.pre_dt=eb;this.stepped=true;this.equal=this.jointMin==this.jointMax;var ef=this.ratio*this.b2.rot-this.b1.rot;if(this.equal){ef-=this.jointMax;this.slack=false;this.scale=1}else{if(ef<this.jointMin){ef=this.jointMin-ef;this.scale=-1;this.slack=false}else{if(ef>this.jointMax){ef-=this.jointMax;this.scale=1;this.slack=false}else{this.scale=0;ef=0;this.slack=true}}}var ed=ef;if(!this.slack){this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia;if(this.kMass!=0){this.kMass=1/this.kMass}else{this.jAcc=0}if(!this.stiff){if(this.breakUnderError&&ed*ed>this.maxError*this.maxError){return true}var ea;var eg=2*Math.PI*this.frequency;this.gamma=1/(eb*eg*(2*this.damping+eg*eb));var ec=1/(1+this.gamma);ea=eb*eg*eg*this.gamma;this.gamma*=ec;this.kMass*=ec;this.bias=-ed*ea;if(this.bias<-this.maxError){this.bias=-this.maxError}else{if(this.bias>this.maxError){this.bias=this.maxError}}}else{this.bias=0;this.gamma=0}this.jAcc*=ee;this.jMax=this.maxForce*eb}return false};dt.prototype.warmStart=function(){if(!this.slack){this.b1.angvel-=this.scale*this.b1.iinertia*this.jAcc;this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*this.jAcc}};dt.prototype.applyImpulseVel=function(){if(this.slack){return false}var ea=this.kMass*(this.bias-this.scale*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel))-this.jAcc*this.gamma;var eb=this.jAcc;this.jAcc+=ea;if(!this.equal&&this.jAcc>0){this.jAcc=0}if(this.breakUnderForce&&(this.jAcc>this.jMax||this.jAcc<-this.jMax)){return true}if(!this.stiff){if(this.jAcc>this.jMax){this.jAcc=this.jMax}else{if(this.jAcc<-this.jMax){this.jAcc=-this.jMax}}}ea=this.jAcc-eb;this.b1.angvel-=this.scale*this.b1.iinertia*ea;this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*ea;return false};dt.prototype.applyImpulsePos=function(){var ep;var eh;var el;var ec=this.ratio*this.b2.rot-this.b1.rot;if(this.equal){ec-=this.jointMax;el=false;this.scale=1}else{if(ec<this.jointMin){ec=this.jointMin-ec;this.scale=-1;el=false}else{if(ec>this.jointMax){ec-=this.jointMax;this.scale=1;el=false}else{this.scale=0;ec=0;el=true}}}ep=ec;if(!el){if(this.breakUnderError&&ep*ep>this.maxError*this.maxError){return true}ep*=0.5;eh=-ep*this.kMass;if(this.equal||eh<0){var ej=this.b1;var eg=-this.scale*eh*this.b1.iinertia;ej.rot+=eg;if(eg*eg>0.0001){ej.axisx=Math.sin(ej.rot);ej.axisy=Math.cos(ej.rot)}else{var eb=eg*eg;var ed=1-0.5*eb;var ef=1-eb*eb/8;var ei=(ed*ej.axisx+eg*ej.axisy)*ef;ej.axisy=(ed*ej.axisy-eg*ej.axisx)*ef;ej.axisx=ei}var ek=this.b2;var eo=this.ratio*this.scale*eh*this.b2.iinertia;ek.rot+=eo;if(eo*eo>0.0001){ek.axisx=Math.sin(ek.rot);ek.axisy=Math.cos(ek.rot)}else{var ee=eo*eo;var em=1-0.5*ee;var en=1-ee*ee/8;var ea=(em*ek.axisx+eo*ek.axisy)*en;ek.axisy=(em*ek.axisy-eo*ek.axisx)*en;ek.axisx=ea}}}return false};dt.prototype.draw=function(ea){};dt.prototype.__class__=dt;var cu=zpp_nape.constraint.ZPP_CopyHelper=function(){this.cb=null;this.bc=null;this.id=0};cu.__name__=["zpp_nape","constraint","ZPP_CopyHelper"];cu.dict=function(ec,eb){var ea=new cu();ea.id=ec;ea.bc=eb;return ea};cu.todo=function(ec,ea){var eb=new cu();eb.id=ec;eb.cb=ea;return eb};cu.prototype.id=null;cu.prototype.bc=null;cu.prototype.cb=null;cu.prototype.__class__=cu;var J=zpp_nape.constraint.ZPP_DistanceJoint=function(){this.stepped=false;this.bias=0;this.gamma=0;this.jMax=0;this.jAcc=0;this.kMass=0;this.wrap_a2=null;this.a2rely=0;this.a2relx=0;this.a2localy=0;this.a2localx=0;this.b2=null;this.wrap_a1=null;this.a1rely=0;this.a1relx=0;this.a1localy=0;this.a1localx=0;this.b1=null;this.cx2=0;this.cx1=0;this.ny=0;this.nx=0;this.equal=false;this.slack=false;this.jointMax=0;this.jointMin=0;this.outer_zn=null;b1.call(this);this.a1localx=0;this.a1localy=0;this.a1relx=0;this.a1rely=0;this.a2localx=0;this.a2localy=0;this.a2relx=0;this.a2rely=0;this.jAcc=0;this.jMax=Infinity;this.stepped=false;this.cx1=this.cx2=0};J.__name__=["zpp_nape","constraint","ZPP_DistanceJoint"];J.__super__=b1;J.prototype=Object.create(b1.prototype);J.prototype.outer_zn=null;J.prototype.jointMin=null;J.prototype.jointMax=null;J.prototype.slack=null;J.prototype.equal=null;J.prototype.is_slack=function(){var eb;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var ea=0;var ee=0;ea=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);ee=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var ed=ea*ea+ee*ee;if(ed<P.epsilon){eb=true}else{ed=Math.sqrt(ed);var ec=1/ed;ea*=ec;ee*=ec;if(this.equal){eb=false}else{if(ed<this.jointMin){eb=false}else{if(ed>this.jointMax){ed-=this.jointMax;eb=false}else{ea=0;ee=0;ed=0;eb=true}}}}return eb};J.prototype.nx=null;J.prototype.ny=null;J.prototype.cx1=null;J.prototype.cx2=null;J.prototype.bodyImpulse=function(ea){if(this.stepped){if(ea==this.b1){return q.get(-this.jAcc*this.nx,-this.jAcc*this.ny,-this.cx1*this.jAcc)}else{return q.get(this.jAcc*this.nx,this.jAcc*this.ny,this.cx2*this.jAcc)}}else{return q.get(0,0,0)}};J.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}};J.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}};J.prototype.b1=null;J.prototype.a1localx=null;J.prototype.a1localy=null;J.prototype.a1relx=null;J.prototype.a1rely=null;J.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy};J.prototype.invalidate_a1=function(ea){this.immutable_midstep("Constraint::a1");this.a1localx=ea.x;this.a1localy=ea.y;this.wake()};J.prototype.setup_a1=function(){var ea=this.a1localx;var eh=this.a1localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a1=eb;this.wrap_a1.zpp_inner._inuse=true;this.wrap_a1.zpp_inner._validate=dX(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=dX(this,this.invalidate_a1)};J.prototype.wrap_a1=null;J.prototype.b2=null;J.prototype.a2localx=null;J.prototype.a2localy=null;J.prototype.a2relx=null;J.prototype.a2rely=null;J.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy};J.prototype.invalidate_a2=function(ea){this.immutable_midstep("Constraint::a2");this.a2localx=ea.x;this.a2localy=ea.y;this.wake()};J.prototype.setup_a2=function(){var ea=this.a2localx;var eh=this.a2localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a2=eb;this.wrap_a2.zpp_inner._inuse=true;this.wrap_a2.zpp_inner._validate=dX(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=dX(this,this.invalidate_a2)};J.prototype.wrap_a2=null;J.prototype.kMass=null;J.prototype.jAcc=null;J.prototype.jMax=null;J.prototype.gamma=null;J.prototype.bias=null;J.prototype.stepped=null;J.prototype.copy=function(ea,eb){var ee=this.outer_zn;if(ee.zpp_inner_zn.wrap_a1==null){ee.zpp_inner_zn.setup_a1()}var ec=ee.zpp_inner_zn.wrap_a1;var eg=this.outer_zn;if(eg.zpp_inner_zn.wrap_a2==null){eg.zpp_inner_zn.setup_a2()}var ef=new dx(null,null,ec,eg.zpp_inner_zn.wrap_a2,this.jointMin,this.jointMax);this.copyto(ef);if(ea!=null&&this.b1!=null){var ek=null;var ed=0;while(ed<ea.length){var ej=ea[ed];++ed;if(ej.id==this.b1.id){ek=ej.bc;break}}if(ek!=null){ef.zpp_inner_zn.b1=ek.zpp_inner}else{eb.push(cu.todo(this.b1.id,function(em){ef.zpp_inner_zn.b1=em.zpp_inner}))}}if(ea!=null&&this.b2!=null){var ei=null;var eh=0;while(eh<ea.length){var el=ea[eh];++eh;if(el.id==this.b2.id){ei=el.bc;break}}if(ei!=null){ef.zpp_inner_zn.b2=ei.zpp_inner}else{eb.push(cu.todo(this.b2.id,function(em){ef.zpp_inner_zn.b2=em.zpp_inner}))}}return ef};J.prototype.validate=function(){if(this.b1==null||this.b2==null){throw new cE("Error: DistanceJoint cannot be simulated null bodies")}if(this.b1==this.b2){throw new cE("Error: DistanceJoint cannot be simulated with body1 == body2")}if(this.b1.space!=this.space||this.b2.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned")}if(this.jointMin>this.jointMax){throw new cE("Error: DistanceJoint must have jointMin <= jointMax")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: Constraints cannot have both bodies non-dynamic")}};J.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}};J.prototype.forest=function(){if(this.b1.type==2){var en;if(this.b1.component==this.b1.component.parent){en=this.b1.component}else{var eo=this.b1.component;var em=null;while(eo!=eo.parent){var ei=eo.parent;eo.parent=em;em=eo;eo=ei}while(em!=null){var eh=em.parent;em.parent=eo;em=eh}en=eo}var er;if(this.component==this.component.parent){er=this.component}else{var et=this.component;var el=null;while(et!=et.parent){var eg=et.parent;et.parent=el;el=et;et=eg}while(el!=null){var ef=el.parent;el.parent=et;el=ef}er=et}if(en!=er){if(en.rank<er.rank){en.parent=er}else{if(en.rank>er.rank){er.parent=en}else{er.parent=en;en.rank++}}}}if(this.b2.type==2){var ee;if(this.b2.component==this.b2.component.parent){ee=this.b2.component}else{var es=this.b2.component;var ek=null;while(es!=es.parent){var ed=es.parent;es.parent=ek;ek=es;es=ed}while(ek!=null){var ec=ek.parent;ek.parent=es;ek=ec}ee=es}var ep;if(this.component==this.component.parent){ep=this.component}else{var eq=this.component;var ej=null;while(eq!=eq.parent){var eb=eq.parent;eq.parent=ej;ej=eq;eq=eb}while(ej!=null){var ea=ej.parent;ej.parent=eq;ej=ea}ep=eq}if(ee!=ep){if(ee.rank<ep.rank){ee.parent=ep}else{if(ee.rank>ep.rank){ep.parent=ee}else{ep.parent=ee;ee.rank++}}}}};J.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&this.b2.id==ea)){if(this.b1.id==ea){return this.b2.id==eb}else{return false}}else{return true}};J.prototype.clearcache=function(){this.jAcc=0;this.pre_dt=-1};J.prototype.preStep=function(ec){if(this.pre_dt==-1){this.pre_dt=ec}var ef=ec/this.pre_dt;this.pre_dt=ec;this.stepped=true;this.equal=this.jointMin==this.jointMax;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var eg=this.nx*this.nx+this.ny*this.ny;if(eg<P.epsilon){this.nx=0;this.ny=0;eg=0;this.slack=true}else{eg=Math.sqrt(eg);var eb=1/eg;this.nx*=eb;this.ny*=eb;if(this.equal){eg-=this.jointMax;this.slack=false}else{if(eg<this.jointMin){eg=this.jointMin-eg;this.nx=-this.nx;this.ny=-this.ny;this.slack=false}else{if(eg>this.jointMax){eg-=this.jointMax;this.slack=false}else{this.nx=0;this.ny=0;eg=0;this.slack=true}}}}var ee=eg;if(!this.slack){this.cx1=this.ny*this.a1relx-this.nx*this.a1rely;this.cx2=this.ny*this.a2relx-this.nx*this.a2rely;this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia;if(this.kMass!=0){this.kMass=1/this.kMass}else{this.jAcc=0}if(!this.stiff){if(this.breakUnderError&&ee*ee>this.maxError*this.maxError){return true}var ea;var eh=2*Math.PI*this.frequency;this.gamma=1/(ec*eh*(2*this.damping+eh*ec));var ed=1/(1+this.gamma);ea=ec*eh*eh*this.gamma;this.gamma*=ed;this.kMass*=ed;this.bias=-ee*ea;if(this.bias<-this.maxError){this.bias=-this.maxError}else{if(this.bias>this.maxError){this.bias=this.maxError}}}else{this.bias=0;this.gamma=0}this.jAcc*=ef;this.jMax=this.maxForce*ec}return false};J.prototype.warmStart=function(){if(!this.slack){var ea=this.b1.imass*this.jAcc;this.b1.velx-=this.nx*ea;this.b1.vely-=this.ny*ea;var eb=this.b2.imass*this.jAcc;this.b2.velx+=this.nx*eb;this.b2.vely+=this.ny*eb;this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc;this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc}};J.prototype.applyImpulseVel=function(){if(this.slack){return false}var ea=this.kMass*(this.bias-(this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1))-this.jAcc*this.gamma;var ed=this.jAcc;this.jAcc+=ea;if(!this.equal&&this.jAcc>0){this.jAcc=0}if(this.breakUnderForce&&this.jAcc<-this.jMax){return true}if(!this.stiff){if(this.jAcc<-this.jMax){this.jAcc=-this.jMax}}ea=this.jAcc-ed;var eb=this.b1.imass*ea;this.b1.velx-=this.nx*eb;this.b1.vely-=this.ny*eb;var ec=this.b2.imass*ea;this.b2.velx+=this.nx*ec;this.b2.vely+=this.ny*ec;this.b1.angvel-=this.cx1*this.b1.iinertia*ea;this.b2.angvel+=this.cx2*this.b2.iinertia*ea;return false};J.prototype.applyImpulsePos=function(){var eo;var eB;var ef=0;var ee=0;ef=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;ee=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var eq=0;var en=0;eq=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;en=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var ed;var eF=0;var eE=0;eF=this.b2.posx+eq-(this.b1.posx+ef);eE=this.b2.posy+en-(this.b1.posy+ee);var et=eF*eF+eE*eE;if(et<P.epsilon){eF=0;eE=0;et=0;ed=true}else{et=Math.sqrt(et);var ep=1/et;eF*=ep;eE*=ep;if(this.equal){et-=this.jointMax;ed=false}else{if(et<this.jointMin){et=this.jointMin-et;eF=-eF;eE=-eE;ed=false}else{if(et>this.jointMax){et-=this.jointMax;ed=false}else{eF=0;eE=0;et=0;ed=true}}}}eo=et;if(!ed){if(this.breakUnderError&&eo*eo>this.maxError*this.maxError){return true}if(eo*eo<P.constraintLinearSlop*P.constraintLinearSlop){return false}eo*=0.5;if(eo*eo>6){var eA=this.b1.smass+this.b2.smass;if(eA>P.epsilon){eA=0.75/eA;eB=-eo*eA;if(this.equal||eB<0){var em=eB*this.b1.imass;this.b1.posx-=eF*em;this.b1.posy-=eE*em;var el=eB*this.b2.imass;this.b2.posx+=eF*el;this.b2.posy+=eE*el;eF=this.b2.posx+eq-(this.b1.posx+ef);eE=this.b2.posy+en-(this.b1.posy+ee);var eC=eF*eF+eE*eE;if(eC<P.epsilon){eF=0;eE=0;eC=0}else{eC=Math.sqrt(eC);var ek=1/eC;eF*=ek;eE*=ek;if(this.equal){eC-=this.jointMax}else{if(eC<this.jointMin){eC=this.jointMin-eC;eF=-eF;eE=-eE}else{if(eC>this.jointMax){eC-=this.jointMax}else{eF=0;eE=0;eC=0}}}}eo=eC;eo*=0.5}}}var es;var er;es=eE*ef-eF*ee;er=eE*eq-eF*en;var ej=this.b1.smass+this.b2.smass+es*es*this.b1.sinertia+er*er*this.b2.sinertia;if(ej!=0){ej=1/ej}eB=-eo*ej;if(this.equal||eB<0){var ei=this.b1.imass*eB;this.b1.posx-=eF*ei;this.b1.posy-=eE*ei;var eh=this.b2.imass*eB;this.b2.posx+=eF*eh;this.b2.posy+=eE*eh;var ez=this.b1;var ev=-es*this.b1.iinertia*eB;ez.rot+=ev;if(ev*ev>0.0001){ez.axisx=Math.sin(ez.rot);ez.axisy=Math.cos(ez.rot)}else{var eG=ev*ev;var eu=1-0.5*eG;var ey=1-eG*eG/8;var ex=(eu*ez.axisx+ev*ez.axisy)*ey;ez.axisy=(eu*ez.axisy-ev*ez.axisx)*ey;ez.axisx=ex}var eD=this.b2;var ec=er*this.b2.iinertia*eB;eD.rot+=ec;if(ec*ec>0.0001){eD.axisx=Math.sin(eD.rot);eD.axisy=Math.cos(eD.rot)}else{var eg=ec*ec;var eb=1-0.5*eg;var ea=1-eg*eg/8;var ew=(eb*eD.axisx+ec*eD.axisy)*ea;eD.axisy=(eb*eD.axisy-ec*eD.axisx)*ea;eD.axisx=ew}}}return false};J.prototype.draw=function(ea){};J.prototype.__class__=J;var bR=zpp_nape.constraint.ZPP_LineJoint=function(){this.biasy=0;this.biasx=0;this.jAccy=0;this.jAccx=0;this.kMassc=0;this.kMassb=0;this.kMassa=0;this.wrap_n=null;this.nrely=0;this.nrelx=0;this.nlocaly=0;this.nlocalx=0;this.wrap_a2=null;this.a2rely=0;this.a2relx=0;this.a2localy=0;this.a2localx=0;this.wrap_a1=null;this.a1rely=0;this.a1relx=0;this.a1localy=0;this.a1localx=0;this.cx2=0;this.cx1=0;this.dot2=0;this.dot1=0;this.equal=false;this.jointMax=0;this.jointMin=0;this.scale=0;this.outer_zn=null;b1.call(this);this.a1localx=0;this.a1localy=0;this.a1relx=0;this.a1rely=0;this.a2localx=0;this.a2localy=0;this.a2relx=0;this.a2rely=0;this.nlocalx=0;this.nlocaly=0;this.nrelx=0;this.nrely=0;this.jAccx=0;this.jAccy=0;this.jMax=Infinity;this.jointMin=-Infinity;this.jointMax=Infinity;this.stepped=false};bR.__name__=["zpp_nape","constraint","ZPP_LineJoint"];bR.__super__=b1;bR.prototype=Object.create(b1.prototype);bR.prototype.outer_zn=null;bR.prototype.scale=null;bR.prototype.jointMin=null;bR.prototype.jointMax=null;bR.prototype.equal=null;bR.prototype.dot1=null;bR.prototype.dot2=null;bR.prototype.cx1=null;bR.prototype.cx2=null;bR.prototype.bodyImpulse=function(ea){if(this.stepped){var ec=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx;var eb=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;if(ea==this.b1){return q.get(-ec,-eb,this.scale*this.cx1*eb-this.dot1*ec)}else{return q.get(ec,eb,this.scale*this.cx1*eb-this.dot1*ec)}}else{return q.get(0,0,0)}};bR.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}};bR.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}};bR.prototype.b1=null;bR.prototype.a1localx=null;bR.prototype.a1localy=null;bR.prototype.a1relx=null;bR.prototype.a1rely=null;bR.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy};bR.prototype.invalidate_a1=function(ea){this.immutable_midstep("Constraint::a1");this.a1localx=ea.x;this.a1localy=ea.y;this.wake()};bR.prototype.setup_a1=function(){var ea=this.a1localx;var eh=this.a1localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a1=eb;this.wrap_a1.zpp_inner._inuse=true;this.wrap_a1.zpp_inner._validate=dX(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=dX(this,this.invalidate_a1)};bR.prototype.wrap_a1=null;bR.prototype.b2=null;bR.prototype.a2localx=null;bR.prototype.a2localy=null;bR.prototype.a2relx=null;bR.prototype.a2rely=null;bR.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy};bR.prototype.invalidate_a2=function(ea){this.immutable_midstep("Constraint::a2");this.a2localx=ea.x;this.a2localy=ea.y;this.wake()};bR.prototype.setup_a2=function(){var ea=this.a2localx;var eh=this.a2localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a2=eb;this.wrap_a2.zpp_inner._inuse=true;this.wrap_a2.zpp_inner._validate=dX(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=dX(this,this.invalidate_a2)};bR.prototype.wrap_a2=null;bR.prototype.zip_n=null;bR.prototype.nlocalx=null;bR.prototype.nlocaly=null;bR.prototype.nrelx=null;bR.prototype.nrely=null;bR.prototype.validate_n=function(){this.wrap_n.zpp_inner.x=this.nlocalx;this.wrap_n.zpp_inner.y=this.nlocaly};bR.prototype.invalidate_n=function(ea){this.immutable_midstep("Constraint::n");this.nlocalx=ea.x;this.nlocaly=ea.y;this.zip_n=true;this.wake()};bR.prototype.setup_n=function(){var ea=this.nlocalx;var eh=this.nlocaly;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_n=eb;this.wrap_n.zpp_inner._inuse=true;this.wrap_n.zpp_inner._validate=dX(this,this.validate_n);this.wrap_n.zpp_inner._invalidate=dX(this,this.invalidate_n)};bR.prototype.wrap_n=null;bR.prototype.validate_norm=function(){if(this.zip_n){this.zip_n=false;var ea=1/Math.sqrt(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly);this.nlocalx*=ea;this.nlocaly*=ea}};bR.prototype.kMassa=null;bR.prototype.kMassb=null;bR.prototype.kMassc=null;bR.prototype.jAccx=null;bR.prototype.jAccy=null;bR.prototype.jMax=null;bR.prototype.gamma=null;bR.prototype.biasx=null;bR.prototype.biasy=null;bR.prototype.stepped=null;bR.prototype.copy=function(ea,eb){var ef=this.outer_zn;if(ef.zpp_inner_zn.wrap_a1==null){ef.zpp_inner_zn.setup_a1()}var ed=ef.zpp_inner_zn.wrap_a1;var ei=this.outer_zn;if(ei.zpp_inner_zn.wrap_a2==null){ei.zpp_inner_zn.setup_a2()}var ec=ei.zpp_inner_zn.wrap_a2;var eg=this.outer_zn;if(eg.zpp_inner_zn.wrap_n==null){eg.zpp_inner_zn.setup_n()}var eh=new aO(null,null,ed,ec,eg.zpp_inner_zn.wrap_n,this.jointMin,this.jointMax);this.copyto(eh);if(ea!=null&&this.b1!=null){var em=null;var ee=0;while(ee<ea.length){var el=ea[ee];++ee;if(el.id==this.b1.id){em=el.bc;break}}if(em!=null){eh.zpp_inner_zn.b1=em.zpp_inner}else{eb.push(cu.todo(this.b1.id,function(eo){eh.zpp_inner_zn.b1=eo.zpp_inner}))}}if(ea!=null&&this.b2!=null){var ek=null;var ej=0;while(ej<ea.length){var en=ea[ej];++ej;if(en.id==this.b2.id){ek=en.bc;break}}if(ek!=null){eh.zpp_inner_zn.b2=ek.zpp_inner}else{eb.push(cu.todo(this.b2.id,function(eo){eh.zpp_inner_zn.b2=eo.zpp_inner}))}}return eh};bR.prototype.validate=function(){if(this.b1==null||this.b2==null){throw new cE("Error: AngleJoint cannot be simulated null bodies")}if(this.b1==this.b2){throw new cE("Error: DistanceJoint cannot be simulated with body1 == body2")}if(this.b1.space!=this.space||this.b2.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned")}if(this.jointMin>this.jointMax){throw new cE("Error: DistanceJoint must have jointMin <= jointMax")}if(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly<P.epsilon){throw new cE("Error: DistanceJoint direction must be non-degenerate")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: Constraints cannot have both bodies non-dynamic")}};bR.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}};bR.prototype.forest=function(){if(this.b1.type==2){var en;if(this.b1.component==this.b1.component.parent){en=this.b1.component}else{var eo=this.b1.component;var em=null;while(eo!=eo.parent){var ei=eo.parent;eo.parent=em;em=eo;eo=ei}while(em!=null){var eh=em.parent;em.parent=eo;em=eh}en=eo}var er;if(this.component==this.component.parent){er=this.component}else{var et=this.component;var el=null;while(et!=et.parent){var eg=et.parent;et.parent=el;el=et;et=eg}while(el!=null){var ef=el.parent;el.parent=et;el=ef}er=et}if(en!=er){if(en.rank<er.rank){en.parent=er}else{if(en.rank>er.rank){er.parent=en}else{er.parent=en;en.rank++}}}}if(this.b2.type==2){var ee;if(this.b2.component==this.b2.component.parent){ee=this.b2.component}else{var es=this.b2.component;var ek=null;while(es!=es.parent){var ed=es.parent;es.parent=ek;ek=es;es=ed}while(ek!=null){var ec=ek.parent;ek.parent=es;ek=ec}ee=es}var ep;if(this.component==this.component.parent){ep=this.component}else{var eq=this.component;var ej=null;while(eq!=eq.parent){var eb=eq.parent;eq.parent=ej;ej=eq;eq=eb}while(ej!=null){var ea=ej.parent;ej.parent=eq;ej=ea}ep=eq}if(ee!=ep){if(ee.rank<ep.rank){ee.parent=ep}else{if(ee.rank>ep.rank){ep.parent=ee}else{ep.parent=ee;ee.rank++}}}}};bR.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&this.b2.id==ea)){if(this.b1.id==ea){return this.b2.id==eb}else{return false}}else{return true}};bR.prototype.clearcache=function(){this.jAccx=0;this.jAccy=0;this.pre_dt=-1};bR.prototype.preStep=function(eo){if(this.pre_dt==-1){this.pre_dt=eo}var eq=eo/this.pre_dt;this.pre_dt=eo;this.equal=this.jointMin==this.jointMax;this.stepped=true;this.validate_norm();this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.nrelx=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly;this.nrely=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var ej=0;var ei=0;var ed=0;var ec=0;ej=this.b2.posx+this.a2relx-this.b1.posx-this.a1relx;ei=this.b2.posy+this.a2rely-this.b1.posy-this.a1rely;ed=ei*this.nrelx-ej*this.nrely;ec=this.nrelx*ej+this.nrely*ei;if(this.equal){ec-=this.jointMin;this.scale=1}else{if(ec>this.jointMax){ec-=this.jointMax;this.scale=1}else{if(ec<this.jointMin){ec=this.jointMin-ec;this.scale=-1}else{ec=0;this.scale=0}}}var en=0;var em=0;en=ej+this.a1relx;em=ei+this.a1rely;this.dot1=this.nrelx*en+this.nrely*em;this.cx1=em*this.nrelx-en*this.nrely;this.dot2=this.nrelx*this.a2relx+this.nrely*this.a2rely;this.cx2=this.a2rely*this.nrelx-this.a2relx*this.nrely;this.kMassa=this.b1.smass+this.b2.smass+this.dot1*this.dot1*this.b1.sinertia+this.dot2*this.dot2*this.b2.sinertia;this.kMassb=-this.scale*(this.dot1*this.cx1*this.b1.sinertia+this.dot2*this.cx2*this.b2.sinertia);this.kMassc=this.scale*this.scale*(this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia);var eb=this.kMassa*this.kMassc-this.kMassb*this.kMassb;var es;if(eb!=eb){this.kMassa=this.kMassb=this.kMassc=0;es=3}else{if(eb==0){var er=0;if(this.kMassa!=0){this.kMassa=1/this.kMassa}else{this.kMassa=0;er=1}if(this.kMassc!=0){this.kMassc=1/this.kMassc}else{this.kMassc=0;er|=2}this.kMassb=0;es=er}else{eb=1/eb;var ek=this.kMassc*eb;this.kMassc=this.kMassa*eb;this.kMassa=ek;this.kMassb*=-eb;es=0}}if((es&1)!=0){this.jAccx=0}if((es&2)!=0){this.jAccy=0}if(!this.stiff){if(this.breakUnderError&&ed*ed+ec*ec>this.maxError*this.maxError){return true}var ea;var ep=2*Math.PI*this.frequency;this.gamma=1/(eo*ep*(2*this.damping+ep*eo));var el=1/(1+this.gamma);ea=eo*ep*ep*this.gamma;this.gamma*=el;this.kMassa*=el;this.kMassb*=el;this.kMassc*=el;this.biasx=ed;this.biasy=ec;var eh=-ea;this.biasx*=eh;this.biasy*=eh;var eg=this.maxError;var ee=this.biasx*this.biasx+this.biasy*this.biasy;if(ee>eg*eg){var ef=eg*(1/Math.sqrt(ee));this.biasx*=ef;this.biasy*=ef}}else{this.gamma=0;this.biasx=0;this.biasy=0}this.jAccx*=eq;this.jAccy*=eq;this.jMax=this.maxForce*eo;return false};bR.prototype.warmStart=function(){var eb=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx;var ea=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;var ec=this.b1.imass;this.b1.velx-=eb*ec;this.b1.vely-=ea*ec;var ed=this.b2.imass;this.b2.velx+=eb*ed;this.b2.vely+=ea*ed;this.b1.angvel+=(this.scale*this.cx1*this.jAccy-this.dot1*this.jAccx)*this.b1.iinertia;this.b2.angvel+=(this.dot2*this.jAccx-this.scale*this.cx2*this.jAccy)*this.b2.iinertia};bR.prototype.applyImpulseVel=function(){var eo=0;var en=0;var ej=0;var eg=0;ej=this.b2.velx-this.b1.velx;eg=this.b2.vely-this.b1.vely;ej+=this.b2.kinvelx-this.b1.kinvelx;eg+=this.b2.kinvely-this.b1.kinvely;eo=eg*this.nrelx-ej*this.nrely+(this.b2.angvel+this.b2.kinangvel)*this.dot2-(this.b1.angvel+this.b1.kinangvel)*this.dot1;en=this.scale*(this.nrelx*ej+this.nrely*eg-(this.b2.angvel+this.b2.kinangvel)*this.cx2+(this.b1.angvel+this.b1.kinangvel)*this.cx1);var ea=0;var eq=0;ea=this.biasx-eo;eq=this.biasy-en;var ep=this.kMassa*ea+this.kMassb*eq;eq=this.kMassb*ea+this.kMassc*eq;ea=ep;var ek=this.gamma;ea-=this.jAccx*ek;eq-=this.jAccy*ek;var em=0;var el=0;em=this.jAccx;el=this.jAccy;this.jAccx+=ea;this.jAccy+=eq;if(this.jAccy>0){this.jAccy=0}if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax){return true}}else{if(!this.stiff){var ei=this.jMax;var ef=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(ef>ei*ei){var ee=ei*(1/Math.sqrt(ef));this.jAccx*=ee;this.jAccy*=ee}}}ea=this.jAccx-em;eq=this.jAccy-el;var eh=this.scale*this.nrelx*eq-this.nrely*ea;var ed=this.nrelx*ea+this.scale*this.nrely*eq;var ec=this.b1.imass;this.b1.velx-=eh*ec;this.b1.vely-=ed*ec;var eb=this.b2.imass;this.b2.velx+=eh*eb;this.b2.vely+=ed*eb;this.b1.angvel+=(this.scale*this.cx1*eq-this.dot1*ea)*this.b1.iinertia;this.b2.angvel+=(this.dot2*ea-this.scale*this.cx2*eq)*this.b2.iinertia;return false};bR.prototype.applyImpulsePos=function(){var eI=0;var eF=0;eI=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly;eF=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy;var eo=0;var en=0;eo=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;en=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var eh=0;var ef=0;eh=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;ef=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var ec=0;var ea=0;var ex;var eg=0;var ee=0;ec=this.b2.posx+eh-this.b1.posx-eo;ea=this.b2.posy+ef-this.b1.posy-en;eg=ea*eI-ec*eF;ee=eI*ec+eF*ea;if(this.equal){ee-=this.jointMin;ex=1}else{if(ee>this.jointMax){ee-=this.jointMax;ex=1}else{if(ee<this.jointMin){ee=this.jointMin-ee;ex=-1}else{ee=0;ex=0}}}if(this.breakUnderError&&eg*eg+ee*ee>this.maxError*this.maxError){return true}if(eg*eg+ee*ee<P.constraintLinearSlop*P.constraintLinearSlop){return false}var et=0;var eq=0;eg*=0.5;ee*=0.5;if(eg*eg+ee*ee>6){var eO=this.b1.smass+this.b2.smass;if(eO>P.epsilon){eO=0.8/eO;var eA=eO*(eF*eg-ex*eI*ee);var ej=eO*(eI*eg*ex-eF*eg);var eC=this.b1.imass;this.b1.posx-=eA*eC;this.b1.posy-=ej*eC;var ey=this.b2.imass;this.b2.posx+=eA*ey;this.b2.posy+=ej*ey;ec=this.b2.posx+eh-this.b1.posx-eo;ea=this.b2.posy+ef-this.b1.posy-en;eg=ea*eI-ec*eF;ee=eI*ec+eF*ea;if(this.equal){ee-=this.jointMin;ex=1}else{if(ee>this.jointMax){ee-=this.jointMax;ex=1}else{if(ee<this.jointMin){ee=this.jointMin-ee;ex=-1}else{ee=0;ex=0}}}eg*=0.5;ee*=0.5}}var eG;var eE;var eN;var eL;var em=0;var el=0;var ek=0;var eS=0;var eR=0;eS=ec+eo;eR=ea+en;eG=eI*eS+eF*eR;eN=eR*eI-eS*eF;eE=eI*eh+eF*ef;eL=ef*eI-eh*eF;em=this.b1.smass+this.b2.smass+eG*eG*this.b1.sinertia+eE*eE*this.b2.sinertia;el=-ex*(eG*eN*this.b1.sinertia+eE*eL*this.b2.sinertia);ek=ex*ex*(this.b1.smass+this.b2.smass+eN*eN*this.b1.sinertia+eL*eL*this.b2.sinertia);et=-eg;eq=-ee;var ei=em*ek-el*el;if(ei!=ei){eq=0;et=eq}else{if(ei==0){if(em!=0){et/=em}else{et=0}if(ek!=0){eq/=ek}else{eq=0}}else{ei=1/ei;var ew=ei*(ek*et-el*eq);eq=ei*(em*eq-el*et);et=ew}}if(eq>0){eq=0}var eM=ex*eI*eq-eF*et;var eJ=eI*et+ex*eF*eq;var ev=this.b1.imass;this.b1.posx-=eM*ev;this.b1.posy-=eJ*ev;var eu=this.b2.imass;this.b2.posx+=eM*eu;this.b2.posy+=eJ*eu;var eb=this.b1;var ed=(ex*eN*eq-eG*et)*this.b1.iinertia;eb.rot+=ed;if(ed*ed>0.0001){eb.axisx=Math.sin(eb.rot);eb.axisy=Math.cos(eb.rot)}else{var eH=ed*ed;var eD=1-0.5*eH;var eK=1-eH*eH/8;var es=(eD*eb.axisx+ed*eb.axisy)*eK;eb.axisy=(eD*eb.axisy-ed*eb.axisx)*eK;eb.axisx=es}var eB=this.b2;var ez=(eE*et-ex*eL*eq)*this.b2.iinertia;eB.rot+=ez;if(ez*ez>0.0001){eB.axisx=Math.sin(eB.rot);eB.axisy=Math.cos(eB.rot)}else{var er=ez*ez;var eQ=1-0.5*er;var eP=1-er*er/8;var ep=(eQ*eB.axisx+ez*eB.axisy)*eP;eB.axisy=(eQ*eB.axisy-ez*eB.axisx)*eP;eB.axisx=ep}return false};bR.prototype.draw=function(ea){};bR.prototype.__class__=bR;var y=zpp_nape.constraint.ZPP_MotorJoint=function(){this.stepped=false;this.jMax=0;this.jAcc=0;this.kMass=0;this.b2=null;this.b1=null;this.rate=0;this.ratio=0;this.outer_zn=null;b1.call(this);this.jAcc=0;this.stepped=false;this.__velocity=true};y.__name__=["zpp_nape","constraint","ZPP_MotorJoint"];y.__super__=b1;y.prototype=Object.create(b1.prototype);y.prototype.outer_zn=null;y.prototype.ratio=null;y.prototype.rate=null;y.prototype.bodyImpulse=function(ea){if(this.stepped){if(ea==this.b1){return q.get(0,0,-this.jAcc)}else{return q.get(0,0,this.ratio*this.jAcc)}}else{return q.get(0,0,0)}};y.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}};y.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}};y.prototype.b1=null;y.prototype.b2=null;y.prototype.kMass=null;y.prototype.jAcc=null;y.prototype.jMax=null;y.prototype.stepped=null;y.prototype.copy=function(ea,eb){var ed=new bQ(null,null,this.rate,this.ratio);this.copyto(ed);if(ea!=null&&this.b1!=null){var eh=null;var ec=0;while(ec<ea.length){var ef=ea[ec];++ec;if(ef.id==this.b1.id){eh=ef.bc;break}}if(eh!=null){ed.zpp_inner_zn.b1=eh.zpp_inner}else{eb.push(cu.todo(this.b1.id,function(ej){ed.zpp_inner_zn.b1=ej.zpp_inner}))}}if(ea!=null&&this.b2!=null){var eg=null;var ee=0;while(ee<ea.length){var ei=ea[ee];++ee;if(ei.id==this.b2.id){eg=ei.bc;break}}if(eg!=null){ed.zpp_inner_zn.b2=eg.zpp_inner}else{eb.push(cu.todo(this.b2.id,function(ej){ed.zpp_inner_zn.b2=ej.zpp_inner}))}}return ed};y.prototype.validate=function(){if(this.b1==null||this.b2==null){throw new cE("Error: AngleJoint cannot be simulated null bodies")}if(this.b1==this.b2){throw new cE("Error: MotorJoint cannot be simulated with body1 == body2")}if(this.b1.space!=this.space||this.b2.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: Constraints cannot have both bodies non-dynamic")}};y.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}};y.prototype.forest=function(){if(this.b1.type==2){var en;if(this.b1.component==this.b1.component.parent){en=this.b1.component}else{var eo=this.b1.component;var em=null;while(eo!=eo.parent){var ei=eo.parent;eo.parent=em;em=eo;eo=ei}while(em!=null){var eh=em.parent;em.parent=eo;em=eh}en=eo}var er;if(this.component==this.component.parent){er=this.component}else{var et=this.component;var el=null;while(et!=et.parent){var eg=et.parent;et.parent=el;el=et;et=eg}while(el!=null){var ef=el.parent;el.parent=et;el=ef}er=et}if(en!=er){if(en.rank<er.rank){en.parent=er}else{if(en.rank>er.rank){er.parent=en}else{er.parent=en;en.rank++}}}}if(this.b2.type==2){var ee;if(this.b2.component==this.b2.component.parent){ee=this.b2.component}else{var es=this.b2.component;var ek=null;while(es!=es.parent){var ed=es.parent;es.parent=ek;ek=es;es=ed}while(ek!=null){var ec=ek.parent;ek.parent=es;ek=ec}ee=es}var ep;if(this.component==this.component.parent){ep=this.component}else{var eq=this.component;var ej=null;while(eq!=eq.parent){var eb=eq.parent;eq.parent=ej;ej=eq;eq=eb}while(ej!=null){var ea=ej.parent;ej.parent=eq;ej=ea}ep=eq}if(ee!=ep){if(ee.rank<ep.rank){ee.parent=ep}else{if(ee.rank>ep.rank){ep.parent=ee}else{ep.parent=ee;ee.rank++}}}}};y.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&this.b2.id==ea)){if(this.b1.id==ea){return this.b2.id==eb}else{return false}}else{return true}};y.prototype.clearcache=function(){this.jAcc=0;this.pre_dt=-1};y.prototype.preStep=function(ea){if(this.pre_dt==-1){this.pre_dt=ea}var eb=ea/this.pre_dt;this.pre_dt=ea;this.stepped=true;this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia;this.kMass=1/this.kMass;this.jAcc*=eb;this.jMax=this.maxForce*ea;return false};y.prototype.warmStart=function(){this.b1.angvel-=this.b1.iinertia*this.jAcc;this.b2.angvel+=this.ratio*this.b2.iinertia*this.jAcc};y.prototype.applyImpulseVel=function(){var ea=-this.kMass*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel-this.rate);var eb=this.jAcc;this.jAcc+=ea;if(this.breakUnderForce){if(this.jAcc>this.jMax||this.jAcc<-this.jMax){return true}}else{if(this.jAcc<-this.jMax){this.jAcc=-this.jMax}else{if(this.jAcc>this.jMax){this.jAcc=this.jMax}}}ea=this.jAcc-eb;this.b1.angvel-=this.b1.iinertia*ea;this.b2.angvel+=this.ratio*this.b2.iinertia*ea;return false};y.prototype.applyImpulsePos=function(){return false};y.prototype.__class__=y;var D=zpp_nape.constraint.ZPP_PivotJoint=function(){this.stepped=false;this.biasy=0;this.biasx=0;this.gamma=0;this.jMax=0;this.jAccy=0;this.jAccx=0;this.kMassc=0;this.kMassb=0;this.kMassa=0;this.wrap_a2=null;this.a2rely=0;this.a2relx=0;this.a2localy=0;this.a2localx=0;this.b2=null;this.wrap_a1=null;this.a1rely=0;this.a1relx=0;this.a1localy=0;this.a1localx=0;this.b1=null;this.outer_zn=null;b1.call(this);this.stepped=false;this.jAccx=0;this.jAccy=0;this.jMax=Infinity;this.a1localx=0;this.a1localy=0;this.a1relx=0;this.a1rely=0;this.a2localx=0;this.a2localy=0;this.a2relx=0;this.a2rely=0};D.__name__=["zpp_nape","constraint","ZPP_PivotJoint"];D.__super__=b1;D.prototype=Object.create(b1.prototype);D.prototype.outer_zn=null;D.prototype.bodyImpulse=function(ea){if(this.stepped){if(ea==this.b1){return q.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely))}else{return q.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely)}}else{return q.get(0,0,0)}};D.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}};D.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}};D.prototype.b1=null;D.prototype.a1localx=null;D.prototype.a1localy=null;D.prototype.a1relx=null;D.prototype.a1rely=null;D.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy};D.prototype.invalidate_a1=function(ea){this.immutable_midstep("Constraint::a1");this.a1localx=ea.x;this.a1localy=ea.y;this.wake()};D.prototype.setup_a1=function(){var ea=this.a1localx;var eh=this.a1localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a1=eb;this.wrap_a1.zpp_inner._inuse=true;this.wrap_a1.zpp_inner._validate=dX(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=dX(this,this.invalidate_a1)};D.prototype.wrap_a1=null;D.prototype.b2=null;D.prototype.a2localx=null;D.prototype.a2localy=null;D.prototype.a2relx=null;D.prototype.a2rely=null;D.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy};D.prototype.invalidate_a2=function(ea){this.immutable_midstep("Constraint::a2");this.a2localx=ea.x;this.a2localy=ea.y;this.wake()};D.prototype.setup_a2=function(){var ea=this.a2localx;var eh=this.a2localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a2=eb;this.wrap_a2.zpp_inner._inuse=true;this.wrap_a2.zpp_inner._validate=dX(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=dX(this,this.invalidate_a2)};D.prototype.wrap_a2=null;D.prototype.kMassa=null;D.prototype.kMassb=null;D.prototype.kMassc=null;D.prototype.jAccx=null;D.prototype.jAccy=null;D.prototype.jMax=null;D.prototype.gamma=null;D.prototype.biasx=null;D.prototype.biasy=null;D.prototype.stepped=null;D.prototype.copy=function(ea,eb){var ee=this.outer_zn;if(ee.zpp_inner_zn.wrap_a1==null){ee.zpp_inner_zn.setup_a1()}var ec=ee.zpp_inner_zn.wrap_a1;var eg=this.outer_zn;if(eg.zpp_inner_zn.wrap_a2==null){eg.zpp_inner_zn.setup_a2()}var ef=new bV(null,null,ec,eg.zpp_inner_zn.wrap_a2);this.copyto(ef);if(ea!=null&&this.b1!=null){var ek=null;var ed=0;while(ed<ea.length){var ej=ea[ed];++ed;if(ej.id==this.b1.id){ek=ej.bc;break}}if(ek!=null){ef.zpp_inner_zn.b1=ek.zpp_inner}else{eb.push(cu.todo(this.b1.id,function(em){ef.zpp_inner_zn.b1=em.zpp_inner}))}}if(ea!=null&&this.b2!=null){var ei=null;var eh=0;while(eh<ea.length){var el=ea[eh];++eh;if(el.id==this.b2.id){ei=el.bc;break}}if(ei!=null){ef.zpp_inner_zn.b2=ei.zpp_inner}else{eb.push(cu.todo(this.b2.id,function(em){ef.zpp_inner_zn.b2=em.zpp_inner}))}}return ef};D.prototype.validate=function(){if(this.b1==null||this.b2==null){throw new cE("Error: PivotJoint cannot be simulated null bodies")}if(this.b1==this.b2){throw new cE("Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2="+this.b1.outer.toString()+")")}if(this.b1.space!=this.space||this.b2.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: Constraints cannot have both bodies non-dynamic (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")")}};D.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}};D.prototype.forest=function(){if(this.b1.type==2){var en;if(this.b1.component==this.b1.component.parent){en=this.b1.component}else{var eo=this.b1.component;var em=null;while(eo!=eo.parent){var ei=eo.parent;eo.parent=em;em=eo;eo=ei}while(em!=null){var eh=em.parent;em.parent=eo;em=eh}en=eo}var er;if(this.component==this.component.parent){er=this.component}else{var et=this.component;var el=null;while(et!=et.parent){var eg=et.parent;et.parent=el;el=et;et=eg}while(el!=null){var ef=el.parent;el.parent=et;el=ef}er=et}if(en!=er){if(en.rank<er.rank){en.parent=er}else{if(en.rank>er.rank){er.parent=en}else{er.parent=en;en.rank++}}}}if(this.b2.type==2){var ee;if(this.b2.component==this.b2.component.parent){ee=this.b2.component}else{var es=this.b2.component;var ek=null;while(es!=es.parent){var ed=es.parent;es.parent=ek;ek=es;es=ed}while(ek!=null){var ec=ek.parent;ek.parent=es;ek=ec}ee=es}var ep;if(this.component==this.component.parent){ep=this.component}else{var eq=this.component;var ej=null;while(eq!=eq.parent){var eb=eq.parent;eq.parent=ej;ej=eq;eq=eb}while(ej!=null){var ea=ej.parent;ej.parent=eq;ej=ea}ep=eq}if(ee!=ep){if(ee.rank<ep.rank){ee.parent=ep}else{if(ee.rank>ep.rank){ep.parent=ee}else{ep.parent=ee;ee.rank++}}}}};D.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&this.b2.id==ea)){if(this.b1.id==ea){return this.b2.id==eb}else{return false}}else{return true}};D.prototype.clearcache=function(){this.jAccx=0;this.jAccy=0;this.pre_dt=-1};D.prototype.preStep=function(el){if(this.pre_dt==-1){this.pre_dt=el}var en=el/this.pre_dt;this.pre_dt=el;this.stepped=true;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var eo=this.b1.smass+this.b2.smass;this.kMassa=eo;this.kMassb=0;this.kMassc=eo;if(this.b1.sinertia!=0){var ec=this.a1relx*this.b1.sinertia;var eb=this.a1rely*this.b1.sinertia;this.kMassa+=eb*this.a1rely;this.kMassb+=-eb*this.a1relx;this.kMassc+=ec*this.a1relx}if(this.b2.sinertia!=0){var er=this.a2relx*this.b2.sinertia;var ee=this.a2rely*this.b2.sinertia;this.kMassa+=ee*this.a2rely;this.kMassb+=-ee*this.a2relx;this.kMassc+=er*this.a2relx}var ed=this.kMassa*this.kMassc-this.kMassb*this.kMassb;var eq;if(ed!=ed){this.kMassa=this.kMassb=this.kMassc=0;eq=3}else{if(ed==0){var ep=0;if(this.kMassa!=0){this.kMassa=1/this.kMassa}else{this.kMassa=0;ep=1}if(this.kMassc!=0){this.kMassc=1/this.kMassc}else{this.kMassc=0;ep|=2}this.kMassb=0;eq=ep}else{ed=1/ed;var ej=this.kMassc*ed;this.kMassc=this.kMassa*ed;this.kMassa=ej;this.kMassb*=-ed;eq=0}}if((eq&1)!=0){this.jAccx=0}if((eq&2)!=0){this.jAccy=0}if(!this.stiff){var ea;var em=2*Math.PI*this.frequency;this.gamma=1/(el*em*(2*this.damping+em*el));var ek=1/(1+this.gamma);ea=el*em*em*this.gamma;this.gamma*=ek;this.kMassa*=ek;this.kMassb*=ek;this.kMassc*=ek;this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);if(this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError){return true}var ei=-ea;this.biasx*=ei;this.biasy*=ei;var eh=this.maxError;var ef=this.biasx*this.biasx+this.biasy*this.biasy;if(ef>eh*eh){var eg=eh*(1/Math.sqrt(ef));this.biasx*=eg;this.biasy*=eg}}else{this.biasx=0;this.biasy=0;this.gamma=0}this.jAccx*=en;this.jAccy*=en;this.jMax=this.maxForce*el;return false};D.prototype.warmStart=function(){var ea=this.b1.imass;this.b1.velx-=this.jAccx*ea;this.b1.vely-=this.jAccy*ea;var eb=this.b2.imass;this.b2.velx+=this.jAccx*eb;this.b2.vely+=this.jAccy*eb;this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia};D.prototype.applyImpulseVel=function(){var ek=0;var ej=0;ek=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel));ej=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel));var ea=0;var em=0;ea=this.biasx-ek;em=this.biasy-ej;var el=this.kMassa*ea+this.kMassb*em;em=this.kMassb*ea+this.kMassc*em;ea=el;var eg=this.gamma;ea-=this.jAccx*eg;em-=this.jAccy*eg;var ei=0;var eh=0;ei=this.jAccx;eh=this.jAccy;this.jAccx+=ea;this.jAccy+=em;if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax){return true}}else{if(!this.stiff){var ef=this.jMax;var ee=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(ee>ef*ef){var ed=ef*(1/Math.sqrt(ee));this.jAccx*=ed;this.jAccy*=ed}}}ea=this.jAccx-ei;em=this.jAccy-eh;var ec=this.b1.imass;this.b1.velx-=ea*ec;this.b1.vely-=em*ec;var eb=this.b2.imass;this.b2.velx+=ea*eb;this.b2.vely+=em*eb;this.b1.angvel-=(em*this.a1relx-ea*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(em*this.a2relx-ea*this.a2rely)*this.b2.iinertia;return false};D.prototype.applyImpulsePos=function(){var eq=0;var eo=0;eq=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;eo=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var eh=0;var ef=0;eh=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;ef=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var eg=0;var ee=0;eg=this.b2.posx+eh-(this.b1.posx+eq);ee=this.b2.posy+ef-(this.b1.posy+eo);if(this.breakUnderError&&eg*eg+ee*ee>this.maxError*this.maxError){return true}if(eg*eg+ee*ee<P.constraintLinearSlop*P.constraintLinearSlop){return false}eg*=0.5;ee*=0.5;var ev=0;var er=0;if(eg*eg+ee*ee>6){var eJ=this.b1.smass+this.b2.smass;if(eJ>P.epsilon){eJ=0.75/eJ;ev=-eg*eJ;er=-ee*eJ;var ep=ev*ev+er*er;if(ep>400){var eE=20*(1/Math.sqrt(ep));ev*=eE;er*=eE}var eA=this.b1.imass;this.b1.posx-=ev*eA;this.b1.posy-=er*eA;var ez=this.b2.imass;this.b2.posx+=ev*ez;this.b2.posy+=er*ez;eg=this.b2.posx+eh-(this.b1.posx+eq);ee=this.b2.posy+ef-(this.b1.posy+eo);eg*=0.5;ee*=0.5}}var en=0;var em=0;var el=0;var eI=this.b1.smass+this.b2.smass;en=eI;em=0;el=eI;if(this.b1.sinertia!=0){var eb=eq*this.b1.sinertia;var ea=eo*this.b1.sinertia;en=eI+ea*eo;em+=-ea*eq;el=eI+eb*eq}if(this.b2.sinertia!=0){var eC=eh*this.b2.sinertia;var ej=ef*this.b2.sinertia;en+=ej*ef;em+=-ej*eh;el+=eC*eh}ev=-eg;er=-ee;var ek=ev*ev+er*er;if(ek>36){var ey=6*(1/Math.sqrt(ek));ev*=ey;er*=ey}var ei=en*el-em*em;if(ei!=ei){er=0;ev=er}else{if(ei==0){if(en!=0){ev/=en}else{ev=0}if(el!=0){er/=el}else{er=0}}else{ei=1/ei;var ex=ei*(el*ev-em*er);er=ei*(en*er-em*ev);ev=ex}}var ew=this.b1.imass;this.b1.posx-=ev*ew;this.b1.posy-=er*ew;var es=this.b2.imass;this.b2.posx+=ev*es;this.b2.posy+=er*es;var ec=this.b1;var ed=-(er*eq-ev*eo)*this.b1.iinertia;ec.rot+=ed;if(ed*ed>0.0001){ec.axisx=Math.sin(ec.rot);ec.axisy=Math.cos(ec.rot)}else{var eG=ed*ed;var eF=1-0.5*eG;var eL=1-eG*eG/8;var eH=(eF*ec.axisx+ed*ec.axisy)*eL;ec.axisy=(eF*ec.axisy-ed*ec.axisx)*eL;ec.axisx=eH}var eD=this.b2;var eB=(er*eh-ev*ef)*this.b2.iinertia;eD.rot+=eB;if(eB*eB>0.0001){eD.axisx=Math.sin(eD.rot);eD.axisy=Math.cos(eD.rot)}else{var eu=eB*eB;var eM=1-0.5*eu;var eK=1-eu*eu/8;var et=(eM*eD.axisx+eB*eD.axisy)*eK;eD.axisy=(eM*eD.axisy-eB*eD.axisx)*eK;eD.axisx=et}return false};D.prototype.draw=function(ea){};D.prototype.__class__=D;var N=zpp_nape.constraint.ZPP_PulleyJoint=function(){this.stepped=false;this.bias=0;this.gamma=0;this.jMax=0;this.jAcc=0;this.kMass=0;this.wrap_a4=null;this.a4rely=0;this.a4relx=0;this.a4localy=0;this.a4localx=0;this.b4=null;this.wrap_a3=null;this.a3rely=0;this.a3relx=0;this.a3localy=0;this.a3localx=0;this.b3=null;this.wrap_a2=null;this.a2rely=0;this.a2relx=0;this.a2localy=0;this.a2localx=0;this.b2=null;this.wrap_a1=null;this.a1rely=0;this.a1relx=0;this.a1localy=0;this.a1localx=0;this.b1=null;this.cx4=0;this.cx3=0;this.cx2=0;this.cx1=0;this.n34y=0;this.n34x=0;this.n12y=0;this.n12x=0;this.equal=false;this.slack=false;this.jointMax=0;this.jointMin=0;this.ratio=1;this.outer_zn=null;b1.call(this);this.a1localx=0;this.a1localy=0;this.a1relx=0;this.a1rely=0;this.a2localx=0;this.a2localy=0;this.a2relx=0;this.a2rely=0;this.a3localx=0;this.a3localy=0;this.a3relx=0;this.a3rely=0;this.a4localx=0;this.a4localy=0;this.a4relx=0;this.a4rely=0;this.n12x=1;this.n12y=0;this.n34x=1;this.n34y=0;this.jAcc=0;this.jMax=Infinity;this.stepped=false;this.cx1=this.cx2=this.cx3=this.cx4=0};N.__name__=["zpp_nape","constraint","ZPP_PulleyJoint"];N.__super__=b1;N.prototype=Object.create(b1.prototype);N.prototype.outer_zn=null;N.prototype.ratio=null;N.prototype.jointMin=null;N.prototype.jointMax=null;N.prototype.slack=null;N.prototype.equal=null;N.prototype.is_slack=function(){var ec;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy;this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy;this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy;this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var ef=0;var ee=0;var ed=0;var eb=0;ef=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);ee=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);ed=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx);eb=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var eh=Math.sqrt(ef*ef+ee*ee);var ea=Math.sqrt(ed*ed+eb*eb);if(ea==0){Math.sqrt(0)}var eg=eh+this.ratio*ea;if(this.equal){ec=false}else{if(eg<this.jointMin){ec=false}else{if(eg>this.jointMax){eg-=this.jointMax;ec=false}else{eg=0;ec=true}}}return ec};N.prototype.n12x=null;N.prototype.n12y=null;N.prototype.n34x=null;N.prototype.n34y=null;N.prototype.cx1=null;N.prototype.cx2=null;N.prototype.cx3=null;N.prototype.cx4=null;N.prototype.bodyImpulse=function(ex){if(this.stepped){var ey=q.get();if(ex==this.b1){var ep=ey.zpp_inner;if(ep._validate!=null){ep._validate()}ey.zpp_inner.x=ey.zpp_inner.x-this.jAcc*this.n12x;var ew=ey.zpp_inner;if(ew._validate!=null){ew._validate()}var ev=ey.zpp_inner;if(ev._validate!=null){ev._validate()}ey.zpp_inner.y=ey.zpp_inner.y-this.jAcc*this.n12y;var eu=ey.zpp_inner;if(eu._validate!=null){eu._validate()}var et=ey.zpp_inner;if(et._validate!=null){et._validate()}ey.zpp_inner.z=ey.zpp_inner.z-this.cx1*this.jAcc;var es=ey.zpp_inner;if(es._validate!=null){es._validate()}}if(ex==this.b2){var er=ey.zpp_inner;if(er._validate!=null){er._validate()}ey.zpp_inner.x=ey.zpp_inner.x+this.jAcc*this.n12x;var eo=ey.zpp_inner;if(eo._validate!=null){eo._validate()}var em=ey.zpp_inner;if(em._validate!=null){em._validate()}ey.zpp_inner.y=ey.zpp_inner.y+this.jAcc*this.n12y;var ek=ey.zpp_inner;if(ek._validate!=null){ek._validate()}var eq=ey.zpp_inner;if(eq._validate!=null){eq._validate()}ey.zpp_inner.z=ey.zpp_inner.z+this.cx2*this.jAcc;var en=ey.zpp_inner;if(en._validate!=null){en._validate()}}if(ex==this.b3){var el=ey.zpp_inner;if(el._validate!=null){el._validate()}ey.zpp_inner.x=ey.zpp_inner.x-this.jAcc*this.n34x;var ej=ey.zpp_inner;if(ej._validate!=null){ej._validate()}var ei=ey.zpp_inner;if(ei._validate!=null){ei._validate()}ey.zpp_inner.y=ey.zpp_inner.y-this.jAcc*this.n34y;var eh=ey.zpp_inner;if(eh._validate!=null){eh._validate()}var eg=ey.zpp_inner;if(eg._validate!=null){eg._validate()}ey.zpp_inner.z=ey.zpp_inner.z-this.cx3*this.jAcc;var ef=ey.zpp_inner;if(ef._validate!=null){ef._validate()}}if(ex==this.b4){var ee=ey.zpp_inner;if(ee._validate!=null){ee._validate()}ey.zpp_inner.x=ey.zpp_inner.x+this.jAcc*this.n34x;var ed=ey.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=ey.zpp_inner;if(ec._validate!=null){ec._validate()}ey.zpp_inner.y=ey.zpp_inner.y+this.jAcc*this.n34y;var eb=ey.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=ey.zpp_inner;if(ea._validate!=null){ea._validate()}ey.zpp_inner.z=ey.zpp_inner.z+this.cx4*this.jAcc;var ez=ey.zpp_inner;if(ez._validate!=null){ez._validate()}}return ey}else{return q.get(0,0,0)}};N.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}if(this.b3!=this.b1&&this.b3!=this.b2){if(this.b3!=null){this.b3.constraints.add(this)}}if(this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3){if(this.b4!=null){this.b4.constraints.add(this)}}};N.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}if(this.b3!=this.b1&&this.b3!=this.b2){if(this.b3!=null){this.b3.constraints.remove(this)}}if(this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3){if(this.b4!=null){this.b4.constraints.remove(this)}}};N.prototype.b1=null;N.prototype.a1localx=null;N.prototype.a1localy=null;N.prototype.a1relx=null;N.prototype.a1rely=null;N.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy};N.prototype.invalidate_a1=function(ea){this.immutable_midstep("Constraint::a1");this.a1localx=ea.x;this.a1localy=ea.y;this.wake()};N.prototype.setup_a1=function(){var ea=this.a1localx;var eh=this.a1localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a1=eb;this.wrap_a1.zpp_inner._inuse=true;this.wrap_a1.zpp_inner._validate=dX(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=dX(this,this.invalidate_a1)};N.prototype.wrap_a1=null;N.prototype.b2=null;N.prototype.a2localx=null;N.prototype.a2localy=null;N.prototype.a2relx=null;N.prototype.a2rely=null;N.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy};N.prototype.invalidate_a2=function(ea){this.immutable_midstep("Constraint::a2");this.a2localx=ea.x;this.a2localy=ea.y;this.wake()};N.prototype.setup_a2=function(){var ea=this.a2localx;var eh=this.a2localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a2=eb;this.wrap_a2.zpp_inner._inuse=true;this.wrap_a2.zpp_inner._validate=dX(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=dX(this,this.invalidate_a2)};N.prototype.wrap_a2=null;N.prototype.b3=null;N.prototype.a3localx=null;N.prototype.a3localy=null;N.prototype.a3relx=null;N.prototype.a3rely=null;N.prototype.validate_a3=function(){this.wrap_a3.zpp_inner.x=this.a3localx;this.wrap_a3.zpp_inner.y=this.a3localy};N.prototype.invalidate_a3=function(ea){this.immutable_midstep("Constraint::a3");this.a3localx=ea.x;this.a3localy=ea.y;this.wake()};N.prototype.setup_a3=function(){var ea=this.a3localx;var eh=this.a3localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a3=eb;this.wrap_a3.zpp_inner._inuse=true;this.wrap_a3.zpp_inner._validate=dX(this,this.validate_a3);this.wrap_a3.zpp_inner._invalidate=dX(this,this.invalidate_a3)};N.prototype.wrap_a3=null;N.prototype.b4=null;N.prototype.a4localx=null;N.prototype.a4localy=null;N.prototype.a4relx=null;N.prototype.a4rely=null;N.prototype.validate_a4=function(){this.wrap_a4.zpp_inner.x=this.a4localx;this.wrap_a4.zpp_inner.y=this.a4localy};N.prototype.invalidate_a4=function(ea){this.immutable_midstep("Constraint::a4");this.a4localx=ea.x;this.a4localy=ea.y;this.wake()};N.prototype.setup_a4=function(){var ea=this.a4localx;var eh=this.a4localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a4=eb;this.wrap_a4.zpp_inner._inuse=true;this.wrap_a4.zpp_inner._validate=dX(this,this.validate_a4);this.wrap_a4.zpp_inner._invalidate=dX(this,this.invalidate_a4)};N.prototype.wrap_a4=null;N.prototype.kMass=null;N.prototype.jAcc=null;N.prototype.jMax=null;N.prototype.gamma=null;N.prototype.bias=null;N.prototype.stepped=null;N.prototype.copy=function(ed,eg){var ep=this.outer_zn;if(ep.zpp_inner_zn.wrap_a1==null){ep.zpp_inner_zn.setup_a1()}var et=ep.zpp_inner_zn.wrap_a1;var es=this.outer_zn;if(es.zpp_inner_zn.wrap_a2==null){es.zpp_inner_zn.setup_a2()}var eo=es.zpp_inner_zn.wrap_a2;var er=this.outer_zn;if(er.zpp_inner_zn.wrap_a3==null){er.zpp_inner_zn.setup_a3()}var en=er.zpp_inner_zn.wrap_a3;var eq=this.outer_zn;if(eq.zpp_inner_zn.wrap_a4==null){eq.zpp_inner_zn.setup_a4()}var ev=new dy(null,null,null,null,et,eo,en,eq.zpp_inner_zn.wrap_a4,this.jointMin,this.jointMax,this.ratio);this.copyto(ev);if(ed!=null&&this.b1!=null){var eu=null;var eb=0;while(eb<ed.length){var ea=ed[eb];++eb;if(ea.id==this.b1.id){eu=ea.bc;break}}if(eu!=null){ev.zpp_inner_zn.b1=eu.zpp_inner}else{eg.push(cu.todo(this.b1.id,function(ew){ev.zpp_inner_zn.b1=ew.zpp_inner}))}}if(ed!=null&&this.b2!=null){var ef=null;var ek=0;while(ek<ed.length){var em=ed[ek];++ek;if(em.id==this.b2.id){ef=em.bc;break}}if(ef!=null){ev.zpp_inner_zn.b2=ef.zpp_inner}else{eg.push(cu.todo(this.b2.id,function(ew){ev.zpp_inner_zn.b2=ew.zpp_inner}))}}if(ed!=null&&this.b3!=null){var ee=null;var ei=0;while(ei<ed.length){var el=ed[ei];++ei;if(el.id==this.b3.id){ee=el.bc;break}}if(ee!=null){ev.zpp_inner_zn.b3=ee.zpp_inner}else{eg.push(cu.todo(this.b3.id,function(ew){ev.zpp_inner_zn.b3=ew.zpp_inner}))}}if(ed!=null&&this.b4!=null){var ec=null;var eh=0;while(eh<ed.length){var ej=ed[eh];++eh;if(ej.id==this.b4.id){ec=ej.bc;break}}if(ec!=null){ev.zpp_inner_zn.b4=ec.zpp_inner}else{eg.push(cu.todo(this.b4.id,function(ew){ev.zpp_inner_zn.b4=ew.zpp_inner}))}}return ev};N.prototype.validate=function(){if(this.b1==null||this.b2==null||this.b3==null||this.b4==null){throw new cE("Error: PulleyJoint cannot be simulated with null bodies")}if(this.b1==this.b2||this.b3==this.b4){throw new cE("Error: PulleyJoint cannot have body1==body2 or body3==body4")}if(this.b1.space!=this.space||this.b2.space!=this.space||this.b3.space!=this.space||this.b4.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned")}if(this.jointMin>this.jointMax){throw new cE("Error: PulleyJoint must have jointMin <= jointMax")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic")}if(this.b3.type!=2&&this.b4.type!=2){throw new cE("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic")}};N.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}if(this.b3!=null&&this.b3.type==2){this.b3.wake()}if(this.b4!=null&&this.b4.type==2){this.b4.wake()}};N.prototype.forest=function(){if(this.b1.type==2){var eD;if(this.b1.component==this.b1.component.parent){eD=this.b1.component}else{var eb=this.b1.component;var ex=null;while(eb!=eb.parent){var eL=eb.parent;eb.parent=ex;ex=eb;eb=eL}while(ex!=null){var eN=ex.parent;ex.parent=eb;ex=eN}eD=eb}var er;if(this.component==this.component.parent){er=this.component}else{var eh=this.component;var eC=null;while(eh!=eh.parent){var eM=eh.parent;eh.parent=eC;eC=eh;eh=eM}while(eC!=null){var eK=eC.parent;eC.parent=eh;eC=eK}er=eh}if(eD!=er){if(eD.rank<er.rank){eD.parent=er}else{if(eD.rank>er.rank){er.parent=eD}else{er.parent=eD;eD.rank++}}}}if(this.b2.type==2){var eu;if(this.b2.component==this.b2.component.parent){eu=this.b2.component}else{var eg=this.b2.component;var eB=null;while(eg!=eg.parent){var eJ=eg.parent;eg.parent=eB;eB=eg;eg=eJ}while(eB!=null){var eI=eB.parent;eB.parent=eg;eB=eI}eu=eg}var eq;if(this.component==this.component.parent){eq=this.component}else{var ef=this.component;var eA=null;while(ef!=ef.parent){var eH=ef.parent;ef.parent=eA;eA=ef;ef=eH}while(eA!=null){var eG=eA.parent;eA.parent=ef;eA=eG}eq=ef}if(eu!=eq){if(eu.rank<eq.rank){eu.parent=eq}else{if(eu.rank>eq.rank){eq.parent=eu}else{eq.parent=eu;eu.rank++}}}}if(this.b3.type==2){var et;if(this.b3.component==this.b3.component.parent){et=this.b3.component}else{var ee=this.b3.component;var ez=null;while(ee!=ee.parent){var eF=ee.parent;ee.parent=ez;ez=ee;ee=eF}while(ez!=null){var eE=ez.parent;ez.parent=ee;ez=eE}et=ee}var ep;if(this.component==this.component.parent){ep=this.component}else{var ed=this.component;var ey=null;while(ed!=ed.parent){var en=ed.parent;ed.parent=ey;ey=ed;ed=en}while(ey!=null){var em=ey.parent;ey.parent=ed;ey=em}ep=ed}if(et!=ep){if(et.rank<ep.rank){et.parent=ep}else{if(et.rank>ep.rank){ep.parent=et}else{ep.parent=et;et.rank++}}}}if(this.b4.type==2){var es;if(this.b4.component==this.b4.component.parent){es=this.b4.component}else{var ec=this.b4.component;var ew=null;while(ec!=ec.parent){var el=ec.parent;ec.parent=ew;ew=ec;ec=el}while(ew!=null){var ek=ew.parent;ew.parent=ec;ew=ek}es=ec}var eo;if(this.component==this.component.parent){eo=this.component}else{var ea=this.component;var ev=null;while(ea!=ea.parent){var ej=ea.parent;ea.parent=ev;ev=ea;ea=ej}while(ev!=null){var ei=ev.parent;ev.parent=ea;ev=ei}eo=ea}if(es!=eo){if(es.rank<eo.rank){es.parent=eo}else{if(es.rank>eo.rank){eo.parent=es}else{eo.parent=es;es.rank++}}}}};N.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&(this.b2.id==ea||this.b3.id==ea||this.b4.id==ea)||this.b2.id==eb&&(this.b3.id==ea||this.b4.id==ea||this.b1.id==ea)||this.b3.id==eb&&(this.b4.id==ea||this.b1.id==ea||this.b2.id==ea))){if(this.b4.id==eb){if(!(this.b1.id==ea||this.b2.id==ea)){return this.b3.id==ea}else{return true}}else{return false}}else{return true}};N.prototype.clearcache=function(){this.jAcc=0;this.pre_dt=-1};N.prototype.preStep=function(ei){if(this.pre_dt==-1){this.pre_dt=ei}var en=ei/this.pre_dt;this.pre_dt=ei;this.stepped=true;this.equal=this.jointMin==this.jointMax;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy;this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy;this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy;this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var er=0;var eq=0;var em=0;var el=0;er=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);eq=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);em=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx);el=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var eo=Math.sqrt(er*er+eq*eq);var eb=Math.sqrt(em*em+el*el);if(eo!=0){var eg=1/eo;this.n12x=er*eg;this.n12y=eq*eg}if(eb!=0){var ef=1/eb;this.n34x=em*ef;this.n34y=el*ef;var ee=this.ratio;this.n34x*=ee;this.n34y*=ee}else{var ed=this.ratio/Math.sqrt(this.n34x*this.n34x+this.n34y*this.n34y);this.n34x*=ed;this.n34y*=ed}var ej=eo+this.ratio*eb;if(this.equal){ej-=this.jointMax;this.slack=false}else{if(ej<this.jointMin){ej=this.jointMin-ej;this.n12x=-this.n12x;this.n12y=-this.n12y;this.n34x=-this.n34x;this.n34y=-this.n34y;this.slack=false}else{if(ej>this.jointMax){ej-=this.jointMax;this.slack=false}else{this.n12x=0;this.n12y=0;this.n34x=0;this.n34y=0;ej=0;this.slack=true}}}var ep=ej;if(!this.slack){this.cx1=this.n12y*this.a1relx-this.n12x*this.a1rely;this.cx2=this.n12y*this.a2relx-this.n12x*this.a2rely;this.cx3=this.n34y*this.a3relx-this.n34x*this.a3rely;this.cx4=this.n34y*this.a4relx-this.n34x*this.a4rely;var ec=this.b1.smass+this.b2.smass+this.ratio*this.ratio*(this.b3.smass+this.b4.smass)+this.b1.sinertia*this.cx1*this.cx1+this.b2.sinertia*this.cx2*this.cx2+this.b3.sinertia*this.cx3*this.cx3+this.b4.sinertia*this.cx4*this.cx4;if(this.b1==this.b4){ec-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx4*this.b1.sinertia)}if(this.b1==this.b3){ec+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx3*this.b1.sinertia)}if(this.b2==this.b3){ec-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx3*this.b2.sinertia)}if(this.b2==this.b4){ec+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx4*this.b2.sinertia)}this.kMass=ec;if(this.kMass!=0){this.kMass=1/this.kMass}else{this.jAcc=0}if(!this.stiff){if(this.breakUnderError&&ep*ep>this.maxError*this.maxError){return true}var ea;var ek=2*Math.PI*this.frequency;this.gamma=1/(ei*ek*(2*this.damping+ek*ei));var eh=1/(1+this.gamma);ea=ei*ek*ek*this.gamma;this.gamma*=eh;this.kMass*=eh;this.bias=-ep*ea;if(this.bias<-this.maxError){this.bias=-this.maxError}else{if(this.bias>this.maxError){this.bias=this.maxError}}}else{this.bias=0;this.gamma=0}this.jAcc*=en;this.jMax=this.maxForce*ei}return false};N.prototype.warmStart=function(){if(!this.slack){var eb=this.b1.imass*this.jAcc;this.b1.velx-=this.n12x*eb;this.b1.vely-=this.n12y*eb;var ed=this.b2.imass*this.jAcc;this.b2.velx+=this.n12x*ed;this.b2.vely+=this.n12y*ed;var ec=this.b3.imass*this.jAcc;this.b3.velx-=this.n34x*ec;this.b3.vely-=this.n34y*ec;var ea=this.b4.imass*this.jAcc;this.b4.velx+=this.n34x*ea;this.b4.vely+=this.n34y*ea;this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc;this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc;this.b3.angvel-=this.cx3*this.b3.iinertia*this.jAcc;this.b4.angvel+=this.cx4*this.b4.iinertia*this.jAcc}};N.prototype.applyImpulseVel=function(){if(this.slack){return false}var ea=this.kMass*(this.bias-(this.n12x*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.n12y*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+this.n34x*(this.b4.velx+this.b4.kinvelx-this.b3.velx-this.b3.kinvelx)+this.n34y*(this.b4.vely+this.b4.kinvely-this.b3.vely-this.b3.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1+(this.b4.angvel+this.b4.kinangvel)*this.cx4-(this.b3.angvel+this.b3.kinangvel)*this.cx3))-this.jAcc*this.gamma;var ef=this.jAcc;this.jAcc+=ea;if(!this.equal&&this.jAcc>0){this.jAcc=0}if(this.breakUnderForce&&this.jAcc<-this.jMax){return true}if(!this.stiff){if(this.jAcc<-this.jMax){this.jAcc=-this.jMax}}ea=this.jAcc-ef;var ec=this.b1.imass*ea;this.b1.velx-=this.n12x*ec;this.b1.vely-=this.n12y*ec;var ee=this.b2.imass*ea;this.b2.velx+=this.n12x*ee;this.b2.vely+=this.n12y*ee;var ed=this.b3.imass*ea;this.b3.velx-=this.n34x*ed;this.b3.vely-=this.n34y*ed;var eb=this.b4.imass*ea;this.b4.velx+=this.n34x*eb;this.b4.vely+=this.n34y*eb;this.b1.angvel-=this.cx1*this.b1.iinertia*ea;this.b2.angvel+=this.cx2*this.b2.iinertia*ea;this.b3.angvel-=this.cx3*this.b3.iinertia*ea;this.b4.angvel+=this.cx4*this.b4.iinertia*ea;return false};N.prototype.applyImpulsePos=function(){var eZ;var eI;var fa=0;var e9=0;fa=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;e9=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var e2=0;var e1=0;e2=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;e1=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var eR=0;var eP=0;eR=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy;eP=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy;var ey=0;var ew=0;ey=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy;ew=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var eM;var eX=0;var eW=0;var eu=0;var et=0;eX=this.n12x;eW=this.n12y;eu=this.n34x;et=this.n34y;var e5=0;var e4=0;var eA=0;var ez=0;e5=this.b2.posx+e2-(this.b1.posx+fa);e4=this.b2.posy+e1-(this.b1.posy+e9);eA=this.b4.posx+ey-(this.b3.posx+eR);ez=this.b4.posy+ew-(this.b3.posy+eP);var e3=Math.sqrt(e5*e5+e4*e4);var ex=Math.sqrt(eA*eA+ez*ez);if(e3!=0){var eC=1/e3;eX=e5*eC;eW=e4*eC}if(ex!=0){var fl=1/ex;eu=eA*fl;et=ez*fl;var fk=this.ratio;eu*=fk;et*=fk}else{var fj=this.ratio/Math.sqrt(eu*eu+et*et);eu*=fj;et*=fj}var e0=e3+this.ratio*ex;if(this.equal){e0-=this.jointMax;eM=false}else{if(e0<this.jointMin){e0=this.jointMin-e0;eX=-eX;eW=-eW;eu=-eu;et=-et;eM=false}else{if(e0>this.jointMax){e0-=this.jointMax;eM=false}else{eX=0;eW=0;eu=0;et=0;e0=0;eM=true}}}eZ=e0;if(!eM){if(this.breakUnderError&&eZ*eZ>this.maxError*this.maxError){return true}if(eZ*eZ<P.constraintLinearSlop*P.constraintLinearSlop){return false}eZ*=0.5;if(eZ*eZ>6){var eG=this.b1.smass+this.b2.smass;if(eG>P.epsilon){eG=0.75/eG;eI=-eZ*eG;if(this.equal||eI<0){var fi=eI*this.b1.imass;this.b1.posx-=eX*fi;this.b1.posy-=eW*fi;var fh=eI*this.b2.imass;this.b2.posx+=eX*fh;this.b2.posy+=eW*fh;var fg=eI*this.b3.imass;this.b3.posx-=eu*fg;this.b3.posy-=et*fg;var ff=eI*this.b4.imass;this.b4.posx+=eu*ff;this.b4.posy+=et*ff;var eh=0;var fn=0;var eg=0;var fm=0;eh=this.b2.posx+e2-(this.b1.posx+fa);fn=this.b2.posy+e1-(this.b1.posy+e9);eg=this.b4.posx+ey-(this.b3.posx+eR);fm=this.b4.posy+ew-(this.b3.posy+eP);var fb=Math.sqrt(eh*eh+fn*fn);var eK=Math.sqrt(eg*eg+fm*fm);if(fb!=0){var fe=1/fb;eX=eh*fe;eW=fn*fe}if(eK!=0){var fd=1/eK;eu=eg*fd;et=fm*fd;var eq=this.ratio;eu*=eq;et*=eq}else{var eo=this.ratio/Math.sqrt(eu*eu+et*et);eu*=eo;et*=eo}var fc=fb+this.ratio*eK;if(this.equal){fc-=this.jointMax}else{if(fc<this.jointMin){fc=this.jointMin-fc;eX=-eX;eW=-eW;eu=-eu;et=-et}else{if(fc>this.jointMax){fc-=this.jointMax}else{eX=0;eW=0;eu=0;et=0;fc=0}}}eZ=fc;eZ*=0.5}}}var er;var ep;var en;var el;er=eW*fa-eX*e9;ep=eW*e2-eX*e1;en=et*eR-eu*eP;el=et*ey-eu*ew;var eY=this.b1.smass+this.b2.smass+this.ratio*this.ratio*(this.b3.smass+this.b4.smass)+this.b1.sinertia*er*er+this.b2.sinertia*ep*ep+this.b3.sinertia*en*en+this.b4.sinertia*el*el;if(this.b1==this.b4){eY-=2*((eX*eu+eW*et)*this.b1.smass+er*el*this.b1.sinertia)}if(this.b1==this.b3){eY+=2*((eX*eu+eW*et)*this.b1.smass+er*en*this.b1.sinertia)}if(this.b2==this.b3){eY-=2*((eX*eu+eW*et)*this.b2.smass+ep*en*this.b2.sinertia)}if(this.b2==this.b4){eY+=2*((eX*eu+eW*et)*this.b2.smass+ep*el*this.b2.sinertia)}var eB=eY;if(eB!=0){eB=1/eB}eI=-eZ*eB;if(this.equal||eI<0){var em=this.b1.imass*eI;this.b1.posx-=eX*em;this.b1.posy-=eW*em;var ek=this.b2.imass*eI;this.b2.posx+=eX*ek;this.b2.posy+=eW*ek;var ej=this.b3.imass*eI;this.b3.posx-=eu*ej;this.b3.posy-=et*ej;var ei=this.b4.imass*eI;this.b4.posx+=eu*ei;this.b4.posy+=et*ei;var ev=this.b1;var es=-er*this.b1.iinertia*eI;ev.rot+=es;if(es*es>0.0001){ev.axisx=Math.sin(ev.rot);ev.axisy=Math.cos(ev.rot)}else{var eQ=es*es;var eD=1-0.5*eQ;var eE=1-eQ*eQ/8;var eS=(eD*ev.axisx+es*ev.axisy)*eE;ev.axisy=(eD*ev.axisy-es*ev.axisx)*eE;ev.axisx=eS}var eJ=this.b2;var ef=ep*this.b2.iinertia*eI;eJ.rot+=ef;if(ef*ef>0.0001){eJ.axisx=Math.sin(eJ.rot);eJ.axisy=Math.cos(eJ.rot)}else{var eO=ef*ef;var eV=1-0.5*eO;var ec=1-eO*eO/8;var e8=(eV*eJ.axisx+ef*eJ.axisy)*ec;eJ.axisy=(eV*eJ.axisy-ef*eJ.axisx)*ec;eJ.axisx=e8}var eH=this.b3;var ee=-en*this.b3.iinertia*eI;eH.rot+=ee;if(ee*ee>0.0001){eH.axisx=Math.sin(eH.rot);eH.axisy=Math.cos(eH.rot)}else{var eN=ee*ee;var eU=1-0.5*eN;var eb=1-eN*eN/8;var e7=(eU*eH.axisx+ee*eH.axisy)*eb;eH.axisy=(eU*eH.axisy-ee*eH.axisx)*eb;eH.axisx=e7}var eF=this.b4;var ed=el*this.b4.iinertia*eI;eF.rot+=ed;if(ed*ed>0.0001){eF.axisx=Math.sin(eF.rot);eF.axisy=Math.cos(eF.rot)}else{var eL=ed*ed;var eT=1-0.5*eL;var ea=1-eL*eL/8;var e6=(eT*eF.axisx+ed*eF.axisy)*ea;eF.axisy=(eT*eF.axisy-ed*eF.axisx)*ea;eF.axisx=e6}}}return false};N.prototype.draw=function(ea){};N.prototype.__class__=N;var b4=zpp_nape.constraint.ZPP_UserConstraint=function(ee,ec){this.jOld=null;this.J=null;this.vec3=null;this.Keff=null;this.jMax=0;this.velonly=false;this.gamma=0;this.soft=0;this.y=null;this.L=null;this.stepped=false;this.bias=null;this.jAcc=null;this.dim=0;this.bodies=null;this.outer_zn=null;b1.call(this);this.bodies=[];this.dim=ee;this.velonly=ec;this.jAcc=[];this.bias=[];this.L=[];this.J=[];this.jOld=[];this.y=[];this.Keff=[];this.vec3=q.get(0,0,0);var ed=0;while(ed<ee){var ea=ed++;this.J[ea]=this.jOld[ea]=this.y[ea]=0;this.bias[ea]=0;this.jAcc[ea]=0;var eb=0;while(eb<ee){this.L[ea*ee+eb++]=0}}this.stepped=false};b4.__name__=["zpp_nape","constraint","ZPP_UserConstraint"];b4.__super__=b1;b4.prototype=Object.create(b1.prototype);b4.prototype.outer_zn=null;b4.prototype.bindVec2_invalidate=function(ea){this.outer_zn.__invalidate()};b4.prototype.bodies=null;b4.prototype.dim=null;b4.prototype.jAcc=null;b4.prototype.bias=null;b4.prototype.addBody=function(eb){var ec=null;var ee=0;var ed=this.bodies;while(ee<ed.length){var ea=ed[ee];++ee;if(ea.body==eb){ec=ea;break}}if(ec==null){this.bodies.push(new l(1,eb));if(this.active&&this.space!=null){if(eb!=null){eb.constraints.add(this)}}}else{ec.cnt++}};b4.prototype.remBody=function(eb){var ec=null;var ee=this.bodies.length|0;var ed=0;while(ed<ee){var ea=this.bodies[ed];if(ea.body==eb){ea.cnt--;if(ea.cnt==0){if(ee>0){this.bodies[ed]=this.bodies[ee-1]}this.bodies.pop();if(this.active&&this.space!=null){if(eb!=null){eb.constraints.remove(this)}}}ec=ea;break}++ed}return ec!=null};b4.prototype.bodyImpulse=function(ea){var ed=0;var ee=this.dim;while(ed<ee){var ec=ed++;this.J[ec]=this.jAcc[ec]}var eb=q.get(0,0,0);if(this.stepped){this.outer_zn.__impulse(this.J,ea.outer,eb)}return eb};b4.prototype.activeBodies=function(){var ec=0;var eb=this.bodies;while(ec<eb.length){var ea=eb[ec];++ec;if(ea.body!=null){ea.body.constraints.add(this)}}};b4.prototype.inactiveBodies=function(){var ec=0;var eb=this.bodies;while(ec<eb.length){var ea=eb[ec];++ec;if(ea.body!=null){ea.body.constraints.remove(this)}}};b4.prototype.stepped=null;b4.prototype.copy=function(eb,ea){this.copyto(this.outer_zn.__copy());throw new cE("not done yet")};b4.prototype.validate=function(){var ec=0;var eb=this.bodies;while(ec<eb.length){var ea=eb[ec];++ec;if(ea.body.space!=this.space){throw new cE("Error: Constraints must have each body within the same sapce to which the constraint has been assigned")}}this.outer_zn.__validate()};b4.prototype.wake_connected=function(){var ec=0;var eb=this.bodies;while(ec<eb.length){var ea=eb[ec];++ec;if(ea.body.type==2){ea.body.wake()}}};b4.prototype.forest=function(){var ef=0;var eg=this.bodies;while(ef<eg.length){var eh=eg[ef];++ef;if(eh.body.type==2){var ec;if(eh.body.component==eh.body.component.parent){ec=eh.body.component}else{var ee=eh.body.component;var ei=null;while(ee!=ee.parent){var eb=ee.parent;ee.parent=ei;ei=ee;ee=eb}while(ei!=null){var el=ei.parent;ei.parent=ee;ei=el}ec=ee}var em;if(this.component==this.component.parent){em=this.component}else{var ed=this.component;var ea=null;while(ed!=ed.parent){var ek=ed.parent;ed.parent=ea;ea=ed;ed=ek}while(ea!=null){var ej=ea.parent;ea.parent=ed;ea=ej}em=ed}if(ec!=em){if(ec.rank<em.rank){ec.parent=em}else{if(ec.rank>em.rank){em.parent=ec}else{em.parent=ec;ec.rank++}}}}}};b4.prototype.pair_exists=function(ea,ef){var ee=false;var eb=this.bodies.length|0;var eh=0;while(eh<eb){var ec=eh++;var ei=this.bodies[ec].body;var ed=ec+1;while(ed<eb){var eg=this.bodies[ed++].body;if(ei.id==ea&&eg.id==ef||ei.id==ef&&eg.id==ea){ee=true;break}}if(ee){break}}return ee};b4.prototype.broken=function(){this.outer_zn.__broken()};b4.prototype.clearcache=function(){var ea=0;var eb=this.dim;while(ea<eb){this.jAcc[ea++]=0}this.pre_dt=-1};b4.prototype.lsq=function(ea){var ec=0;var ed=0;var ee=this.dim;while(ed<ee){var eb=ed++;ec+=ea[eb]*ea[eb]}return ec};b4.prototype._clamp=function(ec,eb){var ea=this.lsq(ec);if(ea>eb*eb){var ef=eb/Math.sqrt(ea);var ed=0;var ee=this.dim;while(ed<ee){ec[ed++]*=ef}}};b4.prototype.L=null;b4.prototype.solve=function(eo){var eg=0;var en=0;var ed=this.dim;while(en<ed){var eq=en++;var ec=0;var el=0;var em=eq-1;while(el<em){var ep=el++;ec+=this.L[eq*this.dim+ep]*this.L[eq*this.dim+ep]}var ee=Math.sqrt(eo[eg++]-ec);this.L[eq*this.dim+eq]=ee;if(ee!=0){ee=1/ee;var ei=eq+1;var eb=this.dim;while(ei<eb){var er=ei++;var es=0;var ej=0;var ek=eq-1;while(ej<ek){var ef=ej++;es+=this.L[er*this.dim+ef]*this.L[eq*this.dim+ef]}this.L[er*this.dim+eq]=ee*(eo[eg++]-es)}}else{var eh=eq+1;var ea=this.dim;while(eh<ea){this.L[eh++*this.dim+eq]=0}eg+=this.dim-eq-1}}return this.L};b4.prototype.y=null;b4.prototype.transform=function(en,ep){var em=0;var eh=this.dim;while(em<eh){var eg=em++;var ei=ep[eg];var ee=en[eg*this.dim+eg];if(ee!=0){var ej=0;while(ej<eg){var ec=ej++;ei-=en[eg*this.dim+ec]*this.y[ec]}this.y[eg]=ei/ee}else{this.y[eg]=0}}var ef=0;var el=this.dim;while(ef<el){var eb=this.dim-1-ef++;var eq=en[eb*this.dim+eb];if(eq!=0){var ed=this.y[eb];var eo=eb+1;var ea=this.dim;while(eo<ea){var ek=eo++;ed-=en[ek*this.dim+eb]*ep[ek]}ep[eb]=ed/eq}else{ep[eb]=0}}};b4.prototype.soft=null;b4.prototype.gamma=null;b4.prototype.velonly=null;b4.prototype.jMax=null;b4.prototype.Keff=null;b4.prototype.preStep=function(ea){this.outer_zn.__validate();if(this.pre_dt==-1){this.pre_dt=ea}var ed=ea/this.pre_dt;this.pre_dt=ea;this.stepped=true;this.outer_zn.__prepare();this.outer_zn.__eff_mass(this.Keff);this.L=this.solve(this.Keff);if(!this.stiff&&!this.velonly){var eb;var ej=2*Math.PI*this.frequency;this.gamma=1/(ea*ej*(2*this.damping+ej*ea));var ek=1/(1+this.gamma);eb=ea*ej*ej*this.gamma;this.gamma*=ek;this.soft=ek;this.outer_zn.__position(this.bias);if(this.breakUnderError&&this.lsq(this.bias)>this.maxError*this.maxError){return true}var ei=0;var ef=this.dim;while(ei<ef){this.bias[ei++]*=-eb}this._clamp(this.bias,this.maxError)}else{var ee=0;var eh=this.dim;while(ee<eh){this.bias[ee++]=0}this.gamma=0;this.soft=1}var ec=0;var eg=this.dim;while(ec<eg){this.jAcc[ec++]*=ed}this.jMax=this.maxForce*ea;return false};b4.prototype.vec3=null;b4.prototype.warmStart=function(){var eb=0;var eh=this.bodies;while(eb<eh.length){var ej=eh[eb];++eb;var ei=ej.body;this.outer_zn.__impulse(this.jAcc,ei.outer,this.vec3);var ek=ei.imass;var ee=this.vec3;var eg=ee.zpp_inner;if(eg._validate!=null){eg._validate()}ei.velx+=ee.zpp_inner.x*ek;var ef=this.vec3;var ed=ef.zpp_inner;if(ed._validate!=null){ed._validate()}ei.vely+=ef.zpp_inner.y*ek;var ec=this.vec3;var ea=ec.zpp_inner;if(ea._validate!=null){ea._validate()}ei.angvel+=ec.zpp_inner.z*ei.iinertia}};b4.prototype.J=null;b4.prototype.jOld=null;b4.prototype.applyImpulseVel=function(){this.outer_zn.__velocity(this.J);var ef=0;var ea=this.dim;while(ef<ea){var eo=ef++;this.J[eo]=this.bias[eo]-this.J[eo]}this.transform(this.L,this.J);var en=0;var ee=this.dim;while(en<ee){var eh=en++;this.jOld[eh]=this.jAcc[eh];this.jAcc[eh]+=this.J[eh]=this.J[eh]*this.soft-this.jAcc[eh]*this.gamma}this.outer_zn.__clamp(this.jAcc);if((this.breakUnderForce||!this.stiff)&&this.lsq(this.jAcc)>this.jMax*this.jMax){if(this.breakUnderForce){return true}else{if(!this.stiff){this._clamp(this.jAcc,this.jMax)}}}var el=0;var ed=this.dim;while(el<ed){var eg=el++;this.J[eg]=this.jAcc[eg]-this.jOld[eg]}var eb=0;var ej=this.bodies;while(eb<ej.length){var es=ej[eb];++eb;var et=es.body;this.outer_zn.__impulse(this.J,et.outer,this.vec3);var ec=et.imass;var ei=this.vec3;var er=ei.zpp_inner;if(er._validate!=null){er._validate()}et.velx+=ei.zpp_inner.x*ec;var eq=this.vec3;var ep=eq.zpp_inner;if(ep._validate!=null){ep._validate()}et.vely+=eq.zpp_inner.y*ec;var em=this.vec3;var ek=em.zpp_inner;if(ek._validate!=null){ek._validate()}et.angvel+=em.zpp_inner.z*et.iinertia}return false};b4.prototype.applyImpulsePos=function(){if(this.velonly){return false}this.outer_zn.__prepare();this.outer_zn.__position(this.J);var eb=this.lsq(this.J);if(this.breakUnderError&&eb>this.maxError*this.maxError){return true}else{if(eb<P.constraintLinearSlop*P.constraintLinearSlop){return false}}var ee=0;var ea=this.dim;while(ee<ea){this.J[ee++]*=-1}this.outer_zn.__eff_mass(this.Keff);this.transform(this.solve(this.Keff),this.J);this.outer_zn.__clamp(this.J);var ed=0;var el=this.bodies;while(ed<el.length){var eq=el[ed];++ed;var er=eq.body;this.outer_zn.__impulse(this.J,er.outer,this.vec3);var ec=er.imass;var ei=this.vec3;var eo=ei.zpp_inner;if(eo._validate!=null){eo._validate()}er.posx+=ei.zpp_inner.x*ec;var en=this.vec3;var em=en.zpp_inner;if(em._validate!=null){em._validate()}er.posy+=en.zpp_inner.y*ec;var ek=this.vec3;var ej=ek.zpp_inner;if(ej._validate!=null){ej._validate()}var ef=ek.zpp_inner.z*er.iinertia;er.rot+=ef;if(ef*ef>0.0001){er.axisx=Math.sin(er.rot);er.axisy=Math.cos(er.rot)}else{var es=ef*ef;var eg=1-0.5*es;var eh=1-es*es/8;var ep=(eg*er.axisx+ef*er.axisy)*eh;er.axisy=(eg*er.axisy-ef*er.axisx)*eh;er.axisx=ep}}return false};b4.prototype.draw=function(ea){this.outer_zn.__draw(ea)};b4.prototype.__class__=b4;var l=zpp_nape.constraint.ZPP_UserBody=function(eb,ea){this.body=null;this.cnt=0;this.cnt=eb;this.body=ea};l.__name__=["zpp_nape","constraint","ZPP_UserBody"];l.prototype.cnt=null;l.prototype.body=null;l.prototype.__class__=l;var aC=zpp_nape.constraint.ZPP_WeldJoint=function(){this.stepped=false;this.biasz=0;this.biasy=0;this.biasx=0;this.gamma=0;this.jMax=0;this.jAccz=0;this.jAccy=0;this.jAccx=0;this.kMassf=0;this.kMasse=0;this.kMassc=0;this.kMassd=0;this.kMassb=0;this.kMassa=0;this.phase=0;this.wrap_a2=null;this.a2rely=0;this.a2relx=0;this.a2localy=0;this.a2localx=0;this.b2=null;this.wrap_a1=null;this.a1rely=0;this.a1relx=0;this.a1localy=0;this.a1localx=0;this.b1=null;this.outer_zn=null;b1.call(this);this.phase=0;this.jAccx=0;this.jAccy=0;this.jAccz=0;this.jMax=Infinity;this.stepped=false;this.a1localx=0;this.a1localy=0;this.a1relx=0;this.a1rely=0;this.a2localx=0;this.a2localy=0;this.a2relx=0;this.a2rely=0};aC.__name__=["zpp_nape","constraint","ZPP_WeldJoint"];aC.__super__=b1;aC.prototype=Object.create(b1.prototype);aC.prototype.outer_zn=null;aC.prototype.bodyImpulse=function(ea){if(this.stepped){if(ea==this.b1){return q.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz))}else{return q.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)}}else{return q.get(0,0,0)}};aC.prototype.activeBodies=function(){if(this.b1!=null){this.b1.constraints.add(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.add(this)}}};aC.prototype.inactiveBodies=function(){if(this.b1!=null){this.b1.constraints.remove(this)}if(this.b2!=this.b1){if(this.b2!=null){this.b2.constraints.remove(this)}}};aC.prototype.b1=null;aC.prototype.a1localx=null;aC.prototype.a1localy=null;aC.prototype.a1relx=null;aC.prototype.a1rely=null;aC.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy};aC.prototype.invalidate_a1=function(ea){this.immutable_midstep("Constraint::a1");this.a1localx=ea.x;this.a1localy=ea.y;this.wake()};aC.prototype.setup_a1=function(){var ea=this.a1localx;var eh=this.a1localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a1=eb;this.wrap_a1.zpp_inner._inuse=true;this.wrap_a1.zpp_inner._validate=dX(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=dX(this,this.invalidate_a1)};aC.prototype.wrap_a1=null;aC.prototype.b2=null;aC.prototype.a2localx=null;aC.prototype.a2localy=null;aC.prototype.a2relx=null;aC.prototype.a2rely=null;aC.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy};aC.prototype.invalidate_a2=function(ea){this.immutable_midstep("Constraint::a2");this.a2localx=ea.x;this.a2localy=ea.y;this.wake()};aC.prototype.setup_a2=function(){var ea=this.a2localx;var eh=this.a2localy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_a2=eb;this.wrap_a2.zpp_inner._inuse=true;this.wrap_a2.zpp_inner._validate=dX(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=dX(this,this.invalidate_a2)};aC.prototype.wrap_a2=null;aC.prototype.phase=null;aC.prototype.kMassa=null;aC.prototype.kMassb=null;aC.prototype.kMassd=null;aC.prototype.kMassc=null;aC.prototype.kMasse=null;aC.prototype.kMassf=null;aC.prototype.jAccx=null;aC.prototype.jAccy=null;aC.prototype.jAccz=null;aC.prototype.jMax=null;aC.prototype.gamma=null;aC.prototype.biasx=null;aC.prototype.biasy=null;aC.prototype.biasz=null;aC.prototype.stepped=null;aC.prototype.copy=function(ea,eb){var ee=this.outer_zn;if(ee.zpp_inner_zn.wrap_a1==null){ee.zpp_inner_zn.setup_a1()}var ec=ee.zpp_inner_zn.wrap_a1;var eg=this.outer_zn;if(eg.zpp_inner_zn.wrap_a2==null){eg.zpp_inner_zn.setup_a2()}var ef=new cX(null,null,ec,eg.zpp_inner_zn.wrap_a2);this.copyto(ef);if(ea!=null&&this.b1!=null){var ek=null;var ed=0;while(ed<ea.length){var ej=ea[ed];++ed;if(ej.id==this.b1.id){ek=ej.bc;break}}if(ek!=null){ef.zpp_inner_zn.b1=ek.zpp_inner}else{eb.push(cu.todo(this.b1.id,function(em){ef.zpp_inner_zn.b1=em.zpp_inner}))}}if(ea!=null&&this.b2!=null){var ei=null;var eh=0;while(eh<ea.length){var el=ea[eh];++eh;if(el.id==this.b2.id){ei=el.bc;break}}if(ei!=null){ef.zpp_inner_zn.b2=ei.zpp_inner}else{eb.push(cu.todo(this.b2.id,function(em){ef.zpp_inner_zn.b2=em.zpp_inner}))}}return ef};aC.prototype.validate=function(){if(this.b1==null||this.b2==null){throw new cE("Error: AngleJoint cannot be simulated null bodies")}if(this.b1==this.b2){throw new cE("Error: WeldJoint cannot be simulated with body1 == body2")}if(this.b1.space!=this.space||this.b2.space!=this.space){throw new cE("Error: Constraints must have each body within the same space to which the constraint has been assigned")}if(this.b1.type!=2&&this.b2.type!=2){throw new cE("Error: Constraints cannot have both bodies non-dynamic")}};aC.prototype.wake_connected=function(){if(this.b1!=null&&this.b1.type==2){this.b1.wake()}if(this.b2!=null&&this.b2.type==2){this.b2.wake()}};aC.prototype.forest=function(){if(this.b1.type==2){var en;if(this.b1.component==this.b1.component.parent){en=this.b1.component}else{var eo=this.b1.component;var em=null;while(eo!=eo.parent){var ei=eo.parent;eo.parent=em;em=eo;eo=ei}while(em!=null){var eh=em.parent;em.parent=eo;em=eh}en=eo}var er;if(this.component==this.component.parent){er=this.component}else{var et=this.component;var el=null;while(et!=et.parent){var eg=et.parent;et.parent=el;el=et;et=eg}while(el!=null){var ef=el.parent;el.parent=et;el=ef}er=et}if(en!=er){if(en.rank<er.rank){en.parent=er}else{if(en.rank>er.rank){er.parent=en}else{er.parent=en;en.rank++}}}}if(this.b2.type==2){var ee;if(this.b2.component==this.b2.component.parent){ee=this.b2.component}else{var es=this.b2.component;var ek=null;while(es!=es.parent){var ed=es.parent;es.parent=ek;ek=es;es=ed}while(ek!=null){var ec=ek.parent;ek.parent=es;ek=ec}ee=es}var ep;if(this.component==this.component.parent){ep=this.component}else{var eq=this.component;var ej=null;while(eq!=eq.parent){var eb=eq.parent;eq.parent=ej;ej=eq;eq=eb}while(ej!=null){var ea=ej.parent;ej.parent=eq;ej=ea}ep=eq}if(ee!=ep){if(ee.rank<ep.rank){ee.parent=ep}else{if(ee.rank>ep.rank){ep.parent=ee}else{ep.parent=ee;ee.rank++}}}}};aC.prototype.pair_exists=function(eb,ea){if(!(this.b1.id==eb&&this.b2.id==ea)){if(this.b1.id==ea){return this.b2.id==eb}else{return false}}else{return true}};aC.prototype.clearcache=function(){this.jAccx=0;this.jAccy=0;this.jAccz=0;this.pre_dt=-1};aC.prototype.preStep=function(em){if(this.pre_dt==-1){this.pre_dt=em}var er=em/this.pre_dt;this.pre_dt=em;this.stepped=true;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var es=this.b1.smass+this.b2.smass;this.kMassa=es;this.kMassb=0;this.kMassd=es;this.kMassc=0;this.kMasse=0;this.kMassf=0;if(this.b1.sinertia!=0){var ec=this.a1relx*this.b1.sinertia;var eb=this.a1rely*this.b1.sinertia;this.kMassa+=eb*this.a1rely;this.kMassb+=-eb*this.a1relx;this.kMassd+=ec*this.a1relx;this.kMassc+=-eb;this.kMasse+=ec;this.kMassf+=this.b1.sinertia}if(this.b2.sinertia!=0){var ew=this.a2relx*this.b2.sinertia;var ee=this.a2rely*this.b2.sinertia;this.kMassa+=ee*this.a2rely;this.kMassb+=-ee*this.a2relx;this.kMassd+=ew*this.a2relx;this.kMassc+=-ee;this.kMasse+=ew;this.kMassf+=this.b2.sinertia}var ed=this.kMassa*(this.kMassd*this.kMassf-this.kMasse*this.kMasse)+this.kMassb*(this.kMassc*this.kMasse-this.kMassb*this.kMassf)+this.kMassc*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);var eu;if(ed!=ed){this.kMassa=0;this.kMassb=0;this.kMassd=0;this.kMassc=0;this.kMasse=0;this.kMassf=0;eu=7}else{if(ed==0){var et=0;if(this.kMassa!=0){this.kMassa=1/this.kMassa}else{this.kMassa=0;et=1}if(this.kMassd!=0){this.kMassd=1/this.kMassd}else{this.kMassd=0;et|=2}if(this.kMassf!=0){this.kMassf=1/this.kMassf}else{this.kMassf=0;et|=4}this.kMassb=this.kMassc=this.kMasse=0;eu=et}else{ed=1/ed;var eq=ed*(this.kMassd*this.kMassf-this.kMasse*this.kMasse);var ep=ed*(this.kMasse*this.kMassc-this.kMassb*this.kMassf);var el=ed*(this.kMassa*this.kMassf-this.kMassc*this.kMassc);var en=ed*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);var ej=ed*(this.kMassb*this.kMassc-this.kMassa*this.kMasse);var ev=this.kMassa*this.kMassd-this.kMassb*this.kMassb;this.kMassa=eq;this.kMassb=ep;this.kMassd=el;this.kMassc=en;this.kMasse=ej;this.kMassf=ed*ev;eu=0}}if((eu&1)!=0){this.jAccx=0}if((eu&2)!=0){this.jAccy=0}if((eu&4)!=0){this.jAccz=0}if(!this.stiff){var ea;var eo=2*Math.PI*this.frequency;this.gamma=1/(em*eo*(2*this.damping+eo*em));var ek=1/(1+this.gamma);ea=em*eo*eo*this.gamma;this.gamma*=ek;this.kMassa*=ek;this.kMassb*=ek;this.kMassd*=ek;this.kMassc*=ek;this.kMasse*=ek;this.kMassf*=ek;this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);this.biasz=this.b2.rot-this.b1.rot-this.phase;if(this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz>this.maxError*this.maxError){return true}var ei=-ea;this.biasx*=ei;this.biasy*=ei;this.biasz*=ei;var eh=this.maxError;var ef=this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz;if(ef>eh*eh){var eg=eh*(1/Math.sqrt(ef));this.biasx*=eg;this.biasy*=eg;this.biasz*=eg}}else{this.biasx=0;this.biasy=0;this.biasz=0;this.gamma=0}this.jAccx*=er;this.jAccy*=er;this.jAccz*=er;this.jMax=this.maxForce*em;return false};aC.prototype.warmStart=function(){var ea=this.b1.imass;this.b1.velx-=this.jAccx*ea;this.b1.vely-=this.jAccy*ea;var eb=this.b2.imass;this.b2.velx+=this.jAccx*eb;this.b2.vely+=this.jAccy*eb;this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)*this.b1.iinertia;this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)*this.b2.iinertia};aC.prototype.applyImpulseVel=function(){var en=0;var em=0;var el=0;en=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel));em=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel));el=this.b2.angvel+this.b2.kinangvel-this.b1.angvel-this.b1.kinangvel;var ea=0;var eq=0;var ep=0;ea=this.biasx-en;eq=this.biasy-em;ep=this.biasz-el;var ec=this.kMassa*ea+this.kMassb*eq+this.kMassc*ep;var eb=this.kMassb*ea+this.kMassd*eq+this.kMasse*ep;ep=this.kMassc*ea+this.kMasse*eq+this.kMassf*ep;ea=ec;eq=eb;var eo=this.gamma;ea-=this.jAccx*eo;eq-=this.jAccy*eo;ep-=this.jAccz*eo;var ek=0;var ej=0;var ei=0;ek=this.jAccx;ej=this.jAccy;ei=this.jAccz;this.jAccx+=ea;this.jAccy+=eq;this.jAccz+=ep;if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz>this.jMax*this.jMax){return true}}else{if(!this.stiff){var eh=this.jMax;var ef=this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz;if(ef>eh*eh){var eg=eh*(1/Math.sqrt(ef));this.jAccx*=eg;this.jAccy*=eg;this.jAccz*=eg}}}ea=this.jAccx-ek;eq=this.jAccy-ej;ep=this.jAccz-ei;var ee=this.b1.imass;this.b1.velx-=ea*ee;this.b1.vely-=eq*ee;var ed=this.b2.imass;this.b2.velx+=ea*ed;this.b2.vely+=eq*ed;this.b1.angvel-=(eq*this.a1relx-ea*this.a1rely+ep)*this.b1.iinertia;this.b2.angvel+=(eq*this.a2relx-ea*this.a2rely+ep)*this.b2.iinertia;return false};aC.prototype.applyImpulsePos=function(){var ey=0;var ew=0;ey=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;ew=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var ei=0;var eg=0;ei=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;eg=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var eh=0;var ef=0;var ee=0;eh=this.b2.posx+ei-(this.b1.posx+ey);ef=this.b2.posy+eg-(this.b1.posy+ew);ee=this.b2.rot-this.b1.rot-this.phase;var eE=0;var eA=0;var ez=0;if(this.breakUnderError&&eh*eh+ef*ef+ee*ee>this.maxError*this.maxError){return true}var eJ=true;if(eh*eh+ef*ef<P.constraintLinearSlop*P.constraintLinearSlop){eJ=false;eh=0;ef=0}var eR=ee*ee;var eL=P.constraintAngularSlop;if(eR<eL*eL){if(!eJ){return false}else{ee=0}}eh*=0.5;ef*=0.5;ee*=0.5;if(eh*eh+ef*ef>6){var eV=this.b1.smass+this.b2.smass;if(eV>P.epsilon){eV=0.75/eV;eE=-eh*eV;eA=-ef*eV;var ex=eE*eE+eA*eA;if(ex>400){var eP=20*(1/Math.sqrt(ex));eE*=eP;eA*=eP}var eI=this.b1.imass;this.b1.posx-=eE*eI;this.b1.posy-=eA*eI;var eH=this.b2.imass;this.b2.posx+=eE*eH;this.b2.posy+=eA*eH;eh=this.b2.posx+ei-(this.b1.posx+ey);ef=this.b2.posy+eg-(this.b1.posy+ew);ee=this.b2.rot-this.b1.rot-this.phase;eh*=0.5;ef*=0.5;ee*=0.5}}var ev=0;var eu=0;var es=0;var et=0;var er=0;var eq=0;var eU=this.b1.smass+this.b2.smass;ev=eU;eu=0;es=eU;et=0;er=0;eq=0;if(this.b1.sinertia!=0){var eb=ey*this.b1.sinertia;var ea=ew*this.b1.sinertia;ev=eU+ea*ew;eu+=-ea*ey;es=eU+eb*ey;et+=-ea;er+=eb;eq+=this.b1.sinertia}if(this.b2.sinertia!=0){var eN=ei*this.b2.sinertia;var eo=eg*this.b2.sinertia;ev+=eo*eg;eu+=-eo*ei;es+=eN*ei;et+=-eo;er+=eN;eq+=this.b2.sinertia}eE=-eh;eA=-ef;ez=-ee;var ep=eE*eE+eA*eA;if(ep>36){var eG=6*(1/Math.sqrt(ep));eE*=eG;eA*=eG}var ej=ev*(es*eq-er*er)+eu*(et*er-eu*eq)+et*(eu*er-et*es);if(ej!=ej){ez=0;eA=ez;eE=eA}else{if(ej==0){if(ev!=0){eE/=ev}else{eE=0}if(es!=0){eA/=es}else{eA=0}if(eq!=0){ez/=eq}else{ez=0}}else{ej=1/ej;var em=er*et-eu*eq;var el=eu*er-et*es;var ek=eu*et-ev*er;var eM=ej*(eE*(es*eq-er*er)+eA*em+ez*el);var en=ej*(eE*em+eA*(ev*eq-et*et)+ez*ek);ez=ej*(eE*el+eA*ek+ez*(ev*es-eu*eu));eE=eM;eA=en}}var eF=this.b1.imass;this.b1.posx-=eE*eF;this.b1.posy-=eA*eF;var eD=this.b2.imass;this.b2.posx+=eE*eD;this.b2.posy+=eA*eD;var ec=this.b1;var ed=-(eA*ey-eE*ew+ez)*this.b1.iinertia;ec.rot+=ed;if(ed*ed>0.0001){ec.axisx=Math.sin(ec.rot);ec.axisy=Math.cos(ec.rot)}else{var eT=ed*ed;var eQ=1-0.5*eT;var eX=1-eT*eT/8;var eS=(eQ*ec.axisx+ed*ec.axisy)*eX;ec.axisy=(eQ*ec.axisy-ed*ec.axisx)*eX;ec.axisx=eS}var eO=this.b2;var eK=(eA*ei-eE*eg+ez)*this.b2.iinertia;eO.rot+=eK;if(eK*eK>0.0001){eO.axisx=Math.sin(eO.rot);eO.axisy=Math.cos(eO.rot)}else{var eC=eK*eK;var eY=1-0.5*eC;var eW=1-eC*eC/8;var eB=(eY*eO.axisx+eK*eO.axisy)*eW;eO.axisy=(eY*eO.axisy-eK*eO.axisx)*eW;eO.axisx=eB}return false};aC.prototype.draw=function(ea){};aC.prototype.__class__=aC;var j=zpp_nape.dynamics.ZPP_Arbiter=function(){this.sensorarb=null;this.fluidarb=null;this.colarb=null;this.type=0;this.pair=null;this.ws2=null;this.ws1=null;this.b2=null;this.b1=null;this.invalidated=false;this.immState=0;this.fresh=false;this.continuous=false;this.presentable=false;this.intchange=false;this.present=0;this.sleeping=false;this.cleared=false;this.active=false;this.endGenerated=0;this.sleep_stamp=0;this.up_stamp=0;this.stamp=0;this.di=0;this.id=0;this.hnext=null;this.outer=null};j.__name__=["zpp_nape","dynamics","ZPP_Arbiter"];j.prototype.outer=null;j.prototype.wrapper=function(){if(this.outer==null){j.internal=true;if(this.type==j.COL){this.colarb.outer_zn=new ak();this.outer=this.colarb.outer_zn}else{if(this.type==j.FLUID){this.fluidarb.outer_zn=new ab();this.outer=this.fluidarb.outer_zn}else{this.outer=new aD()}}this.outer.zpp_inner=this;j.internal=false}return this.outer};j.prototype.inactiveme=function(){return !this.active};j.prototype.hnext=null;j.prototype.id=null;j.prototype.di=null;j.prototype.stamp=null;j.prototype.up_stamp=null;j.prototype.sleep_stamp=null;j.prototype.endGenerated=null;j.prototype.active=null;j.prototype.cleared=null;j.prototype.sleeping=null;j.prototype.present=null;j.prototype.intchange=null;j.prototype.presentable=null;j.prototype.continuous=null;j.prototype.fresh=null;j.prototype.immState=null;j.prototype.acting=function(){if(this.active){return(this.immState&1)!=0}else{return false}};j.prototype.invalidated=null;j.prototype.b1=null;j.prototype.b2=null;j.prototype.ws1=null;j.prototype.ws2=null;j.prototype.pair=null;j.prototype.swap_features=function(){var ea=this.b1;this.b1=this.b2;this.b2=ea;var ec=this.ws1;this.ws1=this.ws2;this.ws2=ec;var eb=this.colarb.s1;this.colarb.s1=this.colarb.s2;this.colarb.s2=eb};j.prototype.type=null;j.prototype.colarb=null;j.prototype.fluidarb=null;j.prototype.sensorarb=null;j.prototype.lazyRetire=function(en,ek){this.cleared=true;if(ek==null||this.b2==ek){var ef=this.b1.arbiters;var ee=null;var em=ef.head;while(em!=null){if(em.elt==this){var eb;var eh;if(ee==null){eb=ef.head;eh=eb.next;ef.head=eh;if(ef.head==null){ef.pushmod=true}}else{eb=ee.next;eh=eb.next;ee.next=eh;if(eh==null){ef.pushmod=true}}var ea=eb;ea.elt=null;ea.next=dL.zpp_pool;dL.zpp_pool=ea;ef.modified=true;ef.length--;ef.pushmod=true;break}ee=em;em=em.next}}if(ek==null||this.b1==ek){var ei=this.b2.arbiters;var ed=null;var el=ei.head;while(el!=null){if(el.elt==this){var eg;var ej;if(ed==null){eg=ei.head;ej=eg.next;ei.head=ej;if(ei.head==null){ei.pushmod=true}}else{eg=ed.next;ej=eg.next;ed.next=ej;if(ej==null){ei.pushmod=true}}var ec=eg;ec.elt=null;ec.next=dL.zpp_pool;dL.zpp_pool=ec;ei.modified=true;ei.length--;ei.pushmod=true;break}ed=el;el=el.next}}if(this.pair!=null){this.pair.arb=null;this.pair=null}this.active=false;en.f_arbiters.modified=true};j.prototype.sup_assign=function(ei,eh,ea,ef){this.b1=ei.body;this.ws1=ei;this.b2=eh.body;this.ws2=eh;this.id=ea;this.di=ef;var ec=this.b1.arbiters;var ed;if(dL.zpp_pool==null){ed=new dL()}else{ed=dL.zpp_pool;dL.zpp_pool=ed.next;ed.next=null}ed.elt=this;var ej=ed;ej.next=ec.head;ec.head=ej;ec.modified=true;ec.length++;var ee=this.b2.arbiters;var eg;if(dL.zpp_pool==null){eg=new dL()}else{eg=dL.zpp_pool;dL.zpp_pool=eg.next;eg.next=null}eg.elt=this;var eb=eg;eb.next=ee.head;ee.head=eb;ee.modified=true;ee.length++;this.active=true;this.present=0;this.cleared=false;this.sleeping=false;this.fresh=false;this.presentable=false};j.prototype.sup_retire=function(){if(!this.cleared){var ef=this.b1.arbiters;var ee=null;var el=ef.head;while(el!=null){if(el.elt==this){var eb;var eh;if(ee==null){eb=ef.head;eh=eb.next;ef.head=eh;if(ef.head==null){ef.pushmod=true}}else{eb=ee.next;eh=eb.next;ee.next=eh;if(eh==null){ef.pushmod=true}}var ea=eb;ea.elt=null;ea.next=dL.zpp_pool;dL.zpp_pool=ea;ef.modified=true;ef.length--;ef.pushmod=true;break}ee=el;el=el.next}var ei=this.b2.arbiters;var ed=null;var ek=ei.head;while(ek!=null){if(ek.elt==this){var eg;var ej;if(ed==null){eg=ei.head;ej=eg.next;ei.head=ej;if(ei.head==null){ei.pushmod=true}}else{eg=ed.next;ej=eg.next;ed.next=ej;if(ej==null){ei.pushmod=true}}var ec=eg;ec.elt=null;ec.next=dL.zpp_pool;dL.zpp_pool=ec;ei.modified=true;ei.length--;ei.pushmod=true;break}ed=ek;ek=ek.next}if(this.pair!=null){this.pair.arb=null;this.pair=null}}this.b1=this.b2=null;this.active=false;this.intchange=false};j.prototype.__class__=j;var A=zpp_nape.dynamics.ZPP_SensorArbiter=function(){this.next=null;j.call(this);this.type=j.SENSOR;this.sensorarb=this};A.__name__=["zpp_nape","dynamics","ZPP_SensorArbiter"];A.__super__=j;A.prototype=Object.create(j.prototype);A.prototype.next=null;A.prototype.alloc=function(){};A.prototype.free=function(){};A.prototype.assign=function(ei,eh,ea,ef){this.b1=ei.body;this.ws1=ei;this.b2=eh.body;this.ws2=eh;this.id=ea;this.di=ef;var ec=this.b1.arbiters;var ed;if(dL.zpp_pool==null){ed=new dL()}else{ed=dL.zpp_pool;dL.zpp_pool=ed.next;ed.next=null}ed.elt=this;var ej=ed;ej.next=ec.head;ec.head=ej;ec.modified=true;ec.length++;var ee=this.b2.arbiters;var eg;if(dL.zpp_pool==null){eg=new dL()}else{eg=dL.zpp_pool;dL.zpp_pool=eg.next;eg.next=null}eg.elt=this;var eb=eg;eb.next=ee.head;ee.head=eb;ee.modified=true;ee.length++;this.active=true;this.present=0;this.cleared=false;this.sleeping=false;this.fresh=false;this.presentable=false};A.prototype.retire=function(){if(!this.cleared){var eg=this.b1.arbiters;var ef=null;var em=eg.head;while(em!=null){if(em.elt==this){var ec;var ei;if(ef==null){ec=eg.head;ei=ec.next;eg.head=ei;if(eg.head==null){eg.pushmod=true}}else{ec=ef.next;ei=ec.next;ef.next=ei;if(ei==null){eg.pushmod=true}}var ea=ec;ea.elt=null;ea.next=dL.zpp_pool;dL.zpp_pool=ea;eg.modified=true;eg.length--;eg.pushmod=true;break}ef=em;em=em.next}var ej=this.b2.arbiters;var ee=null;var el=ej.head;while(el!=null){if(el.elt==this){var eh;var ek;if(ee==null){eh=ej.head;ek=eh.next;ej.head=ek;if(ej.head==null){ej.pushmod=true}}else{eh=ee.next;ek=eh.next;ee.next=ek;if(ek==null){ej.pushmod=true}}var ed=eh;ed.elt=null;ed.next=dL.zpp_pool;dL.zpp_pool=ed;ej.modified=true;ej.length--;ej.pushmod=true;break}ee=el;el=el.next}if(this.pair!=null){this.pair.arb=null;this.pair=null}}this.b1=this.b2=null;this.active=false;this.intchange=false;var eb=this;eb.next=A.zpp_pool;A.zpp_pool=eb};A.prototype.makemutable=function(){};A.prototype.makeimmutable=function(){};A.prototype.__class__=A;var dK=zpp_nape.dynamics.ZPP_FluidArbiter=function(){this.pre_dt=0;this.mutable=false;this.wrap_position=null;this.buoyy=0;this.buoyx=0;this.ny=0;this.nx=0;this.lgamma=0;this.dampy=0;this.dampx=0;this.vMassc=0;this.vMassb=0;this.vMassa=0;this.agamma=0;this.adamp=0;this.wMass=0;this.nodrag=false;this.r2y=0;this.r2x=0;this.r1y=0;this.r1x=0;this.overlap=0;this.centroidy=0;this.centroidx=0;this.next=null;this.outer_zn=null;j.call(this);this.type=j.FLUID;this.fluidarb=this;this.buoyx=0;this.buoyy=0;this.pre_dt=-1};dK.__name__=["zpp_nape","dynamics","ZPP_FluidArbiter"];dK.__super__=j;dK.prototype=Object.create(j.prototype);dK.prototype.outer_zn=null;dK.prototype.next=null;dK.prototype.alloc=function(){};dK.prototype.free=function(){};dK.prototype.centroidx=null;dK.prototype.centroidy=null;dK.prototype.overlap=null;dK.prototype.r1x=null;dK.prototype.r1y=null;dK.prototype.r2x=null;dK.prototype.r2y=null;dK.prototype.nodrag=null;dK.prototype.wMass=null;dK.prototype.adamp=null;dK.prototype.agamma=null;dK.prototype.vMassa=null;dK.prototype.vMassb=null;dK.prototype.vMassc=null;dK.prototype.dampx=null;dK.prototype.dampy=null;dK.prototype.lgamma=null;dK.prototype.nx=null;dK.prototype.ny=null;dK.prototype.buoyx=null;dK.prototype.buoyy=null;dK.prototype.position_validate=function(){this.wrap_position.zpp_inner.x=this.centroidx;this.wrap_position.zpp_inner.y=this.centroidy};dK.prototype.position_invalidate=function(ea){this.centroidx=ea.x;this.centroidy=ea.y};dK.prototype.wrap_position=null;dK.prototype.getposition=function(){var ea;if(au.poolVec2==null){ea=new r()}else{ea=au.poolVec2;au.poolVec2=ea.zpp_pool;ea.zpp_pool=null}if(ea.zpp_inner==null){var ee;if(bB.zpp_pool==null){ee=new bB()}else{ee=bB.zpp_pool;bB.zpp_pool=ee.next;ee.next=null}ee.weak=false;ee._immutable=false;ee.x=0;ee.y=0;ea.zpp_inner=ee;ea.zpp_inner.outer=ea}else{var eb;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}if(ea.zpp_inner.x==0){var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ea.zpp_inner.y==0}else{eb=false}if(!eb){ea.zpp_inner.x=0;ea.zpp_inner.y=0;var ec=ea.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}ea.zpp_inner.weak=false;this.wrap_position=ea;this.wrap_position.zpp_inner._inuse=true;this.wrap_position.zpp_inner._immutable=!this.mutable;this.wrap_position.zpp_inner._validate=dX(this,this.position_validate);this.wrap_position.zpp_inner._invalidate=dX(this,this.position_invalidate)};dK.prototype.assign=function(ei,eh,ea,ef){this.b1=ei.body;this.ws1=ei;this.b2=eh.body;this.ws2=eh;this.id=ea;this.di=ef;var ec=this.b1.arbiters;var ed;if(dL.zpp_pool==null){ed=new dL()}else{ed=dL.zpp_pool;dL.zpp_pool=ed.next;ed.next=null}ed.elt=this;var ej=ed;ej.next=ec.head;ec.head=ej;ec.modified=true;ec.length++;var ee=this.b2.arbiters;var eg;if(dL.zpp_pool==null){eg=new dL()}else{eg=dL.zpp_pool;dL.zpp_pool=eg.next;eg.next=null}eg.elt=this;var eb=eg;eb.next=ee.head;ee.head=eb;ee.modified=true;ee.length++;this.active=true;this.present=0;this.cleared=false;this.sleeping=false;this.fresh=false;this.presentable=false;this.nx=0;this.ny=1;this.dampx=0;this.dampy=0;this.adamp=0};dK.prototype.retire=function(){if(!this.cleared){var eg=this.b1.arbiters;var ef=null;var em=eg.head;while(em!=null){if(em.elt==this){var ec;var ei;if(ef==null){ec=eg.head;ei=ec.next;eg.head=ei;if(eg.head==null){eg.pushmod=true}}else{ec=ef.next;ei=ec.next;ef.next=ei;if(ei==null){eg.pushmod=true}}var ea=ec;ea.elt=null;ea.next=dL.zpp_pool;dL.zpp_pool=ea;eg.modified=true;eg.length--;eg.pushmod=true;break}ef=em;em=em.next}var ej=this.b2.arbiters;var ee=null;var el=ej.head;while(el!=null){if(el.elt==this){var eh;var ek;if(ee==null){eh=ej.head;ek=eh.next;ej.head=ek;if(ej.head==null){ej.pushmod=true}}else{eh=ee.next;ek=eh.next;ee.next=ek;if(ek==null){ej.pushmod=true}}var ed=eh;ed.elt=null;ed.next=dL.zpp_pool;dL.zpp_pool=ed;ej.modified=true;ej.length--;ej.pushmod=true;break}ee=el;el=el.next}if(this.pair!=null){this.pair.arb=null;this.pair=null}}this.b1=this.b2=null;this.active=false;this.intchange=false;var eb=this;eb.next=dK.zpp_pool;dK.zpp_pool=eb;this.pre_dt=-1};dK.prototype.mutable=null;dK.prototype.makemutable=function(){this.mutable=true;if(this.wrap_position!=null){this.wrap_position.zpp_inner._immutable=false}};dK.prototype.makeimmutable=function(){this.mutable=false;if(this.wrap_position!=null){this.wrap_position.zpp_inner._immutable=true}};dK.prototype.inject=function(eb,ea,ec){this.overlap=eb;this.centroidx=ea;this.centroidy=ec};dK.prototype.pre_dt=null;dK.prototype.preStep=function(eV,ek){if(this.pre_dt==-1){this.pre_dt=ek}var e0=ek/this.pre_dt;this.pre_dt=ek;this.r1x=this.centroidx-this.b1.posx;this.r1y=this.centroidy-this.b1.posy;this.r2x=this.centroidx-this.b2.posx;this.r2y=this.centroidy-this.b2.posy;var eY=0;var eW=0;if(this.ws1.fluidEnabled&&this.ws1.fluidProperties.wrap_gravity!=null){eY=this.ws1.fluidProperties.gravityx;eW=this.ws1.fluidProperties.gravityy}else{eY=eV.gravityx;eW=eV.gravityy}var ey=0;var ev=0;if(this.ws2.fluidEnabled&&this.ws2.fluidProperties.wrap_gravity!=null){ey=this.ws2.fluidProperties.gravityx;ev=this.ws2.fluidProperties.gravityy}else{ey=eV.gravityx;ev=eV.gravityy}var eF=0;var eD=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var eN=this.overlap*this.ws1.fluidProperties.density;var eK=this.overlap*this.ws2.fluidProperties.density;if(eN>eK){var eU=eN+eK;eF-=eY*eU;eD-=eW*eU}else{if(eN<eK){var eM=eN+eK;eF+=ey*eM;eD+=ev*eM}else{var ej=0;var eh=0;ej=eY+ey;eh=eW+ev;ej*=0.5;eh*=0.5;if(this.ws1.worldCOMx*ej+this.ws1.worldCOMy*eh>this.ws2.worldCOMx*ej+this.ws2.worldCOMy*eh){var eJ=eN+eK;eF-=ej*eJ;eD-=eh*eJ}else{var eG=eN+eK;eF+=ej*eG;eD+=eh*eG}}}}else{if(this.ws1.fluidEnabled){var eT=this.overlap*this.ws1.fluidProperties.density;eF-=eY*eT;eD-=eW*eT}else{if(this.ws2.fluidEnabled){var eH=this.overlap*this.ws2.fluidProperties.density;eF+=ey*eH;eD+=ev*eH}}}eF*=ek;eD*=ek;this.buoyx=eF;this.buoyy=eD;if(this.b1.type==2){var eE=this.b1.imass;this.b1.velx-=eF*eE;this.b1.vely-=eD*eE;this.b1.angvel-=(eD*this.r1x-eF*this.r1y)*this.b1.iinertia}if(this.b2.type==2){var eC=this.b2.imass;this.b2.velx+=eF*eC;this.b2.vely+=eD*eC;this.b2.angvel+=(eD*this.r2x-eF*this.r2y)*this.b2.iinertia}if((!this.ws1.fluidEnabled||this.ws1.fluidProperties.viscosity==0)&&(!this.ws2.fluidEnabled||this.ws2.fluidProperties.viscosity==0)){this.nodrag=true;this.dampx=0;this.dampy=0;this.adamp=0}else{this.nodrag=false;var e1=0;if(this.ws1.fluidEnabled){this.ws2.validate_angDrag();e1=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area}if(this.ws2.fluidEnabled){this.ws1.validate_angDrag();e1+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area}if(e1!=0){var el=this.b1.sinertia+this.b2.sinertia;if(el!=0){this.wMass=1/el}else{this.wMass=0}e1*=0.0004;var ea=2*Math.PI*e1;this.agamma=1/(ek*ea*(2+ea*ek));var eO=1/(1+this.agamma);this.agamma*=eO;this.wMass*=eO}else{this.wMass=0;this.agamma=0}var ef=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel));var ee=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));if(!(ef*ef+ee*ee<P.epsilon*P.epsilon)){var eQ=1/Math.sqrt(ef*ef+ee*ee);ef*=eQ;ee*=eQ;this.nx=ef;this.ny=ee}var e3=0;if(this.ws1.fluidEnabled){var e2=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area;if(this.ws2.type==0){e3=0-e2*this.ws2.circle.radius*P.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI)}else{var eI=this.ws2.polygon;var ei=0;var es=0;var em=eI.edges.head;while(em!=null){var eS=em.elt;ei+=eS.length;var eg=e2*eS.length*(eS.gnormx*this.nx+eS.gnormy*this.ny);if(eg>0){eg*=-P.fluidVacuumDrag;eg=eg}es-=eg*0.5*P.fluidLinearDrag;em=em.next}e3=es/ei}}if(this.ws2.fluidEnabled){var en=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area;if(this.ws1.type==0){e3-=en*this.ws1.circle.radius*P.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI)}else{var er=this.ws1.polygon;var eq=0;var eA=0;var ep=er.edges.head;while(ep!=null){var eL=ep.elt;eq+=eL.length;var ed=en*eL.length*(eL.gnormx*this.nx+eL.gnormy*this.ny);if(ed>0){ed*=-P.fluidVacuumDrag;ed=ed}eA-=ed*0.5*P.fluidLinearDrag;ep=ep.next}e3+=eA/eq}}if(e3!=0){var eZ=this.b1.smass+this.b2.smass;var ez=0;var ew=0;var eu=0;ez=eZ;ew=0;eu=eZ;if(this.b1.sinertia!=0){var ec=this.r1x*this.b1.sinertia;var eb=this.r1y*this.b1.sinertia;ez=eZ+eb*this.r1y;ew+=-eb*this.r1x;eu=eZ+ec*this.r1x}if(this.b2.sinertia!=0){var eR=this.r2x*this.b2.sinertia;var et=this.r2y*this.b2.sinertia;ez+=et*this.r2y;ew+=-et*this.r2x;eu+=eR*this.r2x}var eo=ez*eu-ew*ew;if(eo!=eo){eu=0;ew=eu;ez=ew}else{if(eo==0){if(ez!=0){ez=1/ez}else{ez=0}if(eu!=0){eu=1/eu}else{eu=0}ew=0}else{eo=1/eo;var eB=eu*eo;eu=ez*eo;ez=eB;ew*=-eo}}this.vMassa=ez;this.vMassb=ew;this.vMassc=eu;var eX=2*Math.PI*e3;this.lgamma=1/(ek*eX*(2+eX*ek));var eP=1/(1+this.lgamma);this.lgamma*=eP;this.vMassa*=eP;this.vMassb*=eP;this.vMassc*=eP}else{this.vMassa=0;this.vMassb=0;this.vMassc=0;this.lgamma=0}}this.dampx*=e0;this.dampy*=e0;this.adamp*=e0};dK.prototype.warmStart=function(){var ea=this.b1.imass;this.b1.velx-=this.dampx*ea;this.b1.vely-=this.dampy*ea;var eb=this.b2.imass;this.b2.velx+=this.dampx*eb;this.b2.vely+=this.dampy*eb;this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y);this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y);this.b1.angvel-=this.adamp*this.b1.iinertia;this.b2.angvel+=this.adamp*this.b2.iinertia};dK.prototype.applyImpulseVel=function(){if(!this.nodrag){var ee=this.b1.angvel+this.b1.kinangvel;var eb=this.b2.angvel+this.b2.kinangvel;var eh=this.b1.velx+this.b1.kinvelx-this.r1y*ee-(this.b2.velx+this.b2.kinvelx-this.r2y*eb);var eg=this.b1.vely+this.b1.kinvely+this.r1x*ee-(this.b2.vely+this.b2.kinvely+this.r2x*eb);var ei=this.vMassa*eh+this.vMassb*eg;eg=this.vMassb*eh+this.vMassc*eg;eh=ei;var ef=this.lgamma;eh-=this.dampx*ef;eg-=this.dampy*ef;this.dampx+=eh;this.dampy+=eg;var ed=this.b1.imass;this.b1.velx-=eh*ed;this.b1.vely-=eg*ed;var ea=this.b2.imass;this.b2.velx+=eh*ea;this.b2.vely+=eg*ea;this.b1.angvel-=this.b1.iinertia*(eg*this.r1x-eh*this.r1y);this.b2.angvel+=this.b2.iinertia*(eg*this.r2x-eh*this.r2y);var ec=(ee-eb)*this.wMass-this.adamp*this.agamma;this.adamp+=ec;this.b1.angvel-=ec*this.b1.iinertia;this.b2.angvel+=ec*this.b2.iinertia}};dK.prototype.__class__=dK;var d9=zpp_nape.dynamics.ZPP_ColArbiter=function(){this.pre_dt=0;this.mutable=false;this.stat=false;this.next=null;this.hpc2=false;this.hc2=false;this.oc2=null;this.c2=null;this.oc1=null;this.c1=null;this.__ref_vertex=0;this.__ref_edge2=null;this.__ref_edge1=null;this.biasCoef=0;this.rev=false;this.radius=0;this.lproj=0;this.lnormy=0;this.lnormx=0;this.surfacey=0;this.surfacex=0;this.k2y=0;this.k2x=0;this.k1y=0;this.k1x=0;this.rt2b=0;this.rn2b=0;this.rt2a=0;this.rn2a=0;this.rt1b=0;this.rn1b=0;this.rt1a=0;this.rn1a=0;this.jrAcc=0;this.rMass=0;this.Kc=0;this.Kb=0;this.Ka=0;this.kMassc=0;this.kMassb=0;this.kMassa=0;this.wrap_normal=null;this.ny=0;this.nx=0;this.innards=null;this.wrap_contacts=null;this.contacts=null;this.s2=null;this.s1=null;this.userdef_rfric=false;this.userdef_restitution=false;this.userdef_stat_fric=false;this.userdef_dyn_fric=false;this.rfric=0;this.restitution=0;this.stat_fric=0;this.dyn_fric=0;this.outer_zn=null;j.call(this);this.pre_dt=-1;this.contacts=new c2();this.innards=new I();this.type=j.COL;this.colarb=this};d9.__name__=["zpp_nape","dynamics","ZPP_ColArbiter"];d9.__super__=j;d9.prototype=Object.create(j.prototype);d9.prototype.outer_zn=null;d9.prototype.dyn_fric=null;d9.prototype.stat_fric=null;d9.prototype.restitution=null;d9.prototype.rfric=null;d9.prototype.userdef_dyn_fric=null;d9.prototype.userdef_stat_fric=null;d9.prototype.userdef_restitution=null;d9.prototype.userdef_rfric=null;d9.prototype.s1=null;d9.prototype.s2=null;d9.prototype.contacts=null;d9.prototype.wrap_contacts=null;d9.prototype.innards=null;d9.prototype.nx=null;d9.prototype.ny=null;d9.prototype.normal_validate=function(){if(this.cleared){throw new cE("Error: Arbiter not currently in use")}this.wrap_normal.zpp_inner.x=this.nx;this.wrap_normal.zpp_inner.y=this.ny;if(this.ws1.id>this.ws2.id){this.wrap_normal.zpp_inner.x=-this.wrap_normal.zpp_inner.x;this.wrap_normal.zpp_inner.y=-this.wrap_normal.zpp_inner.y}};d9.prototype.wrap_normal=null;d9.prototype.getnormal=function(){var ea;if(au.poolVec2==null){ea=new r()}else{ea=au.poolVec2;au.poolVec2=ea.zpp_pool;ea.zpp_pool=null}if(ea.zpp_inner==null){var ee;if(bB.zpp_pool==null){ee=new bB()}else{ee=bB.zpp_pool;bB.zpp_pool=ee.next;ee.next=null}ee.weak=false;ee._immutable=false;ee.x=0;ee.y=0;ea.zpp_inner=ee;ea.zpp_inner.outer=ea}else{var eb;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}if(ea.zpp_inner.x==0){var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ea.zpp_inner.y==0}else{eb=false}if(!eb){ea.zpp_inner.x=0;ea.zpp_inner.y=0;var ec=ea.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}ea.zpp_inner.weak=false;this.wrap_normal=ea;this.wrap_normal.zpp_inner._immutable=true;this.wrap_normal.zpp_inner._inuse=true;this.wrap_normal.zpp_inner._validate=dX(this,this.normal_validate)};d9.prototype.kMassa=null;d9.prototype.kMassb=null;d9.prototype.kMassc=null;d9.prototype.Ka=null;d9.prototype.Kb=null;d9.prototype.Kc=null;d9.prototype.rMass=null;d9.prototype.jrAcc=null;d9.prototype.rn1a=null;d9.prototype.rt1a=null;d9.prototype.rn1b=null;d9.prototype.rt1b=null;d9.prototype.rn2a=null;d9.prototype.rt2a=null;d9.prototype.rn2b=null;d9.prototype.rt2b=null;d9.prototype.k1x=null;d9.prototype.k1y=null;d9.prototype.k2x=null;d9.prototype.k2y=null;d9.prototype.surfacex=null;d9.prototype.surfacey=null;d9.prototype.ptype=null;d9.prototype.lnormx=null;d9.prototype.lnormy=null;d9.prototype.lproj=null;d9.prototype.radius=null;d9.prototype.rev=null;d9.prototype.biasCoef=null;d9.prototype.__ref_edge1=null;d9.prototype.__ref_edge2=null;d9.prototype.__ref_vertex=null;d9.prototype.c1=null;d9.prototype.oc1=null;d9.prototype.c2=null;d9.prototype.oc2=null;d9.prototype.hc2=null;d9.prototype.hpc2=null;d9.prototype.next=null;d9.prototype.alloc=function(){};d9.prototype.free=function(){this.userdef_dyn_fric=false;this.userdef_stat_fric=false;this.userdef_restitution=false;this.userdef_rfric=false;this.__ref_edge1=this.__ref_edge2=null};d9.prototype.stat=null;d9.prototype.injectContact=function(ej,ei,ee,ed,eh,ec,ea){if(ea==null){ea=false}var eg=null;var eb=this.contacts.next;while(eb!=null){var ek=eb;if(ec==ek.hash){eg=ek;break}eb=eb.next}if(eg==null){if(c2.zpp_pool==null){eg=new c2()}else{eg=c2.zpp_pool;c2.zpp_pool=eg.next;eg.next=null}var em=eg.inner;em.jnAcc=em.jtAcc=0;eg.hash=ec;eg.fresh=true;eg.arbiter=this;this.jrAcc=0;var ef=this.contacts;eg._inuse=true;var el=eg;el.next=ef.next;ef.next=el;ef.modified=true;ef.length++;this.innards.add(em)}else{eg.fresh=false}eg.px=ej;eg.py=ei;this.nx=ee;this.ny=ed;eg.dist=eh;eg.stamp=this.stamp;eg.posOnly=ea;return eg};d9.prototype.assign=function(ei,eh,ea,ef){this.b1=ei.body;this.ws1=ei;this.b2=eh.body;this.ws2=eh;this.id=ea;this.di=ef;var ec=this.b1.arbiters;var ed;if(dL.zpp_pool==null){ed=new dL()}else{ed=dL.zpp_pool;dL.zpp_pool=ed.next;ed.next=null}ed.elt=this;var ej=ed;ej.next=ec.head;ec.head=ej;ec.modified=true;ec.length++;var ee=this.b2.arbiters;var eg;if(dL.zpp_pool==null){eg=new dL()}else{eg=dL.zpp_pool;dL.zpp_pool=eg.next;eg.next=null}eg.elt=this;var eb=eg;eb.next=ee.head;ee.head=eb;ee.modified=true;ee.length++;this.active=true;this.present=0;this.cleared=false;this.sleeping=false;this.fresh=false;this.presentable=false;this.s1=ei;this.s2=eh;if(!this.userdef_restitution){if(this.s1.material.elasticity<=-Infinity||this.s2.material.elasticity<=-Infinity){this.restitution=0}else{if(this.s1.material.elasticity>=Infinity||this.s2.material.elasticity>=Infinity){this.restitution=1}else{this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2}}if(this.restitution<0){this.restitution=0}if(this.restitution>1){this.restitution=1}}if(!this.userdef_dyn_fric){this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)}if(!this.userdef_stat_fric){this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)}if(!this.userdef_rfric){this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)}};d9.prototype.calcProperties=function(){if(!this.userdef_restitution){if(this.s1.material.elasticity<=-Infinity||this.s2.material.elasticity<=-Infinity){this.restitution=0}else{if(this.s1.material.elasticity>=Infinity||this.s2.material.elasticity>=Infinity){this.restitution=1}else{this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2}}if(this.restitution<0){this.restitution=0}if(this.restitution>1){this.restitution=1}}if(!this.userdef_dyn_fric){this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)}if(!this.userdef_stat_fric){this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)}if(!this.userdef_rfric){this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)}};d9.prototype.validate_props=function(){if(this.invalidated){this.invalidated=false;if(!this.userdef_restitution){if(this.s1.material.elasticity<=-Infinity||this.s2.material.elasticity<=-Infinity){this.restitution=0}else{if(this.s1.material.elasticity>=Infinity||this.s2.material.elasticity>=Infinity){this.restitution=1}else{this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2}}if(this.restitution<0){this.restitution=0}if(this.restitution>1){this.restitution=1}}if(!this.userdef_dyn_fric){this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)}if(!this.userdef_stat_fric){this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)}if(!this.userdef_rfric){this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)}}};d9.prototype.retire=function(){if(!this.cleared){var eh=this.b1.arbiters;var ef=null;var eq=eh.head;while(eq!=null){if(eq.elt==this){var ec;var ek;if(ef==null){ec=eh.head;ek=ec.next;eh.head=ek;if(eh.head==null){eh.pushmod=true}}else{ec=ef.next;ek=ec.next;ef.next=ek;if(ek==null){eh.pushmod=true}}var ea=ec;ea.elt=null;ea.next=dL.zpp_pool;dL.zpp_pool=ea;eh.modified=true;eh.length--;eh.pushmod=true;break}ef=eq;eq=eq.next}var em=this.b2.arbiters;var ee=null;var ep=em.head;while(ep!=null){if(ep.elt==this){var ej;var eo;if(ee==null){ej=em.head;eo=ej.next;em.head=eo;if(em.head==null){em.pushmod=true}}else{ej=ee.next;eo=ej.next;ee.next=eo;if(eo==null){em.pushmod=true}}var ed=ej;ed.elt=null;ed.next=dL.zpp_pool;dL.zpp_pool=ed;em.modified=true;em.length--;em.pushmod=true;break}ee=ep;ep=ep.next}if(this.pair!=null){this.pair.arb=null;this.pair=null}}this.b1=this.b2=null;this.active=false;this.intchange=false;while(this.contacts.next!=null){var ei=this.contacts;var en=ei.next;ei.pop();en.arbiter=null;en.next=c2.zpp_pool;c2.zpp_pool=en;var eg=this.innards;var el=eg.next;eg.next=el.next;el._inuse=false;if(eg.next==null){eg.pushmod=true}eg.modified=true;eg.length--}var eb=this;eb.userdef_dyn_fric=false;eb.userdef_stat_fric=false;eb.userdef_restitution=false;eb.userdef_rfric=false;eb.__ref_edge1=eb.__ref_edge2=null;eb.next=d9.zpp_pool;d9.zpp_pool=eb;this.pre_dt=-1};d9.prototype.mutable=null;d9.prototype.makemutable=function(){this.mutable=true;if(this.wrap_normal!=null){this.wrap_normal.zpp_inner._immutable=false}if(this.wrap_contacts!=null){this.wrap_contacts.zpp_inner.immutable=false}};d9.prototype.makeimmutable=function(){this.mutable=false;if(this.wrap_normal!=null){this.wrap_normal.zpp_inner._immutable=true}if(this.wrap_contacts!=null){this.wrap_contacts.zpp_inner.immutable=true}};d9.prototype.contacts_adder=function(ea){return false};d9.prototype.contacts_subber=function(ea){var ee=null;var ed=null;var ec=this.innards.next;var eb=this.contacts.next;while(eb!=null){var ef=eb;if(ef==ea.zpp_inner){this.contacts.erase(ee);this.innards.erase(ed);ef.arbiter=null;ef.next=c2.zpp_pool;c2.zpp_pool=ef;break}ee=eb;ed=ec;ec=ec.next;eb=eb.next}};d9.prototype.setupcontacts=function(){this.wrap_contacts=aB.get(this.contacts,true);this.wrap_contacts.zpp_inner.immutable=!this.mutable;this.wrap_contacts.zpp_inner.adder=dX(this,this.contacts_adder);this.wrap_contacts.zpp_inner.dontremove=true;this.wrap_contacts.zpp_inner.subber=dX(this,this.contacts_subber)};d9.prototype.cleanupContacts=function(){var ea=true;var ee=null;var eo=null;var eg=this.innards.next;this.hc2=false;var ec=this.contacts.next;while(ec!=null){var em=ec;if(em.stamp+P.arbiterExpirationDelay<this.stamp){var ei=this.contacts;var eb;var ek;if(ee==null){eb=ei.next;ek=eb.next;ei.next=ek;if(ei.next==null){ei.pushmod=true}}else{eb=ee.next;ek=eb.next;ee.next=ek;if(ek==null){ei.pushmod=true}}eb._inuse=false;ei.modified=true;ei.length--;ei.pushmod=true;ec=ek;var el=this.innards;var ej;var en;if(eo==null){ej=el.next;en=ej.next;el.next=en;if(el.next==null){el.pushmod=true}}else{ej=eo.next;en=ej.next;eo.next=en;if(en==null){el.pushmod=true}}ej._inuse=false;el.modified=true;el.length--;el.pushmod=true;eg=en;em.arbiter=null;em.next=c2.zpp_pool;c2.zpp_pool=em;continue}var ep=em.inner;var ef=em.active;em.active=em.stamp==this.stamp;if(em.active){if(ea){ea=false;this.c1=ep;this.oc1=em}else{this.hc2=true;this.c2=ep;this.oc2=em}}if(ef!=em.active){this.contacts.modified=true}ee=ec;eo=eg;eg=eg.next;ec=ec.next}if(this.hc2){this.hpc2=true;if(this.oc1.posOnly){var eh=this.c1;this.c1=this.c2;this.c2=eh;var ed=this.oc1;this.oc1=this.oc2;this.oc2=ed;this.hc2=false}else{if(this.oc2.posOnly){this.hc2=false}}if(this.oc1.posOnly){ea=true}}else{this.hpc2=false}return ea};d9.prototype.pre_dt=null;d9.prototype.preStep=function(eq){if(this.invalidated){this.invalidated=false;if(!this.userdef_restitution){if(this.s1.material.elasticity<=-Infinity||this.s2.material.elasticity<=-Infinity){this.restitution=0}else{if(this.s1.material.elasticity>=Infinity||this.s2.material.elasticity>=Infinity){this.restitution=1}else{this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2}}if(this.restitution<0){this.restitution=0}if(this.restitution>1){this.restitution=1}}if(!this.userdef_dyn_fric){this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)}if(!this.userdef_stat_fric){this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)}if(!this.userdef_rfric){this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)}}if(this.pre_dt==-1){this.pre_dt=eq}var et=eq/this.pre_dt;this.pre_dt=eq;var em=this.b1.smass+this.b2.smass;this.hc2=false;var eb=true;this.biasCoef=this.b1.type!=2||this.b2.type!=2?this.continuous?P.contactContinuousStaticBiasCoef:P.contactStaticBiasCoef:this.continuous?P.contactContinuousBiasCoef:P.contactBiasCoef;this.continuous=false;var er=null;var eB=null;var ej=this.innards.next;var eu=this.contacts.next;while(eu!=null){var eC=eu;if(eC.stamp+P.arbiterExpirationDelay<this.stamp){var ev=this.contacts;var ea;var eG;if(er==null){ea=ev.next;eG=ea.next;ev.next=eG;if(ev.next==null){ev.pushmod=true}}else{ea=er.next;eG=ea.next;er.next=eG;if(eG==null){ev.pushmod=true}}ea._inuse=false;ev.modified=true;ev.length--;ev.pushmod=true;eu=eG;var ez=this.innards;var ef;var eg;if(eB==null){ef=ez.next;eg=ef.next;ez.next=eg;if(ez.next==null){ez.pushmod=true}}else{ef=eB.next;eg=ef.next;eB.next=eg;if(eg==null){ez.pushmod=true}}ef._inuse=false;ez.modified=true;ez.length--;ez.pushmod=true;ej=eg;eC.arbiter=null;eC.next=c2.zpp_pool;c2.zpp_pool=eC;continue}var ek=eC.inner;var ep=eC.active;eC.active=eC.stamp==this.stamp;if(eC.active){if(eb){eb=false;this.c1=ek;this.oc1=eC}else{this.hc2=true;this.c2=ek;this.oc2=eC}ek.r2x=eC.px-this.b2.posx;ek.r2y=eC.py-this.b2.posy;ek.r1x=eC.px-this.b1.posx;ek.r1y=eC.py-this.b1.posy;var ei=ek.r2x*this.nx+ek.r2y*this.ny;var eE=em+this.b2.sinertia*(ei*ei);var ey=ek.r1x*this.nx+ek.r1y*this.ny;eE+=this.b1.sinertia*(ey*ey);ek.tMass=eE<P.epsilon*P.epsilon?0:1/eE;var ex=this.ny*ek.r2x-this.nx*ek.r2y;var eF=em+this.b2.sinertia*(ex*ex);var ew=this.ny*ek.r1x-this.nx*ek.r1y;eF+=this.b1.sinertia*(ew*ew);ek.nMass=eF<P.epsilon*P.epsilon?0:1/eF;var eo=0;var el=0;var eD=this.b2.angvel+this.b2.kinangvel;eo=this.b2.velx+this.b2.kinvelx-ek.r2y*eD;el=this.b2.vely+this.b2.kinvely+ek.r2x*eD;eD=this.b1.angvel+this.b1.kinangvel;eo-=this.b1.velx+this.b1.kinvelx-ek.r1y*eD;el-=this.b1.vely+this.b1.kinvely+ek.r1x*eD;var ed=this.nx*eo+this.ny*el;eC.elasticity=this.restitution;ek.bounce=ed*eC.elasticity;if(ek.bounce>-P.elasticThreshold){ek.bounce=0}ed=el*this.nx-eo*this.ny;var ec=P.staticFrictionThreshold;if(ed*ed>ec*ec){ek.friction=this.dyn_fric}else{ek.friction=this.stat_fric}ek.jnAcc*=et;ek.jtAcc*=et}if(ep!=eC.active){this.contacts.modified=true}er=eu;eB=ej;ej=ej.next;eu=eu.next}if(this.hc2){this.hpc2=true;if(this.oc1.posOnly){var eA=this.c1;this.c1=this.c2;this.c2=eA;var es=this.oc1;this.oc1=this.oc2;this.oc2=es;this.hc2=false}else{if(this.oc2.posOnly){this.hc2=false}}if(this.oc1.posOnly){eb=true}}else{this.hpc2=false}this.jrAcc*=et;if(!eb){this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y;this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny;this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y;this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny;this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel);this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel)}if(this.hc2){this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y;this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny;this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y;this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny;this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel);this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel);this.kMassa=em+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b;this.kMassb=em+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b;this.kMassc=em+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b;if(this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<P.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)){this.Ka=this.kMassa;this.Kb=this.kMassb;this.Kc=this.kMassc;var ee=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(ee!=ee){this.kMassa=this.kMassb=this.kMassc=0}else{if(ee==0){if(this.kMassa!=0){this.kMassa=1/this.kMassa}else{this.kMassa=0}if(this.kMassc!=0){this.kMassc=1/this.kMassc}else{this.kMassc=0}this.kMassb=0}else{ee=1/ee;var en=this.kMassc*ee;this.kMassc=this.kMassa*ee;this.kMassa=en;this.kMassb*=-ee}}}else{this.hc2=false;if(this.oc2.dist<this.oc1.dist){var eh=this.c1;this.c1=this.c2;this.c2=eh}this.oc2.active=false;this.contacts.modified=true}}this.surfacex=this.b2.svelx;this.surfacey=this.b2.svely;this.surfacex+=this.b1.svelx;this.surfacey+=this.b1.svely;this.surfacex=-this.surfacex;this.surfacey=-this.surfacey;this.rMass=this.b1.sinertia+this.b2.sinertia;if(this.rMass!=0){this.rMass=1/this.rMass}return eb};d9.prototype.warmStart=function(){var eb=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc;var ea=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc;var ed=this.b1.imass;this.b1.velx-=eb*ed;this.b1.vely-=ea*ed;this.b1.angvel-=this.b1.iinertia*(ea*this.c1.r1x-eb*this.c1.r1y);var ef=this.b2.imass;this.b2.velx+=eb*ef;this.b2.vely+=ea*ef;this.b2.angvel+=this.b2.iinertia*(ea*this.c1.r2x-eb*this.c1.r2y);if(this.hc2){var eg=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc;var eh=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc;var ee=this.b1.imass;this.b1.velx-=eg*ee;this.b1.vely-=eh*ee;this.b1.angvel-=this.b1.iinertia*(eh*this.c2.r1x-eg*this.c2.r1y);var ec=this.b2.imass;this.b2.velx+=eg*ec;this.b2.vely+=eh*ec;this.b2.angvel+=this.b2.iinertia*(eh*this.c2.r2x-eg*this.c2.r2y)}this.b2.angvel+=this.jrAcc*this.b2.iinertia;this.b1.angvel-=this.jrAcc*this.b1.iinertia};d9.prototype.applyImpulseVel=function(){var em;var el;var eg;var ed;var ek;var ee;var eh=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);var ef=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);eg=(ef*this.nx-eh*this.ny+this.surfacex)*this.c1.tMass;ed=this.c1.friction*this.c1.jnAcc;ek=this.c1.jtAcc;ee=ek-eg;if(ee>ed){ee=ed}else{if(ee<-ed){ee=-ed}}eg=ee-ek;this.c1.jtAcc=ee;em=-this.ny*eg;el=this.nx*eg;this.b2.velx+=em*this.b2.imass;this.b2.vely+=el*this.b2.imass;this.b1.velx-=em*this.b1.imass;this.b1.vely-=el*this.b1.imass;this.b2.angvel+=this.rt1b*eg*this.b2.iinertia;this.b1.angvel-=this.rt1a*eg*this.b1.iinertia;if(this.hc2){var ec=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel);var ep=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);eg=(ep*this.nx-ec*this.ny+this.surfacex)*this.c2.tMass;ed=this.c2.friction*this.c2.jnAcc;ek=this.c2.jtAcc;ee=ek-eg;if(ee>ed){ee=ed}else{if(ee<-ed){ee=-ed}}eg=ee-ek;this.c2.jtAcc=ee;em=-this.ny*eg;el=this.nx*eg;this.b2.velx+=em*this.b2.imass;this.b2.vely+=el*this.b2.imass;this.b1.velx-=em*this.b1.imass;this.b1.vely-=el*this.b1.imass;this.b2.angvel+=this.rt2b*eg*this.b2.iinertia;this.b1.angvel-=this.rt2a*eg*this.b1.iinertia;eh=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);ef=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);ec=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel);ep=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);var eb=this.c1.jnAcc;var eo=this.c2.jnAcc;var ej=eh*this.nx+ef*this.ny+this.surfacey+this.c1.bounce-(this.Ka*eb+this.Kb*eo);var ei=ec*this.nx+ep*this.ny+this.surfacey+this.c2.bounce-(this.Kb*eb+this.Kc*eo);var ea=-(this.kMassa*ej+this.kMassb*ei);var en=-(this.kMassb*ej+this.kMassc*ei);if(ea>=0&&en>=0){ej=ea-eb;ei=en-eo;this.c1.jnAcc=ea;this.c2.jnAcc=en}else{ea=-this.c1.nMass*ej;if(ea>=0&&this.Kb*ea+ei>=0){ej=ea-eb;ei=-eo;this.c1.jnAcc=ea;this.c2.jnAcc=0}else{en=-this.c2.nMass*ei;if(en>=0&&this.Kb*en+ej>=0){ej=-eb;ei=en-eo;this.c1.jnAcc=0;this.c2.jnAcc=en}else{if(ej>=0&&ei>=0){ej=-eb;ei=-eo;this.c1.jnAcc=this.c2.jnAcc=0}else{ej=0;ei=0}}}}eg=ej+ei;em=this.nx*eg;el=this.ny*eg;this.b2.velx+=em*this.b2.imass;this.b2.vely+=el*this.b2.imass;this.b1.velx-=em*this.b1.imass;this.b1.vely-=el*this.b1.imass;this.b2.angvel+=(this.rn1b*ej+this.rn2b*ei)*this.b2.iinertia;this.b1.angvel-=(this.rn1a*ej+this.rn2a*ei)*this.b1.iinertia}else{if(this.radius!=0){eg=(this.b2.angvel-this.b1.angvel)*this.rMass;ed=this.rfric*this.c1.jnAcc;ek=this.jrAcc;this.jrAcc-=eg;if(this.jrAcc>ed){this.jrAcc=ed}else{if(this.jrAcc<-ed){this.jrAcc=-ed}}eg=this.jrAcc-ek;this.b2.angvel+=eg*this.b2.iinertia;this.b1.angvel-=eg*this.b1.iinertia}eh=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);ef=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);eg=(this.c1.bounce+(this.nx*eh+this.ny*ef)+this.surfacey)*this.c1.nMass;ek=this.c1.jnAcc;ee=ek-eg;if(ee<0){ee=0}eg=ee-ek;this.c1.jnAcc=ee;em=this.nx*eg;el=this.ny*eg;this.b2.velx+=em*this.b2.imass;this.b2.vely+=el*this.b2.imass;this.b1.velx-=em*this.b1.imass;this.b1.vely-=el*this.b1.imass;this.b2.angvel+=this.rn1b*eg*this.b2.iinertia;this.b1.angvel-=this.rn1a*eg*this.b1.iinertia}};d9.prototype.applyImpulsePos=function(){if(this.ptype==2){var fo=this.c1;var fK=0;var fJ=0;fK=this.b2.axisy*fo.lr2x-this.b2.axisx*fo.lr2y;fJ=fo.lr2x*this.b2.axisx+fo.lr2y*this.b2.axisy;fK+=this.b2.posx;fJ+=this.b2.posy;var fZ=0;var fY=0;fZ=this.b1.axisy*fo.lr1x-this.b1.axisx*fo.lr1y;fY=fo.lr1x*this.b1.axisx+fo.lr1y*this.b1.axisy;fZ+=this.b1.posx;fY+=this.b1.posy;var ew=0;var ev=0;ew=fK-fZ;ev=fJ-fY;var eF=Math.sqrt(ew*ew+ev*ev);var e1=this.radius-P.collisionSlop;var fM=eF-e1;if(ew*this.nx+ev*this.ny<0){ew=-ew;ev=-ev;fM-=this.radius}if(fM<0){if(eF<P.epsilon){if(this.b1.smass!=0){this.b1.posx+=P.epsilon*10}else{this.b2.posx+=P.epsilon*10}}else{var eZ=1/eF;ew*=eZ;ev*=eZ;var eE=0.5*(fZ+fK);var eD=0.5*(fY+fJ);var ft=eF-e1;fZ=eE-this.b1.posx;fY=eD-this.b1.posy;fK=eE-this.b2.posx;fJ=eD-this.b2.posy;var eO=ev*fZ-ew*fY;var eM=ev*fK-ew*fJ;var fI=this.b2.smass+eM*eM*this.b2.sinertia+this.b1.smass+eO*eO*this.b1.sinertia;if(fI!=0){var eG=-this.biasCoef*ft/fI;var eX=0;var eW=0;eX=ew*eG;eW=ev*eG;var gd=this.b1.imass;this.b1.posx-=eX*gd;this.b1.posy-=eW*gd;var eH=this.b1;var eA=-eO*this.b1.iinertia*eG;eH.rot+=eA;if(eA*eA>0.0001){eH.axisx=Math.sin(eH.rot);eH.axisy=Math.cos(eH.rot)}else{var fs=eA*eA;var e4=1-0.5*fs;var e8=1-fs*fs/8;var fu=(e4*eH.axisx+eA*eH.axisy)*e8;eH.axisy=(e4*eH.axisy-eA*eH.axisx)*e8;eH.axisx=fu}var gc=this.b2.imass;this.b2.posx+=eX*gc;this.b2.posy+=eW*gc;var fc=this.b2;var eu=eM*this.b2.iinertia*eG;fc.rot+=eu;if(eu*eu>0.0001){fc.axisx=Math.sin(fc.rot);fc.axisy=Math.cos(fc.rot)}else{var fr=eu*eu;var fF=1-0.5*fr;var ei=1-fr*fr/8;var fX=(fF*fc.axisx+eu*fc.axisy)*ei;fc.axisy=(fF*fc.axisy-eu*fc.axisx)*ei;fc.axisx=fX}}}}}else{var eV=0;var eU=0;var eY;var fN=0;var fL=0;var fG=0;var fE=0;if(this.ptype==0){eV=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy;eU=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy;eY=this.lproj+(eV*this.b1.posx+eU*this.b1.posy);fN=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y;fL=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy;fN+=this.b2.posx;fL+=this.b2.posy;if(this.hpc2){fG=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y;fE=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy;fG+=this.b2.posx;fE+=this.b2.posy}}else{eV=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy;eU=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy;eY=this.lproj+(eV*this.b2.posx+eU*this.b2.posy);fN=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y;fL=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy;fN+=this.b1.posx;fL+=this.b1.posy;if(this.hpc2){fG=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y;fE=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy;fG+=this.b1.posx;fE+=this.b1.posy}}var eL=fN*eV+fL*eU-eY-this.radius;eL+=P.collisionSlop;var eJ=0;if(this.hpc2){eJ=fG*eV+fE*eU-eY-this.radius;eJ+=P.collisionSlop}if(eL<0||eJ<0){if(this.rev){eV=-eV;eU=-eU}var fi=0;var ff=0;fi=fN-this.b1.posx;ff=fL-this.b1.posy;var eK=0;var eI=0;eK=fN-this.b2.posx;eI=fL-this.b2.posy;var fq=0;var fn=0;var eT=0;var eR=0;if(this.hpc2){fq=fG-this.b1.posx;fn=fE-this.b1.posy;eT=fG-this.b2.posx;eR=fE-this.b2.posy;var en=eU*fi-eV*ff;var el=eU*eK-eV*eI;var ga=eU*fq-eV*fn;var f8=eU*eT-eV*eR;var et=this.b1.smass+this.b2.smass;this.kMassa=et+this.b1.sinertia*en*en+this.b2.sinertia*el*el;this.kMassb=et+this.b1.sinertia*en*ga+this.b2.sinertia*el*f8;this.kMassc=et+this.b1.sinertia*ga*ga+this.b2.sinertia*f8*f8;var eS=0;var eP=0;var eN=0;eS=this.kMassa;eP=this.kMassb;eN=this.kMassc;var fk=eL*this.biasCoef;var fh=eJ*this.biasCoef;while(true){var f7=0;var f5=0;f7=fk;f5=fh;f7=-fk;f5=-fh;var f0=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(f0!=f0){f5=0;f7=f5}else{if(f0==0){if(this.kMassa!=0){f7/=this.kMassa}else{f7=0}if(this.kMassc!=0){f5/=this.kMassc}else{f5=0}}else{f0=1/f0;var gb=f0*(this.kMassc*f7-this.kMassb*f5);f5=f0*(this.kMassa*f5-this.kMassb*f7);f7=gb}}if(f7>=0&&f5>=0){var f9=(f7+f5)*this.b1.imass;this.b1.posx-=eV*f9;this.b1.posy-=eU*f9;var fa=this.b1;var es=-this.b1.iinertia*(en*f7+ga*f5);fa.rot+=es;if(es*es>0.0001){fa.axisx=Math.sin(fa.rot);fa.axisy=Math.cos(fa.rot)}else{var fp=es*es;var fD=1-0.5*fp;var eh=1-fp*fp/8;var fW=(fD*fa.axisx+es*fa.axisy)*eh;fa.axisy=(fD*fa.axisy-es*fa.axisx)*eh;fa.axisx=fW}var f6=(f7+f5)*this.b2.imass;this.b2.posx+=eV*f6;this.b2.posy+=eU*f6;var e9=this.b2;var er=this.b2.iinertia*(el*f7+f8*f5);e9.rot+=er;if(er*er>0.0001){e9.axisx=Math.sin(e9.rot);e9.axisy=Math.cos(e9.rot)}else{var fm=er*er;var fB=1-0.5*fm;var eg=1-fm*fm/8;var fV=(fB*e9.axisx+er*e9.axisy)*eg;e9.axisy=(fB*e9.axisy-er*e9.axisx)*eg;e9.axisx=fV}break}f7=-fk/eS;f5=0;var eB=eP*f7+fh;if(f7>=0&&eB>=0){var f4=(f7+f5)*this.b1.imass;this.b1.posx-=eV*f4;this.b1.posy-=eU*f4;var e7=this.b1;var eq=-this.b1.iinertia*(en*f7+ga*f5);e7.rot+=eq;if(eq*eq>0.0001){e7.axisx=Math.sin(e7.rot);e7.axisy=Math.cos(e7.rot)}else{var fl=eq*eq;var fA=1-0.5*fl;var ef=1-fl*fl/8;var fU=(fA*e7.axisx+eq*e7.axisy)*ef;e7.axisy=(fA*e7.axisy-eq*e7.axisx)*ef;e7.axisx=fU}var f3=(f7+f5)*this.b2.imass;this.b2.posx+=eV*f3;this.b2.posy+=eU*f3;var e6=this.b2;var ep=this.b2.iinertia*(el*f7+f8*f5);e6.rot+=ep;if(ep*ep>0.0001){e6.axisx=Math.sin(e6.rot);e6.axisy=Math.cos(e6.rot)}else{var fj=ep*ep;var fz=1-0.5*fj;var ee=1-fj*fj/8;var fT=(fz*e6.axisx+ep*e6.axisy)*ee;e6.axisy=(fz*e6.axisy-ep*e6.axisx)*ee;e6.axisx=fT}break}f7=0;f5=-fh/eN;var eC=eP*f5+fk;if(f5>=0&&eC>=0){var f2=(f7+f5)*this.b1.imass;this.b1.posx-=eV*f2;this.b1.posy-=eU*f2;var e5=this.b1;var eo=-this.b1.iinertia*(en*f7+ga*f5);e5.rot+=eo;if(eo*eo>0.0001){e5.axisx=Math.sin(e5.rot);e5.axisy=Math.cos(e5.rot)}else{var fg=eo*eo;var fy=1-0.5*fg;var ed=1-fg*fg/8;var fS=(fy*e5.axisx+eo*e5.axisy)*ed;e5.axisy=(fy*e5.axisy-eo*e5.axisx)*ed;e5.axisx=fS}var f1=(f7+f5)*this.b2.imass;this.b2.posx+=eV*f1;this.b2.posy+=eU*f1;var e3=this.b2;var em=this.b2.iinertia*(el*f7+f8*f5);e3.rot+=em;if(em*em>0.0001){e3.axisx=Math.sin(e3.rot);e3.axisy=Math.cos(e3.rot)}else{var fe=em*em;var fx=1-0.5*fe;var ec=1-fe*fe/8;var fR=(fx*e3.axisx+em*e3.axisy)*ec;e3.axisy=(fx*e3.axisy-em*e3.axisx)*ec;e3.axisx=fR}break}break}}else{var eQ=eU*fi-eV*ff;var ez=eU*eK-eV*eI;var fH=this.b2.smass+ez*ez*this.b2.sinertia+this.b1.smass+eQ*eQ*this.b1.sinertia;if(fH!=0){var fC=-this.biasCoef*eL/fH;var ge=0;var fQ=0;ge=eV*fC;fQ=eU*fC;var ey=this.b1.imass;this.b1.posx-=ge*ey;this.b1.posy-=fQ*ey;var e2=this.b1;var ek=-eQ*this.b1.iinertia*fC;e2.rot+=ek;if(ek*ek>0.0001){e2.axisx=Math.sin(e2.rot);e2.axisy=Math.cos(e2.rot)}else{var fd=ek*ek;var fw=1-0.5*fd;var eb=1-fd*fd/8;var fP=(fw*e2.axisx+ek*e2.axisy)*eb;e2.axisy=(fw*e2.axisy-ek*e2.axisx)*eb;e2.axisx=fP}var ex=this.b2.imass;this.b2.posx+=ge*ex;this.b2.posy+=fQ*ex;var e0=this.b2;var ej=ez*this.b2.iinertia*fC;e0.rot+=ej;if(ej*ej>0.0001){e0.axisx=Math.sin(e0.rot);e0.axisy=Math.cos(e0.rot)}else{var fb=ej*ej;var fv=1-0.5*fb;var ea=1-fb*fb/8;var fO=(fv*e0.axisx+ej*e0.axisy)*ea;e0.axisy=(fv*e0.axisy-ej*e0.axisx)*ea;e0.axisx=fO}}}}}};d9.prototype.__class__=d9;var c2=zpp_nape.dynamics.ZPP_Contact=function(){this.length=0;this.pushmod=false;this.modified=false;this._inuse=false;this.next=null;this.elasticity=0;this.dist=0;this.fresh=false;this.hash=0;this.stamp=0;this.posOnly=false;this.active=false;this.inner=null;this.arbiter=null;this.wrap_position=null;this.py=0;this.px=0;this.outer=null;this.inner=new I()};c2.__name__=["zpp_nape","dynamics","ZPP_Contact"];c2.prototype.outer=null;c2.prototype.wrapper=function(){if(this.outer==null){c2.internal=true;this.outer=new d8();c2.internal=false;this.outer.zpp_inner=this}return this.outer};c2.prototype.px=null;c2.prototype.py=null;c2.prototype.position_validate=function(){this.wrap_position.zpp_inner.x=this.px;this.wrap_position.zpp_inner.y=this.py};c2.prototype.wrap_position=null;c2.prototype.getposition=function(){var ea;if(au.poolVec2==null){ea=new r()}else{ea=au.poolVec2;au.poolVec2=ea.zpp_pool;ea.zpp_pool=null}if(ea.zpp_inner==null){var ee;if(bB.zpp_pool==null){ee=new bB()}else{ee=bB.zpp_pool;bB.zpp_pool=ee.next;ee.next=null}ee.weak=false;ee._immutable=false;ee.x=0;ee.y=0;ea.zpp_inner=ee;ea.zpp_inner.outer=ea}else{var eb;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}if(ea.zpp_inner.x==0){var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ea.zpp_inner.y==0}else{eb=false}if(!eb){ea.zpp_inner.x=0;ea.zpp_inner.y=0;var ec=ea.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}ea.zpp_inner.weak=false;this.wrap_position=ea;this.wrap_position.zpp_inner._inuse=true;this.wrap_position.zpp_inner._immutable=true;this.wrap_position.zpp_inner._validate=dX(this,this.position_validate)};c2.prototype.inactiveme=function(){return !(this.active&&this.arbiter!=null&&!(!this.arbiter.active))};c2.prototype.arbiter=null;c2.prototype.inner=null;c2.prototype.active=null;c2.prototype.posOnly=null;c2.prototype.stamp=null;c2.prototype.hash=null;c2.prototype.fresh=null;c2.prototype.dist=null;c2.prototype.elasticity=null;c2.prototype.free=function(){this.arbiter=null};c2.prototype.alloc=function(){};c2.prototype.next=null;c2.prototype.elem=function(){return this};c2.prototype.begin=function(){return this.next};c2.prototype._inuse=null;c2.prototype.modified=null;c2.prototype.pushmod=null;c2.prototype.length=null;c2.prototype.setbegin=function(ea){this.next=ea;this.modified=true;this.pushmod=true};c2.prototype.add=function(ea){ea._inuse=true;ea.next=this.next;this.next=ea;this.modified=true;this.length++;return ea};c2.prototype.inlined_add=function(ea){ea._inuse=true;ea.next=this.next;this.next=ea;this.modified=true;this.length++;return ea};c2.prototype.addAll=function(ea){var eb=ea.next;while(eb!=null){this.add(eb);eb=eb.next}};c2.prototype.insert=function(eb,ea){ea._inuse=true;if(eb==null){ea.next=this.next;this.next=ea}else{ea.next=eb.next;eb.next=ea}this.pushmod=this.modified=true;this.length++;return ea};c2.prototype.inlined_insert=function(eb,ea){ea._inuse=true;if(eb==null){ea.next=this.next;this.next=ea}else{ea.next=eb.next;eb.next=ea}this.pushmod=this.modified=true;this.length++;return ea};c2.prototype.pop=function(){var ea=this.next;this.next=ea.next;ea._inuse=false;if(this.next==null){this.pushmod=true}this.modified=true;this.length--};c2.prototype.inlined_pop=function(){var ea=this.next;this.next=ea.next;ea._inuse=false;if(this.next==null){this.pushmod=true}this.modified=true;this.length--};c2.prototype.pop_unsafe=function(){var ea=this.next;this.pop();return ea};c2.prototype.inlined_pop_unsafe=function(){var ea=this.next;this.pop();return ea};c2.prototype.remove=function(ed){var ec=null;var ee=this.next;while(ee!=null){if(ee==ed){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;break}ec=ee;ee=ee.next}};c2.prototype.try_remove=function(ec){var eb=null;var ed=this.next;var ea=false;while(ed!=null){if(ed==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};c2.prototype.inlined_remove=function(ed){var ec=null;var ee=this.next;while(ee!=null){if(ee==ed){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;break}ec=ee;ee=ee.next}};c2.prototype.inlined_try_remove=function(ee){var ed=null;var ef=this.next;var eb=false;while(ef!=null){if(ef==ee){var ea;var ec;if(ed==null){ea=this.next;ec=ea.next;this.next=ec;if(this.next==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=ef;ef=ef.next}return eb};c2.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;return eb};c2.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;return eb};c2.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};c2.prototype.clear=function(){};c2.prototype.inlined_clear=function(){};c2.prototype.reverse=function(){var ec=this.next;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.next=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};c2.prototype.empty=function(){return this.next==null};c2.prototype.size=function(){return this.length};c2.prototype.has=function(ec){var ea;ea=false;var eb=this.next;while(eb!=null){if(eb==ec){ea=true;break}eb=eb.next}return ea};c2.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.next;while(eb!=null){if(eb==ec){ea=true;break}eb=eb.next}return ea};c2.prototype.front=function(){return this.next};c2.prototype.back=function(){var ea=this.next;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea};c2.prototype.iterator_at=function(eb){var ea=this.next;while(eb-->0&&ea!=null){ea=ea.next}return ea};c2.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea}else{return null}};c2.prototype.__class__=c2;var I=zpp_nape.dynamics.ZPP_IContact=function(){this.length=0;this.pushmod=false;this.modified=false;this._inuse=false;this.next=null;this.lr2y=0;this.lr2x=0;this.lr1y=0;this.lr1x=0;this.jtAcc=0;this.jnAcc=0;this.friction=0;this.bounce=0;this.tMass=0;this.nMass=0;this.r2y=0;this.r2x=0;this.r1y=0;this.r1x=0};I.__name__=["zpp_nape","dynamics","ZPP_IContact"];I.prototype.r1x=null;I.prototype.r1y=null;I.prototype.r2x=null;I.prototype.r2y=null;I.prototype.nMass=null;I.prototype.tMass=null;I.prototype.bounce=null;I.prototype.friction=null;I.prototype.jnAcc=null;I.prototype.jtAcc=null;I.prototype.lr1x=null;I.prototype.lr1y=null;I.prototype.lr2x=null;I.prototype.lr2y=null;I.prototype.next=null;I.prototype.elem=function(){return this};I.prototype.begin=function(){return this.next};I.prototype._inuse=null;I.prototype.modified=null;I.prototype.pushmod=null;I.prototype.length=null;I.prototype.setbegin=function(ea){this.next=ea;this.modified=true;this.pushmod=true};I.prototype.add=function(ea){ea._inuse=true;ea.next=this.next;this.next=ea;this.modified=true;this.length++;return ea};I.prototype.inlined_add=function(ea){ea._inuse=true;ea.next=this.next;this.next=ea;this.modified=true;this.length++;return ea};I.prototype.addAll=function(ea){var eb=ea.next;while(eb!=null){this.add(eb);eb=eb.next}};I.prototype.insert=function(eb,ea){ea._inuse=true;if(eb==null){ea.next=this.next;this.next=ea}else{ea.next=eb.next;eb.next=ea}this.pushmod=this.modified=true;this.length++;return ea};I.prototype.inlined_insert=function(eb,ea){ea._inuse=true;if(eb==null){ea.next=this.next;this.next=ea}else{ea.next=eb.next;eb.next=ea}this.pushmod=this.modified=true;this.length++;return ea};I.prototype.pop=function(){var ea=this.next;this.next=ea.next;ea._inuse=false;if(this.next==null){this.pushmod=true}this.modified=true;this.length--};I.prototype.inlined_pop=function(){var ea=this.next;this.next=ea.next;ea._inuse=false;if(this.next==null){this.pushmod=true}this.modified=true;this.length--};I.prototype.pop_unsafe=function(){var ea=this.next;this.pop();return ea};I.prototype.inlined_pop_unsafe=function(){var ea=this.next;this.pop();return ea};I.prototype.remove=function(ed){var ec=null;var ee=this.next;while(ee!=null){if(ee==ed){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;break}ec=ee;ee=ee.next}};I.prototype.try_remove=function(ec){var eb=null;var ed=this.next;var ea=false;while(ed!=null){if(ed==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};I.prototype.inlined_remove=function(ed){var ec=null;var ee=this.next;while(ee!=null){if(ee==ed){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;break}ec=ee;ee=ee.next}};I.prototype.inlined_try_remove=function(ee){var ed=null;var ef=this.next;var eb=false;while(ef!=null){if(ef==ee){var ea;var ec;if(ed==null){ea=this.next;ec=ea.next;this.next=ec;if(this.next==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=ef;ef=ef.next}return eb};I.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;return eb};I.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.next;eb=ea.next;this.next=eb;if(this.next==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}ea._inuse=false;this.modified=true;this.length--;this.pushmod=true;return eb};I.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};I.prototype.clear=function(){};I.prototype.inlined_clear=function(){};I.prototype.reverse=function(){var ec=this.next;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.next=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};I.prototype.empty=function(){return this.next==null};I.prototype.size=function(){return this.length};I.prototype.has=function(ec){var ea;ea=false;var eb=this.next;while(eb!=null){if(eb==ec){ea=true;break}eb=eb.next}return ea};I.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.next;while(eb!=null){if(eb==ec){ea=true;break}eb=eb.next}return ea};I.prototype.front=function(){return this.next};I.prototype.back=function(){var ea=this.next;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea};I.prototype.iterator_at=function(eb){var ea=this.next;while(eb-->0&&ea!=null){ea=ea.next}return ea};I.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea}else{return null}};I.prototype.__class__=I;var cA=zpp_nape.dynamics.ZPP_InteractionFilter=function(){this.fluidMask=0;this.fluidGroup=0;this.sensorMask=0;this.sensorGroup=0;this.collisionMask=0;this.collisionGroup=0;this.wrap_shapes=null;this.shapes=null;this.outer=null;this.userData=null;this.next=null;this.shapes=new s();this.collisionGroup=this.sensorGroup=this.fluidGroup=1;this.collisionMask=this.sensorMask=this.fluidMask=-1};cA.__name__=["zpp_nape","dynamics","ZPP_InteractionFilter"];cA.prototype.next=null;cA.prototype.userData=null;cA.prototype.outer=null;cA.prototype.wrapper=function(){if(this.outer==null){this.outer=new G();var ea=this.outer.zpp_inner;ea.outer=null;ea.next=cA.zpp_pool;cA.zpp_pool=ea;this.outer.zpp_inner=this}return this.outer};cA.prototype.free=function(){this.outer=null};cA.prototype.alloc=function(){};cA.prototype.shapes=null;cA.prototype.wrap_shapes=null;cA.prototype.feature_cons=function(){this.shapes=new s()};cA.prototype.addShape=function(ea){this.shapes.add(ea)};cA.prototype.remShape=function(ea){this.shapes.remove(ea)};cA.prototype.copy=function(){var ea;if(cA.zpp_pool==null){ea=new cA()}else{ea=cA.zpp_pool;cA.zpp_pool=ea.next;ea.next=null}ea.collisionGroup=this.collisionGroup;ea.collisionMask=this.collisionMask;ea.sensorGroup=this.sensorGroup;ea.sensorMask=this.sensorMask;ea.fluidGroup=this.fluidGroup;ea.fluidMask=this.fluidMask;return ea};cA.prototype.collisionGroup=null;cA.prototype.collisionMask=null;cA.prototype.shouldCollide=function(ea){if((this.collisionMask&ea.collisionGroup)!=0){return(ea.collisionMask&this.collisionGroup)!=0}else{return false}};cA.prototype.sensorGroup=null;cA.prototype.sensorMask=null;cA.prototype.shouldSense=function(ea){if((this.sensorMask&ea.sensorGroup)!=0){return(ea.sensorMask&this.sensorGroup)!=0}else{return false}};cA.prototype.fluidGroup=null;cA.prototype.fluidMask=null;cA.prototype.shouldFlow=function(ea){if((this.fluidMask&ea.fluidGroup)!=0){return(ea.fluidMask&this.fluidGroup)!=0}else{return false}};cA.prototype.invalidate=function(){var ea=this.shapes.head;while(ea!=null){ea.elt.invalidate_filter();ea=ea.next}};cA.prototype.__class__=cA;var ax=zpp_nape.dynamics.ZPP_InteractionGroup=function(){this.depth=0;this.wrap_interactors=null;this.interactors=null;this.wrap_groups=null;this.groups=null;this.group=null;this.ignore=false;this.outer=null;this.depth=0;this.groups=new da();this.interactors=new bn()};ax.__name__=["zpp_nape","dynamics","ZPP_InteractionGroup"];ax.prototype.outer=null;ax.prototype.ignore=null;ax.prototype.group=null;ax.prototype.setGroup=function(ea){if(this.group!=ea){if(this.group!=null){this.group.groups.remove(this);this.depth=0;this.group.invalidate(true)}this.group=ea;if(ea!=null){ea.groups.add(this);this.depth=ea.depth+1;ea.invalidate(true)}else{this.invalidate(true)}}};ax.prototype.groups=null;ax.prototype.wrap_groups=null;ax.prototype.interactors=null;ax.prototype.wrap_interactors=null;ax.prototype.depth=null;ax.prototype.invalidate=function(ed){if(ed==null){ed=false}if(!(ed||this.ignore)){return}var eb=this.interactors.head;while(eb!=null){var ea=eb.elt;if(ea.ibody!=null){ea.ibody.wake()}else{if(ea.ishape!=null){ea.ishape.body.wake()}else{ea.icompound.wake()}}eb=eb.next}var ec=this.groups.head;while(ec!=null){ec.elt.invalidate(ed);ec=ec.next}};ax.prototype.addGroup=function(ea){this.groups.add(ea);ea.depth=this.depth+1};ax.prototype.remGroup=function(ea){this.groups.remove(ea);ea.depth=0};ax.prototype.addInteractor=function(ea){this.interactors.add(ea)};ax.prototype.remInteractor=function(eb,ea){if(ea==null){ea=-1}this.interactors.remove(eb)};ax.prototype.__class__=ax;var aP=zpp_nape.dynamics.ZPP_SpaceArbiterList=function(){this.at_index_3=0;this.at_index_2=0;this.at_index_1=0;this.at_index_0=0;this.ite_3=null;this.ite_2=null;this.ite_1=null;this.ite_0=null;this.lengths=null;this.zip_length=false;this._length=0;this.space=null;dD.call(this);this.at_index_0=0;this.at_index_1=0;this.at_index_2=0;this.at_index_3=0;this.zip_length=true;this._length=0;this.lengths=[];var ea=0;while(ea<4){++ea;this.lengths.push(0)}};aP.__name__=["zpp_nape","dynamics","ZPP_SpaceArbiterList"];aP.__super__=dD;aP.prototype=Object.create(dD.prototype);aP.prototype.space=null;aP.prototype._length=null;aP.prototype.zip_length=null;aP.prototype.zpp_gl=function(){this.zpp_vm();if(this.zip_length){this._length=0;var ea=0;var ef=this.space.c_arbiters_true.head;while(ef!=null){if(ef.elt.active){++ea}ef=ef.next}this.lengths[0]=ea;this._length+=ea;var ed=0;var eh=this.space.c_arbiters_false.head;while(eh!=null){if(eh.elt.active){++ed}eh=eh.next}this.lengths[1]=ed;this._length+=ed;var ec=0;var eg=this.space.f_arbiters.head;while(eg!=null){if(eg.elt.active){++ec}eg=eg.next}this.lengths[2]=ec;this._length+=ec;var eb=0;var ee=this.space.s_arbiters.head;while(ee!=null){if(ee.elt.active){++eb}ee=ee.next}this.lengths[3]=eb;this._length+=eb;this.zip_length=false}return this._length};aP.prototype.lengths=null;aP.prototype.ite_0=null;aP.prototype.ite_1=null;aP.prototype.ite_2=null;aP.prototype.ite_3=null;aP.prototype.at_index_0=null;aP.prototype.at_index_1=null;aP.prototype.at_index_2=null;aP.prototype.at_index_3=null;aP.prototype.zpp_vm=function(){var ea=false;if(this.space.c_arbiters_true.modified){ea=true;this.space.c_arbiters_true.modified=false}if(this.space.c_arbiters_false.modified){ea=true;this.space.c_arbiters_false.modified=false}if(this.space.f_arbiters.modified){ea=true;this.space.f_arbiters.modified=false}if(this.space.s_arbiters.modified){ea=true;this.space.s_arbiters.modified=false}if(ea){this.zip_length=true;this._length=0;this.ite_0=null;this.ite_1=null;this.ite_2=null;this.ite_3=null}};aP.prototype.push=function(ea){return false};aP.prototype.pop=function(){return null};aP.prototype.unshift=function(ea){return false};aP.prototype.shift=function(){return null};aP.prototype.remove=function(ea){return false};aP.prototype.clear=function(){};aP.prototype.at=function(eb){this.zpp_vm();var ea=null;var ef=0;if(ea==null){if(eb<this.lengths[0]){var eg=eb;if(eg<this.at_index_0||this.ite_0==null){this.at_index_0=0;this.ite_0=this.space.c_arbiters_true.head;while(!this.ite_0.elt.active){this.ite_0=this.ite_0.next}}while(this.at_index_0!=eg){this.at_index_0++;this.ite_0=this.ite_0.next;while(!this.ite_0.elt.active){this.ite_0=this.ite_0.next}}ea=this.ite_0.elt.wrapper()}else{ef=this.lengths[0]}}if(ea==null){if(eb<ef+this.lengths[1]){var ee=eb-ef;if(ee<this.at_index_1||this.ite_1==null){this.at_index_1=0;this.ite_1=this.space.c_arbiters_false.head;while(!this.ite_1.elt.active){this.ite_1=this.ite_1.next}}while(this.at_index_1!=ee){this.at_index_1++;this.ite_1=this.ite_1.next;while(!this.ite_1.elt.active){this.ite_1=this.ite_1.next}}ea=this.ite_1.elt.wrapper()}else{ef+=this.lengths[1]}}if(ea==null){if(eb<ef+this.lengths[2]){var ed=eb-ef;if(ed<this.at_index_2||this.ite_2==null){this.at_index_2=0;this.ite_2=this.space.f_arbiters.head;while(!this.ite_2.elt.active){this.ite_2=this.ite_2.next}}while(this.at_index_2!=ed){this.at_index_2++;this.ite_2=this.ite_2.next;while(!this.ite_2.elt.active){this.ite_2=this.ite_2.next}}ea=this.ite_2.elt.wrapper()}else{ef+=this.lengths[2]}}if(ea==null){if(eb<ef+this.lengths[3]){var ec=eb-ef;if(ec<this.at_index_3||this.ite_3==null){this.at_index_3=0;this.ite_3=this.space.s_arbiters.head;while(!this.ite_3.elt.active){this.ite_3=this.ite_3.next}}while(this.at_index_3!=ec){this.at_index_3++;this.ite_3=this.ite_3.next;while(!this.ite_3.elt.active){this.ite_3=this.ite_3.next}}ea=this.ite_3.elt.wrapper()}else{ef+=this.lengths[3]}}return ea};aP.prototype.__class__=aP;var bT=zpp_nape.geom.ZPP_AABB=function(){this.wrap_max=null;this.maxy=0;this.maxx=0;this.wrap_min=null;this.miny=0;this.minx=0;this.next=null;this.outer=null;this._immutable=false;this._validate=null;this._invalidate=null};bT.__name__=["zpp_nape","geom","ZPP_AABB"];bT.get=function(eb,ea,ee,ed){var ec;if(bT.zpp_pool==null){ec=new bT()}else{ec=bT.zpp_pool;bT.zpp_pool=ec.next;ec.next=null}ec.minx=eb;ec.miny=ea;ec.maxx=ee;ec.maxy=ed;return ec};bT.prototype._invalidate=null;bT.prototype._validate=null;bT.prototype._immutable=null;bT.prototype.validate=function(){if(this._validate!=null){this._validate()}};bT.prototype.invalidate=function(){if(this._invalidate!=null){this._invalidate(this)}};bT.prototype.outer=null;bT.prototype.wrapper=function(){if(this.outer==null){this.outer=new S();var ea=this.outer.zpp_inner;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea.wrap_min=ea.wrap_max=null;ea._invalidate=null;ea._validate=null;ea.next=bT.zpp_pool;bT.zpp_pool=ea;this.outer.zpp_inner=this}return this.outer};bT.prototype.next=null;bT.prototype.alloc=function(){};bT.prototype.free=function(){if(this.outer!=null){this.outer.zpp_inner=null;this.outer=null}this.wrap_min=this.wrap_max=null;this._invalidate=null;this._validate=null};bT.prototype.copy=function(){var eb=this.minx;var ea=this.miny;var ee=this.maxx;var ed=this.maxy;var ec;if(bT.zpp_pool==null){ec=new bT()}else{ec=bT.zpp_pool;bT.zpp_pool=ec.next;ec.next=null}ec.minx=eb;ec.miny=ea;ec.maxx=ee;ec.maxy=ed;return ec};bT.prototype.width=function(){return this.maxx-this.minx};bT.prototype.height=function(){return this.maxy-this.miny};bT.prototype.perimeter=function(){return(this.maxx-this.minx+(this.maxy-this.miny))*2};bT.prototype.minx=null;bT.prototype.miny=null;bT.prototype.wrap_min=null;bT.prototype.getmin=function(){if(this.wrap_min==null){var ea=this.minx;var eh=this.miny;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_min=eb;this.wrap_min.zpp_inner._inuse=true;if(this._immutable){this.wrap_min.zpp_inner._immutable=true}else{this.wrap_min.zpp_inner._invalidate=dX(this,this.mod_min)}this.wrap_min.zpp_inner._validate=dX(this,this.dom_min)}return this.wrap_min};bT.prototype.dom_min=function(){if(this._validate!=null){this._validate()}this.wrap_min.zpp_inner.x=this.minx;this.wrap_min.zpp_inner.y=this.miny};bT.prototype.mod_min=function(ea){if(ea.x!=this.minx||ea.y!=this.miny){this.minx=ea.x;this.miny=ea.y;if(this._invalidate!=null){this._invalidate(this)}}};bT.prototype.maxx=null;bT.prototype.maxy=null;bT.prototype.wrap_max=null;bT.prototype.getmax=function(){if(this.wrap_max==null){var ea=this.maxx;var eh=this.maxy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap_max=eb;this.wrap_max.zpp_inner._inuse=true;if(this._immutable){this.wrap_max.zpp_inner._immutable=true}else{this.wrap_max.zpp_inner._invalidate=dX(this,this.mod_max)}this.wrap_max.zpp_inner._validate=dX(this,this.dom_max)}return this.wrap_max};bT.prototype.dom_max=function(){if(this._validate!=null){this._validate()}this.wrap_max.zpp_inner.x=this.maxx;this.wrap_max.zpp_inner.y=this.maxy};bT.prototype.mod_max=function(ea){if(ea.x!=this.maxx||ea.y!=this.maxy){this.maxx=ea.x;this.maxy=ea.y;if(this._invalidate!=null){this._invalidate(this)}}};bT.prototype.intersectX=function(ea){return !(ea.minx>this.maxx||this.minx>ea.maxx)};bT.prototype.intersectY=function(ea){return !(ea.miny>this.maxy||this.miny>ea.maxy)};bT.prototype.intersect=function(ea){if(ea.miny<=this.maxy&&this.miny<=ea.maxy&&ea.minx<=this.maxx){return this.minx<=ea.maxx}else{return false}};bT.prototype.combine=function(ea){if(ea.minx<this.minx){this.minx=ea.minx}if(ea.maxx>this.maxx){this.maxx=ea.maxx}if(ea.miny<this.miny){this.miny=ea.miny}if(ea.maxy>this.maxy){this.maxy=ea.maxy}};bT.prototype.contains=function(ea){if(ea.minx>=this.minx&&ea.miny>=this.miny&&ea.maxx<=this.maxx){return ea.maxy<=this.maxy}else{return false}};bT.prototype.containsPoint=function(ea){if(ea.x>=this.minx&&ea.x<=this.maxx&&ea.y>=this.miny){return ea.y<=this.maxy}else{return false}};bT.prototype.setCombine=function(eb,ea){this.minx=eb.minx<ea.minx?eb.minx:ea.minx;this.miny=eb.miny<ea.miny?eb.miny:ea.miny;this.maxx=eb.maxx>ea.maxx?eb.maxx:ea.maxx;this.maxy=eb.maxy>ea.maxy?eb.maxy:ea.maxy};bT.prototype.setExpand=function(ea,eb){this.minx=ea.minx-eb;this.miny=ea.miny-eb;this.maxx=ea.maxx+eb;this.maxy=ea.maxy+eb};bT.prototype.setExpandPoint=function(ea,eb){if(ea<this.minx){this.minx=ea}if(ea>this.maxx){this.maxx=ea}if(eb<this.miny){this.miny=eb}if(eb>this.maxy){this.maxy=eb}};bT.prototype.toString=function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"};bT.prototype.__class__=bT;var aG=zpp_nape.util.ZNPList_ZPP_Vec2=function(){this.length=0;this.pushmod=false;this.modified=false;this.head=null};aG.__name__=["zpp_nape","util","ZNPList_ZPP_Vec2"];aG.prototype.head=null;aG.prototype.begin=function(){return this.head};aG.prototype.modified=null;aG.prototype.pushmod=null;aG.prototype.length=null;aG.prototype.setbegin=function(ea){this.head=ea;this.modified=true;this.pushmod=true};aG.prototype.add=function(ec){var eb;if(aV.zpp_pool==null){eb=new aV()}else{eb=aV.zpp_pool;aV.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};aG.prototype.inlined_add=function(ec){var eb;if(aV.zpp_pool==null){eb=new aV()}else{eb=aV.zpp_pool;aV.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;ea.next=this.head;this.head=ea;this.modified=true;this.length++;return ec};aG.prototype.addAll=function(ea){var eb=ea.head;while(eb!=null){this.add(eb.elt);eb=eb.next}};aG.prototype.insert=function(ed,ec){var eb;if(aV.zpp_pool==null){eb=new aV()}else{eb=aV.zpp_pool;aV.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};aG.prototype.inlined_insert=function(ed,ec){var eb;if(aV.zpp_pool==null){eb=new aV()}else{eb=aV.zpp_pool;aV.zpp_pool=eb.next;eb.next=null}eb.elt=ec;var ea=eb;if(ed==null){ea.next=this.head;this.head=ea}else{ea.next=ed.next;ed.next=ea}this.pushmod=this.modified=true;this.length++;return ea};aG.prototype.pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aV.zpp_pool;aV.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};aG.prototype.inlined_pop=function(){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aV.zpp_pool;aV.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--};aG.prototype.pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};aG.prototype.inlined_pop_unsafe=function(){var ea=this.head.elt;this.pop();return ea};aG.prototype.remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aV.zpp_pool;aV.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};aG.prototype.try_remove=function(ec){var eb=null;var ed=this.head;var ea=false;while(ed!=null){if(ed.elt==ec){this.erase(eb);ea=true;break}eb=ed;ed=ed.next}return ea};aG.prototype.inlined_remove=function(ed){var ec=null;var ef=this.head;while(ef!=null){if(ef.elt==ed){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ee=ea;ee.elt=null;ee.next=aV.zpp_pool;aV.zpp_pool=ee;this.modified=true;this.length--;this.pushmod=true;break}ec=ef;ef=ef.next}};aG.prototype.inlined_try_remove=function(ee){var ed=null;var eg=this.head;var eb=false;while(eg!=null){if(eg.elt==ee){var ea;var ec;if(ed==null){ea=this.head;ec=ea.next;this.head=ec;if(this.head==null){this.pushmod=true}}else{ea=ed.next;ec=ea.next;ed.next=ec;if(ec==null){this.pushmod=true}}var ef=ea;ef.elt=null;ef.next=aV.zpp_pool;aV.zpp_pool=ef;this.modified=true;this.length--;this.pushmod=true;eb=true;break}ed=eg;eg=eg.next}return eb};aG.prototype.erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aV.zpp_pool;aV.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};aG.prototype.inlined_erase=function(ec){var ea;var eb;if(ec==null){ea=this.head;eb=ea.next;this.head=eb;if(this.head==null){this.pushmod=true}}else{ea=ec.next;eb=ea.next;ec.next=eb;if(eb==null){this.pushmod=true}}var ed=ea;ed.elt=null;ed.next=aV.zpp_pool;aV.zpp_pool=ed;this.modified=true;this.length--;this.pushmod=true;return eb};aG.prototype.splice=function(ea,eb){while(eb-->0&&ea.next!=null){this.erase(ea)}return ea.next};aG.prototype.clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aV.zpp_pool;aV.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};aG.prototype.inlined_clear=function(){while(this.head!=null){var ea=this.head;this.head=ea.next;ea.elt=null;ea.next=aV.zpp_pool;aV.zpp_pool=ea;if(this.head==null){this.pushmod=true}this.modified=true;this.length--}this.pushmod=true};aG.prototype.reverse=function(){var ec=this.head;var eb=null;while(ec!=null){var ea=ec.next;ec.next=eb;this.head=ec;eb=ec;ec=ea}this.modified=true;this.pushmod=true};aG.prototype.empty=function(){return this.head==null};aG.prototype.size=function(){return this.length};aG.prototype.has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};aG.prototype.inlined_has=function(ec){var ea;ea=false;var eb=this.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}return ea};aG.prototype.front=function(){return this.head.elt};aG.prototype.back=function(){var ea=this.head;var eb=ea;while(eb!=null){ea=eb;eb=eb.next}return ea.elt};aG.prototype.iterator_at=function(eb){var ea=this.head;while(eb-->0&&ea!=null){ea=ea.next}return ea};aG.prototype.at=function(eb){var ea=this.iterator_at(eb);if(ea!=null){return ea.elt}else{return null}};aG.prototype.__class__=aG;var b7=zpp_nape.geom.ZPP_Collide=function(){};b7.__name__=["zpp_nape","geom","ZPP_Collide"];b7.circleContains=function(ed,ec){var eb=0;var ea=0;eb=ec.x-ed.worldCOMx;ea=ec.y-ed.worldCOMy;return eb*eb+ea*ea<ed.radius*ed.radius};b7.polyContains=function(ec,ee){var ed;ed=true;var eb=ec.edges.head;while(eb!=null){var ea=eb.elt;if(ea.gnormx*ee.x+ea.gnormy*ee.y<=ea.gprojection){eb=eb.next;continue}else{ed=false;break}}return ed};b7.shapeContains=function(ea,eb){if(ea.type==0){return b7.circleContains(ea.circle,eb)}else{return b7.polyContains(ea.polygon,eb)}};b7.bodyContains=function(ea,ed){var ec;ec=false;var eb=ea.shapes.head;while(eb!=null){if(b7.shapeContains(eb.elt,ed)){ec=true;break}eb=eb.next}return ec};b7.containTest=function(ee,ed){var es=ee.aabb;var eh=ed.aabb;if(eh.minx>=es.minx&&eh.miny>=es.miny&&eh.maxx<=es.maxx&&eh.maxy<=es.maxy){if(ee.type==0){if(ed.type==0){var ec=ee.circle.radius+-ed.circle.radius;var el=0;var ek=0;el=ed.circle.worldCOMx-ee.circle.worldCOMx;ek=ed.circle.worldCOMy-ee.circle.worldCOMy;return el*el+ek*ek<=ec*ec}else{var ei;ei=true;var eq=ed.polygon.gverts.next;while(eq!=null){var eo=eq;var eg=ee.circle.radius;var eu=0;var ef=0;eu=eo.x-ee.circle.worldCOMx;ef=eo.y-ee.circle.worldCOMy;if(eu*eu+ef*ef<=eg*eg){eq=eq.next;continue}else{ei=false;break}}return ei}}else{if(ed.type==0){var eb;eb=true;var ep=ee.polygon.edges.head;while(ep!=null){var ev=ep.elt;if(ev.gnormx*ed.circle.worldCOMx+ev.gnormy*ed.circle.worldCOMy+ed.circle.radius<=ev.gprojection){ep=ep.next;continue}else{eb=false;break}}return eb}else{var ea;ea=true;var en=ee.polygon.edges.head;while(en!=null){var ew=en.elt;var et=-1e+100;var em=ed.polygon.gverts.next;while(em!=null){var ej=em;var er=ew.gnormx*ej.x+ew.gnormy*ej.y;if(er>et){et=er}em=em.next}if(et<=ew.gprojection){en=en.next;continue}else{ea=false;break}}return ea}}}else{return false}};b7.contactCollide=function(gd,ga,eD,fz){if(ga.type==1){if(gd.type==1){var gF=true;var fe=-1e+100;var eT=-1;var gJ=null;var gI=null;var eK=gd.polygon.edges.head;while(eK!=null){var gT=eK.elt;var gC=1e+100;var e5=ga.polygon.gverts.next;while(e5!=null){var gu=e5;var gD=gT.gnormx*gu.x+gT.gnormy*gu.y;if(gD<gC){gC=gD}if(gC-gT.gprojection<=fe){break}e5=e5.next}gC-=gT.gprojection;if(gC>=0){gF=false;break}if(gC>fe){fe=gC;gJ=gT;eT=1}eK=eK.next}if(gF){var e4=ga.polygon.edges.head;while(e4!=null){var gL=e4.elt;var eF=1e+100;var e3=gd.polygon.gverts.next;while(e3!=null){var fb=e3;var eQ=gL.gnormx*fb.x+gL.gnormy*fb.y;if(eQ<eF){eF=eQ}if(eF-gL.gprojection<=fe){break}e3=e3.next}eF-=gL.gprojection;if(eF>=0){gF=false;break}if(eF>fe){fe=eF;gI=gL;eT=2}e4=e4.next}if(!gF){return false}else{var gE;var gK;var gs;if(eT==1){gE=ga.polygon;gK=gJ;gs=1}else{gE=gd.polygon;gK=gI;gs=-1}var gS=null;var eC=1e+100;var e2=gE.edges.head;while(e2!=null){var eA=e2.elt;var eP=gK.gnormx*eA.gnormx+gK.gnormy*eA.gnormy;if(eP<eC){eC=eP;gS=eA}e2=e2.next}var fo=0;var fl=0;fo=gS.gp0.x;fl=gS.gp0.y;var fa=0;var e9=0;fa=gS.gp1.x;e9=gS.gp1.y;var eS=0;var eR=0;eS=fa-fo;eR=e9-fl;var gN=gK.gnormy*fo-gK.gnormx*fl;var gM=gK.gnormy*fa-gK.gnormx*e9;var gr=1/(gM-gN);var gv=(-gK.tp1-gN)*gr;if(gv>P.epsilon){fo+=eS*gv;fl+=eR*gv}var fG=(-gK.tp0-gM)*gr;if(fG<-P.epsilon){fa+=eS*fG;e9+=eR*fG}var gP=0;var gO=0;var fD=gs;gP=gK.gnormx*fD;gO=gK.gnormy*fD;eD.lnormx=gK.lnormx;eD.lnormy=gK.lnormy;eD.lproj=gK.lprojection;eD.radius=0;eD.rev=fz!=(gs==-1);eD.ptype=eD.rev?1:0;var ft=fo*gK.gnormx+fl*gK.gnormy-gK.gprojection;var ff=fa*gK.gnormx+e9*gK.gnormy-gK.gprojection;if(ft>0&&ff>0){return false}else{if(fz){gP=-gP;gO=-gO}var gq=fo-gK.gnormx*ft*0.5;var gp=fl-gK.gnormy*ft*0.5;var gh=eD.rev?1:0;var gG=null;var e1=eD.contacts.next;while(e1!=null){var gQ=e1;if(gh==gQ.hash){gG=gQ;break}e1=e1.next}if(gG==null){if(c2.zpp_pool==null){gG=new c2()}else{gG=c2.zpp_pool;c2.zpp_pool=gG.next;gG.next=null}var gB=gG.inner;gB.jnAcc=gB.jtAcc=0;gG.hash=gh;gG.fresh=true;gG.arbiter=eD;eD.jrAcc=0;var gl=eD.contacts;gG._inuse=true;var gk=gG;gk.next=gl.next;gl.next=gk;gl.modified=true;gl.length++;eD.innards.add(gB)}else{gG.fresh=false}gG.px=gq;gG.py=gp;eD.nx=gP;eD.ny=gO;gG.dist=ft;gG.stamp=eD.stamp;gG.posOnly=ft>0;var fd=gG;fo-=gE.body.posx;fl-=gE.body.posy;fd.inner.lr1x=fo*gE.body.axisy+fl*gE.body.axisx;fd.inner.lr1y=fl*gE.body.axisy-fo*gE.body.axisx;var eI=fa-gK.gnormx*ff*0.5;var el=e9-gK.gnormy*ff*0.5;var gj=eD.rev?0:1;var g3=null;var e0=eD.contacts.next;while(e0!=null){var fY=e0;if(gj==fY.hash){g3=fY;break}e0=e0.next}if(g3==null){if(c2.zpp_pool==null){g3=new c2()}else{g3=c2.zpp_pool;c2.zpp_pool=g3.next;g3.next=null}var hm=g3.inner;hm.jnAcc=hm.jtAcc=0;g3.hash=gj;g3.fresh=true;g3.arbiter=eD;eD.jrAcc=0;var fr=eD.contacts;g3._inuse=true;var fL=g3;fL.next=fr.next;fr.next=fL;fr.modified=true;fr.length++;eD.innards.add(hm)}else{g3.fresh=false}g3.px=eI;g3.py=el;eD.nx=gP;eD.ny=gO;g3.dist=ff;g3.stamp=eD.stamp;g3.posOnly=ff>0;fd=g3;fa-=gE.body.posx;e9-=gE.body.posy;fd.inner.lr1x=fa*gE.body.axisy+e9*gE.body.axisx;fd.inner.lr1y=e9*gE.body.axisy-fa*gE.body.axisx;if(eT==1){eD.__ref_edge1=gK;eD.__ref_edge2=gS}else{eD.__ref_edge2=gK;eD.__ref_edge1=gS}return true}}}else{return false}}else{var fn=-1e+100;var go=true;var ec=null;var eO=null;var fu=ga.polygon.gverts.next;var eZ=ga.polygon.edges.head;while(eZ!=null){var gH=eZ.elt;var gm=gH.gnormx*gd.circle.worldCOMx+gH.gnormy*gd.circle.worldCOMy-gH.gprojection-gd.circle.radius;if(gm>0){go=false;break}if(gm>fn){fn=gm;ec=gH;eO=fu}fu=fu.next;eZ=eZ.next}if(go){var fc=eO;var gR=eO.next==null?ga.polygon.gverts.next:eO.next;var gn=gd.circle.worldCOMy*ec.gnormx-gd.circle.worldCOMx*ec.gnormy;if(gn<=fc.y*ec.gnormx-fc.x*ec.gnormy){var eU=gd.circle.radius;var eG=0;var ek=0;eG=fc.x-gd.circle.worldCOMx;ek=fc.y-gd.circle.worldCOMy;var gU=eG*eG+ek*ek;var gw;if(gU>eU*eU){gw=null}else{if(gU<P.epsilon*P.epsilon){var eE=gd.circle.worldCOMx;var ej=gd.circle.worldCOMy;var g2=null;var eY=eD.contacts.next;while(eY!=null){var fX=eY;if(0==fX.hash){g2=fX;break}eY=eY.next}if(g2==null){if(c2.zpp_pool==null){g2=new c2()}else{g2=c2.zpp_pool;c2.zpp_pool=g2.next;g2.next=null}var hl=g2.inner;hl.jnAcc=hl.jtAcc=0;g2.hash=0;g2.fresh=true;g2.arbiter=eD;eD.jrAcc=0;var fq=eD.contacts;g2._inuse=true;var fJ=g2;fJ.next=fq.next;fq.next=fJ;fq.modified=true;fq.length++;eD.innards.add(hl)}else{g2.fresh=false}g2.px=eE;g2.py=ej;eD.nx=1;eD.ny=0;g2.dist=-eU;g2.stamp=eD.stamp;g2.posOnly=false;gw=g2}else{var fs=1/Math.sqrt(gU);var fM=fs<P.epsilon?1e+100:1/fs;var gt=0.5+(gd.circle.radius-0.5*eU)*fs;if(fz){var eB=gd.circle.worldCOMx+eG*gt;var ei=gd.circle.worldCOMy+ek*gt;var g1=null;var eX=eD.contacts.next;while(eX!=null){var fW=eX;if(0==fW.hash){g1=fW;break}eX=eX.next}if(g1==null){if(c2.zpp_pool==null){g1=new c2()}else{g1=c2.zpp_pool;c2.zpp_pool=g1.next;g1.next=null}var hk=g1.inner;hk.jnAcc=hk.jtAcc=0;g1.hash=0;g1.fresh=true;g1.arbiter=eD;eD.jrAcc=0;var fp=eD.contacts;g1._inuse=true;var fH=g1;fH.next=fp.next;fp.next=fH;fp.modified=true;fp.length++;eD.innards.add(hk)}else{g1.fresh=false}g1.px=eB;g1.py=ei;eD.nx=-eG*fs;eD.ny=-ek*fs;g1.dist=fM-eU;g1.stamp=eD.stamp;g1.posOnly=false;gw=g1}else{var ez=gd.circle.worldCOMx+eG*gt;var eh=gd.circle.worldCOMy+ek*gt;var g0=null;var f7=eD.contacts.next;while(f7!=null){var fV=f7;if(0==fV.hash){g0=fV;break}f7=f7.next}if(g0==null){if(c2.zpp_pool==null){g0=new c2()}else{g0=c2.zpp_pool;c2.zpp_pool=g0.next;g0.next=null}var hj=g0.inner;hj.jnAcc=hj.jtAcc=0;g0.hash=0;g0.fresh=true;g0.arbiter=eD;eD.jrAcc=0;var fm=eD.contacts;g0._inuse=true;var fE=g0;fE.next=fm.next;fm.next=fE;fm.modified=true;fm.length++;eD.innards.add(hj)}else{g0.fresh=false}g0.px=ez;g0.py=eh;eD.nx=eG*fs;eD.ny=ek*fs;g0.dist=fM-eU;g0.stamp=eD.stamp;g0.posOnly=false;gw=g0}}}if(gw!=null){var ha=gw.inner;eD.ptype=2;var eJ=0;var eH=0;eJ=fc.x-ga.polygon.body.posx;eH=fc.y-ga.polygon.body.posy;eD.__ref_edge1=ec;eD.__ref_vertex=-1;if(fz){ha.lr1x=eJ*ga.polygon.body.axisy+eH*ga.polygon.body.axisx;ha.lr1y=eH*ga.polygon.body.axisy-eJ*ga.polygon.body.axisx;ha.lr2x=gd.circle.localCOMx;ha.lr2y=gd.circle.localCOMy}else{ha.lr2x=eJ*ga.polygon.body.axisy+eH*ga.polygon.body.axisx;ha.lr2y=eH*ga.polygon.body.axisy-eJ*ga.polygon.body.axisx;ha.lr1x=gd.circle.localCOMx;ha.lr1y=gd.circle.localCOMy}eD.radius=gd.circle.radius}return gw!=null}else{if(gn>=gR.y*ec.gnormx-gR.x*ec.gnormy){var eW=gd.circle.radius;var ey=0;var eg=0;ey=gR.x-gd.circle.worldCOMx;eg=gR.y-gd.circle.worldCOMy;var gA=ey*ey+eg*eg;var fI;if(gA>eW*eW){fI=null}else{if(gA<P.epsilon*P.epsilon){var ex=gd.circle.worldCOMx;var ef=gd.circle.worldCOMy;var gZ=null;var f6=eD.contacts.next;while(f6!=null){var fU=f6;if(0==fU.hash){gZ=fU;break}f6=f6.next}if(gZ==null){if(c2.zpp_pool==null){gZ=new c2()}else{gZ=c2.zpp_pool;c2.zpp_pool=gZ.next;gZ.next=null}var hi=gZ.inner;hi.jnAcc=hi.jtAcc=0;gZ.hash=0;gZ.fresh=true;gZ.arbiter=eD;eD.jrAcc=0;var fk=eD.contacts;gZ._inuse=true;var fB=gZ;fB.next=fk.next;fk.next=fB;fk.modified=true;fk.length++;eD.innards.add(hi)}else{gZ.fresh=false}gZ.px=ex;gZ.py=ef;eD.nx=1;eD.ny=0;gZ.dist=-eW;gZ.stamp=eD.stamp;gZ.posOnly=false;fI=gZ}else{var eb=1/Math.sqrt(gA);var fK=eb<P.epsilon?1e+100:1/eb;var gz=0.5+(gd.circle.radius-0.5*eW)*eb;if(fz){var ew=gd.circle.worldCOMx+ey*gz;var ee=gd.circle.worldCOMy+eg*gz;var gY=null;var f5=eD.contacts.next;while(f5!=null){var fT=f5;if(0==fT.hash){gY=fT;break}f5=f5.next}if(gY==null){if(c2.zpp_pool==null){gY=new c2()}else{gY=c2.zpp_pool;c2.zpp_pool=gY.next;gY.next=null}var hh=gY.inner;hh.jnAcc=hh.jtAcc=0;gY.hash=0;gY.fresh=true;gY.arbiter=eD;eD.jrAcc=0;var fj=eD.contacts;gY._inuse=true;var fy=gY;fy.next=fj.next;fj.next=fy;fj.modified=true;fj.length++;eD.innards.add(hh)}else{gY.fresh=false}gY.px=ew;gY.py=ee;eD.nx=-ey*eb;eD.ny=-eg*eb;gY.dist=fK-eW;gY.stamp=eD.stamp;gY.posOnly=false;fI=gY}else{var ev=gd.circle.worldCOMx+ey*gz;var ed=gd.circle.worldCOMy+eg*gz;var gX=null;var f4=eD.contacts.next;while(f4!=null){var fS=f4;if(0==fS.hash){gX=fS;break}f4=f4.next}if(gX==null){if(c2.zpp_pool==null){gX=new c2()}else{gX=c2.zpp_pool;c2.zpp_pool=gX.next;gX.next=null}var hg=gX.inner;hg.jnAcc=hg.jtAcc=0;gX.hash=0;gX.fresh=true;gX.arbiter=eD;eD.jrAcc=0;var fi=eD.contacts;gX._inuse=true;var fx=gX;fx.next=fi.next;fi.next=fx;fi.modified=true;fi.length++;eD.innards.add(hg)}else{gX.fresh=false}gX.px=ev;gX.py=ed;eD.nx=ey*eb;eD.ny=eg*eb;gX.dist=fK-eW;gX.stamp=eD.stamp;gX.posOnly=false;fI=gX}}}if(fI!=null){var g9=fI.inner;eD.ptype=2;var et=0;var hn=0;et=gR.x-ga.polygon.body.posx;hn=gR.y-ga.polygon.body.posy;eD.__ref_edge1=ec;eD.__ref_vertex=1;if(fz){g9.lr1x=et*ga.polygon.body.axisy+hn*ga.polygon.body.axisx;g9.lr1y=hn*ga.polygon.body.axisy-et*ga.polygon.body.axisx;g9.lr2x=gd.circle.localCOMx;g9.lr2y=gd.circle.localCOMy}else{g9.lr2x=et*ga.polygon.body.axisy+hn*ga.polygon.body.axisx;g9.lr2y=hn*ga.polygon.body.axisy-et*ga.polygon.body.axisx;g9.lr1x=gd.circle.localCOMx;g9.lr1y=gd.circle.localCOMy}eD.radius=gd.circle.radius}return fI!=null}else{var eN=0;var ep=0;var fA=gd.circle.radius+fn*0.5;eN=ec.gnormx*fA;ep=ec.gnormy*fA;var eu=0;var gi=0;eu=gd.circle.worldCOMx-eN;gi=gd.circle.worldCOMy-ep;var g8;if(fz){var eM=ec.gnormx;var en=ec.gnormy;var gW=null;var f3=eD.contacts.next;while(f3!=null){var fR=f3;if(0==fR.hash){gW=fR;break}f3=f3.next}if(gW==null){if(c2.zpp_pool==null){gW=new c2()}else{gW=c2.zpp_pool;c2.zpp_pool=gW.next;gW.next=null}var hf=gW.inner;hf.jnAcc=hf.jtAcc=0;gW.hash=0;gW.fresh=true;gW.arbiter=eD;eD.jrAcc=0;var fh=eD.contacts;gW._inuse=true;var fw=gW;fw.next=fh.next;fh.next=fw;fh.modified=true;fh.length++;eD.innards.add(hf)}else{gW.fresh=false}gW.px=eu;gW.py=gi;eD.nx=eM;eD.ny=en;gW.dist=fn;gW.stamp=eD.stamp;gW.posOnly=false;g8=gW}else{var eL=-ec.gnormx;var em=-ec.gnormy;var gV=null;var f2=eD.contacts.next;while(f2!=null){var fQ=f2;if(0==fQ.hash){gV=fQ;break}f2=f2.next}if(gV==null){if(c2.zpp_pool==null){gV=new c2()}else{gV=c2.zpp_pool;c2.zpp_pool=gV.next;gV.next=null}var he=gV.inner;he.jnAcc=he.jtAcc=0;gV.hash=0;gV.fresh=true;gV.arbiter=eD;eD.jrAcc=0;var fg=eD.contacts;gV._inuse=true;var fv=gV;fv.next=fg.next;fg.next=fv;fg.modified=true;fg.length++;eD.innards.add(he)}else{gV.fresh=false}gV.px=eu;gV.py=gi;eD.nx=eL;eD.ny=em;gV.dist=fn;gV.stamp=eD.stamp;gV.posOnly=false;g8=gV}eD.ptype=fz?0:1;eD.lnormx=ec.lnormx;eD.lnormy=ec.lnormy;eD.rev=!fz;eD.lproj=ec.lprojection;eD.radius=gd.circle.radius;g8.inner.lr1x=gd.circle.localCOMx;g8.inner.lr1y=gd.circle.localCOMy;eD.__ref_edge1=ec;eD.__ref_vertex=0;return true}}}else{return false}}}else{var eV=gd.circle.radius+ga.circle.radius;var es=0;var gg=0;es=ga.circle.worldCOMx-gd.circle.worldCOMx;gg=ga.circle.worldCOMy-gd.circle.worldCOMy;var gy=es*es+gg*gg;var fC;if(gy>eV*eV){fC=null}else{if(gy<P.epsilon*P.epsilon){var er=gd.circle.worldCOMx;var gf=gd.circle.worldCOMy;var fP=null;var f1=eD.contacts.next;while(f1!=null){var e8=f1;if(0==e8.hash){fP=e8;break}f1=f1.next}if(fP==null){if(c2.zpp_pool==null){fP=new c2()}else{fP=c2.zpp_pool;c2.zpp_pool=fP.next;fP.next=null}var g7=fP.inner;g7.jnAcc=g7.jtAcc=0;fP.hash=0;fP.fresh=true;fP.arbiter=eD;eD.jrAcc=0;var gc=eD.contacts;fP._inuse=true;var hd=fP;hd.next=gc.next;gc.next=hd;gc.modified=true;gc.length++;eD.innards.add(g7)}else{fP.fresh=false}fP.px=er;fP.py=gf;eD.nx=1;eD.ny=0;fP.dist=-eV;fP.stamp=eD.stamp;fP.posOnly=false;fC=fP}else{var ea=1/Math.sqrt(gy);var fF=ea<P.epsilon?1e+100:1/ea;var gx=0.5+(gd.circle.radius-0.5*eV)*ea;if(fz){var eq=gd.circle.worldCOMx+es*gx;var ge=gd.circle.worldCOMy+gg*gx;var fO=null;var f0=eD.contacts.next;while(f0!=null){var e7=f0;if(0==e7.hash){fO=e7;break}f0=f0.next}if(fO==null){if(c2.zpp_pool==null){fO=new c2()}else{fO=c2.zpp_pool;c2.zpp_pool=fO.next;fO.next=null}var g6=fO.inner;g6.jnAcc=g6.jtAcc=0;fO.hash=0;fO.fresh=true;fO.arbiter=eD;eD.jrAcc=0;var f9=eD.contacts;fO._inuse=true;var hc=fO;hc.next=f9.next;f9.next=hc;f9.modified=true;f9.length++;eD.innards.add(g6)}else{fO.fresh=false}fO.px=eq;fO.py=ge;eD.nx=-es*ea;eD.ny=-gg*ea;fO.dist=fF-eV;fO.stamp=eD.stamp;fO.posOnly=false;fC=fO}else{var eo=gd.circle.worldCOMx+es*gx;var gb=gd.circle.worldCOMy+gg*gx;var fN=null;var fZ=eD.contacts.next;while(fZ!=null){var e6=fZ;if(0==e6.hash){fN=e6;break}fZ=fZ.next}if(fN==null){if(c2.zpp_pool==null){fN=new c2()}else{fN=c2.zpp_pool;c2.zpp_pool=fN.next;fN.next=null}var g4=fN.inner;g4.jnAcc=g4.jtAcc=0;fN.hash=0;fN.fresh=true;fN.arbiter=eD;eD.jrAcc=0;var f8=eD.contacts;fN._inuse=true;var hb=fN;hb.next=f8.next;f8.next=hb;f8.modified=true;f8.length++;eD.innards.add(g4)}else{fN.fresh=false}fN.px=eo;fN.py=gb;eD.nx=es*ea;eD.ny=gg*ea;fN.dist=fF-eV;fN.stamp=eD.stamp;fN.posOnly=false;fC=fN}}}if(fC!=null){var g5=fC.inner;if(fz){g5.lr1x=ga.circle.localCOMx;g5.lr1y=ga.circle.localCOMy;g5.lr2x=gd.circle.localCOMx;g5.lr2y=gd.circle.localCOMy}else{g5.lr1x=gd.circle.localCOMx;g5.lr1y=gd.circle.localCOMy;g5.lr2x=ga.circle.localCOMx;g5.lr2y=ga.circle.localCOMy}eD.radius=gd.circle.radius+ga.circle.radius;eD.ptype=2;return true}else{return false}}};b7.testCollide_safe=function(ec,ea){if(ea.type==0){var eb=ec;ec=ea;ea=eb}return b7.testCollide(ec,ea)};b7.testCollide=function(ee,ec){if(ec.type==1){if(ee.type==1){var ef=true;var ex=ee.polygon.edges.head;while(ex!=null){var em=ex.elt;var ew=1e+100;var eu=ec.polygon.gverts.next;while(eu!=null){var en=eu;var ez=em.gnormx*en.x+em.gnormy*en.y;if(ez<ew){ew=ez}eu=eu.next}ew-=em.gprojection;if(ew>0){ef=false;break}ex=ex.next}if(ef){var et=ec.polygon.edges.head;while(et!=null){var el=et.elt;var ey=1e+100;var es=ee.polygon.gverts.next;while(es!=null){var eg=es;var ek=el.gnormx*eg.x+el.gnormy*eg.y;if(ek<ey){ey=ek}es=es.next}ey-=el.gprojection;if(ey>0){ef=false;break}et=et.next}return ef}else{return false}}else{var eI=null;var eG=null;var eE=true;var eC=-1e+100;var eH=ec.polygon.gverts.next;var er=ec.polygon.edges.head;while(er!=null){var eF=er.elt;var ev=eF.gnormx*ee.circle.worldCOMx+eF.gnormy*ee.circle.worldCOMy-eF.gprojection-ee.circle.radius;if(ev>0){eE=false;break}if(ev>eC){eC=ev;eI=eF;eG=eH}eH=eH.next;er=er.next}if(eE){var eh=eG;var eD=eG.next==null?ec.polygon.gverts.next:eG.next;var eq=ee.circle.worldCOMy*eI.gnormx-ee.circle.worldCOMx*eI.gnormy;if(eq<=eh.y*eI.gnormx-eh.x*eI.gnormy){var eb=ee.circle.radius;var ep=0;var eo=0;ep=eh.x-ee.circle.worldCOMx;eo=eh.y-ee.circle.worldCOMy;return ep*ep+eo*eo<=eb*eb}else{if(eq>=eD.y*eI.gnormx-eD.x*eI.gnormy){var ej=ee.circle.radius;var eB=0;var ed=0;eB=eD.x-ee.circle.worldCOMx;ed=eD.y-ee.circle.worldCOMy;return eB*eB+ed*ed<=ej*ej}else{return true}}}else{return false}}}else{var ei=ee.circle.radius+ec.circle.radius;var eA=0;var ea=0;eA=ec.circle.worldCOMx-ee.circle.worldCOMx;ea=ec.circle.worldCOMy-ee.circle.worldCOMy;return eA*eA+ea*ea<=ei*ei}};b7.flowCollide=function(hw,hu,ke){if(hu.type==1){if(hw.type==1){var hR=[];var hO=[];var fb=true;var gW=true;var j5=hw.polygon.edges.head;while(j5!=null){var mb=j5.elt;var eI=1e+100;var lC=0;var gd=hu.polygon.gverts.next;while(gd!=null){var lj=gd;var lz=mb.gnormx*lj.x+mb.gnormy*lj.y;if(lz<eI){eI=lz}if(lz>=mb.gprojection+P.epsilon){hO[lC]=true;gW=false}++lC;gd=gd.next}eI-=mb.gprojection;if(eI>0){fb=false;break}j5=j5.next}if(gW){var gz=hu.polygon;if(gz.zip_worldCOM){if(gz.body!=null){gz.zip_worldCOM=false;if(gz.zip_localCOM){gz.zip_localCOM=false;if(gz.type==1){var eY=gz.polygon;if(eY.lverts.next.next==null){eY.localCOMx=eY.lverts.next.x;eY.localCOMy=eY.lverts.next.y}else{if(eY.lverts.next.next.next==null){eY.localCOMx=eY.lverts.next.x;eY.localCOMy=eY.lverts.next.y;eY.localCOMx+=eY.lverts.next.next.x;eY.localCOMy+=eY.lverts.next.next.y;eY.localCOMx*=0.5;eY.localCOMy*=0.5}else{eY.localCOMx=0;eY.localCOMy=0;var iu=0;var gb=eY.lverts.next;var lm=gb;gb=gb.next;var gl=gb;gb=gb.next;while(gb!=null){var lg=gb;iu+=gl.x*(lg.y-lm.y);var lB=lg.y*gl.x-lg.x*gl.y;eY.localCOMx+=(gl.x+lg.x)*lB;eY.localCOMy+=(gl.y+lg.y)*lB;lm=gl;gl=lg;gb=gb.next}gb=eY.lverts.next;var fZ=gb;iu+=gl.x*(fZ.y-lm.y);var kG=fZ.y*gl.x-fZ.x*gl.y;eY.localCOMx+=(gl.x+fZ.x)*kG;eY.localCOMy+=(gl.y+fZ.y)*kG;lm=gl;gb=gb.next;var fX=gb;iu+=fZ.x*(fX.y-lm.y);var kE=fX.y*fZ.x-fX.x*fZ.y;eY.localCOMx+=(fZ.x+fX.x)*kE;eY.localCOMy+=(fZ.y+fX.y)*kE;iu=1/(3*iu);var lo=iu;eY.localCOMx*=lo;eY.localCOMy*=lo}}}if(gz.wrap_localCOM!=null){gz.wrap_localCOM.zpp_inner.x=gz.localCOMx;gz.wrap_localCOM.zpp_inner.y=gz.localCOMy}}var eW=gz.body;if(eW.zip_axis){eW.zip_axis=false;eW.axisx=Math.sin(eW.rot);eW.axisy=Math.cos(eW.rot)}gz.worldCOMx=gz.body.posx+(gz.body.axisy*gz.localCOMx-gz.body.axisx*gz.localCOMy);gz.worldCOMy=gz.body.posy+(gz.localCOMx*gz.body.axisx+gz.localCOMy*gz.body.axisy)}}var lZ=hu.polygon.area;var lc=hu.polygon.worldCOMx;var lb=hu.polygon.worldCOMy;ke.overlap=lZ;ke.centroidx=lc;ke.centroidy=lb;return true}else{if(fb){gW=true;var f9=hu.polygon.edges.head;while(f9!=null){var jp=f9.elt;var hm=1e+100;var kF=0;var f7=hw.polygon.gverts.next;while(f7!=null){var gj=f7;var jJ=jp.gnormx*gj.x+jp.gnormy*gj.y;if(jJ<hm){hm=jJ}if(jJ>=jp.gprojection+P.epsilon){hR[kF]=true;gW=false}++kF;f7=f7.next}hm-=jp.gprojection;if(hm>0){fb=false;break}f9=f9.next}if(gW){var eU=hw.polygon;if(eU.zip_worldCOM){if(eU.body!=null){eU.zip_worldCOM=false;if(eU.zip_localCOM){eU.zip_localCOM=false;if(eU.type==1){var eT=eU.polygon;if(eT.lverts.next.next==null){eT.localCOMx=eT.lverts.next.x;eT.localCOMy=eT.lverts.next.y}else{if(eT.lverts.next.next.next==null){eT.localCOMx=eT.lverts.next.x;eT.localCOMy=eT.lverts.next.y;eT.localCOMx+=eT.lverts.next.next.x;eT.localCOMy+=eT.lverts.next.next.y;eT.localCOMx*=0.5;eT.localCOMy*=0.5}else{eT.localCOMx=0;eT.localCOMy=0;var lX=0;var f6=eT.lverts.next;var gM=f6;f6=f6.next;var gh=f6;f6=f6.next;while(f6!=null){var fV=f6;lX+=gh.x*(fV.y-gM.y);var kC=fV.y*gh.x-fV.x*gh.y;eT.localCOMx+=(gh.x+fV.x)*kC;eT.localCOMy+=(gh.y+fV.y)*kC;gM=gh;gh=fV;f6=f6.next}f6=eT.lverts.next;var fT=f6;lX+=gh.x*(fT.y-gM.y);var kA=fT.y*gh.x-fT.x*gh.y;eT.localCOMx+=(gh.x+fT.x)*kA;eT.localCOMy+=(gh.y+fT.y)*kA;gM=gh;f6=f6.next;var fR=f6;lX+=fT.x*(fR.y-gM.y);var ky=fR.y*fT.x-fR.x*fT.y;eT.localCOMx+=(fT.x+fR.x)*ky;eT.localCOMy+=(fT.y+fR.y)*ky;lX=1/(3*lX);var g6=lX;eT.localCOMx*=g6;eT.localCOMy*=g6}}}if(eU.wrap_localCOM!=null){eU.wrap_localCOM.zpp_inner.x=eU.localCOMx;eU.wrap_localCOM.zpp_inner.y=eU.localCOMy}}var eS=eU.body;if(eS.zip_axis){eS.zip_axis=false;eS.axisx=Math.sin(eS.rot);eS.axisy=Math.cos(eS.rot)}eU.worldCOMx=eU.body.posx+(eU.body.axisy*eU.localCOMx-eU.body.axisx*eU.localCOMy);eU.worldCOMy=eU.body.posy+(eU.localCOMx*eU.body.axisx+eU.localCOMy*eU.body.axisy)}}var lW=hw.polygon.area;var eO=hw.polygon.worldCOMx;var ee=hw.polygon.worldCOMy;ke.overlap=lW;ke.centroidx=eO;ke.centroidy=ee;return true}else{if(fb){while(b7.flowpoly.head!=null){var lv=b7.flowpoly.pop_unsafe();if(!lv._inuse){if(lv.outer!=null){lv.outer.zpp_inner=null;lv.outer=null}lv._isimmutable=null;lv._validate=null;lv._invalidate=null;lv.next=bB.zpp_pool;bB.zpp_pool=lv}}var i0=null;var jY=false;var gO=hw.polygon.gverts.next;var l3=0;var gN=hu.polygon.gverts.next;var kD=0;var kj=0;var ez=hu.polygon.edgeCnt;while(kj<ez){var lA=kj++;if(!hO[lA]){kD=lA;break}else{gN=gN.next}}if(gN==null){gN=hu.polygon.gverts.next;jY=true;var el=0;var kh=hw.polygon.edgeCnt;while(el<kh){var j6=el++;if(!hR[j6]){l3=j6;break}else{gO=gO.next}}if(gO==null){gO=hw.polygon.gverts.next}else{b7.flowpoly.add(gO);i0=b7.flowpoly.head.elt}}else{b7.flowpoly.add(gN);i0=b7.flowpoly.head.elt}var ik=1;if(b7.flowpoly.head==null){var eq=true;var fj=hw.polygon.gverts.next;var gL=fj;var fg=fj.next;while(fg!=null){var gg=fg;var hl=2;var km=hu.polygon.gverts.next;var lI=km;var ka=km.next;while(ka!=null){var lG=ka;var g4=0;var gm=0;var gk=0;gm=gL.x-lI.x;gk=gL.y-lI.y;var eN=0;var eK=0;eN=gg.x-gL.x;eK=gg.y-gL.y;var g7=0;var g5=0;g7=lG.x-lI.x;g5=lG.y-lI.y;var iJ=eK*g7-eN*g5;var fH;if(iJ*iJ>P.epsilon*P.epsilon){iJ=1/iJ;var j0=(g5*gm-g7*gk)*iJ;if(j0>P.epsilon&&j0<1-P.epsilon){var l5=(eK*gm-eN*gk)*iJ;if(l5>P.epsilon&&l5<1-P.epsilon){g4=j0;fH=true}else{fH=false}}else{fH=false}}else{fH=false}if(fH){if(g4<hl){hl=g4;gN=km}}km=ka;lI=lG;ka=ka.next}while(true){ka=hu.polygon.gverts.next;var ms=ka;var g3=0;var fL=0;var e7=0;fL=gL.x-lI.x;e7=gL.y-lI.y;var ie=0;var hS=0;ie=gg.x-gL.x;hS=gg.y-gL.y;var jQ=0;var jx=0;jQ=ms.x-lI.x;jx=ms.y-lI.y;var lr=hS*jQ-ie*jx;var hz;if(lr*lr>P.epsilon*P.epsilon){lr=1/lr;var gw=(jx*fL-jQ*e7)*lr;if(gw>P.epsilon&&gw<1-P.epsilon){var ey=(hS*fL-ie*e7)*lr;if(ey>P.epsilon&&ey<1-P.epsilon){g3=gw;hz=true}else{hz=false}}else{hz=false}}else{hz=false}if(hz){if(g3<hl){hl=g3;gN=km}}break}if(hl!=2){var eL=0;var ec=0;var lP=hl;eL=gL.x+(gg.x-gL.x)*lP;ec=gL.y+(gg.y-gL.y)*lP;var md;if(bB.zpp_pool==null){md=new bB()}else{md=bB.zpp_pool;bB.zpp_pool=md.next;md.next=null}md.weak=false;md._immutable=false;md.x=eL;md.y=ec;i0=md;b7.flowpoly.add(i0);jY=true;gO=fj;eq=false;break}fj=fg;gL=gg;fg=fg.next}if(eq){while(true){fg=hw.polygon.gverts.next;var gf=fg;var hj=2;var kk=hu.polygon.gverts.next;var en=kk;var j8=kk.next;while(j8!=null){var mr=j8;var g2=0;var fJ=0;var e6=0;fJ=gL.x-en.x;e6=gL.y-en.y;var ib=0;var hP=0;ib=gf.x-gL.x;hP=gf.y-gL.y;var jO=0;var jw=0;jO=mr.x-en.x;jw=mr.y-en.y;var lp=hP*jO-ib*jw;var hy;if(lp*lp>P.epsilon*P.epsilon){lp=1/lp;var gu=(jw*fJ-jO*e6)*lp;if(gu>P.epsilon&&gu<1-P.epsilon){var ew=(hP*fJ-ib*e6)*lp;if(ew>P.epsilon&&ew<1-P.epsilon){g2=gu;hy=true}else{hy=false}}else{hy=false}}else{hy=false}if(hy){if(g2<hj){hj=g2;gN=kk}}kk=j8;en=mr;j8=j8.next}while(true){j8=hu.polygon.gverts.next;var mq=j8;var g1=0;var fG=0;var e5=0;fG=gL.x-en.x;e5=gL.y-en.y;var h8=0;var hM=0;h8=gf.x-gL.x;hM=gf.y-gL.y;var jM=0;var jv=0;jM=mq.x-en.x;jv=mq.y-en.y;var ln=hM*jM-h8*jv;var hx;if(ln*ln>P.epsilon*P.epsilon){ln=1/ln;var gs=(jv*fG-jM*e5)*ln;if(gs>P.epsilon&&gs<1-P.epsilon){var ev=(hM*fG-h8*e5)*ln;if(ev>P.epsilon&&ev<1-P.epsilon){g1=gs;hx=true}else{hx=false}}else{hx=false}}else{hx=false}if(hx){if(g1<hj){hj=g1;gN=kk}}break}if(hj!=2){var eH=0;var eb=0;var jd=hj;eH=gL.x+(gf.x-gL.x)*jd;eb=gL.y+(gf.y-gL.y)*jd;var k8;if(bB.zpp_pool==null){k8=new bB()}else{k8=bB.zpp_pool;bB.zpp_pool=k8.next;k8.next=null}k8.weak=false;k8._immutable=false;k8.x=eH;k8.y=eb;i0=k8;b7.flowpoly.add(i0);jY=true;gO=fj;break}break}}ik=2}while(true){if(jY){gO=gO.next;++l3;if(gO==null){gO=hw.polygon.gverts.next;l3=0}if(!hR[l3]){var kt=gO;var hv;if(i0!=null){var jo=kt.x;var ma=kt.y;var lK=i0.x;var lJ=i0.y;var kU=0;var kS=0;kU=jo-lK;kS=ma-lJ;hv=kU*kU+kS*kS<P.epsilon}else{hv=false}if(hv){break}b7.flowpoly.add(kt);if(i0==null){i0=b7.flowpoly.head.elt}ik=1}else{var em=b7.flowpoly.head.elt;var mp=gO;var gK=gN;var jI=gN.next;if(jI==null){jI=hu.polygon.gverts.next}var ih=-1;var kY=null;var j7=0;var e2=0;var mc=jI;var f5=jI;while(true){var ge=f5;var g0=0;var fE=0;var e4=0;fE=gK.x-em.x;e4=gK.y-em.y;var h6=0;var hK=0;h6=ge.x-gK.x;hK=ge.y-gK.y;var jK=0;var ju=0;jK=mp.x-em.x;ju=mp.y-em.y;var ll=hK*jK-h6*ju;var ht;if(ll*ll>P.epsilon*P.epsilon){ll=1/ll;var gr=(ju*fE-jK*e4)*ll;if(gr>P.epsilon&&gr<1-P.epsilon){var eu=(hK*fE-h6*e4)*ll;if(eu>P.epsilon&&eu<1-P.epsilon){g0=gr;ht=true}else{ht=false}}else{ht=false}}else{ht=false}if(ht){if(g0>=-1){kY=gN;j7=kD;e2=1;if(1==ik){ih=g0;f5=mc;break}else{ih=g0}}}gK=ge;gN=f5;++kD;if(kD>=hu.polygon.edgeCnt){kD=0}f5=f5.next;if(f5==null){f5=hu.polygon.gverts.next}break}while(f5!=mc){var gc=f5;var gZ=0;var fC=0;var e3=0;fC=gK.x-em.x;e3=gK.y-em.y;var h4=0;var hI=0;h4=gc.x-gK.x;hI=gc.y-gK.y;var jG=0;var jt=0;jG=mp.x-em.x;jt=mp.y-em.y;var lh=hI*jG-h4*jt;var hs;if(lh*lh>P.epsilon*P.epsilon){lh=1/lh;var gq=(jt*fC-jG*e3)*lh;if(gq>P.epsilon&&gq<1-P.epsilon){var et=(hI*fC-h4*e3)*lh;if(et>P.epsilon&&et<1-P.epsilon){gZ=gq;hs=true}else{hs=false}}else{hs=false}}else{hs=false}if(hs){if(gZ>=ih){kY=gN;j7=kD;if(++e2==ik){ih=gZ;break}else{ih=gZ}}}gK=gc;gN=f5;++kD;if(kD>=hu.polygon.edgeCnt){kD=0}f5=f5.next;if(f5==null){f5=hu.polygon.gverts.next}}if(kY==null){break}var gJ=kY;var lQ=kY.next;if(lQ==null){lQ=hu.polygon.gverts.next}var ga=lQ;var eG=0;var ea=0;var ja=ih;eG=gJ.x+(ga.x-gJ.x)*ja;ea=gJ.y+(ga.y-gJ.y)*ja;var hr;if(i0!=null){var hE=i0.x;var hf=i0.y;var kR=0;var kr=0;kR=eG-hE;kr=ea-hf;hr=kR*kR+kr*kr<P.epsilon}else{hr=false}if(hr){break}var k7;if(bB.zpp_pool==null){k7=new bB()}else{k7=bB.zpp_pool;bB.zpp_pool=k7.next;k7.next=null}k7.weak=false;k7._immutable=false;k7.x=eG;k7.y=ea;b7.flowpoly.add(k7);if(i0==null){i0=b7.flowpoly.head.elt}gN=kY;kD=j7;jY=!jY;ik=2}}else{gN=gN.next;++kD;if(gN==null){gN=hu.polygon.gverts.next;kD=0}if(!hO[kD]){var i9=gN;var hq;if(i0!=null){var jm=i9.x;var iY=i9.y;var hD=i0.x;var hd=i0.y;var kQ=0;var kq=0;kQ=jm-hD;kq=iY-hd;hq=kQ*kQ+kq*kq<P.epsilon}else{hq=false}if(hq){break}b7.flowpoly.add(i9);if(i0==null){i0=b7.flowpoly.head.elt}ik=1}else{var ek=b7.flowpoly.head.elt;var mo=gN;var gI=gO;var lS=gO.next;if(lS==null){lS=hw.polygon.gverts.next}var lN=-1;var fc=null;var iz=0;var l9=0;var la=lS;var f4=lS;while(true){var f8=f4;var gV=0;var fA=0;var e1=0;fA=gI.x-ek.x;e1=gI.y-ek.y;var h2=0;var hG=0;h2=f8.x-gI.x;hG=f8.y-gI.y;var jE=0;var jr=0;jE=mo.x-ek.x;jr=mo.y-ek.y;var le=hG*jE-h2*jr;var hp;if(le*le>P.epsilon*P.epsilon){le=1/le;var gp=(jr*fA-jE*e1)*le;if(gp>P.epsilon&&gp<1-P.epsilon){var es=(hG*fA-h2*e1)*le;if(es>P.epsilon&&es<1-P.epsilon){gV=gp;hp=true}else{hp=false}}else{hp=false}}else{hp=false}if(hp){if(gV>=-1){fc=gO;iz=l3;l9=1;if(1==ik){lN=gV;f4=la;break}else{lN=gV}}}gI=f8;gO=f4;++l3;if(l3>=hw.polygon.edgeCnt){l3=0}f4=f4.next;if(f4==null){f4=hw.polygon.gverts.next}break}while(f4!=la){var fM=f4;var gT=0;var fy=0;var e0=0;fy=gI.x-ek.x;e0=gI.y-ek.y;var h0=0;var hF=0;h0=fM.x-gI.x;hF=fM.y-gI.y;var jC=0;var jq=0;jC=mo.x-ek.x;jq=mo.y-ek.y;var ld=hF*jC-h0*jq;var mk;if(ld*ld>P.epsilon*P.epsilon){ld=1/ld;var go=(jq*fy-jC*e0)*ld;if(go>P.epsilon&&go<1-P.epsilon){var ep=(hF*fy-h0*e0)*ld;if(ep>P.epsilon&&ep<1-P.epsilon){gT=go;mk=true}else{mk=false}}else{mk=false}}else{mk=false}if(mk){if(gT>=lN){fc=gO;iz=l3;if(++l9==ik){lN=gT;break}else{lN=gT}}}gI=fM;gO=f4;++l3;if(l3>=hw.polygon.edgeCnt){l3=0}f4=f4.next;if(f4==null){f4=hw.polygon.gverts.next}}if(fc==null){break}var gH=fc;var jc=fc.next;if(jc==null){jc=hw.polygon.gverts.next}var fK=jc;var eF=0;var my=0;var i8=lN;eF=gH.x+(fK.x-gH.x)*i8;my=gH.y+(fK.y-gH.y)*i8;var mj;if(i0!=null){var hC=i0.x;var hb=i0.y;var kP=0;var kp=0;kP=eF-hC;kp=my-hb;mj=kP*kP+kp*kp<P.epsilon}else{mj=false}if(mj){break}var k6;if(bB.zpp_pool==null){k6=new bB()}else{k6=bB.zpp_pool;bB.zpp_pool=k6.next;k6.next=null}k6.weak=false;k6._immutable=false;k6.x=eF;k6.y=my;b7.flowpoly.add(k6);if(i0==null){i0=b7.flowpoly.head.elt}gO=fc;l3=iz;jY=!jY;ik=2}}}if(b7.flowpoly.head!=null&&b7.flowpoly.head.next!=null&&b7.flowpoly.head.next.next!=null){var lV=0;var iB=0;var iA=0;iB=0;iA=0;lV=0;var f3=b7.flowpoly.head;var gG=f3.elt;f3=f3.next;var fI=f3.elt;f3=f3.next;while(f3!=null){var fQ=f3.elt;lV+=fI.x*(fQ.y-gG.y);var kx=fQ.y*fI.x-fQ.x*fI.y;iB+=(fI.x+fQ.x)*kx;iA+=(fI.y+fQ.y)*kx;gG=fI;fI=fQ;f3=f3.next}f3=b7.flowpoly.head;var fP=f3.elt;lV+=fI.x*(fP.y-gG.y);var kw=fP.y*fI.x-fP.x*fI.y;iB+=(fI.x+fP.x)*kw;iA+=(fI.y+fP.y)*kw;gG=fI;f3=f3.next;var fO=f3.elt;lV+=fP.x*(fO.y-gG.y);var kv=fO.y*fP.x-fO.x*fP.y;iB+=(fP.x+fO.x)*kv;iA+=(fP.y+fO.y)*kv;lV*=0.5;var jU=1/(6*lV);iB*=jU;iA*=jU;ke.overlap=-lV;ke.centroidx=iB;ke.centroidy=iA;return true}else{return false}}else{return false}}}else{return false}}}else{var eZ=[];var jX=true;var eo=null;var fq=null;var lL=-1e+100;var gY=true;var iv=hu.polygon.gverts.next;var kB=0;var f1=hu.polygon.edges.head;while(f1!=null){var ej=f1.elt;var jn=ej.gnormx*hw.circle.worldCOMx+ej.gnormy*hw.circle.worldCOMy;if(jn>ej.gprojection+hw.circle.radius){gY=false;break}else{if(jn+hw.circle.radius>ej.gprojection+P.epsilon){jX=false;eZ[kB]=true}}jn-=ej.gprojection+hw.circle.radius;if(jn>lL){lL=jn;eo=ej;fq=iv}iv=iv.next;++kB;f1=f1.next}if(gY){if(jX){var lU=hw.circle.area;var eE=hw.circle.worldCOMx;var mx=hw.circle.worldCOMy;ke.overlap=lU;ke.centroidx=eE;ke.centroidy=mx;return true}else{var gn=fq;var fF=fq.next==null?hu.polygon.gverts.next:fq.next;var kW=hw.circle.worldCOMy*eo.gnormx-hw.circle.worldCOMx*eo.gnormy;var mi;if(kW<=gn.y*eo.gnormx-gn.x*eo.gnormy){var j1=hw.circle.radius;var hV=0;var hU=0;hV=gn.x-hw.circle.worldCOMx;hU=gn.y-hw.circle.worldCOMy;mi=hV*hV+hU*hU<=j1*j1}else{if(kW>=fF.y*eo.gnormx-fF.x*eo.gnormy){var kd=hw.circle.radius;var ks=0;var kc=0;ks=fF.x-hw.circle.worldCOMx;kc=fF.y-hw.circle.worldCOMy;mi=ks*ks+kc*kc<=kd*kd}else{mi=true}}if(mi){var lk=[];var kz=0;var jV=true;var li=null;var jW=0;var ei=hu.polygon.gverts.next;while(ei!=null){var fD=ei;var jl=fD.x;var iW=fD.y;var hB=hw.circle.worldCOMx;var ha=hw.circle.worldCOMy;var kN=0;var ko=0;kN=jl-hB;ko=iW-ha;if(!(lk[kz]=kN*kN+ko*ko<=hw.circle.radius*hw.circle.radius)){jV=false}else{jW=kz;li=ei}++kz;ei=ei.next}if(jV){var eR=hu.polygon;if(eR.zip_worldCOM){if(eR.body!=null){eR.zip_worldCOM=false;if(eR.zip_localCOM){eR.zip_localCOM=false;if(eR.type==1){var eQ=eR.polygon;if(eQ.lverts.next.next==null){eQ.localCOMx=eQ.lverts.next.x;eQ.localCOMy=eQ.lverts.next.y}else{if(eQ.lverts.next.next.next==null){eQ.localCOMx=eQ.lverts.next.x;eQ.localCOMy=eQ.lverts.next.y;eQ.localCOMx+=eQ.lverts.next.next.x;eQ.localCOMy+=eQ.lverts.next.next.y;eQ.localCOMx*=0.5;eQ.localCOMy*=0.5}else{eQ.localCOMx=0;eQ.localCOMy=0;var lT=0;var eh=eQ.lverts.next;var gE=eh;eh=eh.next;var fB=eh;eh=eh.next;while(eh!=null){var fN=eh;lT+=fB.x*(fN.y-gE.y);var ku=fN.y*fB.x-fN.x*fB.y;eQ.localCOMx+=(fB.x+fN.x)*ku;eQ.localCOMy+=(fB.y+fN.y)*ku;gE=fB;fB=fN;eh=eh.next}eh=eQ.lverts.next;var ly=eh;lT+=fB.x*(ly.y-gE.y);var l4=ly.y*fB.x-ly.x*fB.y;eQ.localCOMx+=(fB.x+ly.x)*l4;eQ.localCOMy+=(fB.y+ly.y)*l4;gE=fB;eh=eh.next;var lx=eh;lT+=ly.x*(lx.y-gE.y);var l2=lx.y*ly.x-lx.x*ly.y;eQ.localCOMx+=(ly.x+lx.x)*l2;eQ.localCOMy+=(ly.y+lx.y)*l2;lT=1/(3*lT);var jR=lT;eQ.localCOMx*=jR;eQ.localCOMy*=jR}}}if(eR.wrap_localCOM!=null){eR.wrap_localCOM.zpp_inner.x=eR.localCOMx;eR.wrap_localCOM.zpp_inner.y=eR.localCOMy}}var eP=eR.body;if(eP.zip_axis){eP.zip_axis=false;eP.axisx=Math.sin(eP.rot);eP.axisy=Math.cos(eP.rot)}eR.worldCOMx=eR.body.posx+(eR.body.axisy*eR.localCOMx-eR.body.axisx*eR.localCOMy);eR.worldCOMy=eR.body.posy+(eR.localCOMx*eR.body.axisx+eR.localCOMy*eR.body.axisy)}}var lR=hu.polygon.area;var eD=hu.polygon.worldCOMx;var mw=hu.polygon.worldCOMy;ke.overlap=lR;ke.centroidx=eD;ke.centroidy=mw;return true}else{while(b7.flowpoly.head!=null){var iC=b7.flowpoly.pop_unsafe();if(!iC._inuse){if(iC.outer!=null){iC.outer.zpp_inner=null;iC.outer=null}iC._isimmutable=null;iC._validate=null;iC._invalidate=null;iC.next=bB.zpp_pool;bB.zpp_pool=iC}}b7.flowsegs.clear();var iD=null;var f2=1;if(li==null){li=hu.polygon.gverts.next;f2=2}else{iD=li;b7.flowpoly.add(iD)}while(f2!=0){if(f2==1){li=li.next;if(li==null){li=hu.polygon.gverts.next}++jW;if(jW>=hu.polygon.edgeCnt){jW=0}if(lk[jW]){var jk=iD.x;var iU=iD.y;var hA=li.x;var g9=li.y;var kL=0;var kn=0;kL=jk-hA;kn=iU-g9;if(kL*kL+kn*kn<P.epsilon){break}b7.flowpoly.add(li)}else{var gC=b7.flowpoly.head.elt;var fz=li;var fa=0;var e9=0;fa=fz.x-gC.x;e9=fz.y-gC.y;var ho=0;var hn=0;ho=gC.x-hw.circle.worldCOMx;hn=gC.y-hw.circle.worldCOMy;var l8=fa*fa+e9*e9;var l7=2*(ho*fa+hn*e9);var l6=Math.sqrt(l7*l7-4*l8*(ho*ho+hn*hn-hw.circle.radius*hw.circle.radius));l8=1/(2*l8);var jP=(-l7-l6)*l8;var jg=jP<P.epsilon?(-l7+l6)*l8:jP;var eC=0;var mv=0;var i7=jg;eC=gC.x+(fz.x-gC.x)*i7;mv=gC.y+(fz.y-gC.y)*i7;var ji=iD.x;var iT=iD.y;var kK=0;var kl=0;kK=ji-eC;kl=iT-mv;if(kK*kK+kl*kl<P.epsilon){break}var k5;if(bB.zpp_pool==null){k5=new bB()}else{k5=bB.zpp_pool;bB.zpp_pool=k5.next;k5.next=null}k5.weak=false;k5._immutable=false;k5.x=eC;k5.y=mv;b7.flowpoly.add(k5);f2=2}}else{if(f2==2){var lf=li.next;if(lf==null){lf=hu.polygon.gverts.next}var il=li;f2=0;var k9=lf;var eg=lf;while(true){var fx=eg;var jS=jW+1;if(jS==hu.polygon.edgeCnt){jS=0}if(eZ[jW]){if(lk[jS]){var gX=0;var gF=0;gX=fx.x-il.x;gF=fx.y-il.y;var iQ=0;var iI=0;iQ=il.x-hw.circle.worldCOMx;iI=il.y-hw.circle.worldCOMy;var hN=gX*gX+gF*gF;var hk=2*(iQ*gX+iI*gF);var gy=Math.sqrt(hk*hk-4*hN*(iQ*iQ+iI*iI-hw.circle.radius*hw.circle.radius));hN=1/(2*hN);var jN=(-hk-gy)*hN;var kO=jN<P.epsilon?(-hk+gy)*hN:jN;var eB=0;var mu=0;var i6=kO;eB=il.x+(fx.x-il.x)*i6;mu=il.y+(fx.y-il.y)*i6;var jf=iD.x;var iS=iD.y;var kJ=0;var ki=0;kJ=jf-eB;ki=iS-mu;if(kJ*kJ+ki*ki<P.epsilon){f2=0;eg=k9;break}var k4;if(bB.zpp_pool==null){k4=new bB()}else{k4=bB.zpp_pool;bB.zpp_pool=k4.next;k4.next=null}k4.weak=false;k4._immutable=false;k4.x=eB;k4.y=mu;var lt=k4;b7.flowsegs.add(b7.flowpoly.head.elt);b7.flowsegs.add(lt);b7.flowpoly.add(lt);f2=1;eg=k9;break}else{var g8=0;var jL=0;var gU=0;var gD=0;gU=fx.x-il.x;gD=fx.y-il.y;var iO=0;var iH=0;iO=il.x-hw.circle.worldCOMx;iH=il.y-hw.circle.worldCOMy;var hL=gU*gU+gD*gD;var hi=2*(iO*gU+iH*gD);var gx=hi*hi-4*hL*(iO*iO+iH*iH-hw.circle.radius*hw.circle.radius);var j9;if(gx*gx<P.epsilon){if(gx<0){g8=10}else{jL=-hi/(2*hL);g8=jL}j9=false}else{gx=Math.sqrt(gx);hL=1/(2*hL);g8=(-hi-gx)*hL;jL=(-hi+gx)*hL;j9=true}if(g8<1-P.epsilon&&jL>P.epsilon){var ig=0;var fv=0;var i5=g8;ig=il.x+(fx.x-il.x)*i5;fv=il.y+(fx.y-il.y)*i5;var mh;if(iD!=null){var je=iD.x;var iP=iD.y;var kI=0;var kg=0;kI=je-ig;kg=iP-fv;mh=kI*kI+kg*kg<P.epsilon}else{mh=false}if(mh){f2=0;eg=k9;break}var k3;if(bB.zpp_pool==null){k3=new bB()}else{k3=bB.zpp_pool;bB.zpp_pool=k3.next;k3.next=null}k3.weak=false;k3._immutable=false;k3.x=ig;k3.y=fv;var ip=k3;if(b7.flowpoly.head!=null){b7.flowsegs.add(b7.flowpoly.head.elt);b7.flowsegs.add(ip)}b7.flowpoly.add(ip);if(iD==null){iD=b7.flowpoly.head.elt}if(j9){var ic=0;var ft=0;var i4=jL;ic=il.x+(fx.x-il.x)*i4;ft=il.y+(fx.y-il.y)*i4;var k2;if(bB.zpp_pool==null){k2=new bB()}else{k2=bB.zpp_pool;bB.zpp_pool=k2.next;k2.next=null}k2.weak=false;k2._immutable=false;k2.x=ic;k2.y=ft;b7.flowpoly.add(k2)}}}}il=fx;li=eg;jW=jS;eg=eg.next;if(eg==null){eg=hu.polygon.gverts.next}break}while(eg!=k9){var fw=eg;var ix=jW+1;if(ix==hu.polygon.edgeCnt){ix=0}if(eZ[jW]){if(lk[ix]){var gS=0;var gB=0;gS=fw.x-il.x;gB=fw.y-il.y;var iM=0;var iG=0;iM=il.x-hw.circle.worldCOMx;iG=il.y-hw.circle.worldCOMy;var hJ=gS*gS+gB*gB;var hh=2*(iM*gS+iG*gB);var gv=Math.sqrt(hh*hh-4*hJ*(iM*iM+iG*iG-hw.circle.radius*hw.circle.radius));hJ=1/(2*hJ);var jH=(-hh-gv)*hJ;var kM=jH<P.epsilon?(-hh+gv)*hJ:jH;var h9=0;var fs=0;var i3=kM;h9=il.x+(fw.x-il.x)*i3;fs=il.y+(fw.y-il.y)*i3;var jb=iD.x;var iN=iD.y;var kH=0;var kf=0;kH=jb-h9;kf=iN-fs;if(kH*kH+kf*kf<P.epsilon){f2=0;break}var k0;if(bB.zpp_pool==null){k0=new bB()}else{k0=bB.zpp_pool;bB.zpp_pool=k0.next;k0.next=null}k0.weak=false;k0._immutable=false;k0.x=h9;k0.y=fs;var io=k0;b7.flowsegs.add(b7.flowpoly.head.elt);b7.flowsegs.add(io);b7.flowpoly.add(io);f2=1;break}else{var j2=0;var jF=0;var gR=0;var gA=0;gR=fw.x-il.x;gA=fw.y-il.y;var iK=0;var iF=0;iK=il.x-hw.circle.worldCOMx;iF=il.y-hw.circle.worldCOMy;var hH=gR*gR+gA*gA;var hg=2*(iK*gR+iF*gA);var gt=hg*hg-4*hH*(iK*iK+iF*iF-hw.circle.radius*hw.circle.radius);var kT;if(gt*gt<P.epsilon){if(gt<0){j2=10}else{jF=-hg/(2*hH);j2=jF}kT=false}else{gt=Math.sqrt(gt);hH=1/(2*hH);j2=(-hg-gt)*hH;jF=(-hg+gt)*hH;kT=true}if(j2<1-P.epsilon&&jF>P.epsilon){var h7=0;var fr=0;var i2=j2;h7=il.x+(fw.x-il.x)*i2;fr=il.y+(fw.y-il.y)*i2;var mg;if(iD!=null){var eA=iD.x;var iL=iD.y;var iX=0;var he=0;iX=eA-h7;he=iL-fr;mg=iX*iX+he*he<P.epsilon}else{mg=false}if(mg){f2=0;break}var kZ;if(bB.zpp_pool==null){kZ=new bB()}else{kZ=bB.zpp_pool;bB.zpp_pool=kZ.next;kZ.next=null}kZ.weak=false;kZ._immutable=false;kZ.x=h7;kZ.y=fr;var im=kZ;if(b7.flowpoly.head!=null){b7.flowsegs.add(b7.flowpoly.head.elt);b7.flowsegs.add(im)}b7.flowpoly.add(im);if(iD==null){iD=b7.flowpoly.head.elt}if(kT){var h5=0;var fp=0;var kb=jF;h5=il.x+(fw.x-il.x)*kb;fp=il.y+(fw.y-il.y)*kb;var kV;if(bB.zpp_pool==null){kV=new bB()}else{kV=bB.zpp_pool;bB.zpp_pool=kV.next;kV.next=null}kV.weak=false;kV._immutable=false;kV.x=h5;kV.y=fp;b7.flowpoly.add(kV)}}}}il=fw;li=eg;jW=ix;eg=eg.next;if(eg==null){eg=hu.polygon.gverts.next}}}}}if(b7.flowpoly.head==null){return false}else{if(b7.flowpoly.head.next==null){var mn=true;var ef=hu.polygon.edges.head;while(ef!=null){var lD=ef.elt;if(lD.gnormx*hw.circle.worldCOMx+lD.gnormy*hw.circle.worldCOMy>lD.gprojection){mn=false;break}ef=ef.next}if(mn){var lO=hw.circle.area;var h3=hw.circle.worldCOMx;var fo=hw.circle.worldCOMy;ke.overlap=lO;ke.centroidx=h3;ke.centroidy=fo;return true}else{return false}}else{var jj=0;var iR=0;var lM=0;if(b7.flowpoly.head.next.next!=null){var jZ=0;var j4=0;var j3=0;j4=0;j3=0;jZ=0;var ed=b7.flowpoly.head;var ij=ed.elt;ed=ed.next;var fu=ed.elt;ed=ed.next;while(ed!=null){var lw=ed.elt;jZ+=fu.x*(lw.y-ij.y);var l1=lw.y*fu.x-lw.x*fu.y;j4+=(fu.x+lw.x)*l1;j3+=(fu.y+lw.y)*l1;ij=fu;fu=lw;ed=ed.next}ed=b7.flowpoly.head;var lu=ed.elt;jZ+=fu.x*(lu.y-ij.y);var l0=lu.y*fu.x-lu.x*fu.y;j4+=(fu.x+lu.x)*l0;j3+=(fu.y+lu.y)*l0;ij=fu;ed=ed.next;var ls=ed.elt;jZ+=lu.x*(ls.y-ij.y);var lY=ls.y*lu.x-ls.x*lu.y;j4+=(lu.x+ls.x)*lY;j3+=(lu.y+ls.y)*lY;jZ*=0.5;var iE=1/(6*jZ);j4*=iE;j3*=iE;var jD=-jZ;jj+=j4*jD;iR+=j3*jD;lM=0-jZ}else{b7.flowsegs.add(b7.flowpoly.head.elt);b7.flowsegs.add(b7.flowpoly.head.next.elt)}while(b7.flowsegs.head!=null){var ii=b7.flowsegs.pop_unsafe();var e8=b7.flowsegs.pop_unsafe();var iV=0;var hc=0;iV=e8.x-ii.x;hc=e8.y-ii.y;var iy=0;var iw=0;iy=iV;iw=hc;var fd=1/Math.sqrt(iy*iy+iw*iw);iy*=fd;iw*=fd;var jB=iy;iy=-iw;iw=jB;var h1=0;var fn=0;h1=ii.x+e8.x;fn=ii.y+e8.y;h1*=0.5;fn*=0.5;h1-=hw.circle.worldCOMx;fn-=hw.circle.worldCOMy;var er=iy*h1+iw*fn;var jh=0;var fe=0;var hW=er/hw.circle.radius;var iZ=Math.sqrt(1-hW*hW);var gi=Math.acos(hW);jh=hw.circle.radius*(hw.circle.radius*gi-er*iZ);fe=0.6666666666666666*hw.circle.radius*iZ*iZ*iZ/(gi-hW*iZ);h1=hw.circle.worldCOMx;fn=hw.circle.worldCOMy;var jA=fe;h1+=iy*jA;fn+=iw*jA;var jz=jh;jj+=h1*jz;iR+=fn*jz;lM+=jh}var jy=1/lM;jj*=jy;iR*=jy;ke.overlap=lM;ke.centroidx=jj;ke.centroidy=iR;return true}}}}else{return false}}}else{return false}}}else{var mf=hw.circle;var me=hu.circle;var lH=0;var lF=0;lH=me.worldCOMx-mf.worldCOMx;lF=me.worldCOMy-mf.worldCOMy;var lq=mf.radius+me.radius;var kX=lH*lH+lF*lF;if(kX>lq*lq){return false}else{if(kX<P.epsilon*P.epsilon){if(mf.radius<me.radius){var f0=mf.area;var hZ=mf.worldCOMx;var fm=mf.worldCOMy;ke.overlap=f0;ke.centroidx=hZ;ke.centroidy=fm}else{var fY=me.area;var hY=me.worldCOMx;var fl=me.worldCOMy;ke.overlap=fY;ke.centroidx=hY;ke.centroidy=fl}return true}else{var lE=Math.sqrt(kX);var jT=1/lE;var fi=0.5*(lE-(me.radius*me.radius-mf.radius*mf.radius)*jT);if(fi<=-mf.radius){var fW=mf.area;var hX=mf.worldCOMx;var fk=mf.worldCOMy;ke.overlap=fW;ke.centroidx=hX;ke.centroidy=fk}else{var ff=lE-fi;if(ff<=-me.radius){var fU=me.area;var hT=me.worldCOMx;var eX=me.worldCOMy;ke.overlap=fU;ke.centroidx=hT;ke.centroidy=eX}else{var fS=0;var eM=0;var fh=0;var eJ=0;var mm=fi/mf.radius;var gQ=Math.sqrt(1-mm*mm);var it=Math.acos(mm);fS=mf.radius*(mf.radius*it-fi*gQ);eM=0.6666666666666666*mf.radius*gQ*gQ*gQ/(it-mm*gQ);var ml=ff/me.radius;var gP=Math.sqrt(1-ml*ml);var ir=Math.acos(ml);fh=me.radius*(me.radius*ir-ff*gP);eJ=0.6666666666666666*me.radius*gP*gP*gP/(ir-ml*gP);var iq=fS+fh;var mt=(eM*fS+(lE-eJ)*fh)/iq*jT;var hQ=mf.worldCOMx+lH*mt;var eV=mf.worldCOMy+lF*mt;ke.overlap=iq;ke.centroidx=hQ;ke.centroidy=eV}}return true}}}};b7.prototype.__class__=b7;var an=zpp_nape.geom.ZPP_Convex=function(){};an.__name__=["zpp_nape","geom","ZPP_Convex"];an.isinner=function(eb,ea,eg){var ed=0;var ec=0;ed=eb.x-ea.x;ec=eb.y-ea.y;var ef=0;var ee=0;ef=eg.x-ea.x;ee=eg.y-ea.y;return ee*ed-ef*ec>=0};an.optimise=function(ei){var ep=ei.vertices;var el=ei.vertices;if(ep!=null){var ef=ep;while(true){ef.sort();ef=ef.next;if(!(ef!=el)){break}}}var ej=ei.vertices;var eg=ei.vertices;if(ej!=null){var eq=ej;while(true){var ec=eq;var ed=ec.prev;var ea=null;var ee=ec.diagonals.head;while(ee!=null){var em=ee.elt;if(!an.isinner(ee.next==null?ec.next:ee.next.elt,ec,ed)){ea=ee;ed=em;ee=ee.next;continue}var eb=true;var eh=em.prev;var eo=null;var en=em.diagonals.head;while(en!=null){var ek=en.elt;if(ek==ec){eb=an.isinner(en.next==null?em.next:en.next.elt,em,eh);break}eh=ek;eo=en;en=en.next}if(eb){ee=ec.diagonals.erase(ea);em.diagonals.erase(eo);continue}ed=em;ea=ee;ee=ee.next}eq=eq.next;if(!(eq!=eg)){break}}}};an.prototype.__class__=an;var a4=zpp_nape.geom.ZPP_ConvexRayResult=function(){this.toiDistance=0;this.next=null;this.inner=false;this.ray=null;this.position=null;this.convex=null;this.shape=null;this.normal=null};a4.__name__=["zpp_nape","geom","ZPP_ConvexRayResult"];a4.getRay=function(ef,ee,eb,ea){var ed;if(a4.rayPool==null){a4.internal=true;ed=new df();ed.zpp_inner=new a4();ed.zpp_inner.ray=ed;a4.internal=false}else{ed=a4.rayPool.ray;a4.rayPool=a4.rayPool.next;ed.zpp_inner.next=null}var ec=ed.zpp_inner;ec.normal=ef;ef.zpp_inner._immutable=true;ec.toiDistance=ee;ec.inner=eb;ec.shape=ea;return ed};a4.getConvex=function(ef,ea,ee,ec){var ed;if(a4.convexPool==null){a4.internal=true;ed=new bJ();ed.zpp_inner=new a4();ed.zpp_inner.convex=ed;a4.internal=false}else{ed=a4.convexPool.convex;a4.convexPool=a4.convexPool.next;ed.zpp_inner.next=null}var eb=ed.zpp_inner;eb.normal=ef;eb.position=ea;ef.zpp_inner._immutable=true;ea.zpp_inner._immutable=true;eb.toiDistance=ee;eb.shape=ec;return ed};a4.prototype.normal=null;a4.prototype.shape=null;a4.prototype.convex=null;a4.prototype.position=null;a4.prototype.ray=null;a4.prototype.inner=null;a4.prototype.next=null;a4.prototype.toiDistance=null;a4.prototype.disposed=function(){};a4.prototype.free=function(){this.normal.zpp_inner._immutable=false;var ed=this.normal;var eb=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;if(this.position!=null){this.position.zpp_inner._immutable=false;var ec=this.position;var ea=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}this.shape=null;this.toiDistance=0;if(this.convex!=null){this.next=a4.convexPool;a4.convexPool=this}else{this.next=a4.rayPool;a4.rayPool=this}};a4.prototype.__class__=a4;var E=zpp_nape.geom.ZPP_CutVert=function(){this.used=false;this.rank=0;this.parent=null;this.positive=false;this.value=0;this.vert=null;this.posy=0;this.posx=0;this.next=null;this.prev=null};E.__name__=["zpp_nape","geom","ZPP_CutVert"];E.path=function(eb){var ea;if(E.zpp_pool==null){ea=new E()}else{ea=E.zpp_pool;E.zpp_pool=ea.next;ea.next=null}ea.vert=eb;ea.parent=ea;ea.rank=0;ea.used=false;return ea};E.prototype.prev=null;E.prototype.next=null;E.prototype.posx=null;E.prototype.posy=null;E.prototype.vert=null;E.prototype.value=null;E.prototype.positive=null;E.prototype.parent=null;E.prototype.rank=null;E.prototype.used=null;E.prototype.alloc=function(){};E.prototype.free=function(){this.vert=null;this.parent=null};E.prototype.__class__=E;var c3=zpp_nape.geom.ZPP_CutInt=function(){this.path1=null;this.start=null;this.end=null;this.path0=null;this.vertex=false;this.virtualint=false;this.time=0;this.next=null};c3.__name__=["zpp_nape","geom","ZPP_CutInt"];c3.get=function(ee,ea,eh,eg,ef,ec,ed){if(ed==null){ed=false}if(ec==null){ec=false}var eb;if(c3.zpp_pool==null){eb=new c3()}else{eb=c3.zpp_pool;c3.zpp_pool=eb.next;eb.next=null}eb.virtualint=ec;eb.end=ea;eb.start=eh;eb.path0=eg;eb.path1=ef;eb.time=ee;eb.vertex=ed;return eb};c3.prototype.next=null;c3.prototype.time=null;c3.prototype.virtualint=null;c3.prototype.vertex=null;c3.prototype.path0=null;c3.prototype.end=null;c3.prototype.start=null;c3.prototype.path1=null;c3.prototype.alloc=function(){};c3.prototype.free=function(){this.end=this.start=null;this.path0=this.path1=null};c3.prototype.__class__=c3;var az=zpp_nape.geom.ZPP_Cutter=function(){};az.__name__=["zpp_nape","geom","ZPP_Cutter"];az.run=function(g9,eX,h0,eh,f9,hR){var f7=0;var f6=0;var f5=eX.zpp_inner;if(f5._validate!=null){f5._validate()}f7=eX.zpp_inner.x;var fn=eX.zpp_inner;if(fn._validate!=null){fn._validate()}f6=eX.zpp_inner.y;var f4=0;var f3=0;var fm=h0.zpp_inner;if(fm._validate!=null){fm._validate()}f4=h0.zpp_inner.x-f7;var fl=h0.zpp_inner;if(fl._validate!=null){fl._validate()}f3=h0.zpp_inner.y-f6;var gl=eh?0:-Infinity;var e1=f9?1:Infinity;var el=-(f6*f4-f7*f3);var hM=null;var gt=false;var gi=g9;while(true){var gy;if(E.zpp_pool==null){gy=new E()}else{gy=E.zpp_pool;E.zpp_pool=gy.next;gy.next=null}gy.vert=gi;gy.posx=gy.vert.x;gy.posy=gy.vert.y;gy.value=gy.posy*f4-gy.posx*f3+el;gy.positive=gy.value>0;if(gy.value==0){gt=true}var eY=gy;if(hM==null){hM=eY.prev=eY.next=eY}else{eY.prev=hM;eY.next=hM.next;hM.next.prev=eY;hM.next=eY}hM=eY;gi=gi.next;if(!(gi!=g9)){break}}if(gt){var hb=null;var ho=hM;var hf=hM;if(ho!=null){var gs=ho;while(true){var hi=gs;if(hi.value!=0){hb=hi;break}gs=gs.next;if(!(gs!=hf)){break}}}var g7=0;var g6=0;g7=f4;g6=f3;var eB=1/Math.sqrt(g7*g7+g6*g6);g7*=eB;g6*=eB;var ge=g7;g7=-g6;g6=ge;var fI=null;var hh=hb;while(true){if(hh.value!=0&&(fI==null||hh==fI.next)){fI=hh;hh=hh.next;if(!(hh!=hb)){break}else{continue}}var hX=fI.value*hh.value;if(hX==0){hh=hh.next;if(!(hh!=hb)){break}else{continue}}var gF=fI.next;var em;if(hX>0){em=fI.positive}else{var gB=gF.next;var gU=0;var gP=0;gU=gF.posx+gB.posx;gP=gF.posy+gB.posy;gU*=0.5;gP*=0.5;var gd=gU+g7*1e-8;var gc=gP+g6*1e-8;var fG=false;if(g9!=null){var e7=g9;while(true){var hg=e7;var gh=hg.prev;if((hg.y<gc&&gh.y>=gc||gh.y<gc&&hg.y>=gc)&&(hg.x<=gd||gh.x<=gd)){if(hg.x+(gc-hg.y)/(gh.y-hg.y)*(gh.x-hg.x)<gd){fG=!fG}}e7=e7.next;if(!(e7!=g9)){break}}}em=fG}var gn=hh;if(gF!=null){var e6=gF;while(true){e6.positive=em;e6=e6.next;if(!(e6!=gn)){break}}}fI=hh;hh=hh.next;if(!(hh!=hb)){break}}while(true){if(hh.value!=0&&(fI==null||hh==fI.next)){fI=hh;hh=hh.next;break}var fd=fI.value*hh.value;if(fd==0){hh=hh.next;break}var eb=fI.next;var ef;if(fd>0){ef=fI.positive}else{var hQ=eb.next;var eW=0;var eI=0;eW=eb.posx+hQ.posx;eI=eb.posy+hQ.posy;eW*=0.5;eI*=0.5;var eH=eW+g7*1e-8;var et=eI+g6*1e-8;var g2=false;if(g9!=null){var e4=g9;while(true){var he=e4;var gr=he.prev;if((he.y<et&&gr.y>=et||gr.y<et&&he.y>=et)&&(he.x<=eH||gr.x<=eH)){if(he.x+(et-he.y)/(gr.y-he.y)*(gr.x-he.x)<eH){g2=!g2}}e4=e4.next;if(!(e4!=g9)){break}}}ef=g2}var gm=hh;if(eb!=null){var e3=eb;while(true){e3.positive=ef;e3=e3.next;if(!(e3!=gm)){break}}}fI=hh;hh=hh.next;break}}if(az.ints==null){az.ints=new t()}if(az.paths==null){az.paths=new B()}var fi=null;var eG=hM.posx;var er=hM.posy;var g1;if(dr.zpp_pool==null){g1=new dr()}else{g1=dr.zpp_pool;dr.zpp_pool=g1.next;g1.next=null}g1.forced=false;g1.x=eG;g1.y=er;var fF=g1;if(fi==null){fi=fF.prev=fF.next=fF}else{fF.next=fi;fF.prev=fi.prev;fi.prev.next=fF;fi.prev=fF}var hY=fi;var gZ;if(E.zpp_pool==null){gZ=new E()}else{gZ=E.zpp_pool;E.zpp_pool=gZ.next;gZ.next=null}gZ.vert=fi;gZ.parent=gZ;gZ.rank=0;gZ.used=false;var e2=gZ;az.paths.add(e2);var gq=hM;while(true){var go=gq.next;var eF=go.posx;var ep=go.posy;var gX;if(dr.zpp_pool==null){gX=new dr()}else{gX=dr.zpp_pool;dr.zpp_pool=gX.next;gX.next=null}gX.forced=false;gX.x=eF;gX.y=ep;var gb=gX;if(gq.positive==go.positive){if(fi==null){fi=gb.prev=gb.next=gb}else{gb.next=fi;gb.prev=fi.prev;fi.prev.next=gb;fi.prev=gb}}else{var eR=0;var eP=0;eR=go.posx-gq.posx;eP=go.posy-gq.posy;var fo=f3*eR-f4*eP;fo=1/fo;var hl=0;var hj=0;hl=f7-gq.posx;hj=f6-gq.posy;var gg=(eP*hl-eR*hj)*fo;if(gg<gl||gg>e1){var gT;if(c3.zpp_pool==null){gT=new c3()}else{gT=c3.zpp_pool;c3.zpp_pool=gT.next;gT.next=null}gT.virtualint=true;gT.end=null;gT.start=null;gT.path0=null;gT.path1=null;gT.time=gg;gT.vertex=false;az.ints.add(gT);if(fi==null){fi=gb.prev=gb.next=gb}else{gb.next=fi;gb.prev=fi.prev;fi.prev.next=gb;fi.prev=gb}}else{if(gq.value==0){var eJ=fi.prev;fi=null;var eE=eJ.x;var eo=eJ.y;var gO;if(dr.zpp_pool==null){gO=new dr()}else{gO=dr.zpp_pool;dr.zpp_pool=gO.next;gO.next=null}gO.forced=false;gO.x=eE;gO.y=eo;var fE=gO;if(fi==null){fi=fE.prev=fE.next=fE}else{fE.next=fi;fE.prev=fi.prev;fi.prev.next=fE;fi.prev=fE}if(fi==null){fi=gb.prev=gb.next=gb}else{gb.next=fi;gb.prev=fi.prev;fi.prev.next=gb;fi.prev=gb}var f8=az.paths.head.elt;var gJ;if(E.zpp_pool==null){gJ=new E()}else{gJ=E.zpp_pool;E.zpp_pool=gJ.next;gJ.next=null}gJ.vert=fi;gJ.parent=gJ;gJ.rank=0;gJ.used=false;az.paths.add(gJ);var e0=az.paths.head.elt;var gE;if(c3.zpp_pool==null){gE=new c3()}else{gE=c3.zpp_pool;c3.zpp_pool=gE.next;gE.next=null}gE.virtualint=true;gE.end=eJ;gE.start=fi;gE.path0=f8;gE.path1=e0;gE.time=gg;gE.vertex=false;az.ints.add(gE)}else{if(go.value==0){if(fi==null){fi=gb.prev=gb.next=gb}else{gb.next=fi;gb.prev=fi.prev;fi.prev.next=gb;fi.prev=gb}var g5=fi.prev;fi=null;var eD=go.posx;var en=go.posy;var gA;if(dr.zpp_pool==null){gA=new dr()}else{gA=dr.zpp_pool;dr.zpp_pool=gA.next;gA.next=null}gA.forced=false;gA.x=eD;gA.y=en;var fC=gA;if(fi==null){fi=fC.prev=fC.next=fC}else{fC.next=fi;fC.prev=fi.prev;fi.prev.next=fC;fi.prev=fC}var hV=az.paths.head.elt;var f2;if(E.zpp_pool==null){f2=new E()}else{f2=E.zpp_pool;E.zpp_pool=f2.next;f2.next=null}f2.vert=fi;f2.parent=f2;f2.rank=0;f2.used=false;az.paths.add(f2);var ek=az.paths.head.elt;var f1;if(c3.zpp_pool==null){f1=new c3()}else{f1=c3.zpp_pool;c3.zpp_pool=f1.next;f1.next=null}f1.virtualint=true;f1.end=g5;f1.start=fi;f1.path0=hV;f1.path1=ek;f1.time=gg;f1.vertex=false;az.ints.add(f1)}else{var fH=(f3*hl-f4*hj)*fo;var fL=0;var fJ=0;fL=gq.posx;fJ=gq.posy;fL+=eR*fH;fJ+=eP*fH;var f0;if(dr.zpp_pool==null){f0=new dr()}else{f0=dr.zpp_pool;dr.zpp_pool=f0.next;f0.next=null}f0.forced=false;f0.x=fL;f0.y=fJ;var fy=f0;if(fi==null){fi=fy.prev=fy.next=fy}else{fy.next=fi;fy.prev=fi.prev;fi.prev.next=fy;fi.prev=fy}var g4=fi.prev;fi=null;var fY;if(dr.zpp_pool==null){fY=new dr()}else{fY=dr.zpp_pool;dr.zpp_pool=fY.next;fY.next=null}fY.forced=false;fY.x=fL;fY.y=fJ;var fw=fY;if(fi==null){fi=fw.prev=fw.next=fw}else{fw.next=fi;fw.prev=fi.prev;fi.prev.next=fw;fi.prev=fw}if(fi==null){fi=gb.prev=gb.next=gb}else{gb.next=fi;gb.prev=fi.prev;fi.prev.next=gb;fi.prev=gb}var hU=az.paths.head.elt;var fX;if(E.zpp_pool==null){fX=new E()}else{fX=E.zpp_pool;E.zpp_pool=fX.next;fX.next=null}fX.vert=fi;fX.parent=fX;fX.rank=0;fX.used=false;az.paths.add(fX);var ej=az.paths.head.elt;var fW;if(c3.zpp_pool==null){fW=new c3()}else{fW=c3.zpp_pool;c3.zpp_pool=fW.next;fW.next=null}fW.virtualint=false;fW.end=g4;fW.start=fi;fW.path0=hU;fW.path1=ej;fW.time=gg;fW.vertex=false;az.ints.add(fW)}}}}gq=gq.next;if(!(gq!=hM)){break}}var g3=fi.prev;g3.next.prev=hY.prev;hY.prev.next=g3.next;g3.next=hY;hY.prev=g3;var fs=az.paths.head.elt;var hZ;if(e2==e2.parent){hZ=e2}else{var fv=e2;var ed=null;while(fv!=fv.parent){var hW=fv.parent;fv.parent=ed;ed=fv;fv=hW}while(ed!=null){var eV=ed.parent;ed.parent=fv;ed=eV}hZ=fv}var hP;if(fs==fs.parent){hP=fs}else{var fu=fs;var gW=null;while(fu!=fu.parent){var eU=fu.parent;fu.parent=gW;gW=fu;fu=eU}while(gW!=null){var eT=gW.parent;gW.parent=fu;gW=eT}hP=fu}if(hZ!=hP){if(hZ.rank<hP.rank){hZ.parent=hP}else{if(hZ.rank>hP.rank){hP.parent=hZ}else{hP.parent=hZ;hZ.rank++}}}var fq=az.ints;if(fq.head!=null&&fq.head.next!=null){var ea=fq.head;var hT=null;var fp=null;var fB=null;var eS=null;var fz=1;var gv;var eL;var hz;while(true){gv=0;fp=ea;ea=null;hT=ea;while(fp!=null){++gv;fB=fp;eL=0;hz=fz;while(fB!=null&&eL<fz){++eL;fB=fB.next}while(eL>0||hz>0&&fB!=null){if(eL==0){eS=fB;fB=fB.next;--hz}else{if(hz==0||fB==null){eS=fp;fp=fp.next;--eL}else{if(fp.elt.time<fB.elt.time){eS=fp;fp=fp.next;--eL}else{eS=fB;fB=fB.next;--hz}}}if(hT!=null){hT.next=eS}else{ea=eS}hT=eS}fp=fB}hT.next=null;fz<<=1;if(!(gv>1)){break}}fq.head=ea;fq.modified=true;fq.pushmod=true}while(az.ints.head!=null){var e8=az.ints.pop_unsafe();var eZ=az.ints.pop_unsafe();if(!e8.virtualint&&!eZ.virtualint){e8.end.next.prev=eZ.start.prev;eZ.start.prev.next=e8.end.next;e8.end.next=eZ.start;eZ.start.prev=e8.end;eZ.end.next.prev=e8.start.prev;e8.start.prev.next=eZ.end.next;eZ.end.next=e8.start;e8.start.prev=eZ.end;var fO;if(e8.path0==e8.path0.parent){fO=e8.path0}else{var ft=e8.path0;var gS=null;while(ft!=ft.parent){var eQ=ft.parent;ft.parent=gS;gS=ft;ft=eQ}while(gS!=null){var eO=gS.parent;gS.parent=ft;gS=eO}fO=ft}var ei;if(eZ.path1==eZ.path1.parent){ei=eZ.path1}else{var fr=eZ.path1;var gN=null;while(fr!=fr.parent){var eN=fr.parent;fr.parent=gN;gN=fr;fr=eN}while(gN!=null){var eM=gN.parent;gN.parent=fr;gN=eM}ei=fr}if(fO!=ei){if(fO.rank<ei.rank){fO.parent=ei}else{if(fO.rank>ei.rank){ei.parent=fO}else{ei.parent=fO;fO.rank++}}}var fN;if(e8.path1==e8.path1.parent){fN=e8.path1}else{var hJ=e8.path1;var gI=null;while(hJ!=hJ.parent){var eK=hJ.parent;hJ.parent=gI;gI=hJ;hJ=eK}while(gI!=null){var hw=gI.parent;gI.parent=hJ;gI=hw}fN=hJ}var eg;if(eZ.path0==eZ.path0.parent){eg=eZ.path0}else{var hH=eZ.path0;var gD=null;while(hH!=hH.parent){var hv=hH.parent;hH.parent=gD;gD=hH;hH=hv}while(gD!=null){var hu=gD.parent;gD.parent=hH;gD=hu}eg=hH}if(fN!=eg){if(fN.rank<eg.rank){fN.parent=eg}else{if(fN.rank>eg.rank){eg.parent=fN}else{eg.parent=fN;fN.rank++}}}}else{if(e8.virtualint&&!eZ.virtualint){var hs;if(eZ.end!=null&&eZ.end.prev==eZ.end){eZ.end.next=eZ.end.prev=null;var gj=eZ.end;if(gj.wrap!=null){gj.wrap.zpp_inner._inuse=false;var fk=gj.wrap;var gM=fk.zpp_inner;fk.zpp_inner.outer=null;fk.zpp_inner=null;fk.zpp_pool=au.poolVec2;au.poolVec2=fk;if(gM.outer!=null){gM.outer.zpp_inner=null;gM.outer=null}gM._isimmutable=null;gM._validate=null;gM._invalidate=null;gM.next=bB.zpp_pool;bB.zpp_pool=gM;gj.wrap=null}gj.prev=gj.next=null;gj.next=dr.zpp_pool;dr.zpp_pool=gj;hs=null}else{var fZ=eZ.end.prev;eZ.end.prev.next=eZ.end.next;eZ.end.next.prev=eZ.end.prev;eZ.end.next=eZ.end.prev=null;var hO=eZ.end;if(hO.wrap!=null){hO.wrap.zpp_inner._inuse=false;var fh=hO.wrap;var eA=fh.zpp_inner;fh.zpp_inner.outer=null;fh.zpp_inner=null;fh.zpp_pool=au.poolVec2;au.poolVec2=fh;if(eA.outer!=null){eA.outer.zpp_inner=null;eA.outer=null}eA._isimmutable=null;eA._validate=null;eA._invalidate=null;eA.next=bB.zpp_pool;bB.zpp_pool=eA;hO.wrap=null}hO.prev=hO.next=null;hO.next=dr.zpp_pool;dr.zpp_pool=hO;eZ.end=null;hs=fZ}eZ.end=hs;if(!eZ.vertex){if(eZ.end!=eZ.path0.vert){eZ.start.x=eZ.end.x;eZ.start.y=eZ.end.y;var fD;if(eZ.end!=null&&eZ.end.prev==eZ.end){eZ.end.next=eZ.end.prev=null;var hN=eZ.end;if(hN.wrap!=null){hN.wrap.zpp_inner._inuse=false;var ff=hN.wrap;var ez=ff.zpp_inner;ff.zpp_inner.outer=null;ff.zpp_inner=null;ff.zpp_pool=au.poolVec2;au.poolVec2=ff;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez;hN.wrap=null}hN.prev=hN.next=null;hN.next=dr.zpp_pool;dr.zpp_pool=hN;fD=null}else{var g0=eZ.end.prev;eZ.end.prev.next=eZ.end.next;eZ.end.next.prev=eZ.end.prev;eZ.end.next=eZ.end.prev=null;var hL=eZ.end;if(hL.wrap!=null){hL.wrap.zpp_inner._inuse=false;var fc=hL.wrap;var ey=fc.zpp_inner;fc.zpp_inner.outer=null;fc.zpp_inner=null;fc.zpp_pool=au.poolVec2;au.poolVec2=fc;if(ey.outer!=null){ey.outer.zpp_inner=null;ey.outer=null}ey._isimmutable=null;ey._validate=null;ey._invalidate=null;ey.next=bB.zpp_pool;bB.zpp_pool=ey;hL.wrap=null}hL.prev=hL.next=null;hL.next=dr.zpp_pool;dr.zpp_pool=hL;eZ.end=null;fD=g0}eZ.end=fD}else{var gk=eZ.start.next;eZ.start.x=gk.x;eZ.start.y=gk.y;if(gk!=null&&gk.prev==gk){gk.next=gk.prev=null;var hK=gk;if(hK.wrap!=null){hK.wrap.zpp_inner._inuse=false;var fa=hK.wrap;var ex=fa.zpp_inner;fa.zpp_inner.outer=null;fa.zpp_inner=null;fa.zpp_pool=au.poolVec2;au.poolVec2=fa;if(ex.outer!=null){ex.outer.zpp_inner=null;ex.outer=null}ex._isimmutable=null;ex._validate=null;ex._invalidate=null;ex.next=bB.zpp_pool;bB.zpp_pool=ex;hK.wrap=null}hK.prev=hK.next=null;hK.next=dr.zpp_pool;dr.zpp_pool=hK;gk=null}else{gk.prev.next=gk.next;gk.next.prev=gk.prev;gk.next=gk.prev=null;var hI=gk;if(hI.wrap!=null){hI.wrap.zpp_inner._inuse=false;var e9=hI.wrap;var ew=e9.zpp_inner;e9.zpp_inner.outer=null;e9.zpp_inner=null;e9.zpp_pool=au.poolVec2;au.poolVec2=e9;if(ew.outer!=null){ew.outer.zpp_inner=null;ew.outer=null}ew._isimmutable=null;ew._validate=null;ew._invalidate=null;ew.next=bB.zpp_pool;bB.zpp_pool=ew;hI.wrap=null}hI.prev=hI.next=null;hI.next=dr.zpp_pool;dr.zpp_pool=hI}}}eZ.end.next.prev=eZ.start.prev;eZ.start.prev.next=eZ.end.next;eZ.end.next=eZ.start;eZ.start.prev=eZ.end;var fM;if(eZ.path0==eZ.path0.parent){fM=eZ.path0}else{var hF=eZ.path0;var gz=null;while(hF!=hF.parent){var ht=hF.parent;hF.parent=gz;gz=hF;hF=ht}while(gz!=null){var hr=gz.parent;gz.parent=hF;gz=hr}fM=hF}var ee;if(eZ.path1==eZ.path1.parent){ee=eZ.path1}else{var hD=eZ.path1;var gx=null;while(hD!=hD.parent){var hq=hD.parent;hD.parent=gx;gx=hD;hD=hq}while(gx!=null){var hp=gx.parent;gx.parent=hD;gx=hp}ee=hD}if(fM!=ee){if(fM.rank<ee.rank){fM.parent=ee}else{if(fM.rank>ee.rank){ee.parent=fM}else{ee.parent=fM;fM.rank++}}}}else{if(eZ.virtualint&&!e8.virtualint){var fA;if(e8.end!=null&&e8.end.prev==e8.end){e8.end.next=e8.end.prev=null;var hG=e8.end;if(hG.wrap!=null){hG.wrap.zpp_inner._inuse=false;var fU=hG.wrap;var ev=fU.zpp_inner;fU.zpp_inner.outer=null;fU.zpp_inner=null;fU.zpp_pool=au.poolVec2;au.poolVec2=fU;if(ev.outer!=null){ev.outer.zpp_inner=null;ev.outer=null}ev._isimmutable=null;ev._validate=null;ev._invalidate=null;ev.next=bB.zpp_pool;bB.zpp_pool=ev;hG.wrap=null}hG.prev=hG.next=null;hG.next=dr.zpp_pool;dr.zpp_pool=hG;fA=null}else{var gY=e8.end.prev;e8.end.prev.next=e8.end.next;e8.end.next.prev=e8.end.prev;e8.end.next=e8.end.prev=null;var hE=e8.end;if(hE.wrap!=null){hE.wrap.zpp_inner._inuse=false;var fT=hE.wrap;var eu=fT.zpp_inner;fT.zpp_inner.outer=null;fT.zpp_inner=null;fT.zpp_pool=au.poolVec2;au.poolVec2=fT;if(eu.outer!=null){eu.outer.zpp_inner=null;eu.outer=null}eu._isimmutable=null;eu._validate=null;eu._invalidate=null;eu.next=bB.zpp_pool;bB.zpp_pool=eu;hE.wrap=null}hE.prev=hE.next=null;hE.next=dr.zpp_pool;dr.zpp_pool=hE;e8.end=null;fA=gY}e8.end=fA;if(!e8.vertex){if(e8.end!=e8.path0.vert){e8.start.x=e8.end.x;e8.start.y=e8.end.y;var fx;if(e8.end!=null&&e8.end.prev==e8.end){e8.end.next=e8.end.prev=null;var hC=e8.end;if(hC.wrap!=null){hC.wrap.zpp_inner._inuse=false;var fS=hC.wrap;var es=fS.zpp_inner;fS.zpp_inner.outer=null;fS.zpp_inner=null;fS.zpp_pool=au.poolVec2;au.poolVec2=fS;if(es.outer!=null){es.outer.zpp_inner=null;es.outer=null}es._isimmutable=null;es._validate=null;es._invalidate=null;es.next=bB.zpp_pool;bB.zpp_pool=es;hC.wrap=null}hC.prev=hC.next=null;hC.next=dr.zpp_pool;dr.zpp_pool=hC;fx=null}else{var gV=e8.end.prev;e8.end.prev.next=e8.end.next;e8.end.next.prev=e8.end.prev;e8.end.next=e8.end.prev=null;var hB=e8.end;if(hB.wrap!=null){hB.wrap.zpp_inner._inuse=false;var fR=hB.wrap;var eq=fR.zpp_inner;fR.zpp_inner.outer=null;fR.zpp_inner=null;fR.zpp_pool=au.poolVec2;au.poolVec2=fR;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq;hB.wrap=null}hB.prev=hB.next=null;hB.next=dr.zpp_pool;dr.zpp_pool=hB;e8.end=null;fx=gV}e8.end=fx}else{var hS=e8.start.next;e8.start.x=hS.x;e8.start.y=hS.y;if(hS!=null&&hS.prev==hS){hS.next=hS.prev=null;var fj=hS;if(fj.wrap!=null){fj.wrap.zpp_inner._inuse=false;var fQ=fj.wrap;var gH=fQ.zpp_inner;fQ.zpp_inner.outer=null;fQ.zpp_inner=null;fQ.zpp_pool=au.poolVec2;au.poolVec2=fQ;if(gH.outer!=null){gH.outer.zpp_inner=null;gH.outer=null}gH._isimmutable=null;gH._validate=null;gH._invalidate=null;gH.next=bB.zpp_pool;bB.zpp_pool=gH;fj.wrap=null}fj.prev=fj.next=null;fj.next=dr.zpp_pool;dr.zpp_pool=fj;hS=null}else{hS.prev.next=hS.next;hS.next.prev=hS.prev;hS.next=hS.prev=null;var fg=hS;if(fg.wrap!=null){fg.wrap.zpp_inner._inuse=false;var fP=fg.wrap;var gC=fP.zpp_inner;fP.zpp_inner.outer=null;fP.zpp_inner=null;fP.zpp_pool=au.poolVec2;au.poolVec2=fP;if(gC.outer!=null){gC.outer.zpp_inner=null;gC.outer=null}gC._isimmutable=null;gC._validate=null;gC._invalidate=null;gC.next=bB.zpp_pool;bB.zpp_pool=gC;fg.wrap=null}fg.prev=fg.next=null;fg.next=dr.zpp_pool;dr.zpp_pool=fg}}}e8.end.next.prev=e8.start.prev;e8.start.prev.next=e8.end.next;e8.end.next=e8.start;e8.start.prev=e8.end;var fK;if(e8.path0==e8.path0.parent){fK=e8.path0}else{var hA=e8.path0;var gw=null;while(hA!=hA.parent){var hn=hA.parent;hA.parent=gw;gw=hA;hA=hn}while(gw!=null){var hm=gw.parent;gw.parent=hA;gw=hm}fK=hA}var ec;if(e8.path1==e8.path1.parent){ec=e8.path1}else{var hy=e8.path1;var gu=null;while(hy!=hy.parent){var hk=hy.parent;hy.parent=gu;gu=hy;hy=hk}while(gu!=null){var gR=gu.parent;gu.parent=hy;gu=gR}ec=hy}if(fK!=ec){if(fK.rank<ec.rank){fK.parent=ec}else{if(fK.rank>ec.rank){ec.parent=fK}else{ec.parent=fK;fK.rank++}}}}}}e8.end=e8.start=null;e8.path0=e8.path1=null;e8.next=c3.zpp_pool;c3.zpp_pool=e8;eZ.end=eZ.start=null;eZ.path0=eZ.path1=null;eZ.next=c3.zpp_pool;c3.zpp_pool=eZ}var fV=hR==null?new u():hR;var eC=az.paths.head;while(eC!=null){var hd=eC.elt;var gf;if(hd==hd.parent){gf=hd}else{var hx=hd;var hc=null;while(hx!=hx.parent){var gL=hx.parent;hx.parent=hc;hc=hx;hx=gL}while(hc!=null){var gG=hc.parent;hc.parent=hx;hc=gG}gf=hx}if(gf.used){eC=eC.next;continue}gf.used=true;var ha=gf.vert;var ga=true;while(gf.vert!=null&&(ga||ha!=gf.vert)){ga=false;if(ha.x==ha.next.x&&ha.y==ha.next.y){if(ha==gf.vert){gf.vert=ha.next==ha?null:ha.next;ga=true}if(ha!=null&&ha.prev==ha){ha.next=ha.prev=null;ha=null;ha=ha}else{var gQ=ha.next;ha.prev.next=ha.next;ha.next.prev=ha.prev;ha.next=ha.prev=null;ha=null;ha=gQ}}else{ha=ha.next}}if(gf.vert!=null){var e5=a7.get();e5.zpp_inner.vertices=gf.vert;if(fV.zpp_inner.reverse_flag){fV.push(e5)}else{fV.unshift(e5)}}eC=eC.next}while(az.paths.head!=null){var g8=az.paths.pop_unsafe();g8.vert=null;g8.parent=null;g8.next=E.zpp_pool;E.zpp_pool=g8}while(hM!=null){if(hM!=null&&hM.prev==hM){hM.next=hM.prev=null;var fe=hM;fe.vert=null;fe.parent=null;fe.next=E.zpp_pool;E.zpp_pool=fe;hM=null;hM=hM}else{var gK=hM.next;hM.prev.next=hM.next;hM.next.prev=hM.prev;hM.next=hM.prev=null;var fb=hM;fb.vert=null;fb.parent=null;fb.next=E.zpp_pool;E.zpp_pool=fb;hM=null;hM=gK}}return fV};az.prototype.__class__=az;var bM=zpp_nape.geom.ZPP_Geom=function(){};bM.__name__=["zpp_nape","geom","ZPP_Geom"];bM.validateShape=function(eQ){if(eQ.type==1){var ea=eQ.polygon;if(ea.zip_gaxi){if(ea.body!=null){ea.zip_gaxi=false;ea.validate_laxi();var eO=ea.body;if(eO.zip_axis){eO.zip_axis=false;eO.axisx=Math.sin(eO.rot);eO.axisy=Math.cos(eO.rot)}if(ea.zip_gverts){if(ea.body!=null){ea.zip_gverts=false;ea.validate_lverts();var eM=ea.body;if(eM.zip_axis){eM.zip_axis=false;eM.axisx=Math.sin(eM.rot);eM.axisy=Math.cos(eM.rot)}var ev=ea.lverts.next;var eb=ea.gverts.next;while(eb!=null){var eU=eb;var eS=ev;ev=ev.next;eU.x=ea.body.posx+(ea.body.axisy*eS.x-ea.body.axisx*eS.y);eU.y=ea.body.posy+(eS.x*ea.body.axisx+eS.y*ea.body.axisy);eb=eb.next}}}var eV=ea.edges.head;var ej=ea.gverts.next;var eN=ej;ej=ej.next;while(ej!=null){var eL=ej;var eW=eV.elt;eV=eV.next;eW.gp0=eN;eW.gp1=eL;eW.gnormx=ea.body.axisy*eW.lnormx-ea.body.axisx*eW.lnormy;eW.gnormy=eW.lnormx*ea.body.axisx+eW.lnormy*ea.body.axisy;eW.gprojection=ea.body.posx*eW.gnormx+ea.body.posy*eW.gnormy+eW.lprojection;if(eW.wrap_gnorm!=null){eW.wrap_gnorm.zpp_inner.x=eW.gnormx;eW.wrap_gnorm.zpp_inner.y=eW.gnormy}eW.tp0=eW.gp0.y*eW.gnormx-eW.gp0.x*eW.gnormy;eW.tp1=eW.gp1.y*eW.gnormx-eW.gp1.x*eW.gnormy;eN=eL;ej=ej.next}var el=eV.elt;el.gp0=eN;el.gp1=ea.gverts.next;el.gnormx=ea.body.axisy*el.lnormx-ea.body.axisx*el.lnormy;el.gnormy=el.lnormx*ea.body.axisx+el.lnormy*ea.body.axisy;el.gprojection=ea.body.posx*el.gnormx+ea.body.posy*el.gnormy+el.lprojection;if(el.wrap_gnorm!=null){el.wrap_gnorm.zpp_inner.x=el.gnormx;el.wrap_gnorm.zpp_inner.y=el.gnormy}el.tp0=el.gp0.y*el.gnormx-el.gp0.x*el.gnormy;el.tp1=el.gp1.y*el.gnormx-el.gp1.x*el.gnormy}}}if(eQ.zip_aabb){if(eQ.body!=null){eQ.zip_aabb=false;if(eQ.type==0){var eK=eQ.circle;if(eK.zip_worldCOM){if(eK.body!=null){eK.zip_worldCOM=false;if(eK.zip_localCOM){eK.zip_localCOM=false;if(eK.type==1){var eI=eK.polygon;if(eI.lverts.next.next==null){eI.localCOMx=eI.lverts.next.x;eI.localCOMy=eI.lverts.next.y}else{if(eI.lverts.next.next.next==null){eI.localCOMx=eI.lverts.next.x;eI.localCOMy=eI.lverts.next.y;eI.localCOMx+=eI.lverts.next.next.x;eI.localCOMy+=eI.lverts.next.next.y;eI.localCOMx*=0.5;eI.localCOMy*=0.5}else{eI.localCOMx=0;eI.localCOMy=0;var et=0;var ei=eI.lverts.next;var ee=ei;ei=ei.next;var eZ=ei;ei=ei.next;while(ei!=null){var eJ=ei;et+=eZ.x*(eJ.y-ee.y);var eq=eJ.y*eZ.x-eJ.x*eZ.y;eI.localCOMx+=(eZ.x+eJ.x)*eq;eI.localCOMy+=(eZ.y+eJ.y)*eq;ee=eZ;eZ=eJ;ei=ei.next}ei=eI.lverts.next;var ew=ei;et+=eZ.x*(ew.y-ee.y);var eH=ew.y*eZ.x-ew.x*eZ.y;eI.localCOMx+=(eZ.x+ew.x)*eH;eI.localCOMy+=(eZ.y+ew.y)*eH;ee=eZ;ei=ei.next;var eu=ei;et+=ew.x*(eu.y-ee.y);var eF=eu.y*ew.x-eu.x*ew.y;eI.localCOMx+=(ew.x+eu.x)*eF;eI.localCOMy+=(ew.y+eu.y)*eF;et=1/(3*et);var eP=et;eI.localCOMx*=eP;eI.localCOMy*=eP}}}if(eK.wrap_localCOM!=null){eK.wrap_localCOM.zpp_inner.x=eK.localCOMx;eK.wrap_localCOM.zpp_inner.y=eK.localCOMy}}var eG=eK.body;if(eG.zip_axis){eG.zip_axis=false;eG.axisx=Math.sin(eG.rot);eG.axisy=Math.cos(eG.rot)}eK.worldCOMx=eK.body.posx+(eK.body.axisy*eK.localCOMx-eK.body.axisx*eK.localCOMy);eK.worldCOMy=eK.body.posy+(eK.localCOMx*eK.body.axisx+eK.localCOMy*eK.body.axisy)}}var en=eK.radius;var em=eK.radius;eK.aabb.minx=eK.worldCOMx-en;eK.aabb.miny=eK.worldCOMy-em;eK.aabb.maxx=eK.worldCOMx+en;eK.aabb.maxy=eK.worldCOMy+em}else{var eE=eQ.polygon;if(eE.zip_gverts){if(eE.body!=null){eE.zip_gverts=false;eE.validate_lverts();var eC=eE.body;if(eC.zip_axis){eC.zip_axis=false;eC.axisx=Math.sin(eC.rot);eC.axisy=Math.cos(eC.rot)}var eD=eE.lverts.next;var eh=eE.gverts.next;while(eh!=null){var eT=eh;var ec=eD;eD=eD.next;eT.x=eE.body.posx+(eE.body.axisy*ec.x-eE.body.axisx*ec.y);eT.y=eE.body.posy+(ec.x*eE.body.axisx+ec.y*eE.body.axisy);eh=eh.next}}}var eX=eE.gverts.next;eE.aabb.minx=eX.x;eE.aabb.miny=eX.y;eE.aabb.maxx=eX.x;eE.aabb.maxy=eX.y;var eg=eE.gverts.next.next;while(eg!=null){var eR=eg;if(eR.x<eE.aabb.minx){eE.aabb.minx=eR.x}if(eR.x>eE.aabb.maxx){eE.aabb.maxx=eR.x}if(eR.y<eE.aabb.miny){eE.aabb.miny=eR.y}if(eR.y>eE.aabb.maxy){eE.aabb.maxy=eR.y}eg=eg.next}}}}if(eQ.zip_worldCOM){if(eQ.body!=null){eQ.zip_worldCOM=false;if(eQ.zip_localCOM){eQ.zip_localCOM=false;if(eQ.type==1){var eA=eQ.polygon;if(eA.lverts.next.next==null){eA.localCOMx=eA.lverts.next.x;eA.localCOMy=eA.lverts.next.y}else{if(eA.lverts.next.next.next==null){eA.localCOMx=eA.lverts.next.x;eA.localCOMy=eA.lverts.next.y;eA.localCOMx+=eA.lverts.next.next.x;eA.localCOMy+=eA.lverts.next.next.y;eA.localCOMx*=0.5;eA.localCOMy*=0.5}else{eA.localCOMx=0;eA.localCOMy=0;var ek=0;var ef=eA.lverts.next;var ed=ef;ef=ef.next;var eY=ef;ef=ef.next;while(ef!=null){var es=ef;ek+=eY.x*(es.y-ed.y);var eB=es.y*eY.x-es.x*eY.y;eA.localCOMx+=(eY.x+es.x)*eB;eA.localCOMy+=(eY.y+es.y)*eB;ed=eY;eY=es;ef=ef.next}ef=eA.lverts.next;var ep=ef;ek+=eY.x*(ep.y-ed.y);var ez=ep.y*eY.x-ep.x*eY.y;eA.localCOMx+=(eY.x+ep.x)*ez;eA.localCOMy+=(eY.y+ep.y)*ez;ed=eY;ef=ef.next;var eo=ef;ek+=ep.x*(eo.y-ed.y);var ey=eo.y*ep.x-eo.x*ep.y;eA.localCOMx+=(ep.x+eo.x)*ey;eA.localCOMy+=(ep.y+eo.y)*ey;ek=1/(3*ek);var er=ek;eA.localCOMx*=er;eA.localCOMy*=er}}}if(eQ.wrap_localCOM!=null){eQ.wrap_localCOM.zpp_inner.x=eQ.localCOMx;eQ.wrap_localCOM.zpp_inner.y=eQ.localCOMy}}var ex=eQ.body;if(ex.zip_axis){ex.zip_axis=false;ex.axisx=Math.sin(ex.rot);ex.axisy=Math.cos(ex.rot)}eQ.worldCOMx=eQ.body.posx+(eQ.body.axisy*eQ.localCOMx-eQ.body.axisx*eQ.localCOMy);eQ.worldCOMy=eQ.body.posy+(eQ.localCOMx*eQ.body.axisx+eQ.localCOMy*eQ.body.axisy)}}};bM.prototype.__class__=bM;var dr=zpp_nape.geom.ZPP_GeomVert=function(){this.forced=false;this.wrap=null;this.next=null;this.prev=null;this.y=0;this.x=0};dr.__name__=["zpp_nape","geom","ZPP_GeomVert"];dr.get=function(ea,ec){var eb;if(dr.zpp_pool==null){eb=new dr()}else{eb=dr.zpp_pool;dr.zpp_pool=eb.next;eb.next=null}eb.forced=false;eb.x=ea;eb.y=ec;return eb};dr.prototype.x=null;dr.prototype.y=null;dr.prototype.prev=null;dr.prototype.next=null;dr.prototype.wrap=null;dr.prototype.forced=null;dr.prototype.free=function(){if(this.wrap!=null){this.wrap.zpp_inner._inuse=false;var eb=this.wrap;var ea=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;this.wrap=null}this.prev=this.next=null};dr.prototype.alloc=function(){this.forced=false};dr.prototype.wrapper=function(){if(this.wrap==null){var ea=this.x;var eh=this.y;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.wrap=eb;this.wrap.zpp_inner._inuse=true;this.wrap.zpp_inner._invalidate=dX(this,this.modwrap);this.wrap.zpp_inner._validate=dX(this,this.getwrap)}return this.wrap};dr.prototype.modwrap=function(ea){this.x=ea.x;this.y=ea.y};dr.prototype.getwrap=function(){this.wrap.zpp_inner.x=this.x;this.wrap.zpp_inner.y=this.y};dr.prototype.__class__=dr;var b5=zpp_nape.geom.ZPP_GeomPoly=function(ea){this.vertices=null;this.outer=null;this.outer=ea};b5.__name__=["zpp_nape","geom","ZPP_GeomPoly"];b5.prototype.outer=null;b5.prototype.vertices=null;b5.prototype.__class__=b5;var dn=zpp_nape.geom.ZPP_GeomVertexIterator=function(){this.next=null;this.outer=null;this.forward=false;this.first=false;this.start=null;this.ptr=null;this.outer=new cz()};dn.__name__=["zpp_nape","geom","ZPP_GeomVertexIterator"];dn.get=function(ec,eb){var ea;if(dn.zpp_pool==null){ea=new dn()}else{ea=dn.zpp_pool;dn.zpp_pool=ea.next;ea.next=null}ea.outer.zpp_inner=ea;ea.ptr=ec;ea.forward=eb;ea.start=ec;ea.first=ec!=null;return ea.outer};dn.prototype.ptr=null;dn.prototype.start=null;dn.prototype.first=null;dn.prototype.forward=null;dn.prototype.outer=null;dn.prototype.next=null;dn.prototype.free=function(){this.outer.zpp_inner=null;this.ptr=this.start=null};dn.prototype.alloc=function(){};dn.prototype.__class__=dn;var W=zpp_nape.geom.ZPP_MarchSpan=function(){this.next=null;this.out=false;this.rank=0;this.parent=null;this.parent=this};W.__name__=["zpp_nape","geom","ZPP_MarchSpan"];W.prototype.parent=null;W.prototype.rank=null;W.prototype.out=null;W.prototype.next=null;W.prototype.free=function(){this.parent=this};W.prototype.alloc=function(){this.out=false;this.rank=0};W.prototype.__class__=W;var T=zpp_nape.geom.ZPP_MarchPair=function(){this.next=null;this.spanr=null;this.span2=null;this.span1=null;this.pd=null;this.okeyr=0;this.keyr=0;this.pr=null;this.okey2=0;this.key2=0;this.p2=null;this.okey1=0;this.key1=0;this.p1=null};T.__name__=["zpp_nape","geom","ZPP_MarchPair"];T.prototype.p1=null;T.prototype.key1=null;T.prototype.okey1=null;T.prototype.p2=null;T.prototype.key2=null;T.prototype.okey2=null;T.prototype.pr=null;T.prototype.keyr=null;T.prototype.okeyr=null;T.prototype.pd=null;T.prototype.span1=null;T.prototype.span2=null;T.prototype.spanr=null;T.prototype.next=null;T.prototype.free=function(){this.p1=this.p2=this.pr=this.pd=null;this.span1=this.span2=this.spanr=null};T.prototype.alloc=function(){};T.prototype.__class__=T;var bc=zpp_nape.geom.ZPP_MarchingSquares=function(){};bc.__name__=["zpp_nape","geom","ZPP_MarchingSquares"];bc.isos=null;bc.ints=null;bc.map=null;bc.run=function(fe,eI,en,eG,ek,eR,fE,fR,e6){var ex=eG-eI;var eK=eR.zpp_inner;if(eK._validate!=null){eK._validate()}var fP=ex/eR.zpp_inner.x;var fQ=fP|0;var eF=ek-en;var fc=eR.zpp_inner;if(fc._validate!=null){fc._validate()}var fB=eF/eR.zpp_inner.y;var fC=fB|0;if(fP!=fQ){++fQ}if(fB!=fC){++fC}if(fR){if(bc.map==null){bc.map=new ae(fQ,fC)}else{bc.map.resize(fQ,fC,null)}}if(bc.isos==null){bc.isos=new cb(fQ+1,fC+1)}else{bc.isos.resize(fQ+1,fC+1,0)}var er=0;var eq=fC+1;while(er<eq){var eY=er++;var fD;if(eY==0){fD=en}else{if(eY<=fC){var fb=eR.zpp_inner;if(fb._validate!=null){fb._validate()}fD=en+eR.zpp_inner.y*eY}else{fD=ek}}var em=0;var eo=fQ+1;while(em<eo){var eZ=em++;var eb;if(eZ==0){eb=eI}else{if(eZ<=fQ){var fa=eR.zpp_inner;if(fa._validate!=null){fa._validate()}eb=eI+eR.zpp_inner.x*eZ}else{eb=eG}}var e8=bc.isos;var ew=fe(eb,fD);e8.list[eY*e8.width+eZ]=ew}}if(bc.ints==null){bc.ints=new ac(fQ+1,(fC<<1)+1)}else{bc.ints.resize(fQ+1,(fC<<1)+1,null)}var fz=null;if(fR){if(W.zpp_pool==null){fz=new W()}else{fz=W.zpp_pool;W.zpp_pool=fz.next;fz.next=null}fz.out=false;fz.rank=0}var eH=en;var es=0;var ej=fC;while(es<ej){var eA=es++;var eB=eH;var fU;if(eA==fC-1){fU=ek}else{var e7=eR.zpp_inner;if(e7._validate!=null){e7._validate()}fU=en+eR.zpp_inner.y*(eA+1)}eH=fU;var eJ=eI;var fd=null;var fx=0;var fL=fQ;while(fx<fL){var eO=fx++;var eP=eJ;var eh;if(eO==fQ-1){eh=eG}else{var e5=eR.zpp_inner;if(e5._validate!=null){e5._validate()}eh=eI+eR.zpp_inner.x*(eO+1)}eJ=eh;var eL=bc.me.marchSquare(fe,bc.isos,bc.ints,eP,eB,eh,fU,eO,eA,eO==0||!fR,eA==0||!fR,eO==fQ-1||!fR,eA==fC-1||!fR,fE);if(eL==null){fd=null;continue}if(fR){var eQ=eL.p2!=null&&eL.okey2!=14?eL.p2:eL.p1;eL.pd=((eQ==eL.p2?eL.okey2:eL.okey1)&128)==0?eQ.prev:eQ.prev.prev;var e4=bc.map;e4.list[eA*e4.width+eO]=eL;var eE;if(fd!=null){var fs=eL.key1;var fW=fs&1|(fs&192)>>5;var e9=0;if((fW&1)!=0){e9=1}if((fW&2)!=0){++e9}if((fW&4)!=0){++e9}eE=e9>=2}else{eE=false}if(eE){bc.me.combLR(fd,eL);eL.span1=fd.spanr}else{if(W.zpp_pool==null){eL.span1=new W()}else{eL.span1=W.zpp_pool;W.zpp_pool=eL.span1.next;eL.span1.next=null}var e2=eL.span1;e2.out=false;e2.rank=0;eL.span1.next=fz;fz=eL.span1}if(eL.p2!=null){if(W.zpp_pool==null){eL.span2=new W()}else{eL.span2=W.zpp_pool;W.zpp_pool=eL.span2.next;eL.span2.next=null}var e1=eL.span2;e1.out=false;e1.rank=0;eL.span2.next=fz;fz=eL.span2;eL.spanr=eL.span2}else{eL.spanr=eL.span1}var fr=(eL.keyr&28)>>2;var ev=0;if((fr&1)!=0){ev=1}if((fr&2)!=0){++ev}if((fr&4)!=0){++ev}if(ev>=2){fd=eL}else{fd=null}}else{bc.me.output(e6,eL.p1);if(eL.p2!=null){bc.me.output(e6,eL.p2)}eL.p1=eL.p2=eL.pr=eL.pd=null;eL.span1=eL.span2=eL.spanr=null;eL.next=T.zpp_pool;T.zpp_pool=eL}}}if(!fR){return}var ep=1;var eg=fC;while(ep<eg){var ez=ep++;var fu=null;var fw=0;var fJ=fQ;while(fw<fJ){var eN=fw++;var fm=bc.map;var fh=fm.list[ez*fm.width+eN];if(fh==null){fu=null;continue}var fq=(fh.p2!=null&&fh.okey2==14?fh.okey2:fh.okey1)&7;var eu=0;if((fq&1)!=0){eu=1}if((fq&2)!=0){++eu}if((fq&4)!=0){++eu}if(eu<2){fu=null;continue}var fl=bc.map;var fj=fl.list[(ez-1)*fl.width+eN];if(fj==null){fu=null;continue}var fp=((fj.p2!=null&&fj.okey2==56?fj.okey2:fj.okey1)&112)>>4;var et=0;if((fp&1)!=0){et=1}if((fp&2)!=0){++et}if((fp&4)!=0){++et}if(et<2){fu=null;continue}var fy=fj.p2!=null&&fj.okey2==56?fj.span2:fj.span1;var fg=fh.p2!=null&&fh.okey2==14?fh.span2:fh.span1;var eD;if(fy==fy.parent){eD=fy}else{var eX=fy;var ft=null;while(eX!=eX.parent){var ff=eX.parent;eX.parent=ft;ft=eX;eX=ff}while(ft!=null){var ei=ft.parent;ft.parent=eX;ft=ei}eD=eX}var eC;if(fg==fg.parent){eC=fg}else{var eW=fg;var fN=null;while(eW!=eW.parent){var ef=eW.parent;eW.parent=fN;fN=eW;eW=ef}while(fN!=null){var ee=fN.parent;fN.parent=eW;fN=ee}eC=eW}if(eD==eC){if(fu!=fg){bc.me.combUD_virtual(fj,fh)}}else{var fO;if(fy==fy.parent){fO=fy}else{var eV=fy;var fM=null;while(eV!=eV.parent){var ec=eV.parent;eV.parent=fM;fM=eV;eV=ec}while(fM!=null){var ea=fM.parent;fM.parent=eV;fM=ea}fO=eV}var fA;if(fg==fg.parent){fA=fg}else{var eU=fg;var fK=null;while(eU!=eU.parent){var fX=eU.parent;eU.parent=fK;fK=eU;eU=fX}while(fK!=null){var fV=fK.parent;fK.parent=eU;fK=fV}fA=eU}if(fO!=fA){if(fO.rank<fA.rank){fO.parent=fA}else{if(fO.rank>fA.rank){fA.parent=fO}else{fA.parent=fO;fO.rank++}}}bc.me.combUD(fj,fh)}if(((fg==fh.span2?fh.okey2:fh.okey1)&4)!=0){fu=fg}else{fu=null}}}var el=0;var ed=fC;while(el<ed){var ey=el++;var fv=0;var fG=fQ;while(fv<fG){var eM=fv++;var fk=bc.map;var e3=fk.list[ey*fk.width+eM];if(e3==null){continue}var fI;if(e3.span1==e3.span1.parent){fI=e3.span1}else{var eT=e3.span1;var fH=null;while(eT!=eT.parent){var fT=eT.parent;eT.parent=fH;fH=eT;eT=fT}while(fH!=null){var fS=fH.parent;fH.parent=eT;fH=fS}fI=eT}if(!fI.out){fI.out=true;bc.me.output(e6,e3.p1)}if(e3.p2!=null){if(e3.span2==e3.span2.parent){fI=e3.span2}else{var eS=e3.span2;var fF=null;while(eS!=eS.parent){var fo=eS.parent;eS.parent=fF;fF=eS;eS=fo}while(fF!=null){var fn=fF.parent;fF.parent=eS;fF=fn}fI=eS}if(!fI.out){fI.out=true;bc.me.output(e6,e3.p2)}}e3.p1=e3.p2=e3.pr=e3.pd=null;e3.span1=e3.span2=e3.spanr=null;e3.next=T.zpp_pool;T.zpp_pool=e3;var fi=bc.map;fi.list[ey*fi.width+eM]=null}}while(fz!=null){var e0=fz;fz=e0.next;e0.parent=e0;e0.next=W.zpp_pool;W.zpp_pool=e0}};bc.ISO=function(eb,ea,ec){return eb(ea,ec)};bc.prototype.output=function(ef,ea){var ee;if(ea==null||ea.next==ea||ea.next==ea.prev){ee=true}else{var eb=0;var ek=ea;var eg=ea;if(ek!=null){var ed=ek;while(true){var ei=ed;eb+=ei.x*(ei.next.y-ei.prev.y);ed=ed.next;if(!(ed!=eg)){break}}}var eh=eb*0.5;ee=eh*eh<P.epsilon*P.epsilon}if(ee){while(ea!=null){if(ea!=null&&ea.prev==ea){ea.next=ea.prev=null;ea=null;ea=ea}else{var ej=ea.next;ea.prev.next=ea.next;ea.next.prev=ea.prev;ea.next=ea.prev=null;ea=null;ea=ej}}return}var ec=a7.get();ec.zpp_inner.vertices=ea;if(ef.zpp_inner.reverse_flag){ef.push(ec)}else{ef.unshift(ec)}};bc.prototype.linkright=function(ec,ea){var eb=ea&7;if(eb==0){return ec}else{if(eb==3){return ec.next.next}else{return ec.next}}};bc.prototype.linkleft=function(eb,ea){if((ea&1)==0){return eb.prev}else{return eb}};bc.prototype.linkdown=function(eb,ea){if((ea&128)==0){return eb.prev}else{return eb.prev.prev}};bc.prototype.linkup=function(eb,ea){return eb};bc.prototype.combLR=function(eq,ep){var eb=eq.pr;var ec=eq.okeyr&7;var ee=ec==0?eb:ec==3?eb.next.next:eb.next;var ed=ep.p1;var es=(ep.okey1&1)==0?ed.prev:ed;var eh=ee.next;var ea=es.prev;if((eq.keyr&4)!=0){if(ep.pr==ep.p1){ep.pr=ee.prev}ep.p1=ee.prev;ee.prev.next=es.next;es.next.prev=ee.prev;var ef=ee;if(ef.wrap!=null){ef.wrap.zpp_inner._inuse=false;var ei=ef.wrap;var er=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(er.outer!=null){er.outer.zpp_inner=null;er.outer=null}er._isimmutable=null;er._validate=null;er._invalidate=null;er.next=bB.zpp_pool;bB.zpp_pool=er;ef.wrap=null}ef.prev=ef.next=null;ef.next=dr.zpp_pool;dr.zpp_pool=ef}else{ee.next=es.next;es.next.prev=ee}var ek=es;if(ek.wrap!=null){ek.wrap.zpp_inner._inuse=false;var eo=ek.wrap;var el=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(el.outer!=null){el.outer.zpp_inner=null;el.outer=null}el._isimmutable=null;el._validate=null;el._invalidate=null;el.next=bB.zpp_pool;bB.zpp_pool=el;ek.wrap=null}ek.prev=ek.next=null;ek.next=dr.zpp_pool;dr.zpp_pool=ek;if((eq.keyr&16)!=0){ep.pd=eh.next;eh.next.prev=ea.prev;ea.prev.next=eh.next;if(eh.wrap!=null){eh.wrap.zpp_inner._inuse=false;var en=eh.wrap;var ej=en.zpp_inner;en.zpp_inner.outer=null;en.zpp_inner=null;en.zpp_pool=au.poolVec2;au.poolVec2=en;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej;eh.wrap=null}eh.prev=eh.next=null;eh.next=dr.zpp_pool;dr.zpp_pool=eh}else{eh.prev=ea.prev;ea.prev.next=eh}if(ea.wrap!=null){ea.wrap.zpp_inner._inuse=false;var em=ea.wrap;var eg=em.zpp_inner;em.zpp_inner.outer=null;em.zpp_inner=null;em.zpp_pool=au.poolVec2;au.poolVec2=em;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg;ea.wrap=null}ea.prev=ea.next=null;ea.next=dr.zpp_pool;dr.zpp_pool=ea};bc.prototype.combUD=function(ei,eh){var ee=ei.p2!=null&&ei.key2==56;var ej=eh.p2!=null&&eh.key2==14?eh.p2:eh.p1;var ed=ei.pd;var ea=ej;var ek=ed.prev;var ec=ea.next;ea.next=ed.next;ed.next.prev=ea;if(ed.wrap!=null){ed.wrap.zpp_inner._inuse=false;var ef=ed.wrap;var el=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(el.outer!=null){el.outer.zpp_inner=null;el.outer=null}el._isimmutable=null;el._validate=null;el._invalidate=null;el.next=bB.zpp_pool;bB.zpp_pool=el;ed.wrap=null}ed.prev=ed.next=null;ed.next=dr.zpp_pool;dr.zpp_pool=ed;ec.prev=ek.prev;ek.prev.next=ec;if(ek==ei.p1){ei.p1=ec}if(ek.wrap!=null){ek.wrap.zpp_inner._inuse=false;var eg=ek.wrap;var eb=eg.zpp_inner;eg.zpp_inner.outer=null;eg.zpp_inner=null;eg.zpp_pool=au.poolVec2;au.poolVec2=eg;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ek.wrap=null}ek.prev=ek.next=null;ek.next=dr.zpp_pool;dr.zpp_pool=ek};bc.prototype.combUD_virtual=function(ec,ea){var ee=ec.p2!=null&&ec.key2==56;var eb=ea.p2!=null&&ea.key2==14?ea.p2:ea.p1;var ed=ec.pd;var ef=eb;ed.forced=ef.forced=ed.prev.forced=ef.next.forced=true};bc.prototype.combLeft=function(ec){var ea=ec&1|(ec&192)>>5;var eb=0;if((ea&1)!=0){eb=1}if((ea&2)!=0){++eb}if((ea&4)!=0){++eb}return eb>=2};bc.prototype.combRight=function(ec){var ea=(ec&28)>>2;var eb=0;if((ea&1)!=0){eb=1}if((ea&2)!=0){++eb}if((ea&4)!=0){++eb}return eb>=2};bc.prototype.combUp=function(ec){var ea=ec&7;var eb=0;if((ea&1)!=0){eb=1}if((ea&2)!=0){++eb}if((ea&4)!=0){++eb}return eb>=2};bc.prototype.combDown=function(ec){var ea=(ec&112)>>4;var eb=0;if((ea&1)!=0){eb=1}if((ea&2)!=0){++eb}if((ea&4)!=0){++eb}return eb>=2};bc.prototype.comb=function(ea){var eb=0;if((ea&1)!=0){eb=1}if((ea&2)!=0){++eb}if((ea&4)!=0){++eb}return eb>=2};bc.prototype.marchSquare=function(iD,it,ex,fo,eP,fl,eM,iK,ir,ip,io,g9,g7,gS){var ej=0;var gi=it.list[ir*it.width+iK];if(gi<0){ej=8}var gg=it.list[ir*it.width+(iK+1)];if(gg<0){ej|=4}var gf=it.list[(ir+1)*it.width+(iK+1)];if(gf<0){ej|=2}var gd=it.list[(ir+1)*it.width+iK];if(gd<0){ej|=1}if(ej==0){return null}else{var gV;if(T.zpp_pool==null){gV=new T()}else{gV=T.zpp_pool;T.zpp_pool=gV.next;gV.next=null}if(ej!=10&&ej!=5){var h4=bc.look_march[ej];gV.okey1=h4;var en=0;while(en<8){var hQ=en++;if((h4&1<<hQ)!=0){var hI=null;if(hQ==0){var h2;if(dr.zpp_pool==null){h2=new dr()}else{h2=dr.zpp_pool;dr.zpp_pool=h2.next;h2.next=null}h2.forced=false;h2.x=fo;h2.y=eP;hI=h2;if(ip||io){hI.forced=true}}else{if(hQ==2){var h1;if(dr.zpp_pool==null){h1=new dr()}else{h1=dr.zpp_pool;dr.zpp_pool=h1.next;h1.next=null}h1.forced=false;h1.x=fl;h1.y=eP;hI=h1;if(g9||io){hI.forced=true}}else{if(hQ==4){var h0;if(dr.zpp_pool==null){h0=new dr()}else{h0=dr.zpp_pool;dr.zpp_pool=h0.next;h0.next=null}h0.forced=false;h0.x=fl;h0.y=eM;hI=h0;if(g9||g7){hI.forced=true}}else{if(hQ==6){var hZ;if(dr.zpp_pool==null){hZ=new dr()}else{hZ=dr.zpp_pool;dr.zpp_pool=hZ.next;hZ.next=null}hZ.forced=false;hZ.x=fo;hZ.y=eM;hI=hZ;if(ip||g7){hI.forced=true}}else{if(hQ==1){hI=ex.list[(ir<<1)*ex.width+iK];if(hI==null){var hG=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var hY;if(dr.zpp_pool==null){hY=new dr()}else{hY=dr.zpp_pool;dr.zpp_pool=hY.next;hY.next=null}hY.forced=false;hY.x=hG;hY.y=eP;hI=hY;ex.list[(ir<<1)*ex.width+iK]=hI}else{var fk=hI.x;var hF=hI.y;var hX;if(dr.zpp_pool==null){hX=new dr()}else{hX=dr.zpp_pool;dr.zpp_pool=hX.next;hX.next=null}hX.forced=false;hX.x=fk;hX.y=hF;hI=hX}if(io){hI.forced=true}if(hI.x==fo||hI.x==fl){if(hI.x==fo&&(h4&1)!=0||hI.x==fl&&(h4&4)!=0){h4^=2}}}else{if(hQ==5){hI=ex.list[((ir<<1)+2)*ex.width+iK];if(hI==null){var fi=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var hW;if(dr.zpp_pool==null){hW=new dr()}else{hW=dr.zpp_pool;dr.zpp_pool=hW.next;hW.next=null}hW.forced=false;hW.x=fi;hW.y=eM;hI=hW;ex.list[((ir<<1)+2)*ex.width+iK]=hI}else{var fg=hI.x;var eK=hI.y;var hV;if(dr.zpp_pool==null){hV=new dr()}else{hV=dr.zpp_pool;dr.zpp_pool=hV.next;hV.next=null}hV.forced=false;hV.x=fg;hV.y=eK;hI=hV}if(g7){hI.forced=true}if(hI.x==fo||hI.x==fl){if(hI.x==fo&&(h4&64)!=0||hI.x==fl&&(h4&16)!=0){h4^=32}}}else{if(hQ==3){hI=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(hI==null){var eI=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var hT;if(dr.zpp_pool==null){hT=new dr()}else{hT=dr.zpp_pool;dr.zpp_pool=hT.next;hT.next=null}hT.forced=false;hT.x=fl;hT.y=eI;hI=hT;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=hI}else{var fe=hI.x;var eG=hI.y;var hu;if(dr.zpp_pool==null){hu=new dr()}else{hu=dr.zpp_pool;dr.zpp_pool=hu.next;hu.next=null}hu.forced=false;hu.x=fe;hu.y=eG;hI=hu}if(g9){hI.forced=true}if(hI.y==eP||hI.y==eM){if(hI.y==eP&&(h4&4)!=0||hI.y==eM&&(h4&16)!=0){h4^=8}}}else{hI=ex.list[((ir<<1)+1)*ex.width+iK];if(hI==null){var eE=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var ht;if(dr.zpp_pool==null){ht=new dr()}else{ht=dr.zpp_pool;dr.zpp_pool=ht.next;ht.next=null}ht.forced=false;ht.x=fo;ht.y=eE;hI=ht;ex.list[((ir<<1)+1)*ex.width+iK]=hI}else{var fc=hI.x;var eC=hI.y;var hs;if(dr.zpp_pool==null){hs=new dr()}else{hs=dr.zpp_pool;dr.zpp_pool=hs.next;hs.next=null}hs.forced=false;hs.x=fc;hs.y=eC;hI=hs}if(ip){hI.forced=true}if(hI.y==eP||hI.y==eM){if(hI.y==eP&&(h4&1)!=0||hI.y==eM&&(h4&64)!=0){h4^=128}}}}}}}}}var fV=hI;if(gV.p1==null){gV.p1=fV.prev=fV.next=fV}else{fV.prev=gV.p1;fV.next=gV.p1.next;gV.p1.next.prev=fV;gV.p1.next=fV}gV.p1=fV}}gV.p1=gV.p1.next;gV.key1=h4;if(h4==1||h4==4||h4==16||h4==64||h4==3||h4==12||h4==48||h4==192||h4==129||h4==6||h4==24||h4==96||h4==5||h4==20||h4==80||h4==65||h4==17||h4==68){h4=0;gV.key1=0;gV.p1=null}if(h4==0){gV=null}else{gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}}else{var hU=iD(0.5*(fo+fl),0.5*(eP+eM))<0;if(ej==10){if(hU){var ge=187;gV.okey1=187;var ft=0;while(ft<8){var gz=ft++;if((ge&1<<gz)!=0){var ij=null;if(gz==0){var hr;if(dr.zpp_pool==null){hr=new dr()}else{hr=dr.zpp_pool;dr.zpp_pool=hr.next;hr.next=null}hr.forced=false;hr.x=fo;hr.y=eP;ij=hr;if(ip||io){ij.forced=true}}else{if(gz==2){var hq;if(dr.zpp_pool==null){hq=new dr()}else{hq=dr.zpp_pool;dr.zpp_pool=hq.next;hq.next=null}hq.forced=false;hq.x=fl;hq.y=eP;ij=hq;if(g9||io){ij.forced=true}}else{if(gz==4){var hp;if(dr.zpp_pool==null){hp=new dr()}else{hp=dr.zpp_pool;dr.zpp_pool=hp.next;hp.next=null}hp.forced=false;hp.x=fl;hp.y=eM;ij=hp;if(g9||g7){ij.forced=true}}else{if(gz==6){var ho;if(dr.zpp_pool==null){ho=new dr()}else{ho=dr.zpp_pool;dr.zpp_pool=ho.next;ho.next=null}ho.forced=false;ho.x=fo;ho.y=eM;ij=ho;if(ip||g7){ij.forced=true}}else{if(gz==1){ij=ex.list[(ir<<1)*ex.width+iK];if(ij==null){var fb=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var hn;if(dr.zpp_pool==null){hn=new dr()}else{hn=dr.zpp_pool;dr.zpp_pool=hn.next;hn.next=null}hn.forced=false;hn.x=fb;hn.y=eP;ij=hn;ex.list[(ir<<1)*ex.width+iK]=ij}else{var fa=ij.x;var eA=ij.y;var hm;if(dr.zpp_pool==null){hm=new dr()}else{hm=dr.zpp_pool;dr.zpp_pool=hm.next;hm.next=null}hm.forced=false;hm.x=fa;hm.y=eA;ij=hm}if(io){ij.forced=true}if(ij.x==fo||ij.x==fl){if(ij.x==fo&&(ge&1)!=0||ij.x==fl&&(ge&4)!=0){ge^=2}}}else{if(gz==5){ij=ex.list[((ir<<1)+2)*ex.width+iK];if(ij==null){var e8=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var hk;if(dr.zpp_pool==null){hk=new dr()}else{hk=dr.zpp_pool;dr.zpp_pool=hk.next;hk.next=null}hk.forced=false;hk.x=e8;hk.y=eM;ij=hk;ex.list[((ir<<1)+2)*ex.width+iK]=ij}else{var im=ij.x;var ey=ij.y;var ha;if(dr.zpp_pool==null){ha=new dr()}else{ha=dr.zpp_pool;dr.zpp_pool=ha.next;ha.next=null}ha.forced=false;ha.x=im;ha.y=ey;ij=ha}if(g7){ij.forced=true}if(ij.x==fo||ij.x==fl){if(ij.x==fo&&(ge&64)!=0||ij.x==fl&&(ge&16)!=0){ge^=32}}}else{if(gz==3){ij=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(ij==null){var eu=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var g8;if(dr.zpp_pool==null){g8=new dr()}else{g8=dr.zpp_pool;dr.zpp_pool=g8.next;g8.next=null}g8.forced=false;g8.x=fl;g8.y=eu;ij=g8;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=ij}else{var il=ij.x;var f8=ij.y;var g6;if(dr.zpp_pool==null){g6=new dr()}else{g6=dr.zpp_pool;dr.zpp_pool=g6.next;g6.next=null}g6.forced=false;g6.x=il;g6.y=f8;ij=g6}if(g9){ij.forced=true}if(ij.y==eP||ij.y==eM){if(ij.y==eP&&(ge&4)!=0||ij.y==eM&&(ge&16)!=0){ge^=8}}}else{ij=ex.list[((ir<<1)+1)*ex.width+iK];if(ij==null){var f6=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var g5;if(dr.zpp_pool==null){g5=new dr()}else{g5=dr.zpp_pool;dr.zpp_pool=g5.next;g5.next=null}g5.forced=false;g5.x=fo;g5.y=f6;ij=g5;ex.list[((ir<<1)+1)*ex.width+iK]=ij}else{var ik=ij.x;var f4=ij.y;var g4;if(dr.zpp_pool==null){g4=new dr()}else{g4=dr.zpp_pool;dr.zpp_pool=g4.next;g4.next=null}g4.forced=false;g4.x=ik;g4.y=f4;ij=g4}if(ip){ij.forced=true}if(ij.y==eP||ij.y==eM){if(ij.y==eP&&(ge&1)!=0||ij.y==eM&&(ge&64)!=0){ge^=128}}}}}}}}}var gR=ij;if(gV.p1==null){gV.p1=gR.prev=gR.next=gR}else{gR.prev=gV.p1;gR.next=gV.p1.next;gV.p1.next.prev=gR;gV.p1.next=gR}gV.p1=gR}}gV.p1=gV.p1.next;gV.key1=ge;if(ge==1||ge==4||ge==16||ge==64||ge==3||ge==12||ge==48||ge==192||ge==129||ge==6||ge==24||ge==96||ge==5||ge==20||ge==80||ge==65||ge==17||ge==68){ge=0;gV.key1=0;gV.p1=null}if(ge==0){gV=null}else{gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}}else{var gc=131;gV.okey1=131;var fr=0;while(fr<8){var gy=fr++;if((gc&1<<gy)!=0){var ih=null;if(gy==0){var g3;if(dr.zpp_pool==null){g3=new dr()}else{g3=dr.zpp_pool;dr.zpp_pool=g3.next;g3.next=null}g3.forced=false;g3.x=fo;g3.y=eP;ih=g3;if(ip||io){ih.forced=true}}else{if(gy==2){var g2;if(dr.zpp_pool==null){g2=new dr()}else{g2=dr.zpp_pool;dr.zpp_pool=g2.next;g2.next=null}g2.forced=false;g2.x=fl;g2.y=eP;ih=g2;if(g9||io){ih.forced=true}}else{if(gy==4){var g1;if(dr.zpp_pool==null){g1=new dr()}else{g1=dr.zpp_pool;dr.zpp_pool=g1.next;g1.next=null}g1.forced=false;g1.x=fl;g1.y=eM;ih=g1;if(g9||g7){ih.forced=true}}else{if(gy==6){var g0;if(dr.zpp_pool==null){g0=new dr()}else{g0=dr.zpp_pool;dr.zpp_pool=g0.next;g0.next=null}g0.forced=false;g0.x=fo;g0.y=eM;ih=g0;if(ip||g7){ih.forced=true}}else{if(gy==1){ih=ex.list[(ir<<1)*ex.width+iK];if(ih==null){var ii=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var gY;if(dr.zpp_pool==null){gY=new dr()}else{gY=dr.zpp_pool;dr.zpp_pool=gY.next;gY.next=null}gY.forced=false;gY.x=ii;gY.y=eP;ih=gY;ex.list[(ir<<1)*ex.width+iK]=ih}else{var ig=ih.x;var f2=ih.y;var gJ;if(dr.zpp_pool==null){gJ=new dr()}else{gJ=dr.zpp_pool;dr.zpp_pool=gJ.next;gJ.next=null}gJ.forced=false;gJ.x=ig;gJ.y=f2;ih=gJ}if(io){ih.forced=true}if(ih.x==fo||ih.x==fl){if(ih.x==fo&&(gc&1)!=0||ih.x==fl&&(gc&4)!=0){gc^=2}}}else{if(gy==5){ih=ex.list[((ir<<1)+2)*ex.width+iK];if(ih==null){var ic=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var gI;if(dr.zpp_pool==null){gI=new dr()}else{gI=dr.zpp_pool;dr.zpp_pool=gI.next;gI.next=null}gI.forced=false;gI.x=ic;gI.y=eM;ih=gI;ex.list[((ir<<1)+2)*ex.width+iK]=ih}else{var ib=ih.x;var f1=ih.y;var gH;if(dr.zpp_pool==null){gH=new dr()}else{gH=dr.zpp_pool;dr.zpp_pool=gH.next;gH.next=null}gH.forced=false;gH.x=ib;gH.y=f1;ih=gH}if(g7){ih.forced=true}if(ih.x==fo||ih.x==fl){if(ih.x==fo&&(gc&64)!=0||ih.x==fl&&(gc&16)!=0){gc^=32}}}else{if(gy==3){ih=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(ih==null){var f0=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var gG;if(dr.zpp_pool==null){gG=new dr()}else{gG=dr.zpp_pool;dr.zpp_pool=gG.next;gG.next=null}gG.forced=false;gG.x=fl;gG.y=f0;ih=gG;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=ih}else{var h9=ih.x;var fZ=ih.y;var gF;if(dr.zpp_pool==null){gF=new dr()}else{gF=dr.zpp_pool;dr.zpp_pool=gF.next;gF.next=null}gF.forced=false;gF.x=h9;gF.y=fZ;ih=gF}if(g9){ih.forced=true}if(ih.y==eP||ih.y==eM){if(ih.y==eP&&(gc&4)!=0||ih.y==eM&&(gc&16)!=0){gc^=8}}}else{ih=ex.list[((ir<<1)+1)*ex.width+iK];if(ih==null){var fY=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var gE;if(dr.zpp_pool==null){gE=new dr()}else{gE=dr.zpp_pool;dr.zpp_pool=gE.next;gE.next=null}gE.forced=false;gE.x=fo;gE.y=fY;ih=gE;ex.list[((ir<<1)+1)*ex.width+iK]=ih}else{var h7=ih.x;var fX=ih.y;var gD;if(dr.zpp_pool==null){gD=new dr()}else{gD=dr.zpp_pool;dr.zpp_pool=gD.next;gD.next=null}gD.forced=false;gD.x=h7;gD.y=fX;ih=gD}if(ip){ih.forced=true}if(ih.y==eP||ih.y==eM){if(ih.y==eP&&(gc&1)!=0||ih.y==eM&&(gc&64)!=0){gc^=128}}}}}}}}}var gQ=ih;if(gV.p1==null){gV.p1=gQ.prev=gQ.next=gQ}else{gQ.prev=gV.p1;gQ.next=gV.p1.next;gV.p1.next.prev=gQ;gV.p1.next=gQ}gV.p1=gQ}}gV.p1=gV.p1.next;gV.key1=gc;if(gc==1||gc==4||gc==16||gc==64||gc==3||gc==12||gc==48||gc==192||gc==129||gc==6||gc==24||gc==96||gc==5||gc==20||gc==80||gc==65||gc==17||gc==68){gc=0;gV.key1=0;gV.p1=null}if(gc!=0){var gb=56;gV.okey2=56;var fp=0;while(fp<8){var gx=fp++;if((gb&1<<gx)!=0){var ie=null;if(gx==0){var gC;if(dr.zpp_pool==null){gC=new dr()}else{gC=dr.zpp_pool;dr.zpp_pool=gC.next;gC.next=null}gC.forced=false;gC.x=fo;gC.y=eP;ie=gC;if(ip||io){ie.forced=true}}else{if(gx==2){var gB;if(dr.zpp_pool==null){gB=new dr()}else{gB=dr.zpp_pool;dr.zpp_pool=gB.next;gB.next=null}gB.forced=false;gB.x=fl;gB.y=eP;ie=gB;if(g9||io){ie.forced=true}}else{if(gx==4){var gA;if(dr.zpp_pool==null){gA=new dr()}else{gA=dr.zpp_pool;dr.zpp_pool=gA.next;gA.next=null}gA.forced=false;gA.x=fl;gA.y=eM;ie=gA;if(g9||g7){ie.forced=true}}else{if(gx==6){var gr;if(dr.zpp_pool==null){gr=new dr()}else{gr=dr.zpp_pool;dr.zpp_pool=gr.next;gr.next=null}gr.forced=false;gr.x=fo;gr.y=eM;ie=gr;if(ip||g7){ie.forced=true}}else{if(gx==1){ie=ex.list[(ir<<1)*ex.width+iK];if(ie==null){var h5=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var gq;if(dr.zpp_pool==null){gq=new dr()}else{gq=dr.zpp_pool;dr.zpp_pool=gq.next;gq.next=null}gq.forced=false;gq.x=h5;gq.y=eP;ie=gq;ex.list[(ir<<1)*ex.width+iK]=ie}else{var hS=ie.x;var fW=ie.y;var gp;if(dr.zpp_pool==null){gp=new dr()}else{gp=dr.zpp_pool;dr.zpp_pool=gp.next;gp.next=null}gp.forced=false;gp.x=hS;gp.y=fW;ie=gp}if(io){ie.forced=true}if(ie.x==fo||ie.x==fl){if(ie.x==fo&&(gb&1)!=0||ie.x==fl&&(gb&4)!=0){gb^=2}}}else{if(gx==5){ie=ex.list[((ir<<1)+2)*ex.width+iK];if(ie==null){var hR=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var go;if(dr.zpp_pool==null){go=new dr()}else{go=dr.zpp_pool;dr.zpp_pool=go.next;go.next=null}go.forced=false;go.x=hR;go.y=eM;ie=go;ex.list[((ir<<1)+2)*ex.width+iK]=ie}else{var hP=ie.x;var fK=ie.y;var gn;if(dr.zpp_pool==null){gn=new dr()}else{gn=dr.zpp_pool;dr.zpp_pool=gn.next;gn.next=null}gn.forced=false;gn.x=hP;gn.y=fK;ie=gn}if(g7){ie.forced=true}if(ie.x==fo||ie.x==fl){if(ie.x==fo&&(gb&64)!=0||ie.x==fl&&(gb&16)!=0){gb^=32}}}else{if(gx==3){ie=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(ie==null){var fJ=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var gm;if(dr.zpp_pool==null){gm=new dr()}else{gm=dr.zpp_pool;dr.zpp_pool=gm.next;gm.next=null}gm.forced=false;gm.x=fl;gm.y=fJ;ie=gm;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=ie}else{var hO=ie.x;var fI=ie.y;var gl;if(dr.zpp_pool==null){gl=new dr()}else{gl=dr.zpp_pool;dr.zpp_pool=gl.next;gl.next=null}gl.forced=false;gl.x=hO;gl.y=fI;ie=gl}if(g9){ie.forced=true}if(ie.y==eP||ie.y==eM){if(ie.y==eP&&(gb&4)!=0||ie.y==eM&&(gb&16)!=0){gb^=8}}}else{ie=ex.list[((ir<<1)+1)*ex.width+iK];if(ie==null){var fH=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var gk;if(dr.zpp_pool==null){gk=new dr()}else{gk=dr.zpp_pool;dr.zpp_pool=gk.next;gk.next=null}gk.forced=false;gk.x=fo;gk.y=fH;ie=gk;ex.list[((ir<<1)+1)*ex.width+iK]=ie}else{var hN=ie.x;var fG=ie.y;var gj;if(dr.zpp_pool==null){gj=new dr()}else{gj=dr.zpp_pool;dr.zpp_pool=gj.next;gj.next=null}gj.forced=false;gj.x=hN;gj.y=fG;ie=gj}if(ip){ie.forced=true}if(ie.y==eP||ie.y==eM){if(ie.y==eP&&(gb&1)!=0||ie.y==eM&&(gb&64)!=0){gb^=128}}}}}}}}}var gP=ie;if(gV.p2==null){gV.p2=gP.prev=gP.next=gP}else{gP.prev=gV.p2;gP.next=gV.p2.next;gV.p2.next.prev=gP;gV.p2.next=gP}gV.p2=gP}}gV.p2=gV.p2.next;gV.key2=gb;if(gb==1||gb==4||gb==16||gb==64||gb==3||gb==12||gb==48||gb==192||gb==129||gb==6||gb==24||gb==96||gb==5||gb==20||gb==80||gb==65||gb==17||gb==68){gb=0;gV.key2=0;gV.p2=null}if(gb==0){gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}else{gV.pr=gV.p2;gV.okeyr=gV.okey2;gV.keyr=gV.key2}}else{var ga=56;gV.okey1=56;var fm=0;while(fm<8){var gw=fm++;if((ga&1<<gw)!=0){var id=null;if(gw==0){var gh;if(dr.zpp_pool==null){gh=new dr()}else{gh=dr.zpp_pool;dr.zpp_pool=gh.next;gh.next=null}gh.forced=false;gh.x=fo;gh.y=eP;id=gh;if(ip||io){id.forced=true}}else{if(gw==2){var fU;if(dr.zpp_pool==null){fU=new dr()}else{fU=dr.zpp_pool;dr.zpp_pool=fU.next;fU.next=null}fU.forced=false;fU.x=fl;fU.y=eP;id=fU;if(g9||io){id.forced=true}}else{if(gw==4){var fT;if(dr.zpp_pool==null){fT=new dr()}else{fT=dr.zpp_pool;dr.zpp_pool=fT.next;fT.next=null}fT.forced=false;fT.x=fl;fT.y=eM;id=fT;if(g9||g7){id.forced=true}}else{if(gw==6){var fS;if(dr.zpp_pool==null){fS=new dr()}else{fS=dr.zpp_pool;dr.zpp_pool=fS.next;fS.next=null}fS.forced=false;fS.x=fo;fS.y=eM;id=fS;if(ip||g7){id.forced=true}}else{if(gw==1){id=ex.list[(ir<<1)*ex.width+iK];if(id==null){var hM=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var fR;if(dr.zpp_pool==null){fR=new dr()}else{fR=dr.zpp_pool;dr.zpp_pool=fR.next;fR.next=null}fR.forced=false;fR.x=hM;fR.y=eP;id=fR;ex.list[(ir<<1)*ex.width+iK]=id}else{var hL=id.x;var fF=id.y;var fQ;if(dr.zpp_pool==null){fQ=new dr()}else{fQ=dr.zpp_pool;dr.zpp_pool=fQ.next;fQ.next=null}fQ.forced=false;fQ.x=hL;fQ.y=fF;id=fQ}if(io){id.forced=true}if(id.x==fo||id.x==fl){if(id.x==fo&&(ga&1)!=0||id.x==fl&&(ga&4)!=0){ga^=2}}}else{if(gw==5){id=ex.list[((ir<<1)+2)*ex.width+iK];if(id==null){var hK=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var fP;if(dr.zpp_pool==null){fP=new dr()}else{fP=dr.zpp_pool;dr.zpp_pool=fP.next;fP.next=null}fP.forced=false;fP.x=hK;fP.y=eM;id=fP;ex.list[((ir<<1)+2)*ex.width+iK]=id}else{var hJ=id.x;var fE=id.y;var fO;if(dr.zpp_pool==null){fO=new dr()}else{fO=dr.zpp_pool;dr.zpp_pool=fO.next;fO.next=null}fO.forced=false;fO.x=hJ;fO.y=fE;id=fO}if(g7){id.forced=true}if(id.x==fo||id.x==fl){if(id.x==fo&&(ga&64)!=0||id.x==fl&&(ga&16)!=0){ga^=32}}}else{if(gw==3){id=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(id==null){var fD=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var fN;if(dr.zpp_pool==null){fN=new dr()}else{fN=dr.zpp_pool;dr.zpp_pool=fN.next;fN.next=null}fN.forced=false;fN.x=fl;fN.y=fD;id=fN;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=id}else{var hH=id.x;var fC=id.y;var fM;if(dr.zpp_pool==null){fM=new dr()}else{fM=dr.zpp_pool;dr.zpp_pool=fM.next;fM.next=null}fM.forced=false;fM.x=hH;fM.y=fC;id=fM}if(g9){id.forced=true}if(id.y==eP||id.y==eM){if(id.y==eP&&(ga&4)!=0||id.y==eM&&(ga&16)!=0){ga^=8}}}else{id=ex.list[((ir<<1)+1)*ex.width+iK];if(id==null){var fB=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var fL;if(dr.zpp_pool==null){fL=new dr()}else{fL=dr.zpp_pool;dr.zpp_pool=fL.next;fL.next=null}fL.forced=false;fL.x=fo;fL.y=fB;id=fL;ex.list[((ir<<1)+1)*ex.width+iK]=id}else{var hE=id.x;var e9=id.y;var fA;if(dr.zpp_pool==null){fA=new dr()}else{fA=dr.zpp_pool;dr.zpp_pool=fA.next;fA.next=null}fA.forced=false;fA.x=hE;fA.y=e9;id=fA}if(ip){id.forced=true}if(id.y==eP||id.y==eM){if(id.y==eP&&(ga&1)!=0||id.y==eM&&(ga&64)!=0){ga^=128}}}}}}}}}var gO=id;if(gV.p1==null){gV.p1=gO.prev=gO.next=gO}else{gO.prev=gV.p1;gO.next=gV.p1.next;gV.p1.next.prev=gO;gV.p1.next=gO}gV.p1=gO}}gV.p1=gV.p1.next;gV.key1=ga;if(ga==1||ga==4||ga==16||ga==64||ga==3||ga==12||ga==48||ga==192||ga==129||ga==6||ga==24||ga==96||ga==5||ga==20||ga==80||ga==65||ga==17||ga==68){ga=0;gV.key1=0;gV.p1=null}if(ga==0){gV=null}else{gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}}}}else{if(hU){var f9=238;gV.okey1=238;var fj=0;while(fj<8){var gv=fj++;if((f9&1<<gv)!=0){var ia=null;if(gv==0){var fz;if(dr.zpp_pool==null){fz=new dr()}else{fz=dr.zpp_pool;dr.zpp_pool=fz.next;fz.next=null}fz.forced=false;fz.x=fo;fz.y=eP;ia=fz;if(ip||io){ia.forced=true}}else{if(gv==2){var fy;if(dr.zpp_pool==null){fy=new dr()}else{fy=dr.zpp_pool;dr.zpp_pool=fy.next;fy.next=null}fy.forced=false;fy.x=fl;fy.y=eP;ia=fy;if(g9||io){ia.forced=true}}else{if(gv==4){var fx;if(dr.zpp_pool==null){fx=new dr()}else{fx=dr.zpp_pool;dr.zpp_pool=fx.next;fx.next=null}fx.forced=false;fx.x=fl;fx.y=eM;ia=fx;if(g9||g7){ia.forced=true}}else{if(gv==6){var fw;if(dr.zpp_pool==null){fw=new dr()}else{fw=dr.zpp_pool;dr.zpp_pool=fw.next;fw.next=null}fw.forced=false;fw.x=fo;fw.y=eM;ia=fw;if(ip||g7){ia.forced=true}}else{if(gv==1){ia=ex.list[(ir<<1)*ex.width+iK];if(ia==null){var hD=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var fv;if(dr.zpp_pool==null){fv=new dr()}else{fv=dr.zpp_pool;dr.zpp_pool=fv.next;fv.next=null}fv.forced=false;fv.x=hD;fv.y=eP;ia=fv;ex.list[(ir<<1)*ex.width+iK]=ia}else{var hC=ia.x;var e7=ia.y;var fu;if(dr.zpp_pool==null){fu=new dr()}else{fu=dr.zpp_pool;dr.zpp_pool=fu.next;fu.next=null}fu.forced=false;fu.x=hC;fu.y=e7;ia=fu}if(io){ia.forced=true}if(ia.x==fo||ia.x==fl){if(ia.x==fo&&(f9&1)!=0||ia.x==fl&&(f9&4)!=0){f9^=2}}}else{if(gv==5){ia=ex.list[((ir<<1)+2)*ex.width+iK];if(ia==null){var hB=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var fs;if(dr.zpp_pool==null){fs=new dr()}else{fs=dr.zpp_pool;dr.zpp_pool=fs.next;fs.next=null}fs.forced=false;fs.x=hB;fs.y=eM;ia=fs;ex.list[((ir<<1)+2)*ex.width+iK]=ia}else{var hA=ia.x;var e6=ia.y;var fq;if(dr.zpp_pool==null){fq=new dr()}else{fq=dr.zpp_pool;dr.zpp_pool=fq.next;fq.next=null}fq.forced=false;fq.x=hA;fq.y=e6;ia=fq}if(g7){ia.forced=true}if(ia.x==fo||ia.x==fl){if(ia.x==fo&&(f9&64)!=0||ia.x==fl&&(f9&16)!=0){f9^=32}}}else{if(gv==3){ia=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(ia==null){var e5=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var fn;if(dr.zpp_pool==null){fn=new dr()}else{fn=dr.zpp_pool;dr.zpp_pool=fn.next;fn.next=null}fn.forced=false;fn.x=fl;fn.y=e5;ia=fn;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=ia}else{var hz=ia.x;var e4=ia.y;var eY;if(dr.zpp_pool==null){eY=new dr()}else{eY=dr.zpp_pool;dr.zpp_pool=eY.next;eY.next=null}eY.forced=false;eY.x=hz;eY.y=e4;ia=eY}if(g9){ia.forced=true}if(ia.y==eP||ia.y==eM){if(ia.y==eP&&(f9&4)!=0||ia.y==eM&&(f9&16)!=0){f9^=8}}}else{ia=ex.list[((ir<<1)+1)*ex.width+iK];if(ia==null){var e3=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var eX;if(dr.zpp_pool==null){eX=new dr()}else{eX=dr.zpp_pool;dr.zpp_pool=eX.next;eX.next=null}eX.forced=false;eX.x=fo;eX.y=e3;ia=eX;ex.list[((ir<<1)+1)*ex.width+iK]=ia}else{var hy=ia.x;var e2=ia.y;var eW;if(dr.zpp_pool==null){eW=new dr()}else{eW=dr.zpp_pool;dr.zpp_pool=eW.next;eW.next=null}eW.forced=false;eW.x=hy;eW.y=e2;ia=eW}if(ip){ia.forced=true}if(ia.y==eP||ia.y==eM){if(ia.y==eP&&(f9&1)!=0||ia.y==eM&&(f9&64)!=0){f9^=128}}}}}}}}}var gN=ia;if(gV.p1==null){gV.p1=gN.prev=gN.next=gN}else{gN.prev=gV.p1;gN.next=gV.p1.next;gV.p1.next.prev=gN;gV.p1.next=gN}gV.p1=gN}}gV.p1=gV.p1.next;gV.key1=f9;if(f9==1||f9==4||f9==16||f9==64||f9==3||f9==12||f9==48||f9==192||f9==129||f9==6||f9==24||f9==96||f9==5||f9==20||f9==80||f9==65||f9==17||f9==68){f9=0;gV.key1=0;gV.p1=null}if(f9==0){gV=null}else{gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}}else{var f7=224;gV.okey1=224;var fh=0;while(fh<8){var gu=fh++;if((f7&1<<gu)!=0){var h8=null;if(gu==0){var eV;if(dr.zpp_pool==null){eV=new dr()}else{eV=dr.zpp_pool;dr.zpp_pool=eV.next;eV.next=null}eV.forced=false;eV.x=fo;eV.y=eP;h8=eV;if(ip||io){h8.forced=true}}else{if(gu==2){var eU;if(dr.zpp_pool==null){eU=new dr()}else{eU=dr.zpp_pool;dr.zpp_pool=eU.next;eU.next=null}eU.forced=false;eU.x=fl;eU.y=eP;h8=eU;if(g9||io){h8.forced=true}}else{if(gu==4){var eT;if(dr.zpp_pool==null){eT=new dr()}else{eT=dr.zpp_pool;dr.zpp_pool=eT.next;eT.next=null}eT.forced=false;eT.x=fl;eT.y=eM;h8=eT;if(g9||g7){h8.forced=true}}else{if(gu==6){var eS;if(dr.zpp_pool==null){eS=new dr()}else{eS=dr.zpp_pool;dr.zpp_pool=eS.next;eS.next=null}eS.forced=false;eS.x=fo;eS.y=eM;h8=eS;if(ip||g7){h8.forced=true}}else{if(gu==1){h8=ex.list[(ir<<1)*ex.width+iK];if(h8==null){var hx=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var eR;if(dr.zpp_pool==null){eR=new dr()}else{eR=dr.zpp_pool;dr.zpp_pool=eR.next;eR.next=null}eR.forced=false;eR.x=hx;eR.y=eP;h8=eR;ex.list[(ir<<1)*ex.width+iK]=h8}else{var hw=h8.x;var e1=h8.y;var eQ;if(dr.zpp_pool==null){eQ=new dr()}else{eQ=dr.zpp_pool;dr.zpp_pool=eQ.next;eQ.next=null}eQ.forced=false;eQ.x=hw;eQ.y=e1;h8=eQ}if(io){h8.forced=true}if(h8.x==fo||h8.x==fl){if(h8.x==fo&&(f7&1)!=0||h8.x==fl&&(f7&4)!=0){f7^=2}}}else{if(gu==5){h8=ex.list[((ir<<1)+2)*ex.width+iK];if(h8==null){var hv=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var eO;if(dr.zpp_pool==null){eO=new dr()}else{eO=dr.zpp_pool;dr.zpp_pool=eO.next;eO.next=null}eO.forced=false;eO.x=hv;eO.y=eM;h8=eO;ex.list[((ir<<1)+2)*ex.width+iK]=h8}else{var hl=h8.x;var e0=h8.y;var ei;if(dr.zpp_pool==null){ei=new dr()}else{ei=dr.zpp_pool;dr.zpp_pool=ei.next;ei.next=null}ei.forced=false;ei.x=hl;ei.y=e0;h8=ei}if(g7){h8.forced=true}if(h8.x==fo||h8.x==fl){if(h8.x==fo&&(f7&64)!=0||h8.x==fl&&(f7&16)!=0){f7^=32}}}else{if(gu==3){h8=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(h8==null){var eZ=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var eh;if(dr.zpp_pool==null){eh=new dr()}else{eh=dr.zpp_pool;dr.zpp_pool=eh.next;eh.next=null}eh.forced=false;eh.x=fl;eh.y=eZ;h8=eh;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=h8}else{var hj=h8.x;var ew=h8.y;var eg;if(dr.zpp_pool==null){eg=new dr()}else{eg=dr.zpp_pool;dr.zpp_pool=eg.next;eg.next=null}eg.forced=false;eg.x=hj;eg.y=ew;h8=eg}if(g9){h8.forced=true}if(h8.y==eP||h8.y==eM){if(h8.y==eP&&(f7&4)!=0||h8.y==eM&&(f7&16)!=0){f7^=8}}}else{h8=ex.list[((ir<<1)+1)*ex.width+iK];if(h8==null){var et=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var ef;if(dr.zpp_pool==null){ef=new dr()}else{ef=dr.zpp_pool;dr.zpp_pool=ef.next;ef.next=null}ef.forced=false;ef.x=fo;ef.y=et;h8=ef;ex.list[((ir<<1)+1)*ex.width+iK]=h8}else{var hi=h8.x;var es=h8.y;var ee;if(dr.zpp_pool==null){ee=new dr()}else{ee=dr.zpp_pool;dr.zpp_pool=ee.next;ee.next=null}ee.forced=false;ee.x=hi;ee.y=es;h8=ee}if(ip){h8.forced=true}if(h8.y==eP||h8.y==eM){if(h8.y==eP&&(f7&1)!=0||h8.y==eM&&(f7&64)!=0){f7^=128}}}}}}}}}var gM=h8;if(gV.p1==null){gV.p1=gM.prev=gM.next=gM}else{gM.prev=gV.p1;gM.next=gV.p1.next;gV.p1.next.prev=gM;gV.p1.next=gM}gV.p1=gM}}gV.p1=gV.p1.next;gV.key1=f7;if(f7==1||f7==4||f7==16||f7==64||f7==3||f7==12||f7==48||f7==192||f7==129||f7==6||f7==24||f7==96||f7==5||f7==20||f7==80||f7==65||f7==17||f7==68){f7=0;gV.key1=0;gV.p1=null}if(f7!=0){var f5=14;gV.okey2=14;var ff=0;while(ff<8){var gt=ff++;if((f5&1<<gt)!=0){var h6=null;if(gt==0){var ed;if(dr.zpp_pool==null){ed=new dr()}else{ed=dr.zpp_pool;dr.zpp_pool=ed.next;ed.next=null}ed.forced=false;ed.x=fo;ed.y=eP;h6=ed;if(ip||io){h6.forced=true}}else{if(gt==2){var ec;if(dr.zpp_pool==null){ec=new dr()}else{ec=dr.zpp_pool;dr.zpp_pool=ec.next;ec.next=null}ec.forced=false;ec.x=fl;ec.y=eP;h6=ec;if(g9||io){h6.forced=true}}else{if(gt==4){var eb;if(dr.zpp_pool==null){eb=new dr()}else{eb=dr.zpp_pool;dr.zpp_pool=eb.next;eb.next=null}eb.forced=false;eb.x=fl;eb.y=eM;h6=eb;if(g9||g7){h6.forced=true}}else{if(gt==6){var ea;if(dr.zpp_pool==null){ea=new dr()}else{ea=dr.zpp_pool;dr.zpp_pool=ea.next;ea.next=null}ea.forced=false;ea.x=fo;ea.y=eM;h6=ea;if(ip||g7){h6.forced=true}}else{if(gt==1){h6=ex.list[(ir<<1)*ex.width+iK];if(h6==null){var hh=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var iJ;if(dr.zpp_pool==null){iJ=new dr()}else{iJ=dr.zpp_pool;dr.zpp_pool=iJ.next;iJ.next=null}iJ.forced=false;iJ.x=hh;iJ.y=eP;h6=iJ;ex.list[(ir<<1)*ex.width+iK]=h6}else{var hg=h6.x;var er=h6.y;var iC;if(dr.zpp_pool==null){iC=new dr()}else{iC=dr.zpp_pool;dr.zpp_pool=iC.next;iC.next=null}iC.forced=false;iC.x=hg;iC.y=er;h6=iC}if(io){h6.forced=true}if(h6.x==fo||h6.x==fl){if(h6.x==fo&&(f5&1)!=0||h6.x==fl&&(f5&4)!=0){f5^=2}}}else{if(gt==5){h6=ex.list[((ir<<1)+2)*ex.width+iK];if(h6==null){var hf=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var iB;if(dr.zpp_pool==null){iB=new dr()}else{iB=dr.zpp_pool;dr.zpp_pool=iB.next;iB.next=null}iB.forced=false;iB.x=hf;iB.y=eM;h6=iB;ex.list[((ir<<1)+2)*ex.width+iK]=h6}else{var he=h6.x;var eq=h6.y;var iA;if(dr.zpp_pool==null){iA=new dr()}else{iA=dr.zpp_pool;dr.zpp_pool=iA.next;iA.next=null}iA.forced=false;iA.x=he;iA.y=eq;h6=iA}if(g7){h6.forced=true}if(h6.x==fo||h6.x==fl){if(h6.x==fo&&(f5&64)!=0||h6.x==fl&&(f5&16)!=0){f5^=32}}}else{if(gt==3){h6=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(h6==null){var ep=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var iz;if(dr.zpp_pool==null){iz=new dr()}else{iz=dr.zpp_pool;dr.zpp_pool=iz.next;iz.next=null}iz.forced=false;iz.x=fl;iz.y=ep;h6=iz;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=h6}else{var hd=h6.x;var eo=h6.y;var iy;if(dr.zpp_pool==null){iy=new dr()}else{iy=dr.zpp_pool;dr.zpp_pool=iy.next;iy.next=null}iy.forced=false;iy.x=hd;iy.y=eo;h6=iy}if(g9){h6.forced=true}if(h6.y==eP||h6.y==eM){if(h6.y==eP&&(f5&4)!=0||h6.y==eM&&(f5&16)!=0){f5^=8}}}else{h6=ex.list[((ir<<1)+1)*ex.width+iK];if(h6==null){var em=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var ix;if(dr.zpp_pool==null){ix=new dr()}else{ix=dr.zpp_pool;dr.zpp_pool=ix.next;ix.next=null}ix.forced=false;ix.x=fo;ix.y=em;h6=ix;ex.list[((ir<<1)+1)*ex.width+iK]=h6}else{var hc=h6.x;var el=h6.y;var iw;if(dr.zpp_pool==null){iw=new dr()}else{iw=dr.zpp_pool;dr.zpp_pool=iw.next;iw.next=null}iw.forced=false;iw.x=hc;iw.y=el;h6=iw}if(ip){h6.forced=true}if(h6.y==eP||h6.y==eM){if(h6.y==eP&&(f5&1)!=0||h6.y==eM&&(f5&64)!=0){f5^=128}}}}}}}}}var gL=h6;if(gV.p2==null){gV.p2=gL.prev=gL.next=gL}else{gL.prev=gV.p2;gL.next=gV.p2.next;gV.p2.next.prev=gL;gV.p2.next=gL}gV.p2=gL}}gV.p2=gV.p2.next;gV.key2=f5;if(f5==1||f5==4||f5==16||f5==64||f5==3||f5==12||f5==48||f5==192||f5==129||f5==6||f5==24||f5==96||f5==5||f5==20||f5==80||f5==65||f5==17||f5==68){f5=0;gV.key2=0;gV.p2=null}if(f5==0){gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}else{gV.pr=gV.p2;gV.okeyr=gV.okey2;gV.keyr=gV.key2}}else{var f3=14;gV.okey1=14;var fd=0;while(fd<8){var gs=fd++;if((f3&1<<gs)!=0){var h3=null;if(gs==0){var iv;if(dr.zpp_pool==null){iv=new dr()}else{iv=dr.zpp_pool;dr.zpp_pool=iv.next;iv.next=null}iv.forced=false;iv.x=fo;iv.y=eP;h3=iv;if(ip||io){h3.forced=true}}else{if(gs==2){var iu;if(dr.zpp_pool==null){iu=new dr()}else{iu=dr.zpp_pool;dr.zpp_pool=iu.next;iu.next=null}iu.forced=false;iu.x=fl;iu.y=eP;h3=iu;if(g9||io){h3.forced=true}}else{if(gs==4){var iq;if(dr.zpp_pool==null){iq=new dr()}else{iq=dr.zpp_pool;dr.zpp_pool=iq.next;iq.next=null}iq.forced=false;iq.x=fl;iq.y=eM;h3=iq;if(g9||g7){h3.forced=true}}else{if(gs==6){var eN;if(dr.zpp_pool==null){eN=new dr()}else{eN=dr.zpp_pool;dr.zpp_pool=eN.next;eN.next=null}eN.forced=false;eN.x=fo;eN.y=eM;h3=eN;if(ip||g7){h3.forced=true}}else{if(gs==1){h3=ex.list[(ir<<1)*ex.width+iK];if(h3==null){var hb=this.xlerp(fo,fl,eP,gi,gg,iD,gS);var eL;if(dr.zpp_pool==null){eL=new dr()}else{eL=dr.zpp_pool;dr.zpp_pool=eL.next;eL.next=null}eL.forced=false;eL.x=hb;eL.y=eP;h3=eL;ex.list[(ir<<1)*ex.width+iK]=h3}else{var gZ=h3.x;var ek=h3.y;var eJ;if(dr.zpp_pool==null){eJ=new dr()}else{eJ=dr.zpp_pool;dr.zpp_pool=eJ.next;eJ.next=null}eJ.forced=false;eJ.x=gZ;eJ.y=ek;h3=eJ}if(io){h3.forced=true}if(h3.x==fo||h3.x==fl){if(h3.x==fo&&(f3&1)!=0||h3.x==fl&&(f3&4)!=0){f3^=2}}}else{if(gs==5){h3=ex.list[((ir<<1)+2)*ex.width+iK];if(h3==null){var gX=this.xlerp(fo,fl,eM,gd,gf,iD,gS);var eH;if(dr.zpp_pool==null){eH=new dr()}else{eH=dr.zpp_pool;dr.zpp_pool=eH.next;eH.next=null}eH.forced=false;eH.x=gX;eH.y=eM;h3=eH;ex.list[((ir<<1)+2)*ex.width+iK]=h3}else{var gW=h3.x;var iI=h3.y;var eF;if(dr.zpp_pool==null){eF=new dr()}else{eF=dr.zpp_pool;dr.zpp_pool=eF.next;eF.next=null}eF.forced=false;eF.x=gW;eF.y=iI;h3=eF}if(g7){h3.forced=true}if(h3.x==fo||h3.x==fl){if(h3.x==fo&&(f3&64)!=0||h3.x==fl&&(f3&16)!=0){f3^=32}}}else{if(gs==3){h3=ex.list[((ir<<1)+1)*ex.width+(iK+1)];if(h3==null){var iH=this.ylerp(eP,eM,fl,gg,gf,iD,gS);var eD;if(dr.zpp_pool==null){eD=new dr()}else{eD=dr.zpp_pool;dr.zpp_pool=eD.next;eD.next=null}eD.forced=false;eD.x=fl;eD.y=iH;h3=eD;ex.list[((ir<<1)+1)*ex.width+(iK+1)]=h3}else{var gU=h3.x;var iG=h3.y;var eB;if(dr.zpp_pool==null){eB=new dr()}else{eB=dr.zpp_pool;dr.zpp_pool=eB.next;eB.next=null}eB.forced=false;eB.x=gU;eB.y=iG;h3=eB}if(g9){h3.forced=true}if(h3.y==eP||h3.y==eM){if(h3.y==eP&&(f3&4)!=0||h3.y==eM&&(f3&16)!=0){f3^=8}}}else{h3=ex.list[((ir<<1)+1)*ex.width+iK];if(h3==null){var iF=this.ylerp(eP,eM,fo,gi,gd,iD,gS);var ez;if(dr.zpp_pool==null){ez=new dr()}else{ez=dr.zpp_pool;dr.zpp_pool=ez.next;ez.next=null}ez.forced=false;ez.x=fo;ez.y=iF;h3=ez;ex.list[((ir<<1)+1)*ex.width+iK]=h3}else{var gT=h3.x;var iE=h3.y;var ev;if(dr.zpp_pool==null){ev=new dr()}else{ev=dr.zpp_pool;dr.zpp_pool=ev.next;ev.next=null}ev.forced=false;ev.x=gT;ev.y=iE;h3=ev}if(ip){h3.forced=true}if(h3.y==eP||h3.y==eM){if(h3.y==eP&&(f3&1)!=0||h3.y==eM&&(f3&64)!=0){f3^=128}}}}}}}}}var gK=h3;if(gV.p1==null){gV.p1=gK.prev=gK.next=gK}else{gK.prev=gV.p1;gK.next=gV.p1.next;gV.p1.next.prev=gK;gV.p1.next=gK}gV.p1=gK}}gV.p1=gV.p1.next;gV.key1=f3;if(f3==1||f3==4||f3==16||f3==64||f3==3||f3==12||f3==48||f3==192||f3==129||f3==6||f3==24||f3==96||f3==5||f3==20||f3==80||f3==65||f3==17||f3==68){f3=0;gV.key1=0;gV.p1=null}if(f3==0){gV=null}else{gV.pr=gV.p1;gV.okeyr=gV.okey1;gV.keyr=gV.key1}}}}}return gV}};bc.prototype.lerp=function(ee,eb,ea,ef){if(ea==0){return ee}else{if(ef==0){return eb}else{var ed=ea-ef;var ec=ed*ed<P.epsilon*P.epsilon?0.5:ea/ed;if(ec<0){ec=0}else{if(ec>1){ec=1}}return ee+ec*(eb-ee)}}};bc.prototype.xlerp=function(ec,eb,eh,ek,ei,em,ej){var ef;if(ek==0){ef=ec}else{if(ei==0){ef=eb}else{var ea=ek-ei;var el=ea*ea<P.epsilon*P.epsilon?0.5:ek/ea;if(el<0){el=0}else{if(el>1){el=1}}ef=ec+el*(eb-ec)}}while(ej--!=0&&ec<ef&&ef<eb){var ed=em(ef,eh);if(ed==0){break}if(ek*ed<0){eb=ef;ei=ed}else{ec=ef;ek=ed}if(ek==0){ef=ec}else{if(ei==0){ef=eb}else{var eg=ek-ei;var ee=eg*eg<P.epsilon*P.epsilon?0.5:ek/eg;if(ee<0){ee=0}else{if(ee>1){ee=1}}ef=ec+ee*(eb-ec)}}}return ef};bc.prototype.ylerp=function(ei,ef,eg,ek,eh,em,ej){var eb;if(ek==0){eb=ei}else{if(eh==0){eb=ef}else{var ea=ek-eh;var el=ea*ea<P.epsilon*P.epsilon?0.5:ek/ea;if(el<0){el=0}else{if(el>1){el=1}}eb=ei+el*(ef-ei)}}while(ej--!=0&&ei<eb&&eb<ef){var ec=em(eg,eb);if(ec==0){break}if(ek*ec<0){ef=eb;eh=ec}else{ei=eb;ek=ec}if(ek==0){eb=ei}else{if(eh==0){eb=ef}else{var ee=ek-eh;var ed=ee*ee<P.epsilon*P.epsilon?0.5:ek/ee;if(ed<0){ed=0}else{if(ed>1){ed=1}}eb=ei+ed*(ef-ei)}}}return eb};bc.prototype.__class__=bc;var cm=zpp_nape.geom.ZPP_Mat23=function(){this.next=null;this._invalidate=null;this.ty=0;this.tx=0;this.d=0;this.c=0;this.b=0;this.a=0;this.outer=null};cm.__name__=["zpp_nape","geom","ZPP_Mat23"];cm.get=function(){var ea;if(cm.zpp_pool==null){ea=new cm()}else{ea=cm.zpp_pool;cm.zpp_pool=ea.next;ea.next=null}return ea};cm.identity=function(){var ea=cm.get();ea.setas(1,0,0,1,0,0);return ea};cm.prototype.outer=null;cm.prototype.wrapper=function(){if(this.outer==null){this.outer=new cI();var ea=this.outer.zpp_inner;ea.next=cm.zpp_pool;cm.zpp_pool=ea;this.outer.zpp_inner=this}return this.outer};cm.prototype.a=null;cm.prototype.b=null;cm.prototype.c=null;cm.prototype.d=null;cm.prototype.tx=null;cm.prototype.ty=null;cm.prototype._invalidate=null;cm.prototype.invalidate=function(){if(this._invalidate!=null){this._invalidate()}};cm.prototype.set=function(ea){this.setas(ea.a,ea.b,ea.c,ea.d,ea.tx,ea.ty)};cm.prototype.setas=function(ed,eb,ef,ee,ec,ea){this.tx=ec;this.ty=ea;this.a=ed;this.b=eb;this.c=ef;this.d=ee};cm.prototype.next=null;cm.prototype.free=function(){};cm.prototype.alloc=function(){};cm.prototype.__class__=cm;var bI=zpp_nape.geom.ZPP_MatMN=function(ea,ed){this.x=null;this.n=0;this.m=0;this.outer=null;this.m=ea;this.n=ed;this.x=[];var eb=0;var ec=ea*ed;while(eb<ec){++eb;this.x.push(0)}};bI.__name__=["zpp_nape","geom","ZPP_MatMN"];bI.prototype.outer=null;bI.prototype.m=null;bI.prototype.n=null;bI.prototype.x=null;bI.prototype.__class__=bI;var aE=zpp_nape.geom.ZPP_Monotone=function(){};aE.__name__=["zpp_nape","geom","ZPP_Monotone"];aE.bisector=function(ei){var ej=ei.prev;var ee=ei.next;var ec=0;var ea=0;ec=ei.x-ej.x;ea=ei.y-ej.y;var eh=0;var ef=0;eh=ee.x-ei.x;ef=ee.y-ei.y;var ed;if(bB.zpp_pool==null){ed=new bB()}else{ed=bB.zpp_pool;bB.zpp_pool=ed.next;ed.next=null}ed.weak=false;ed._immutable=false;ed.x=-ea-ef;ed.y=ec+eh;var eg=ed;var eb=1/Math.sqrt(eg.x*eg.x+eg.y*eg.y);eg.x*=eb;eg.y*=eb;if(ef*ec-eh*ea<0){eg.x=-eg.x;eg.y=-eg.y}return eg};aE.below=function(ee,ed){if(ee.y<ed.y){return true}else{if(ee.y>ed.y){return false}else{if(ee.x<ed.x){return true}else{if(ee.x>ed.x){return false}else{var ea=aE.bisector(ee);var ec=aE.bisector(ed);ea.x+=ee.x;ea.y+=ee.y;ec.x+=ed.x;ec.y+=ed.y;var eb=ea.x<ec.x||ea.x==ec.x&&ea.y<ec.y;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec;return eb}}}}};aE.above=function(eb,ea){return aE.below(ea,eb)};aE.left_vertex=function(eb){var ea=eb.prev;if(!(ea.y>eb.y)){if(ea.y==eb.y){return eb.next.y<eb.y}else{return false}}else{return true}};aE.isMonotone=function(eh){var ed=eh;var ek=eh;var eo=eh.next;if(eo!=null){var ec=eo;while(true){var ea=ec;if(ea.y<ed.y){ed=ea}if(ea.y>ek.y){ek=ea}ec=ec.next;if(!(ec!=eh)){break}}}var ei=true;var eb=ed;if(ek!=ed.next){var eg=ed.next;var ej=ek;if(eg!=null){var ep=eg;while(true){var em=ep;if(em.y<eb.y){ei=false;break}eb=em;ep=ep.next;if(!(ep!=ej)){break}}}}if(!ei){return false}eb=ed;if(ek!=ed.prev){var ef=ed.prev;var ee=ek;if(ef!=null){var en=ef;while(true){var el=en;if(el.y<eb.y){ei=false;break}eb=el;en=en.prev;if(!(en!=ee)){break}}}}return ei};aE.sharedPPoly=null;aE.getShared=function(){if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}return aE.sharedPPoly};aE.decompose=function(ee,ey){if(ey==null){ey=new a(ee)}else{ey.init(ee)}if(ey.vertices==null){return ey}if(aE.queue==null){aE.queue=new dO()}var ei=ey.vertices;var ef=ey.vertices;if(ei!=null){var eb=ei;while(true){var eG=eb;aE.queue.add(eG);var eu=0;var et=0;eu=eG.next.x-eG.x;et=eG.next.y-eG.y;var eh=0;var eg=0;eh=eG.prev.x-eG.x;eg=eG.prev.y-eG.y;var en=eg*eu-eh*et>0;eG.type=aE.below(eG.prev,eG)?aE.below(eG.next,eG)?en?0:3:4:aE.below(eG,eG.next)?en?1:2:4;eb=eb.next;if(!(eb!=ef)){break}}}var eq=aE.queue;if(eq.head!=null&&eq.head.next!=null){var ej=eq.head;var eK=null;var ed=null;var eF=null;var eI=null;var em=1;var ec;var eA;var ea;while(true){ec=0;ed=ej;ej=null;eK=ej;while(ed!=null){++ec;eF=ed;eA=0;ea=em;while(eF!=null&&eA<em){++eA;eF=eF.next}while(eA>0||ea>0&&eF!=null){if(eA==0){eI=eF;eF=eF.next;--ea}else{if(ea==0||eF==null){eI=ed;ed=ed.next;--eA}else{if(aE.above(ed.elt,eF.elt)){eI=ed;ed=ed.next;--eA}else{eI=eF;eF=eF.next;--ea}}}if(eK!=null){eK.next=eI}else{ej=eI}eK=eI}ed=eF}eK.next=null;em<<=1;if(!(ec>1)){break}}eq.head=ej;eq.modified=true;eq.pushmod=true}if(aE.edges==null){if(b8.zpp_pool==null){aE.edges=new b8()}else{aE.edges=b8.zpp_pool;b8.zpp_pool=aE.edges.next;aE.edges.next=null}aE.edges.lt=ah.edge_lt;aE.edges.swapped=ah.edge_swap}while(aE.queue.head!=null){var eD=aE.queue.pop_unsafe();switch(eD.type){case 0:eD.helper=eD;eD.node=aE.edges.insert(eD);break;case 1:var eJ=eD.prev;if(eJ.helper.type==2){ey.add_diagonal(eD,eJ.helper)}aE.edges.remove_node(eJ.node);break;case 2:var es=eD.prev;if(es.helper.type==2){ey.add_diagonal(eD,es.helper)}aE.edges.remove_node(es.node);var ez=null;if(!aE.edges.empty()){var ew=aE.edges.parent;while(ew.prev!=null){ew=ew.prev}while(ew!=null){var eH=ew.data;if(!ah.vert_lt(eH,eD)){ez=eH;break}if(ew.next!=null){ew=ew.next;while(ew.prev!=null){ew=ew.prev}}else{while(ew.parent!=null&&ew==ew.parent.next){ew=ew.parent}ew=ew.parent}}}var er=ez;if(er!=null){if(er.helper.type==2){ey.add_diagonal(eD,er.helper)}er.helper=eD}break;case 3:var eC=null;if(!aE.edges.empty()){var el=aE.edges.parent;while(el.prev!=null){el=el.prev}while(el!=null){var ex=el.data;if(!ah.vert_lt(ex,eD)){eC=ex;break}if(el.next!=null){el=el.next;while(el.prev!=null){el=el.prev}}else{while(el.parent!=null&&el==el.parent.next){el=el.parent}el=el.parent}}}var ep=eC;if(ep!=null){ey.add_diagonal(eD,ep.helper);ep.helper=eD}eD.node=aE.edges.insert(eD);eD.helper=eD;break;case 4:var eE=eD.prev;if(aE.left_vertex(eD)){if(eE.helper.type==2){ey.add_diagonal(eD,eE.helper)}aE.edges.remove_node(eE.node);eD.node=aE.edges.insert(eD);eD.helper=eD}else{var eB=null;if(!aE.edges.empty()){var ek=aE.edges.parent;while(ek.prev!=null){ek=ek.prev}while(ek!=null){var ev=ek.data;if(!ah.vert_lt(ev,eD)){eB=ev;break}if(ek.next!=null){ek=ek.next;while(ek.prev!=null){ek=ek.prev}}else{while(ek.parent!=null&&ek==ek.parent.next){ek=ek.parent}ek=ek.parent}}}var eo=eB;if(eo.helper.type==2){ey.add_diagonal(eD,eo.helper)}eo.helper=eD}break}}return ey};aE.prototype.__class__=aE;var ah=zpp_nape.geom.ZPP_PartitionVertex=function(){this.node=null;this.prev=null;this.next=null;this.rightchain=false;this.helper=null;this.type=0;this.diagonals=null;this.forced=false;this.y=0;this.x=0;this.mag=0;this.id=0;this.id=ah.nextId++;this.diagonals=new dO()};ah.__name__=["zpp_nape","geom","ZPP_PartitionVertex"];ah.get=function(ea){var eb;if(ah.zpp_pool==null){eb=new ah()}else{eb=ah.zpp_pool;ah.zpp_pool=eb.next;eb.next=null}eb.x=ea.x;eb.y=ea.y;return eb};ah.rightdistance=function(ef,eb){var eg=ef.next.y>ef.y;var ec=0;var ea=0;ec=ef.next.x-ef.x;ea=ef.next.y-ef.y;var ee=0;var ed=0;ee=eb.x-ef.x;ed=eb.y-ef.y;return(eg?-1:1)*(ed*ec-ee*ea)};ah.vert_lt=function(ec,eb){if(eb==ec||eb==ec.next){return true}else{if(ec.y==ec.next.y){var ea=ec.x;var ed=ec.next.x;return(ea<ed?ea:ed)<=eb.x}else{return ah.rightdistance(ec,eb)<=0}}};ah.edge_swap=function(ec,eb){var ea=ec.node;ec.node=eb.node;eb.node=ea};ah.edge_lt=function(ee,ed){if(ee==ed&&ee.next==ed.next){return false}if(ee==ed.next){return !ah.vert_lt(ee,ed)}else{if(ed==ee.next){return ah.vert_lt(ed,ee)}else{if(ee.y==ee.next.y){if(ed.y==ed.next.y){var eo=ee.x;var em=ee.next.x;var ei=eo>em?eo:em;var ef=ed.x;var en=ed.next.x;return ei>(ef>en?ef:en)}else{if(!(ah.rightdistance(ed,ee)>0)){return ah.rightdistance(ed,ee.next)>0}else{return true}}}else{var eg=ah.rightdistance(ee,ed);var ej=ah.rightdistance(ee,ed.next);if(eg==0&&ej==0){var ec=ee.x;var el=ee.next.x;var eh=ec>el?ec:el;var eb=ed.x;var ek=ed.next.x;return eh>(eb>ek?eb:ek)}if(eg*ej>=0){if(!(eg<0)){return ej<0}else{return true}}var ep=ah.rightdistance(ed,ee);var ea=ah.rightdistance(ed,ee.next);if(ep*ea>=0){if(!(ep>0)){return ea>0}else{return true}}return false}}}};ah.prototype.id=null;ah.prototype.mag=null;ah.prototype.x=null;ah.prototype.y=null;ah.prototype.forced=null;ah.prototype.diagonals=null;ah.prototype.type=null;ah.prototype.helper=null;ah.prototype.rightchain=null;ah.prototype.next=null;ah.prototype.prev=null;ah.prototype.alloc=function(){};ah.prototype.free=function(){this.helper=null};ah.prototype.copy=function(){var ea;if(ah.zpp_pool==null){ea=new ah()}else{ea=ah.zpp_pool;ah.zpp_pool=ea.next;ea.next=null}ea.x=this.x;ea.y=this.y;ea.forced=this.forced;return ea};ah.prototype.sort=function(){var ej=0;var eh=0;var ep=0;var eo=0;ej=this.prev.x-this.x;eh=this.prev.y-this.y;ep=this.next.x-this.x;eo=this.next.y-this.y;var ex=eo*ej-ep*eh;var em=ex>0?-1:ex==0?0:1;var eq=this.diagonals;if(eq.head!=null&&eq.head.next!=null){var eg=eq.head;var en=null;var eb=null;var et=null;var ee=null;var ea=1;var es;var er;var ed;while(true){es=0;eb=eg;eg=null;en=eg;while(eb!=null){++es;et=eb;er=0;ed=ea;while(et!=null&&er<ea){++er;et=et.next}while(er>0||ed>0&&et!=null){if(er==0){ee=et;et=et.next;--ed}else{if(ed==0||et==null){ee=eb;eb=eb.next;--er}else{var eu;if(em==1){ej=eb.elt.x-this.x;eh=eb.elt.y-this.y;ep=et.elt.x-this.x;eo=et.elt.y-this.y;var el=eo*ej-ep*eh;eu=(el>0?-1:el==0?0:1)==1}else{ej=this.prev.x-this.x;eh=this.prev.y-this.y;ep=eb.elt.x-this.x;eo=eb.elt.y-this.y;var ei=eo*ej-ep*eh;var ey=ei>0?-1:ei==0?0:1;ej=this.prev.x-this.x;eh=this.prev.y-this.y;ep=et.elt.x-this.x;eo=et.elt.y-this.y;var ef=eo*ej-ep*eh;var ew=ef>0?-1:ef==0?0:1;if(ey*ew==1||ey*ew==0&&(ey==1||ew==1)){ej=eb.elt.x-this.x;eh=eb.elt.y-this.y;ep=et.elt.x-this.x;eo=et.elt.y-this.y;var ec=eo*ej-ep*eh;eu=(ec>0?-1:ec==0?0:1)==1}else{if(ey==-1||ew==-1){eu=ew==-1}else{if(ey==0&&ew==0){ej=this.x-this.prev.x;eh=this.y-this.prev.y;ep=eb.elt.x-this.x;eo=eb.elt.y-this.y;var ev=ej*ep+eh*eo;ep=et.elt.x-this.x;eo=et.elt.y-this.y;var ek=ej*ep+eh*eo;if(ev<0&&ek>0){eu=true}else{if(ek<0&&ev>0){eu=false}else{eu=true}}}else{eu=true}}}}if(eu){ee=eb;eb=eb.next;--er}else{ee=et;et=et.next;--ed}}}if(en!=null){en.next=ee}else{eg=ee}en=ee}eb=et}en.next=null;ea<<=1;if(!(es>1)){break}}eq.head=eg;eq.modified=true;eq.pushmod=true}};ah.prototype.node=null;ah.prototype.__class__=ah;var a=zpp_nape.geom.ZPP_PartitionedPoly=function(ea){this.next=null;this.vertices=null;this.init(ea)};a.__name__=["zpp_nape","geom","ZPP_PartitionedPoly"];a.sharedPPList=null;a.getSharedPP=function(){if(a.sharedPPList==null){a.sharedPPList=new bu()}return a.sharedPPList};a.sharedGVList=null;a.getShared=function(){if(a.sharedGVList==null){a.sharedGVList=new dA()}return a.sharedGVList};a.prototype.vertices=null;a.prototype.eq=function(ec,ea){var ef=ec.x;var ee=ec.y;var eh=ea.x;var eg=ea.y;var ed=0;var eb=0;ed=ef-eh;eb=ee-eg;return ed*ed+eb*eb<P.epsilon*P.epsilon};a.prototype.next=null;a.prototype.alloc=function(){};a.prototype.free=function(){};a.prototype.init=function(eh){if(eh==null){return}var eb=0;if(eh!=null){var ed=eh;while(true){var ek=ed;eb+=ek.x*(ek.next.y-ek.prev.y);ed=ed.next;if(!(ed!=eh)){break}}}var ee=eb*0.5>0;var ea=eh;while(true){var eg;if(ee){var ei;if(ah.zpp_pool==null){ei=new ah()}else{ei=ah.zpp_pool;ah.zpp_pool=ei.next;ei.next=null}ei.x=ea.x;ei.y=ea.y;var ef=ei;if(this.vertices==null){this.vertices=ef.prev=ef.next=ef}else{ef.prev=this.vertices;ef.next=this.vertices.next;this.vertices.next.prev=ef;this.vertices.next=ef}eg=ef}else{var ej;if(ah.zpp_pool==null){ej=new ah()}else{ej=ah.zpp_pool;ah.zpp_pool=ej.next;ej.next=null}ej.x=ea.x;ej.y=ea.y;var ec=ej;if(this.vertices==null){this.vertices=ec.prev=ec.next=ec}else{ec.next=this.vertices;ec.prev=this.vertices.prev;this.vertices.prev.next=ec;this.vertices.prev=ec}eg=ec}this.vertices=eg;this.vertices.forced=ea.forced;ea=ea.next;if(!(ea!=eh)){break}}this.remove_collinear_vertices()};a.prototype.remove_collinear_vertices=function(){var ec=this.vertices;var em=true;while(em||ec!=this.vertices){em=false;if(this.eq(ec,ec.next)){if(ec==this.vertices){this.vertices=ec.next;em=true}if(ec.forced){ec.next.forced=true}if(ec!=null&&ec.prev==ec){ec.next=ec.prev=null;var ee=ec;ee.helper=null;ee.next=ah.zpp_pool;ah.zpp_pool=ee;ec=null;ec=ec}else{var en=ec.next;ec.prev.next=ec.next;ec.next.prev=ec.prev;ec.next=ec.prev=null;var eg=ec;eg.helper=null;eg.next=ah.zpp_pool;ah.zpp_pool=eg;ec=null;ec=en}if(ec==null){this.vertices=null;break}}else{ec=ec.next}}if(this.vertices==null){return true}var ei;while(true){ei=false;ec=this.vertices;em=true;while(em||ec!=this.vertices){em=false;var eh=ec.prev;var eb=0;var ea=0;eb=ec.x-eh.x;ea=ec.y-eh.y;var ek=0;var ej=0;ek=ec.next.x-ec.x;ej=ec.next.y-ec.y;var el=ej*eb-ek*ea;if(el*el>=P.epsilon*P.epsilon){ec=ec.next}else{if(ec==this.vertices){this.vertices=ec.next;em=true}if(ec!=null&&ec.prev==ec){ec.next=ec.prev=null;var ef=ec;ef.helper=null;ef.next=ah.zpp_pool;ah.zpp_pool=ef;ec=null;ec=ec}else{var eo=ec.next;ec.prev.next=ec.next;ec.next.prev=ec.prev;ec.next=ec.prev=null;var ed=ec;ed.helper=null;ed.next=ah.zpp_pool;ah.zpp_pool=ed;ec=null;ec=eo}ei=true;if(ec==null){ei=false;this.vertices=null;break}}}if(!ei){break}}return this.vertices==null};a.prototype.add_diagonal=function(eb,ea){eb.diagonals.add(ea);ea.diagonals.add(eb);eb.forced=ea.forced=true};a.prototype.extract_partitions=function(eg){if(eg==null){eg=new bu()}if(this.vertices!=null){var ej=this.vertices;var eh=this.vertices;if(ej!=null){var ee=ej;while(true){ee.sort();ee=ee.next;if(!(ee!=eh)){break}}}this.pull_partitions(this.vertices,eg);while(this.vertices!=null){var ef;if(this.vertices!=null&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var ea=this.vertices;ea.helper=null;ea.next=ah.zpp_pool;ah.zpp_pool=ea;ef=this.vertices=null}else{var ei=this.vertices.next;this.vertices.prev.next=this.vertices.next;this.vertices.next.prev=this.vertices.prev;this.vertices.next=this.vertices.prev=null;var ec=this.vertices;ec.helper=null;ec.next=ah.zpp_pool;ah.zpp_pool=ec;this.vertices=null;ef=ei}this.vertices=ef}var ed=null;var eb=eg.head;while(eb!=null){if(eb.elt.remove_collinear_vertices()){eg.erase(ed);continue}ed=eb;eb=eb.next}}return eg};a.prototype.pull_partitions=function(ec,eh){var ea;if(a.zpp_pool==null){ea=new a()}else{ea=a.zpp_pool;a.zpp_pool=ea.next;ea.next=null}var ef=ec;while(true){var ek;if(ah.zpp_pool==null){ek=new ah()}else{ek=ah.zpp_pool;ah.zpp_pool=ek.next;ek.next=null}ek.x=ef.x;ek.y=ef.y;ek.forced=ef.forced;var ee=ek;if(ea.vertices==null){ea.vertices=ee.prev=ee.next=ee}else{ee.prev=ea.vertices;ee.next=ea.vertices.next;ea.vertices.next.prev=ee;ea.vertices.next=ee}ea.vertices=ee;ea.vertices.forced=ef.forced;if(ef.diagonals.head!=null){var eg=ef.diagonals;var ej=eg.head.elt;eg.pop();if(ej==ec){break}else{ef=this.pull_partitions(ef,eh)}}else{ef=ef.next}if(!(ef!=ec)){break}}var eb=0;var em=ea.vertices;var ei=ea.vertices;if(em!=null){var ed=em;while(true){var el=ed;eb+=el.x*(el.next.y-el.prev.y);ed=ed.next;if(!(ed!=ei)){break}}}if(eb*0.5!=0){eh.add(ea)}return ef};a.prototype.extract=function(eb){if(eb==null){eb=new dA()}if(this.vertices!=null){var ed=this.vertices;var ea=this.vertices;if(ed!=null){var ef=ed;while(true){ef.sort();ef=ef.next;if(!(ef!=ea)){break}}}this.pull(this.vertices,eb);while(this.vertices!=null){var ec;if(this.vertices!=null&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var eh=this.vertices;eh.helper=null;eh.next=ah.zpp_pool;ah.zpp_pool=eh;ec=this.vertices=null}else{var eg=this.vertices.next;this.vertices.prev.next=this.vertices.next;this.vertices.next.prev=this.vertices.prev;this.vertices.next=this.vertices.prev=null;var ee=this.vertices;ee.helper=null;ee.next=ah.zpp_pool;ah.zpp_pool=ee;this.vertices=null;ec=eg}this.vertices=ec}}return eb};a.prototype.pull=function(ec,eG){var eg=null;var ex=ec;while(true){var em=ex.x;var ek=ex.y;var eh;if(dr.zpp_pool==null){eh=new dr()}else{eh=dr.zpp_pool;dr.zpp_pool=eh.next;eh.next=null}eh.forced=false;eh.x=em;eh.y=ek;var es=eh;if(eg==null){eg=es.prev=es.next=es}else{es.prev=eg;es.next=eg.next;eg.next.prev=es;eg.next=es}eg=es;es.forced=ex.forced;if(ex.diagonals.head!=null){var eA=ex.diagonals;var ef=eA.head.elt;eA.pop();if(ef==ec){break}else{ex=this.pull(ex,eG)}}else{ex=ex.next}if(!(ex!=ec)){break}}var eF=0;var er=eg;var ej=eg;if(er!=null){var eE=er;while(true){var eq=eE;eF+=eq.x*(eq.next.y-eq.prev.y);eE=eE.next;if(!(eE!=ej)){break}}}var ez=eF*0.5;if(ez*ez>=P.epsilon*P.epsilon){var ew=eg;var ey=true;while(ey||ew!=eg){ey=false;var eo=ew.x;var el=ew.y;var eD=ew.next.x;var eB=ew.next.y;var ep=0;var en=0;ep=eo-eD;en=el-eB;if(ep*ep+en*en<P.epsilon*P.epsilon){if(ew==eg){eg=ew.next;ey=true}if(ew.forced){ew.next.forced=true}if(ew!=null&&ew.prev==ew){ew.next=ew.prev=null;ew=null;ew=ew}else{var ei=ew.next;ew.prev.next=ew.next;ew.next.prev=ew.prev;ew.next=ew.prev=null;ew=null;ew=ei}if(ew==null){eg=null;break}}else{ew=ew.next}}if(eg!=null){var eC;while(true){eC=false;ew=eg;ey=true;while(ey||ew!=eg){ey=false;var ev=ew.prev;var ee=0;var ed=0;ee=ew.x-ev.x;ed=ew.y-ev.y;var eu=0;var et=0;eu=ew.next.x-ew.x;et=ew.next.y-ew.y;var eb=et*ee-eu*ed;if(eb*eb>=P.epsilon*P.epsilon){ew=ew.next}else{if(ew==eg){eg=ew.next;ey=true}if(ew!=null&&ew.prev==ew){ew.next=ew.prev=null;ew=null;ew=ew}else{var ea=ew.next;ew.prev.next=ew.next;ew.next.prev=ew.prev;ew.next=ew.prev=null;ew=null;ew=ea}eC=true;if(ew==null){eC=false;eg=null;break}}}if(!eC){break}}}if(eg!=null){eG.add(eg)}}return ex};a.prototype.__class__=a;var bf=zpp_nape.geom.ZPP_Ray=function(){this.zip_dir=false;this.absnormaly=0;this.absnormalx=0;this.normaly=0;this.normalx=0;this.idiry=0;this.idirx=0;this.diry=0;this.dirx=0;this.originy=0;this.originx=0;this.userData=null;this.maxdist=0;this.direction=null;this.origin=null;var eh;if(au.poolVec2==null){eh=new r()}else{eh=au.poolVec2;au.poolVec2=eh.zpp_pool;eh.zpp_pool=null}if(eh.zpp_inner==null){var el;if(bB.zpp_pool==null){el=new bB()}else{el=bB.zpp_pool;bB.zpp_pool=el.next;el.next=null}el.weak=false;el._immutable=false;el.x=0;el.y=0;eh.zpp_inner=el;eh.zpp_inner.outer=eh}else{var eb;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}if(eh.zpp_inner.x==0){var ei=eh.zpp_inner;if(ei._validate!=null){ei._validate()}eb=eh.zpp_inner.y==0}else{eb=false}if(!eb){eh.zpp_inner.x=0;eh.zpp_inner.y=0;var eg=eh.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}}eh.zpp_inner.weak=false;this.origin=eh;this.origin.zpp_inner._invalidate=dX(this,this.origin_invalidate);var ek;if(au.poolVec2==null){ek=new r()}else{ek=au.poolVec2;au.poolVec2=ek.zpp_pool;ek.zpp_pool=null}if(ek.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=0;ej.y=0;ek.zpp_inner=ej;ek.zpp_inner.outer=ek}else{var ea;var ee=ek.zpp_inner;if(ee._validate!=null){ee._validate()}if(ek.zpp_inner.x==0){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ek.zpp_inner.y==0}else{ea=false}if(!ea){ek.zpp_inner.x=0;ek.zpp_inner.y=0;var ec=ek.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}ek.zpp_inner.weak=false;this.direction=ek;this.direction.zpp_inner._invalidate=dX(this,this.direction_invalidate);this.originx=0;this.originy=0;this.dirx=0;this.diry=0;this.zip_dir=false};bf.__name__=["zpp_nape","geom","ZPP_Ray"];bf.prototype.origin=null;bf.prototype.direction=null;bf.prototype.maxdist=null;bf.prototype.userData=null;bf.prototype.originx=null;bf.prototype.originy=null;bf.prototype.dirx=null;bf.prototype.diry=null;bf.prototype.idirx=null;bf.prototype.idiry=null;bf.prototype.normalx=null;bf.prototype.normaly=null;bf.prototype.absnormalx=null;bf.prototype.absnormaly=null;bf.prototype.origin_invalidate=function(ea){this.originx=ea.x;this.originy=ea.y};bf.prototype.direction_invalidate=function(ea){this.dirx=ea.x;this.diry=ea.y;this.zip_dir=true};bf.prototype.zip_dir=null;bf.prototype.invalidate_dir=function(){this.zip_dir=true};bf.prototype.validate_dir=function(){if(this.zip_dir){this.zip_dir=false;var ec=1/Math.sqrt(this.dirx*this.dirx+this.diry*this.diry);this.dirx*=ec;this.diry*=ec;this.idirx=1/this.dirx;this.idiry=1/this.diry;this.normalx=-this.diry;this.normaly=this.dirx;var ea=this.normalx;this.absnormalx=ea<0?-ea:ea;var eb=this.normaly;this.absnormaly=eb<0?-eb:eb}};bf.prototype.rayAABB=function(){var ed=this.originx;var eb=ed;var eg=this.originy;var ee=eg;if(this.maxdist>=Infinity){if(this.dirx>0){eb=Infinity}else{if(this.dirx<0){eb=-Infinity}}if(this.diry>0){ee=Infinity}else{if(this.diry<0){ee=-Infinity}}}else{eb+=this.maxdist*this.dirx;ee+=this.maxdist*this.diry}if(eb<ed){var ec=ed;ed=eb;eb=ec}if(ee<eg){var ef=eg;eg=ee;ee=ef}var ea;if(bT.zpp_pool==null){ea=new bT()}else{ea=bT.zpp_pool;bT.zpp_pool=ea.next;ea.next=null}ea.minx=ed;ea.miny=eg;ea.maxx=eb;ea.maxy=ee;return ea};bf.prototype.aabbtest=function(ea){var eb=this.normalx*(this.originx-0.5*(ea.minx+ea.maxx))+this.normaly*(this.originy-0.5*(ea.miny+ea.maxy));return(eb<0?-eb:eb)<this.absnormalx*0.5*(ea.maxx-ea.minx)+this.absnormaly*0.5*(ea.maxy-ea.miny)};bf.prototype.aabbsect=function(ek){var ec=this.originx>=ek.minx&&this.originx<=ek.maxx;var eb=this.originy>=ek.miny&&this.originy<=ek.maxy;if(ec&&eb){return 0}else{var eg=-1;while(!(this.dirx>=0&&this.originx>=ek.maxx)){if(this.dirx<=0&&this.originx<=ek.minx){break}if(this.diry>=0&&this.originy>=ek.maxy){break}if(this.diry<=0&&this.originy<=ek.miny){break}if(this.dirx>0){var el=(ek.minx-this.originx)*this.idirx;if(el>=0&&el<=this.maxdist){var eh=this.originy+el*this.diry;if(eh>=ek.miny&&eh<=ek.maxy){eg=el;break}}}else{if(this.dirx<0){var ef=(ek.maxx-this.originx)*this.idirx;if(ef>=0&&ef<=this.maxdist){var ej=this.originy+ef*this.diry;if(ej>=ek.miny&&ej<=ek.maxy){eg=ef;break}}}}if(this.diry>0){var ee=(ek.miny-this.originy)*this.idiry;if(ee>=0&&ee<=this.maxdist){var ei=this.originx+ee*this.dirx;if(ei>=ek.minx&&ei<=ek.maxx){eg=ee;break}}}else{if(this.diry<0){var ed=(ek.maxy-this.originy)*this.idiry;if(ed>=0&&ed<=this.maxdist){var ea=this.originx+ed*this.dirx;if(ea>=ek.minx&&ea<=ek.maxx){eg=ed;break}}}}break}return eg}};bf.prototype.circlesect=function(eZ,em,el){if(eZ.zip_worldCOM){if(eZ.body!=null){eZ.zip_worldCOM=false;if(eZ.zip_localCOM){eZ.zip_localCOM=false;if(eZ.type==1){var eb=eZ.polygon;if(eb.lverts.next.next==null){eb.localCOMx=eb.lverts.next.x;eb.localCOMy=eb.lverts.next.y}else{if(eb.lverts.next.next.next==null){eb.localCOMx=eb.lverts.next.x;eb.localCOMy=eb.lverts.next.y;eb.localCOMx+=eb.lverts.next.next.x;eb.localCOMy+=eb.lverts.next.next.y;eb.localCOMx*=0.5;eb.localCOMy*=0.5}else{eb.localCOMx=0;eb.localCOMy=0;var et=0;var ec=eb.lverts.next;var eQ=ec;ec=ec.next;var eO=ec;ec=ec.next;while(ec!=null){var eM=ec;et+=eO.x*(eM.y-eQ.y);var eq=eM.y*eO.x-eM.x*eO.y;eb.localCOMx+=(eO.x+eM.x)*eq;eb.localCOMy+=(eO.y+eM.y)*eq;eQ=eO;eO=eM;ec=ec.next}ec=eb.lverts.next;var ex=ec;et+=eO.x*(ex.y-eQ.y);var eI=ex.y*eO.x-ex.x*eO.y;eb.localCOMx+=(eO.x+ex.x)*eI;eb.localCOMy+=(eO.y+ex.y)*eI;eQ=eO;ec=ec.next;var ev=ec;et+=ex.x*(ev.y-eQ.y);var eG=ev.y*ex.x-ev.x*ex.y;eb.localCOMx+=(ex.x+ev.x)*eG;eb.localCOMy+=(ex.y+ev.y)*eG;et=1/(3*et);var eS=et;eb.localCOMx*=eS;eb.localCOMy*=eS}}}if(eZ.wrap_localCOM!=null){eZ.wrap_localCOM.zpp_inner.x=eZ.localCOMx;eZ.wrap_localCOM.zpp_inner.y=eZ.localCOMy}}var eR=eZ.body;if(eR.zip_axis){eR.zip_axis=false;eR.axisx=Math.sin(eR.rot);eR.axisy=Math.cos(eR.rot)}eZ.worldCOMx=eZ.body.posx+(eZ.body.axisy*eZ.localCOMx-eZ.body.axisx*eZ.localCOMy);eZ.worldCOMy=eZ.body.posy+(eZ.localCOMx*eZ.body.axisx+eZ.localCOMy*eZ.body.axisy)}}var ee=0;var ed=0;ee=this.originx-eZ.worldCOMx;ed=this.originy-eZ.worldCOMy;var ek=this.dirx*this.dirx+this.diry*this.diry;var ej=2*(ee*this.dirx+ed*this.diry);var ei=ee*ee+ed*ed-eZ.radius*eZ.radius;var ef=ej*ej-4*ek*ei;if(ef==0){var er=-ej/2*ek;if((!em||ei>0)&&er>0&&er<el&&er<=this.maxdist){var eV=0;var eU=0;eV=this.originx;eU=this.originy;eV+=this.dirx*er;eU+=this.diry*er;eV-=eZ.worldCOMx;eU-=eZ.worldCOMy;var eK=1/Math.sqrt(eV*eV+eU*eU);eV*=eK;eU*=eK;if(ei<=0){eV=-eV;eU=-eU}var ep;if(au.poolVec2==null){ep=new r()}else{ep=au.poolVec2;au.poolVec2=ep.zpp_pool;ep.zpp_pool=null}if(ep.zpp_inner==null){var eJ;if(bB.zpp_pool==null){eJ=new bB()}else{eJ=bB.zpp_pool;bB.zpp_pool=eJ.next;eJ.next=null}eJ.weak=false;eJ._immutable=false;eJ.x=eV;eJ.y=eU;ep.zpp_inner=eJ;ep.zpp_inner.outer=ep}else{var eT;var eP=ep.zpp_inner;if(eP._validate!=null){eP._validate()}if(ep.zpp_inner.x==eV){var eN=ep.zpp_inner;if(eN._validate!=null){eN._validate()}eT=ep.zpp_inner.y==eU}else{eT=false}if(!eT){ep.zpp_inner.x=eV;ep.zpp_inner.y=eU;var eL=ep.zpp_inner;if(eL._invalidate!=null){eL._invalidate(eL)}}}ep.zpp_inner.weak=false;return a4.getRay(ep,er,ei<=0,eZ.outer)}else{return null}}else{ef=Math.sqrt(ef);ek=1/(2*ek);var eu=(-ej-ef)*ek;var ea=(-ej+ef)*ek;if(eu>0){if(eu<el&&eu<=this.maxdist){var eo=0;var eh=0;eo=this.originx;eh=this.originy;eo+=this.dirx*eu;eh+=this.diry*eu;eo-=eZ.worldCOMx;eh-=eZ.worldCOMy;var ew=1/Math.sqrt(eo*eo+eh*eh);eo*=ew;eh*=ew;var eF;if(au.poolVec2==null){eF=new r()}else{eF=au.poolVec2;au.poolVec2=eF.zpp_pool;eF.zpp_pool=null}if(eF.zpp_inner==null){var eD;if(bB.zpp_pool==null){eD=new bB()}else{eD=bB.zpp_pool;bB.zpp_pool=eD.next;eD.next=null}eD.weak=false;eD._immutable=false;eD.x=eo;eD.y=eh;eF.zpp_inner=eD;eF.zpp_inner.outer=eF}else{var eY;var eH=eF.zpp_inner;if(eH._validate!=null){eH._validate()}if(eF.zpp_inner.x==eo){var eE=eF.zpp_inner;if(eE._validate!=null){eE._validate()}eY=eF.zpp_inner.y==eh}else{eY=false}if(!eY){eF.zpp_inner.x=eo;eF.zpp_inner.y=eh;var eC=eF.zpp_inner;if(eC._invalidate!=null){eC._invalidate(eC)}}}eF.zpp_inner.weak=false;return a4.getRay(eF,eu,false,eZ.outer)}else{return null}}else{if(ea>0&&em){if(ea<el&&ea<=this.maxdist){var en=0;var eg=0;en=this.originx;eg=this.originy;en+=this.dirx*ea;eg+=this.diry*ea;en-=eZ.worldCOMx;eg-=eZ.worldCOMy;var es=1/Math.sqrt(en*en+eg*eg);en*=es;eg*=es;en=-en;eg=-eg;var eB;if(au.poolVec2==null){eB=new r()}else{eB=au.poolVec2;au.poolVec2=eB.zpp_pool;eB.zpp_pool=null}if(eB.zpp_inner==null){var ez;if(bB.zpp_pool==null){ez=new bB()}else{ez=bB.zpp_pool;bB.zpp_pool=ez.next;ez.next=null}ez.weak=false;ez._immutable=false;ez.x=en;ez.y=eg;eB.zpp_inner=ez;eB.zpp_inner.outer=eB}else{var eX;var eA=eB.zpp_inner;if(eA._validate!=null){eA._validate()}if(eB.zpp_inner.x==en){var ey=eB.zpp_inner;if(ey._validate!=null){ey._validate()}eX=eB.zpp_inner.y==eg}else{eX=false}if(!eX){eB.zpp_inner.x=en;eB.zpp_inner.y=eg;var eW=eB.zpp_inner;if(eW._invalidate!=null){eW._invalidate(eW)}}}eB.zpp_inner.weak=false;return a4.getRay(eB,ea,true,eZ.outer)}else{return null}}else{return null}}}};bf.prototype.circlesect2=function(fh,ew,ev){if(fh.zip_worldCOM){if(fh.body!=null){fh.zip_worldCOM=false;if(fh.zip_localCOM){fh.zip_localCOM=false;if(fh.type==1){var ef=fh.polygon;if(ef.lverts.next.next==null){ef.localCOMx=ef.lverts.next.x;ef.localCOMy=ef.lverts.next.y}else{if(ef.lverts.next.next.next==null){ef.localCOMx=ef.lverts.next.x;ef.localCOMy=ef.lverts.next.y;ef.localCOMx+=ef.lverts.next.next.x;ef.localCOMy+=ef.lverts.next.next.y;ef.localCOMx*=0.5;ef.localCOMy*=0.5}else{ef.localCOMx=0;ef.localCOMy=0;var eF=0;var eh=ef.lverts.next;var e5=eh;eh=eh.next;var e2=eh;eh=eh.next;while(eh!=null){var e0=eh;eF+=e2.x*(e0.y-e5.y);var eA=e0.y*e2.x-e0.x*e2.y;ef.localCOMx+=(e2.x+e0.x)*eA;ef.localCOMy+=(e2.y+e0.y)*eA;e5=e2;e2=e0;eh=eh.next}eh=ef.lverts.next;var eI=eh;eF+=e2.x*(eI.y-e5.y);var eW=eI.y*e2.x-eI.x*e2.y;ef.localCOMx+=(e2.x+eI.x)*eW;ef.localCOMy+=(e2.y+eI.y)*eW;e5=e2;eh=eh.next;var eG=eh;eF+=eI.x*(eG.y-e5.y);var eU=eG.y*eI.x-eG.x*eI.y;ef.localCOMx+=(eI.x+eG.x)*eU;ef.localCOMy+=(eI.y+eG.y)*eU;eF=1/(3*eF);var e7=eF;ef.localCOMx*=e7;ef.localCOMy*=e7}}}if(fh.wrap_localCOM!=null){fh.wrap_localCOM.zpp_inner.x=fh.localCOMx;fh.wrap_localCOM.zpp_inner.y=fh.localCOMy}}var e6=fh.body;if(e6.zip_axis){e6.zip_axis=false;e6.axisx=Math.sin(e6.rot);e6.axisy=Math.cos(e6.rot)}fh.worldCOMx=fh.body.posx+(fh.body.axisy*fh.localCOMx-fh.body.axisx*fh.localCOMy);fh.worldCOMy=fh.body.posy+(fh.localCOMx*fh.body.axisx+fh.localCOMy*fh.body.axisy)}}var ej=0;var ei=0;ej=this.originx-fh.worldCOMx;ei=this.originy-fh.worldCOMy;var er=this.dirx*this.dirx+this.diry*this.diry;var eq=2*(ej*this.dirx+ei*this.diry);var eo=ej*ej+ei*ei-fh.radius*fh.radius;var ek=eq*eq-4*er*eo;if(ek==0){var eC=-eq/2*er;if((!ew||eo>0)&&eC>0&&eC<=this.maxdist){var fa=0;var e9=0;fa=this.originx;e9=this.originy;fa+=this.dirx*eC;e9+=this.diry*eC;fa-=fh.worldCOMx;e9-=fh.worldCOMy;var eY=1/Math.sqrt(fa*fa+e9*e9);fa*=eY;e9*=eY;if(eo<=0){fa=-fa;e9=-e9}var ez;if(au.poolVec2==null){ez=new r()}else{ez=au.poolVec2;au.poolVec2=ez.zpp_pool;ez.zpp_pool=null}if(ez.zpp_inner==null){var eX;if(bB.zpp_pool==null){eX=new bB()}else{eX=bB.zpp_pool;bB.zpp_pool=eX.next;eX.next=null}eX.weak=false;eX._immutable=false;eX.x=fa;eX.y=e9;ez.zpp_inner=eX;ez.zpp_inner.outer=ez}else{var e8;var e3=ez.zpp_inner;if(e3._validate!=null){e3._validate()}if(ez.zpp_inner.x==fa){var e1=ez.zpp_inner;if(e1._validate!=null){e1._validate()}e8=ez.zpp_inner.y==e9}else{e8=false}if(!e8){ez.zpp_inner.x=fa;ez.zpp_inner.y=e9;var eZ=ez.zpp_inner;if(eZ._invalidate!=null){eZ._invalidate(eZ)}}}ez.zpp_inner.weak=false;var eB=a4.getRay(ez,eC,eo<=0,fh.outer);var e4=null;var eu=ev.zpp_inner.inner.head;while(eu!=null){if(eB.zpp_inner.toiDistance<eu.elt.zpp_inner.toiDistance){break}e4=eu;eu=eu.next}var eV=ev.zpp_inner.inner;var eT;if(dp.zpp_pool==null){eT=new dp()}else{eT=dp.zpp_pool;dp.zpp_pool=eT.next;eT.next=null}eT.elt=eB;var eg=eT;if(e4==null){eg.next=eV.head;eV.head=eg}else{eg.next=e4.next;e4.next=eg}eV.pushmod=eV.modified=true;eV.length++}}else{ek=Math.sqrt(ek);er=1/(2*er);var eE=(-eq-ek)*er;var ee=(-eq+ek)*er;if(eE>0&&eE<=this.maxdist){var ey=0;var em=0;ey=this.originx;em=this.originy;ey+=this.dirx*eE;em+=this.diry*eE;ey-=fh.worldCOMx;em-=fh.worldCOMy;var eH=1/Math.sqrt(ey*ey+em*em);ey*=eH;em*=eH;var eR;if(au.poolVec2==null){eR=new r()}else{eR=au.poolVec2;au.poolVec2=eR.zpp_pool;eR.zpp_pool=null}if(eR.zpp_inner==null){var eP;if(bB.zpp_pool==null){eP=new bB()}else{eP=bB.zpp_pool;bB.zpp_pool=eP.next;eP.next=null}eP.weak=false;eP._immutable=false;eP.x=ey;eP.y=em;eR.zpp_inner=eP;eR.zpp_inner.outer=eR}else{var fg;var eS=eR.zpp_inner;if(eS._validate!=null){eS._validate()}if(eR.zpp_inner.x==ey){var eQ=eR.zpp_inner;if(eQ._validate!=null){eQ._validate()}fg=eR.zpp_inner.y==em}else{fg=false}if(!fg){eR.zpp_inner.x=ey;eR.zpp_inner.y=em;var eO=eR.zpp_inner;if(eO._invalidate!=null){eO._invalidate(eO)}}}eR.zpp_inner.weak=false;var ed=a4.getRay(eR,eE,false,fh.outer);var ep=null;var et=ev.zpp_inner.inner.head;while(et!=null){if(ed.zpp_inner.toiDistance<et.elt.zpp_inner.toiDistance){break}ep=et;et=et.next}var eN=ev.zpp_inner.inner;var eM;if(dp.zpp_pool==null){eM=new dp()}else{eM=dp.zpp_pool;dp.zpp_pool=eM.next;eM.next=null}eM.elt=ed;var eb=eM;if(ep==null){eb.next=eN.head;eN.head=eb}else{eb.next=ep.next;ep.next=eb}eN.pushmod=eN.modified=true;eN.length++}if(ee>0&&ee<=this.maxdist&&ew){var ex=0;var el=0;ex=this.originx;el=this.originy;ex+=this.dirx*ee;el+=this.diry*ee;ex-=fh.worldCOMx;el-=fh.worldCOMy;var eD=1/Math.sqrt(ex*ex+el*el);ex*=eD;el*=eD;ex=-ex;el=-el;var eL;if(au.poolVec2==null){eL=new r()}else{eL=au.poolVec2;au.poolVec2=eL.zpp_pool;eL.zpp_pool=null}if(eL.zpp_inner==null){var eK;if(bB.zpp_pool==null){eK=new bB()}else{eK=bB.zpp_pool;bB.zpp_pool=eK.next;eK.next=null}eK.weak=false;eK._immutable=false;eK.x=ex;eK.y=el;eL.zpp_inner=eK;eL.zpp_inner.outer=eL}else{var ff;var fe=eL.zpp_inner;if(fe._validate!=null){fe._validate()}if(eL.zpp_inner.x==ex){var fd=eL.zpp_inner;if(fd._validate!=null){fd._validate()}ff=eL.zpp_inner.y==el}else{ff=false}if(!ff){eL.zpp_inner.x=ex;eL.zpp_inner.y=el;var fc=eL.zpp_inner;if(fc._invalidate!=null){fc._invalidate(fc)}}}eL.zpp_inner.weak=false;var ec=a4.getRay(eL,ee,true,fh.outer);var en=null;var es=ev.zpp_inner.inner.head;while(es!=null){if(ec.zpp_inner.toiDistance<es.elt.zpp_inner.toiDistance){break}en=es;es=es.next}var fb=ev.zpp_inner.inner;var eJ;if(dp.zpp_pool==null){eJ=new dp()}else{eJ=dp.zpp_pool;dp.zpp_pool=eJ.next;eJ.next=null}eJ.elt=ec;var ea=eJ;if(en==null){ea.next=fb.head;fb.head=ea}else{ea.next=en.next;en.next=ea}fb.pushmod=fb.modified=true;fb.length++}}};bf.prototype.polysect=function(eC,eo,en){var eJ=en;var ef=null;var eH=eC.edges.head;var eA=eC.gverts.next;var ex=eA;var ez=eA.next;while(ez!=null){var ev=ez;var eG=eH.elt;if(eo||eG.gnormx*this.dirx+eG.gnormy*this.diry<0){var ej=0;var eh=0;ej=ev.x-ex.x;eh=ev.y-ex.y;var eg=0;var ee=0;eg=ex.x-this.originx;ee=ex.y-this.originy;var el=eh*this.dirx-ej*this.diry;if(el*el>P.epsilon){el=1/el;var ek=(eh*eg-ej*ee)*el;if(ek>0&&ek<eJ&&ek<=this.maxdist){var ed=(this.diry*eg-this.dirx*ee)*el;if(ed>-P.epsilon&&ed<1+P.epsilon){eJ=ek;ef=eH.elt}}}}eH=eH.next;eA=ez;ex=ev;ez=ez.next}while(true){ez=eC.gverts.next;var eK=ez;var ep=eH.elt;if(eo||ep.gnormx*this.dirx+ep.gnormy*this.diry<0){var es=0;var em=0;es=eK.x-ex.x;em=eK.y-ex.y;var ea=0;var et=0;ea=ex.x-this.originx;et=ex.y-this.originy;var eI=em*this.dirx-es*this.diry;if(eI*eI>P.epsilon){eI=1/eI;var er=(em*ea-es*et)*eI;if(er>0&&er<eJ&&er<=this.maxdist){var eb=(this.diry*ea-this.dirx*et)*eI;if(eb>-P.epsilon&&eb<1+P.epsilon){eJ=er;ef=eH.elt}}}}eH=eH.next;break}if(ef!=null){var eF=0;var eD=0;eF=ef.gnormx;eD=ef.gnormy;var eE=eF*this.dirx+eD*this.diry>0;if(eE){eF=-eF;eD=-eD}var eq;if(au.poolVec2==null){eq=new r()}else{eq=au.poolVec2;au.poolVec2=eq.zpp_pool;eq.zpp_pool=null}if(eq.zpp_inner==null){var eu;if(bB.zpp_pool==null){eu=new bB()}else{eu=bB.zpp_pool;bB.zpp_pool=eu.next;eu.next=null}eu.weak=false;eu._immutable=false;eu.x=eF;eu.y=eD;eq.zpp_inner=eu;eq.zpp_inner.outer=eq}else{var eB;var ec=eq.zpp_inner;if(ec._validate!=null){ec._validate()}if(eq.zpp_inner.x==eF){var ey=eq.zpp_inner;if(ey._validate!=null){ey._validate()}eB=eq.zpp_inner.y==eD}else{eB=false}if(!eB){eq.zpp_inner.x=eF;eq.zpp_inner.y=eD;var ew=eq.zpp_inner;if(ew._invalidate!=null){ew._invalidate(ew)}}}eq.zpp_inner.weak=false;return a4.getRay(eq,eJ,eE,eC.outer)}else{return null}};bf.prototype.polysect2=function(eY,ev,et){var e7=Infinity;var eu=-1;var ej=null;var ey=null;var e5=eY.edges.head;var eV=eY.gverts.next;var eS=eV;var eU=eV.next;while(eU!=null){var eP=eU;var e4=e5.elt;if(ev||e4.gnormx*this.dirx+e4.gnormy*this.diry<0){var em=0;var el=0;em=eP.x-eS.x;el=eP.y-eS.y;var ek=0;var eh=0;ek=eS.x-this.originx;eh=eS.y-this.originy;var eq=el*this.dirx-em*this.diry;if(eq*eq>P.epsilon){eq=1/eq;var eo=(el*ek-em*eh)*eq;if(eo>0&&eo<=this.maxdist&&(eo<e7||eo>eu)){var ee=(this.diry*ek-this.dirx*eh)*eq;if(ee>-P.epsilon&&ee<1+P.epsilon){if(eo<e7){e7=eo;ej=e5.elt}if(eo>eu){eu=eo;ey=e5.elt}}}}}e5=e5.next;eV=eU;eS=eP;eU=eU.next}while(true){eU=eY.gverts.next;var e8=eU;var ew=e5.elt;if(ev||ew.gnormx*this.dirx+ew.gnormy*this.diry<0){var eB=0;var er=0;eB=e8.x-eS.x;er=e8.y-eS.y;var ea=0;var eE=0;ea=eS.x-this.originx;eE=eS.y-this.originy;var e6=er*this.dirx-eB*this.diry;if(e6*e6>P.epsilon){e6=1/e6;var eA=(er*ea-eB*eE)*e6;if(eA>0&&eA<=this.maxdist&&(eA<e7||eA>eu)){var ec=(this.diry*ea-this.dirx*eE)*e6;if(ec>-P.epsilon&&ec<1+P.epsilon){if(eA<e7){e7=eA;ej=e5.elt}if(eA>eu){eu=eA;ey=e5.elt}}}}}e5=e5.next;break}if(ej!=null){var e2=0;var eZ=0;e2=ej.gnormx;eZ=ej.gnormy;var e0=e2*this.dirx+eZ*this.diry>0;if(e0){e2=-e2;eZ=-eZ}var ez;if(au.poolVec2==null){ez=new r()}else{ez=au.poolVec2;au.poolVec2=ez.zpp_pool;ez.zpp_pool=null}if(ez.zpp_inner==null){var eM;if(bB.zpp_pool==null){eM=new bB()}else{eM=bB.zpp_pool;bB.zpp_pool=eM.next;eM.next=null}eM.weak=false;eM._immutable=false;eM.x=e2;eM.y=eZ;ez.zpp_inner=eM;ez.zpp_inner.outer=ez}else{var eX;var ed=ez.zpp_inner;if(ed._validate!=null){ed._validate()}if(ez.zpp_inner.x==e2){var eT=ez.zpp_inner;if(eT._validate!=null){eT._validate()}eX=ez.zpp_inner.y==eZ}else{eX=false}if(!eX){ez.zpp_inner.x=e2;ez.zpp_inner.y=eZ;var eR=ez.zpp_inner;if(eR._invalidate!=null){eR._invalidate(eR)}}}ez.zpp_inner.weak=false;var eK=a4.getRay(ez,e7,e0,eY.outer);var eQ=null;var eg=et.zpp_inner.inner.head;while(eg!=null){if(eK.zpp_inner.toiDistance<eg.elt.zpp_inner.toiDistance){break}eQ=eg;eg=eg.next}var eO=et.zpp_inner.inner;var eI;if(dp.zpp_pool==null){eI=new dp()}else{eI=dp.zpp_pool;dp.zpp_pool=eI.next;eI.next=null}eI.elt=eK;var ef=eI;if(eQ==null){ef.next=eO.head;eO.head=ef}else{ef.next=eQ.next;eQ.next=ef}eO.pushmod=eO.modified=true;eO.length++}if(ey!=null&&ej!=ey){var ex=0;var en=0;ex=ey.gnormx;en=ey.gnormy;var eW=ex*this.dirx+en*this.diry>0;if(eW){ex=-ex;en=-en}var eG;if(au.poolVec2==null){eG=new r()}else{eG=au.poolVec2;au.poolVec2=eG.zpp_pool;eG.zpp_pool=null}if(eG.zpp_inner==null){var eF;if(bB.zpp_pool==null){eF=new bB()}else{eF=bB.zpp_pool;bB.zpp_pool=eF.next;eF.next=null}eF.weak=false;eF._immutable=false;eF.x=ex;eF.y=en;eG.zpp_inner=eF;eG.zpp_inner.outer=eG}else{var e3;var eN=eG.zpp_inner;if(eN._validate!=null){eN._validate()}if(eG.zpp_inner.x==ex){var eL=eG.zpp_inner;if(eL._validate!=null){eL._validate()}e3=eG.zpp_inner.y==en}else{e3=false}if(!e3){eG.zpp_inner.x=ex;eG.zpp_inner.y=en;var eJ=eG.zpp_inner;if(eJ._invalidate!=null){eJ._invalidate(eJ)}}}eG.zpp_inner.weak=false;var eD=a4.getRay(eG,eu,eW,eY.outer);var ep=null;var es=et.zpp_inner.inner.head;while(es!=null){if(eD.zpp_inner.toiDistance<es.elt.zpp_inner.toiDistance){break}ep=es;es=es.next}var eH=et.zpp_inner.inner;var eC;if(dp.zpp_pool==null){eC=new dp()}else{eC=dp.zpp_pool;dp.zpp_pool=eC.next;eC.next=null}eC.elt=eD;var eb=eC;if(ep==null){eb.next=eH.head;eH.head=eb}else{eb.next=ep.next;ep.next=eb}eH.pushmod=eH.modified=true;eH.length++}};bf.prototype.__class__=bf;var dG=zpp_nape.geom.ZPP_SimpleVert=function(){this.node=null;this.next=null;this.id=0;this.links=null;this.y=0;this.x=0;this.forced=false;this.id=cr.ZPP_SimpleVert();if(bX.zpp_pool==null){this.links=new bX()}else{this.links=bX.zpp_pool;bX.zpp_pool=this.links.next;this.links.next=null}this.links.lt=dG.less_xy};dG.__name__=["zpp_nape","geom","ZPP_SimpleVert"];dG.less_xy=function(eb,ea){if(!(eb.y<ea.y)){if(eb.y==ea.y){return eb.x<ea.x}else{return false}}else{return true}};dG.swap_nodes=function(ec,eb){var ea=ec.node;ec.node=eb.node;eb.node=ea};dG.get=function(ea,ec){var eb;if(dG.zpp_pool==null){eb=new dG()}else{eb=dG.zpp_pool;dG.zpp_pool=eb.next;eb.next=null}eb.x=ea;eb.y=ec;return eb};dG.prototype.forced=null;dG.prototype.x=null;dG.prototype.y=null;dG.prototype.links=null;dG.prototype.id=null;dG.prototype.next=null;dG.prototype.node=null;dG.prototype.free=function(){this.links.clear();this.node=null;this.forced=false};dG.prototype.alloc=function(){};dG.prototype.__class__=dG;var co=zpp_nape.geom.ZPP_SimpleSeg=function(){this.node=null;this.prev=null;this.next=null;this.id=0;this.vertices=null;this.right=null;this.left=null;this.id=cr.ZPP_SimpleSeg();if(bX.zpp_pool==null){this.vertices=new bX()}else{this.vertices=bX.zpp_pool;bX.zpp_pool=this.vertices.next;this.vertices.next=null}this.vertices.lt=dX(this,this.less_xy)};co.__name__=["zpp_nape","geom","ZPP_SimpleSeg"];co.get=function(ec,eb){var ea;if(co.zpp_pool==null){ea=new co()}else{ea=co.zpp_pool;co.zpp_pool=ea.next;ea.next=null}ea.left=ec;ea.right=eb;ea.vertices.insert(ec);ea.vertices.insert(eb);return ea};co.prototype.left=null;co.prototype.right=null;co.prototype.vertices=null;co.prototype.id=null;co.prototype.next=null;co.prototype.free=function(){this.left=this.right=null;this.prev=null;this.node=null;this.vertices.clear()};co.prototype.alloc=function(){};co.prototype.prev=null;co.prototype.node=null;co.prototype.less_xy=function(eb,ea){if(!(eb.x<ea.x)){if(eb.x==ea.x){return eb.y<ea.y}else{return false}}else{return true}};co.prototype.__class__=co;var dI=zpp_nape.geom.ZPP_SimpleEvent=function(){this.next=null;this.node=null;this.segment2=null;this.segment=null;this.vertex=null;this.type=0};dI.__name__=["zpp_nape","geom","ZPP_SimpleEvent"];dI.swap_nodes=function(eb,ea){var ec=eb.node;eb.node=ea.node;ea.node=ec};dI.less_xy=function(eb,ea){if(eb.vertex.x<ea.vertex.x){return true}else{if(eb.vertex.x>ea.vertex.x){return false}else{if(eb.vertex.y<ea.vertex.y){return true}else{if(eb.vertex.y>ea.vertex.y){return false}else{return eb.type<ea.type}}}}};dI.get=function(ea){var eb;if(dI.zpp_pool==null){eb=new dI()}else{eb=dI.zpp_pool;dI.zpp_pool=eb.next;eb.next=null}eb.vertex=ea;return eb};dI.prototype.type=null;dI.prototype.vertex=null;dI.prototype.segment=null;dI.prototype.segment2=null;dI.prototype.node=null;dI.prototype.next=null;dI.prototype.free=function(){this.vertex=null;this.segment=this.segment2=null;this.node=null};dI.prototype.alloc=function(){};dI.prototype.__class__=dI;var bz=zpp_nape.geom.ZPP_SimpleSweep=function(){this.tree=null;this.sweepx=0;if(bD.zpp_pool==null){this.tree=new bD()}else{this.tree=bD.zpp_pool;bD.zpp_pool=this.tree.next;this.tree.next=null}this.tree.lt=dX(this,this.edge_lt);this.tree.swapped=dX(this,this.swap_nodes)};bz.__name__=["zpp_nape","geom","ZPP_SimpleSweep"];bz.prototype.sweepx=null;bz.prototype.tree=null;bz.prototype.swap_nodes=function(ec,eb){var ea=ec.node;ec.node=eb.node;eb.node=ea};bz.prototype.edge_lt=function(ee,eb){var ec=0;var ea=0;var ei=0;var eh=0;var eg;if(ee.left==eb.left&&ee.right==eb.right){return false}else{if(ee.left==eb.right){if(ee.left.x==ee.right.x){if(ee.left.y<ee.right.y){return ee.left.y>eb.left.y}else{return ee.right.y>eb.left.y}}else{eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.left.x-ee.left.x;eh=eb.left.y-ee.left.y;return(eg?ea*ei-ec*eh:eh*ec-ei*ea)<0}}else{if(ee.right==eb.left){var ef;if(eb.left.x==eb.right.x){if(eb.left.y<eb.right.y){ef=eb.left.y>ee.left.y}else{ef=eb.right.y>ee.left.y}}else{eg=eb.right.x<eb.left.x;ec=eb.right.x-eb.left.x;ea=eb.right.y-eb.left.y;ei=ee.left.x-eb.left.x;eh=ee.left.y-eb.left.y;ef=(eg?ea*ei-ec*eh:eh*ec-ei*ea)<0}return !ef}else{if(ee.left==eb.left){if(ee.left.x==ee.right.x){if(ee.left.y<ee.right.y){return ee.left.y>eb.right.y}else{return ee.right.y>eb.right.y}}else{eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.right.x-ee.left.x;eh=eb.right.y-ee.left.y;return(eg?ea*ei-ec*eh:eh*ec-ei*ea)<0}}else{if(ee.right==eb.right){if(ee.left.x==ee.right.x){if(ee.left.y<ee.right.y){return ee.left.y>eb.left.y}else{return ee.right.y>eb.left.y}}else{eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.left.x-ee.left.x;eh=eb.left.y-ee.left.y;return(eg?ea*ei-ec*eh:eh*ec-ei*ea)<0}}}}}}if(ee.left.x==ee.right.x){if(eb.left.x==eb.right.x){return(ee.left.y<ee.right.y?ee.right:ee.left).y>(eb.left.y<eb.right.y?eb.right:eb.left).y}else{eg=eb.right.x<eb.left.x;ec=eb.right.x-eb.left.x;ea=eb.right.y-eb.left.y;ei=ee.left.x-eb.left.x;eh=ee.left.y-eb.left.y;var ed=eg?ea*ei-ec*eh:eh*ec-ei*ea;eg=eb.right.x<eb.left.x;ec=eb.right.x-eb.left.x;ea=eb.right.y-eb.left.y;ei=ee.right.x-eb.left.x;eh=ee.right.y-eb.left.y;if(ed*(eg?ea*ei-ec*eh:eh*ec-ei*ea)>=0){return ed>=0}else{return this.sweepx>=ee.left.x}}}else{if(eb.left.x==eb.right.x){eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.left.x-ee.left.x;eh=eb.left.y-ee.left.y;var ek=eg?ea*ei-ec*eh:eh*ec-ei*ea;eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.right.x-ee.left.x;eh=eb.right.y-ee.left.y;if(ek*(eg?ea*ei-ec*eh:eh*ec-ei*ea)>=0){return ek<0}else{return this.sweepx<eb.left.x}}else{eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.left.x-ee.left.x;eh=eb.left.y-ee.left.y;var ej=(eg?ea*ei-ec*eh:eh*ec-ei*ea)<0;eg=ee.right.x<ee.left.x;ec=ee.right.x-ee.left.x;ea=ee.right.y-ee.left.y;ei=eb.right.x-ee.left.x;eh=eb.right.y-ee.left.y;if(ej==(eg?ea*ei-ec*eh:eh*ec-ei*ea)<0){return ej}else{eg=eb.right.x<eb.left.x;ec=eb.right.x-eb.left.x;ea=eb.right.y-eb.left.y;ei=ee.left.x-eb.left.x;eh=ee.left.y-eb.left.y;var el=(eg?ea*ei-ec*eh:eh*ec-ei*ea)>=0;eg=eb.right.x<eb.left.x;ec=eb.right.x-eb.left.x;ea=eb.right.y-eb.left.y;ei=ee.right.x-eb.left.x;eh=ee.right.y-eb.left.y;if(el==(eg?ea*ei-ec*eh:eh*ec-ei*ea)>=0){return el}return(this.sweepx-ee.left.x)/(ee.right.x-ee.left.x)*(ee.right.y-ee.left.y)+ee.left.y>(this.sweepx-eb.left.x)/(eb.right.x-eb.left.x)*(eb.right.y-eb.left.y)+eb.left.y}}}};bz.prototype.clear=function(){this.tree.clear()};bz.prototype.add=function(ec){ec.node=this.tree.insert(ec);var ea=this.tree.successor_node(ec.node);var eb=this.tree.predecessor_node(ec.node);if(ea!=null){ec.next=ea.data;ea.data.prev=ec}if(eb!=null){ec.prev=eb.data;eb.data.next=ec}return ec};bz.prototype.remove=function(ec){var ea=this.tree.successor_node(ec.node);var eb=this.tree.predecessor_node(ec.node);if(ea!=null){ea.data.prev=ec.prev}if(eb!=null){eb.data.next=ec.next}this.tree.remove_node(ec.node);ec.node=null};bz.prototype.intersect=function(ee,ed){if(ee==null||ed==null){return false}else{if(ee.left==ed.left||ee.left==ed.right||ee.right==ed.left||ee.right==ed.right){return false}else{var ea=(ed.left.x-ee.left.x)*(ee.right.y-ee.left.y)-(ee.right.x-ee.left.x)*(ed.left.y-ee.left.y);var eb=(ed.right.x-ee.left.x)*(ee.right.y-ee.left.y)-(ee.right.x-ee.left.x)*(ed.right.y-ee.left.y);if(ea*eb>0){return false}else{var ec=(ee.left.x-ed.left.x)*(ed.right.y-ed.left.y)-(ed.right.x-ed.left.x)*(ee.left.y-ed.left.y);var ef=(ee.right.x-ed.left.x)*(ed.right.y-ed.left.y)-(ed.right.x-ed.left.x)*(ee.right.y-ed.left.y);if(ec*ef>0){return false}else{if(ea*eb>=0&&ec*ef>=0){return true}else{return true}}}}}};bz.prototype.intersection=function(ed,eb){if(ed==null||eb==null){return null}else{if(ed.left==eb.left||ed.left==eb.right||ed.right==eb.left||ed.right==eb.right){return null}else{var ec=0;var ea=0;ec=ed.right.x-ed.left.x;ea=ed.right.y-ed.left.y;var en=0;var ek=0;en=eb.right.x-eb.left.x;ek=eb.right.y-eb.left.y;var eh=ek*ec-en*ea;if(eh==0){return null}eh=1/eh;var ef=0;var ee=0;ef=eb.left.x-ed.left.x;ee=eb.left.y-ed.left.y;var ep=(ek*ef-en*ee)*eh;if(ep<0||ep>1){return null}var eq=(ea*ef-ec*ee)*eh;if(eq<0||eq>1){return null}var eg;if(eq==0||eq==1||ep==0||ep==1){if(eq==0){eg=eb.left}else{if(eq==1){eg=eb.right}else{if(ep==0){eg=ed.left}else{eg=ed.right}}}}else{var eo=0.5*(ed.left.x+ec*ep+eb.left.x+en*eq);var em=0.5*(ed.left.y+ea*ep+eb.left.y+ek*eq);var ei;if(dG.zpp_pool==null){ei=new dG()}else{ei=dG.zpp_pool;dG.zpp_pool=ei.next;ei.next=null}ei.x=eo;ei.y=em;eg=ei}var el;if(dI.zpp_pool==null){el=new dI()}else{el=dI.zpp_pool;dI.zpp_pool=el.next;el.next=null}el.vertex=eg;var ej=el;ej.type=0;ej.segment=ed;ej.segment2=eb;return ej}}};bz.prototype.__class__=bz;var bv=zpp_nape.geom.ZPP_Simple=function(){};bv.__name__=["zpp_nape","geom","ZPP_Simple"];bv.decompose=function(eO,e9){if(bv.sweep==null){bv.sweep=new bz();bv.inthash=new bK()}if(bv.vertices==null){if(bX.zpp_pool==null){bv.vertices=new bX()}else{bv.vertices=bX.zpp_pool;bX.zpp_pool=bv.vertices.next;bv.vertices.next=null}bv.vertices.lt=dG.less_xy;bv.vertices.swapped=dG.swap_nodes}if(bv.queue==null){if(bl.zpp_pool==null){bv.queue=new bl()}else{bv.queue=bl.zpp_pool;bl.zpp_pool=bv.queue.next;bv.queue.next=null}bv.queue.lt=dI.less_xy;bv.queue.swapped=dI.swap_nodes}var fr=null;var fh=null;if(eO!=null){var eG=eO;while(true){var e8=eG;var e7=e8.x;var e5=e8.y;var fd;if(dG.zpp_pool==null){fd=new dG()}else{fd=dG.zpp_pool;dG.zpp_pool=fd.next;fd.next=null}fd.x=e7;fd.y=e5;var f9=fd;var eY=bv.vertices.parent;while(eY!=null){if(bv.vertices.lt(f9,eY.data)){eY=eY.prev}else{if(bv.vertices.lt(eY.data,f9)){eY=eY.next}else{break}}}var eF=eY;if(eF!=null){var fc=f9;fc.links.clear();fc.node=null;fc.forced=false;fc.next=dG.zpp_pool;dG.zpp_pool=fc;f9=eF.data}else{f9.node=bv.vertices.insert(f9)}if(fh!=null){var f5;if(dI.zpp_pool==null){f5=new dI()}else{f5=dI.zpp_pool;dI.zpp_pool=f5.next;f5.next=null}f5.vertex=fh;var e4=f5;var f3;if(dI.zpp_pool==null){f3=new dI()}else{f3=dI.zpp_pool;dI.zpp_pool=f3.next;f3.next=null}f3.vertex=f9;var e3=f3;var fi;if(dI.less_xy(e4,e3)){e4.type=1;e3.type=2;fi=co.get(fh,f9)}else{e4.type=2;e3.type=1;fi=co.get(f9,fh)}e4.segment=e3.segment=fi;bv.queue.insert(e4);bv.queue.insert(e3);fh.links.insert(f9);f9.links.insert(fh)}fh=f9;if(fr==null){fr=f9}eG=eG.next;if(!(eG!=eO)){break}}}var f1;if(dI.zpp_pool==null){f1=new dI()}else{f1=dI.zpp_pool;dI.zpp_pool=f1.next;f1.next=null}f1.vertex=fh;var fH=f1;var fY;if(dI.zpp_pool==null){fY=new dI()}else{fY=dI.zpp_pool;dI.zpp_pool=fY.next;fY.next=null}fY.vertex=fr;var fj=fY;var gb;if(dI.less_xy(fH,fj)){fH.type=1;fj.type=2;gb=co.get(fh,fr)}else{fH.type=2;fj.type=1;gb=co.get(fr,fh)}fH.segment=fj.segment=gb;bv.queue.insert(fH);bv.queue.insert(fj);fh.links.insert(fr);fr.links.insert(fh);if(bv.ints==null){if(bl.zpp_pool==null){bv.ints=new bl()}else{bv.ints=bl.zpp_pool;bl.zpp_pool=bv.ints.next;bv.ints.next=null}bv.ints.lt=dI.less_xy}while(!bv.queue.empty()){var fl=bv.queue.pop_front();bv.sweep.sweepx=fl.vertex.x;if(fl.type==1){var fb=fl.segment;bv.sweep.add(fb);if(fb.next!=null&&fb!=null&&!(fb.next.id<fb.id?bv.inthash.has(fb.next.id,fb.id):bv.inthash.has(fb.id,fb.next.id))){var ga=bv.sweep.intersection(fb.next,fb);if(ga!=null){if(ga.vertex.x>=bv.sweep.sweepx){var et=bv.queue.parent;while(et!=null){if(bv.queue.lt(ga,et.data)){et=et.prev}else{if(bv.queue.lt(et.data,ga)){et=et.next}else{break}}}if(et==null){var es=bv.ints.parent;while(es!=null){if(bv.ints.lt(ga,es.data)){es=es.prev}else{if(bv.ints.lt(es.data,ga)){es=es.next}else{break}}}var fC=es;if(fC!=null){var f6=ga.vertex;f6.links.clear();f6.node=null;f6.forced=false;f6.next=dG.zpp_pool;dG.zpp_pool=f6;ga.vertex=fC.data.vertex;fC.data=ga;bv.queue.insert(ga)}else{bv.queue.insert(ga);bv.ints.insert(ga)}if(fb.next.id<fb.id){var ff=fb.next.id;var eE=fb.id;var fV;if(ca.zpp_pool==null){fV=new ca()}else{fV=ca.zpp_pool;ca.zpp_pool=fV.next;fV.next=null}fV.id=ff;fV.di=eE;var fS=fV;fS.value=true;bv.inthash.add(fS)}else{var eD=fb.id;var fD=fb.next.id;var fP;if(ca.zpp_pool==null){fP=new ca()}else{fP=ca.zpp_pool;ca.zpp_pool=fP.next;fP.next=null}fP.id=eD;fP.di=fD;var fN=fP;fN.value=true;bv.inthash.add(fN)}}else{var f4=ga.vertex;f4.links.clear();f4.node=null;f4.forced=false;f4.next=dG.zpp_pool;dG.zpp_pool=f4;ga.vertex=null;ga.segment=ga.segment2=null;ga.node=null;ga.next=dI.zpp_pool;dI.zpp_pool=ga}}else{var f2=ga.vertex;f2.links.clear();f2.node=null;f2.forced=false;f2.next=dG.zpp_pool;dG.zpp_pool=f2;ga.vertex=null;ga.segment=ga.segment2=null;ga.node=null;ga.next=dI.zpp_pool;dI.zpp_pool=ga}}}if(fb!=null&&fb.prev!=null&&!(fb.id<fb.prev.id?bv.inthash.has(fb.id,fb.prev.id):bv.inthash.has(fb.prev.id,fb.id))){var fZ=bv.sweep.intersection(fb,fb.prev);if(fZ!=null){if(fZ.vertex.x>=bv.sweep.sweepx){var er=bv.queue.parent;while(er!=null){if(bv.queue.lt(fZ,er.data)){er=er.prev}else{if(bv.queue.lt(er.data,fZ)){er=er.next}else{break}}}if(er==null){var ep=bv.ints.parent;while(ep!=null){if(bv.ints.lt(fZ,ep.data)){ep=ep.prev}else{if(bv.ints.lt(ep.data,fZ)){ep=ep.next}else{break}}}var fA=ep;if(fA!=null){var f0=fZ.vertex;f0.links.clear();f0.node=null;f0.forced=false;f0.next=dG.zpp_pool;dG.zpp_pool=f0;fZ.vertex=fA.data.vertex;fA.data=fZ;bv.queue.insert(fZ)}else{bv.queue.insert(fZ);bv.ints.insert(fZ)}if(fb.id<fb.prev.id){var eC=fb.id;var fB=fb.prev.id;var fK;if(ca.zpp_pool==null){fK=new ca()}else{fK=ca.zpp_pool;ca.zpp_pool=fK.next;fK.next=null}fK.id=eC;fK.di=fB;var e0=fK;e0.value=true;bv.inthash.add(e0)}else{var eB=fb.prev.id;var fz=fb.id;var eX;if(ca.zpp_pool==null){eX=new ca()}else{eX=ca.zpp_pool;ca.zpp_pool=eX.next;eX.next=null}eX.id=eB;eX.di=fz;var eV=eX;eV.value=true;bv.inthash.add(eV)}}else{var fX=fZ.vertex;fX.links.clear();fX.node=null;fX.forced=false;fX.next=dG.zpp_pool;dG.zpp_pool=fX;fZ.vertex=null;fZ.segment=fZ.segment2=null;fZ.node=null;fZ.next=dI.zpp_pool;dI.zpp_pool=fZ}}else{var fU=fZ.vertex;fU.links.clear();fU.node=null;fU.forced=false;fU.next=dG.zpp_pool;dG.zpp_pool=fU;fZ.vertex=null;fZ.segment=fZ.segment2=null;fZ.node=null;fZ.next=dI.zpp_pool;dI.zpp_pool=fZ}}}}else{if(fl.type==2){var ee=fl.segment;if(ee.node!=null){var fk=ee.next;var fT=ee.prev;bv.sweep.remove(ee);ee.left=ee.right=null;ee.prev=null;ee.node=null;ee.vertices.clear();ee.next=co.zpp_pool;co.zpp_pool=ee;if(fk!=null&&fT!=null&&!(fk.id<fT.id?bv.inthash.has(fk.id,fT.id):bv.inthash.has(fT.id,fk.id))){var fW=bv.sweep.intersection(fk,fT);if(fW!=null){if(fW.vertex.x>=bv.sweep.sweepx){var en=bv.queue.parent;while(en!=null){if(bv.queue.lt(fW,en.data)){en=en.prev}else{if(bv.queue.lt(en.data,fW)){en=en.next}else{break}}}if(en==null){var el=bv.ints.parent;while(el!=null){if(bv.ints.lt(fW,el.data)){el=el.prev}else{if(bv.ints.lt(el.data,fW)){el=el.next}else{break}}}var fy=el;if(fy!=null){var fQ=fW.vertex;fQ.links.clear();fQ.node=null;fQ.forced=false;fQ.next=dG.zpp_pool;dG.zpp_pool=fQ;fW.vertex=fy.data.vertex;fy.data=fW;bv.queue.insert(fW)}else{bv.queue.insert(fW);bv.ints.insert(fW)}if(fk.id<fT.id){var eA=fk.id;var fx=fT.id;var eT;if(ca.zpp_pool==null){eT=new ca()}else{eT=ca.zpp_pool;ca.zpp_pool=eT.next;eT.next=null}eT.id=eA;eT.di=fx;var eR=eT;eR.value=true;bv.inthash.add(eR)}else{var ez=fT.id;var fv=fk.id;var eP;if(ca.zpp_pool==null){eP=new ca()}else{eP=ca.zpp_pool;ca.zpp_pool=eP.next;eP.next=null}eP.id=ez;eP.di=fv;var eM=eP;eM.value=true;bv.inthash.add(eM)}}else{var fM=fW.vertex;fM.links.clear();fM.node=null;fM.forced=false;fM.next=dG.zpp_pool;dG.zpp_pool=fM;fW.vertex=null;fW.segment=fW.segment2=null;fW.node=null;fW.next=dI.zpp_pool;dI.zpp_pool=fW}}else{var fJ=fW.vertex;fJ.links.clear();fJ.node=null;fJ.forced=false;fJ.next=dG.zpp_pool;dG.zpp_pool=fJ;fW.vertex=null;fW.segment=fW.segment2=null;fW.node=null;fW.next=dI.zpp_pool;dI.zpp_pool=fW}}}}}else{var fR=fl.vertex;var gd=fR.node==null;var fn=fl.segment;var fm=fl.segment2;if(fm.next!=fn){var fa=fn;fn=fm;fm=fa}var ej=fn.vertices.parent;while(ej!=null){if(fn.vertices.lt(fR,ej.data)){ej=ej.prev}else{if(fn.vertices.lt(ej.data,fR)){ej=ej.next}else{break}}}var ec=ej==null;var eh=fm.vertices.parent;while(eh!=null){if(fm.vertices.lt(fR,eh.data)){eh=eh.prev}else{if(fm.vertices.lt(eh.data,fR)){eh=eh.next}else{break}}}var ef=eh==null;if(ec){var f7=fn.vertices.insert(fR);var e6=fR==fn.left?fR:fn.vertices.predecessor_node(f7).data;var ed=fR==fn.right?fR:fn.vertices.successor_node(f7).data;e6.links.remove(ed);if(fR!=e6){e6.links.insert(fR)}ed.links.remove(e6);if(fR!=ed){ed.links.insert(fR)}if(fR!=e6){fR.links.insert(e6)}if(fR!=ed){fR.links.insert(ed)}}if(ef){var f8=fm.vertices.insert(fR);var ex=fR==fm.left?fR:fm.vertices.predecessor_node(f8).data;var eH=fR==fm.right?fR:fm.vertices.successor_node(f8).data;ex.links.remove(eH);if(fR!=ex){ex.links.insert(fR)}eH.links.remove(ex);if(fR!=eH){eH.links.insert(fR)}if(fR!=ex){fR.links.insert(ex)}if(fR!=eH){fR.links.insert(eH)}}if(gd){fR.node=bv.vertices.insert(fR)}fR.forced=true;if(gd){var fI=fn.node;var fp=fm.node;fI.data=fm;fp.data=fn;fn.node=fp;fm.node=fI;fm.next=fn.next;fn.next=fm;fn.prev=fm.prev;fm.prev=fn;if(fn.prev!=null){fn.prev.next=fn}if(fm.next!=null){fm.next.prev=fm}}if(fm.next!=null&&fm!=null&&!(fm.next.id<fm.id?bv.inthash.has(fm.next.id,fm.id):bv.inthash.has(fm.id,fm.next.id))){var fO=bv.sweep.intersection(fm.next,fm);if(fO!=null){if(fO.vertex.x>=bv.sweep.sweepx){var eg=bv.queue.parent;while(eg!=null){if(bv.queue.lt(fO,eg.data)){eg=eg.prev}else{if(bv.queue.lt(eg.data,fO)){eg=eg.next}else{break}}}if(eg==null){var fG=bv.ints.parent;while(fG!=null){if(bv.ints.lt(fO,fG.data)){fG=fG.prev}else{if(bv.ints.lt(fG.data,fO)){fG=fG.next}else{break}}}var fw=fG;if(fw!=null){var eZ=fO.vertex;eZ.links.clear();eZ.node=null;eZ.forced=false;eZ.next=dG.zpp_pool;dG.zpp_pool=eZ;fO.vertex=fw.data.vertex;fw.data=fO;bv.queue.insert(fO)}else{bv.queue.insert(fO);bv.ints.insert(fO)}if(fm.next.id<fm.id){var ey=fm.next.id;var ft=fm.id;var eK;if(ca.zpp_pool==null){eK=new ca()}else{eK=ca.zpp_pool;ca.zpp_pool=eK.next;eK.next=null}eK.id=ey;eK.di=ft;var eJ=eK;eJ.value=true;bv.inthash.add(eJ)}else{var ew=fm.id;var fs=fm.next.id;var eI;if(ca.zpp_pool==null){eI=new ca()}else{eI=ca.zpp_pool;ca.zpp_pool=eI.next;eI.next=null}eI.id=ew;eI.di=fs;var eq=eI;eq.value=true;bv.inthash.add(eq)}}else{var eW=fO.vertex;eW.links.clear();eW.node=null;eW.forced=false;eW.next=dG.zpp_pool;dG.zpp_pool=eW;fO.vertex=null;fO.segment=fO.segment2=null;fO.node=null;fO.next=dI.zpp_pool;dI.zpp_pool=fO}}else{var eU=fO.vertex;eU.links.clear();eU.node=null;eU.forced=false;eU.next=dG.zpp_pool;dG.zpp_pool=eU;fO.vertex=null;fO.segment=fO.segment2=null;fO.node=null;fO.next=dI.zpp_pool;dI.zpp_pool=fO}}}if(fn!=null&&fn.prev!=null&&!(fn.id<fn.prev.id?bv.inthash.has(fn.id,fn.prev.id):bv.inthash.has(fn.prev.id,fn.id))){var fL=bv.sweep.intersection(fn,fn.prev);if(fL!=null){if(fL.vertex.x>=bv.sweep.sweepx){var fF=bv.queue.parent;while(fF!=null){if(bv.queue.lt(fL,fF.data)){fF=fF.prev}else{if(bv.queue.lt(fF.data,fL)){fF=fF.next}else{break}}}if(fF==null){var fE=bv.ints.parent;while(fE!=null){if(bv.ints.lt(fL,fE.data)){fE=fE.prev}else{if(bv.ints.lt(fE.data,fL)){fE=fE.next}else{break}}}var fu=fE;if(fu!=null){var eS=fL.vertex;eS.links.clear();eS.node=null;eS.forced=false;eS.next=dG.zpp_pool;dG.zpp_pool=eS;fL.vertex=fu.data.vertex;fu.data=fL;bv.queue.insert(fL)}else{bv.queue.insert(fL);bv.ints.insert(fL)}if(fn.id<fn.prev.id){var ev=fn.id;var fq=fn.prev.id;var eo;if(ca.zpp_pool==null){eo=new ca()}else{eo=ca.zpp_pool;ca.zpp_pool=eo.next;eo.next=null}eo.id=ev;eo.di=fq;var em=eo;em.value=true;bv.inthash.add(em)}else{var eu=fn.prev.id;var fo=fn.id;var ek;if(ca.zpp_pool==null){ek=new ca()}else{ek=ca.zpp_pool;ca.zpp_pool=ek.next;ek.next=null}ek.id=eu;ek.di=fo;var ei=ek;ei.value=true;bv.inthash.add(ei)}}else{var eQ=fL.vertex;eQ.links.clear();eQ.node=null;eQ.forced=false;eQ.next=dG.zpp_pool;dG.zpp_pool=eQ;fL.vertex=null;fL.segment=fL.segment2=null;fL.node=null;fL.next=dI.zpp_pool;dI.zpp_pool=fL}}else{var eN=fL.vertex;eN.links.clear();eN.node=null;eN.forced=false;eN.next=dG.zpp_pool;dG.zpp_pool=eN;fL.vertex=null;fL.segment=fL.segment2=null;fL.node=null;fL.next=dI.zpp_pool;dI.zpp_pool=fL}}}bv.ints.remove(fl)}}fl.vertex=null;fl.segment=fl.segment2=null;fl.node=null;fl.next=dI.zpp_pool;dI.zpp_pool=fl}var eb=0;var ea=bv.inthash.table.length;while(eb<ea){var fg=eb++;var fe=bv.inthash.table[fg];if(fe==null){continue}while(fe!=null){var gc=fe.hnext;fe.hnext=null;var eL=fe;eL.next=ca.zpp_pool;ca.zpp_pool=eL;fe=gc}bv.inthash.table[fg]=null}if(e9==null){e9=new dA()}while(!bv.vertices.empty()){bv.clip_polygon(bv.vertices,e9)}return e9};bv.clip_polygon=function(ed,eb){var ex=null;var ef=ed.first();var er=ef;var eA=ef.links.parent;var ej=eA.prev==null?eA.next:eA.prev;var eH=eA.data;var eM=ej.data;var ev=0;var et=0;ev=ef.x-eH.x;et=ef.y-eH.y;var eh=0;var eg=0;eh=eM.x-ef.x;eg=eM.y-ef.y;if(eg*ev-eh*et<0){eM=eH}var eE=ef.x;var eC=ef.y;var eF;if(dr.zpp_pool==null){eF=new dr()}else{eF=dr.zpp_pool;dr.zpp_pool=eF.next;eF.next=null}eF.forced=false;eF.x=eE;eF.y=eC;var ec=eF;if(ex==null){ex=ec.prev=ec.next=ec}else{ec.prev=ex;ec.next=ex.next;ex.next.prev=ec;ex.next=ec}ex=ec;ec.forced=ef.forced;while(true){ef.links.remove(eM);eM.links.remove(ef);if(eM==er){if(ef.links.empty()){ed.remove(ef);var eL=ef;eL.links.clear();eL.node=null;eL.forced=false;eL.next=dG.zpp_pool;dG.zpp_pool=eL}break}var em=eM.x;var eO=eM.y;var eD;if(dr.zpp_pool==null){eD=new dr()}else{eD=dr.zpp_pool;dr.zpp_pool=eD.next;eD.next=null}eD.forced=false;eD.x=em;eD.y=eO;var ee=eD;if(ex==null){ex=ee.prev=ee.next=ee}else{ee.prev=ex;ee.next=ex.next;ex.next.prev=ee;ex.next=ee}ex=ee;ee.forced=eM.forced;if(eM.links.singular()){if(ef.links.empty()){ed.remove(ef);var ek=ef;ek.links.clear();ek.node=null;ek.forced=false;ek.next=dG.zpp_pool;dG.zpp_pool=ek}ef=eM;eM=eM.links.parent.data}else{var eN=null;var eu=0;if(!eM.links.empty()){var ew=eM.links.parent;while(ew.prev!=null){ew=ew.prev}while(ew!=null){var eK=ew.data;if(eN==null){eN=eK;var eJ=0;var es=0;eJ=eM.x-ef.x;es=eM.y-ef.y;var eB=0;var eo=0;eB=eK.x-eM.x;eo=eK.y-eM.y;eu=eo*eJ-eB*es}else{var eI=0;var eq=0;eI=eM.x-ef.x;eq=eM.y-ef.y;var ez=0;var en=0;ez=eK.x-eM.x;en=eK.y-eM.y;var ea=en*eI-ez*eq;if(ea>0&&eu<=0){eN=eK;eu=ea}else{if(eu*ea>=0){var eG=0;var ep=0;eG=eM.x-eK.x;ep=eM.y-eK.y;var ey=0;var el=0;ey=eN.x-eM.x;el=eN.y-eM.y;if(el*eG-ey*ep>0){eN=eK;eu=ea}}}}if(ew.next!=null){ew=ew.next;while(ew.prev!=null){ew=ew.prev}}else{while(ew.parent!=null&&ew==ew.parent.next){ew=ew.parent}ew=ew.parent}}}if(ef.links.empty()){ed.remove(ef);var ei=ef;ei.links.clear();ei.node=null;ei.forced=false;ei.next=dG.zpp_pool;dG.zpp_pool=ei}ef=eM;eM=eN}}ed.remove(er);er.links.clear();er.node=null;er.forced=false;er.next=dG.zpp_pool;dG.zpp_pool=er;eb.add(ex)};bv.isSimple=function(ep){if(bv.sweep==null){bv.sweep=new bz();bv.inthash=new bK()}var eb=bv.list_vertices;if(eb==null){eb=bv.list_vertices=new a8()}if(ep!=null){var ec=ep;while(true){var eA=ec;var ey=eA.x;var ew=eA.y;var eq;if(dG.zpp_pool==null){eq=new dG()}else{eq=dG.zpp_pool;dG.zpp_pool=eq.next;eq.next=null}eq.x=ey;eq.y=ew;eb.add(eq);ec=ec.next;if(!(ec!=ep)){break}}}var ef=bv.list_queue;if(ef==null){ef=bv.list_queue=new dC()}var eg=eb.head;var eB=eg.elt;eg=eg.next;while(eg!=null){var eK=eg.elt;var ez;if(dI.zpp_pool==null){ez=new dI()}else{ez=dI.zpp_pool;dI.zpp_pool=ez.next;ez.next=null}ez.vertex=eB;var eo=ef.add(ez);var ex;if(dI.zpp_pool==null){ex=new dI()}else{ex=dI.zpp_pool;dI.zpp_pool=ex.next;ex.next=null}ex.vertex=eK;var en=ef.add(ex);var eD;if(dI.less_xy(eo,en)){eo.type=1;en.type=2;eD=co.get(eB,eK)}else{eo.type=2;en.type=1;eD=co.get(eK,eB)}eo.segment=en.segment=eD;eB=eK;eg=eg.next}var eJ=eb.head.elt;var ev;if(dI.zpp_pool==null){ev=new dI()}else{ev=dI.zpp_pool;dI.zpp_pool=ev.next;ev.next=null}ev.vertex=eB;var eC=ef.add(ev);var eu;if(dI.zpp_pool==null){eu=new dI()}else{eu=dI.zpp_pool;dI.zpp_pool=eu.next;eu.next=null}eu.vertex=eJ;var ek=ef.add(eu);var eI;if(dI.less_xy(eC,ek)){eC.type=1;ek.type=2;eI=co.get(eB,eJ)}else{eC.type=2;ek.type=1;eI=co.get(eJ,eB)}eC.segment=ek.segment=eI;var em=ef;if(em.head!=null&&em.head.next!=null){var ei=em.head;var eL=null;var ee=null;var eE=null;var eG=null;var ej=1;var ed;var er;var ea;while(true){ed=0;ee=ei;ei=null;eL=ei;while(ee!=null){++ed;eE=ee;er=0;ea=ej;while(eE!=null&&er<ej){++er;eE=eE.next}while(er>0||ea>0&&eE!=null){if(er==0){eG=eE;eE=eE.next;--ea}else{if(ea==0||eE==null){eG=ee;ee=ee.next;--er}else{if(dI.less_xy(ee.elt,eE.elt)){eG=ee;ee=ee.next;--er}else{eG=eE;eE=eE.next;--ea}}}if(eL!=null){eL.next=eG}else{ei=eG}eL=eG}ee=eE}eL.next=null;ej<<=1;if(!(ed>1)){break}}em.head=ei;em.modified=true;em.pushmod=true}var et=true;while(ef.head!=null){var eH=ef.pop_unsafe();var es=eH.segment;if(eH.type==1){bv.sweep.add(es);if(bv.sweep.intersect(es,es.next)||bv.sweep.intersect(es,es.prev)){et=false;break}}else{if(eH.type==2){if(bv.sweep.intersect(es.prev,es.next)){et=false;break}bv.sweep.remove(es);es.left=es.right=null;es.prev=null;es.node=null;es.vertices.clear();es.next=co.zpp_pool;co.zpp_pool=es}}eH.vertex=null;eH.segment=eH.segment2=null;eH.node=null;eH.next=dI.zpp_pool;dI.zpp_pool=eH}while(ef.head!=null){var el=ef.pop_unsafe();if(el.type==2){var eF=el.segment;eF.left=eF.right=null;eF.prev=null;eF.node=null;eF.vertices.clear();eF.next=co.zpp_pool;co.zpp_pool=eF}el.vertex=null;el.segment=el.segment2=null;el.node=null;el.next=dI.zpp_pool;dI.zpp_pool=el}bv.sweep.clear();while(eb.head!=null){var eh=eb.pop_unsafe();eh.links.clear();eh.node=null;eh.forced=false;eh.next=dG.zpp_pool;dG.zpp_pool=eh}return et};bv.prototype.__class__=bv;var cD=zpp_nape.geom.ZPP_SimplifyV=function(){this.forced=false;this.flag=false;this.prev=null;this.next=null;this.y=0;this.x=0};cD.__name__=["zpp_nape","geom","ZPP_SimplifyV"];cD.get=function(ea){var eb;if(cD.zpp_pool==null){eb=new cD()}else{eb=cD.zpp_pool;cD.zpp_pool=eb.next;eb.next=null}eb.x=ea.x;eb.y=ea.y;eb.flag=false;return eb};cD.prototype.x=null;cD.prototype.y=null;cD.prototype.next=null;cD.prototype.prev=null;cD.prototype.flag=null;cD.prototype.forced=null;cD.prototype.free=function(){};cD.prototype.alloc=function(){};cD.prototype.__class__=cD;var cG=zpp_nape.geom.ZPP_SimplifyP=function(){this.max=null;this.min=null;this.next=null};cG.__name__=["zpp_nape","geom","ZPP_SimplifyP"];cG.get=function(ec,ea){var eb;if(cG.zpp_pool==null){eb=new cG()}else{eb=cG.zpp_pool;cG.zpp_pool=eb.next;eb.next=null}eb.min=ec;eb.max=ea;return eb};cG.prototype.next=null;cG.prototype.min=null;cG.prototype.max=null;cG.prototype.free=function(){this.min=this.max=null};cG.prototype.alloc=function(){};cG.prototype.__class__=cG;var aL=zpp_nape.geom.ZPP_Simplify=function(){};aL.__name__=["zpp_nape","geom","ZPP_Simplify"];aL.lessval=function(eb,ea){return eb.x-ea.x+(eb.y-ea.y)};aL.less=function(eb,ea){return eb.x-ea.x+(eb.y-ea.y)<0};aL.distance=function(ej,ei,eh){var ee=0;var ed=0;ee=eh.x-ei.x;ed=eh.y-ei.y;var ec=0;var eb=0;ec=ej.x-ei.x;eb=ej.y-ei.y;if(ee*ee+ed*ed==0){return ec*ec+eb*eb}else{var el=(ec*ee+eb*ed)/(ee*ee+ed*ed);if(el<=0){return ec*ec+eb*eb}else{if(el>=1){var ea=ej.x;var en=ej.y;var eg=eh.x;var ef=eh.y;var em=0;var ek=0;em=ea-eg;ek=en-ef;return em*em+ek*ek}else{ec-=ee*el;eb-=ed*el;return ec*ec+eb*eb}}}};aL.simplify=function(ee,eE){var ep=null;var eK=null;var en=null;eE*=eE;if(aL.stack==null){aL.stack=new c0()}var eD=null;var em=null;var ef=ee;while(true){var eA;if(cD.zpp_pool==null){eA=new cD()}else{eA=cD.zpp_pool;cD.zpp_pool=eA.next;eA.next=null}eA.x=ef.x;eA.y=ef.y;eA.flag=false;var eC=eA;eC.forced=ef.forced;if(eC.forced){eC.flag=true;if(eD!=null){var ey;if(cG.zpp_pool==null){ey=new cG()}else{ey=cG.zpp_pool;cG.zpp_pool=ey.next;ey.next=null}ey.min=eD;ey.max=eC;aL.stack.add(ey)}else{em=eC}eD=eC}if(ep==null){ep=eC.prev=eC.next=eC}else{eC.prev=ep;eC.next=ep.next;ep.next.prev=eC;ep.next=eC}ep=eC;if(eK==null){eK=eC;en=eC}else{if(eC.x-eK.x+(eC.y-eK.y)<0){eK=eC}if(en.x-eC.x+(en.y-eC.y)<0){en=eC}}ef=ef.next;if(!(ef!=ee)){break}}if(aL.stack.head==null){if(em==null){eK.flag=en.flag=true;var ew;if(cG.zpp_pool==null){ew=new cG()}else{ew=cG.zpp_pool;cG.zpp_pool=ew.next;ew.next=null}ew.min=eK;ew.max=en;aL.stack.add(ew);var ev;if(cG.zpp_pool==null){ev=new cG()}else{ev=cG.zpp_pool;cG.zpp_pool=ev.next;ev.next=null}ev.min=en;ev.max=eK;aL.stack.add(ev)}else{var eI=eK.x-em.x+(eK.y-em.y);if(eI<0){eI=-eI}var eG=en.x-em.x+(en.y-em.y);if(eG<0){eG=-eG}if(eI>eG){eK.flag=em.flag=true;var eu;if(cG.zpp_pool==null){eu=new cG()}else{eu=cG.zpp_pool;cG.zpp_pool=eu.next;eu.next=null}eu.min=eK;eu.max=em;aL.stack.add(eu);var et;if(cG.zpp_pool==null){et=new cG()}else{et=cG.zpp_pool;cG.zpp_pool=et.next;et.next=null}et.min=em;et.max=eK;aL.stack.add(et)}else{en.flag=em.flag=true;var es;if(cG.zpp_pool==null){es=new cG()}else{es=cG.zpp_pool;cG.zpp_pool=es.next;es.next=null}es.min=en;es.max=em;aL.stack.add(es);var er;if(cG.zpp_pool==null){er=new cG()}else{er=cG.zpp_pool;cG.zpp_pool=er.next;er.next=null}er.min=em;er.max=en;aL.stack.add(er)}}}else{var eq;if(cG.zpp_pool==null){eq=new cG()}else{eq=cG.zpp_pool;cG.zpp_pool=eq.next;eq.next=null}eq.min=eD;eq.max=em;aL.stack.add(eq)}while(aL.stack.head!=null){var el=aL.stack.pop_unsafe();var eg=el.min;var eH=el.max;el.min=el.max=null;el.next=cG.zpp_pool;cG.zpp_pool=el;var eo=eE;var ec=null;var eJ=eg.next;while(eJ!=eH){var ed=aL.distance(eJ,eg,eH);if(ed>eo){eo=ed;ec=eJ}eJ=eJ.next}if(ec!=null){ec.flag=true;var ek;if(cG.zpp_pool==null){ek=new cG()}else{ek=cG.zpp_pool;cG.zpp_pool=ek.next;ek.next=null}ek.min=eg;ek.max=ec;aL.stack.add(ek);var ej;if(cG.zpp_pool==null){ej=new cG()}else{ej=cG.zpp_pool;cG.zpp_pool=ej.next;ej.next=null}ej.min=ec;ej.max=eH;aL.stack.add(ej)}}var eb=null;while(ep!=null){if(ep.flag){var ez=ep.x;var ex=ep.y;var ei;if(dr.zpp_pool==null){ei=new dr()}else{ei=dr.zpp_pool;dr.zpp_pool=ei.next;ei.next=null}ei.forced=false;ei.x=ez;ei.y=ex;var ea=ei;if(eb==null){eb=ea.prev=ea.next=ea}else{ea.prev=eb;ea.next=eb.next;eb.next.prev=ea;eb.next=ea}eb=ea;ea.forced=ep.forced}if(ep!=null&&ep.prev==ep){ep.next=ep.prev=null;var eF=ep;eF.next=cD.zpp_pool;cD.zpp_pool=eF;ep=null;ep=ep}else{var eB=ep.next;ep.prev.next=ep.next;ep.next.prev=ep.prev;ep.next=ep.prev=null;var eh=ep;eh.next=cD.zpp_pool;cD.zpp_pool=eh;ep=null;ep=eB}}return eb};aL.prototype.__class__=aL;var ct=zpp_nape.geom.ZPP_ToiEvent=function(){this.kinematic=false;this.failed=false;this.slipped=false;this.axis=null;this.c2=null;this.c1=null;this.frozen2=false;this.frozen1=false;this.arbiter=null;this.s2=null;this.s1=null;this.toi=0;this.next=null;this.c1=new bB();this.c2=new bB();this.axis=new bB()};ct.__name__=["zpp_nape","geom","ZPP_ToiEvent"];ct.prototype.next=null;ct.prototype.alloc=function(){this.failed=false;this.s1=this.s2=null;this.arbiter=null};ct.prototype.free=function(){};ct.prototype.toi=null;ct.prototype.s1=null;ct.prototype.s2=null;ct.prototype.arbiter=null;ct.prototype.frozen1=null;ct.prototype.frozen2=null;ct.prototype.c1=null;ct.prototype.c2=null;ct.prototype.axis=null;ct.prototype.slipped=null;ct.prototype.failed=null;ct.prototype.kinematic=null;ct.prototype.__class__=ct;var de=zpp_nape.geom.ZPP_SweepDistance=function(){};de.__name__=["zpp_nape","geom","ZPP_SweepDistance"];de.dynamicSweep=function(eC,h7,gR,kq,hj){if(hj==null){hj=false}var gx=eC.s1;var gv=eC.s2;var kp=gx.body;var ko=gv.body;var jS=0;var jQ=0;jS=ko.velx-kp.velx;jQ=ko.vely-kp.vely;var gZ=kp.angvel;if(gZ<0){gZ=-gZ}var gY=ko.angvel;if(gY<0){gY=-gY}var fF=gx.sweepCoef*gZ+gv.sweepCoef*gY;if(!hj&&!eC.kinematic&&jS*jS+jQ*jQ<P.dynamicSweepLinearThreshold*P.dynamicSweepLinearThreshold&&fF<P.dynamicSweepAngularThreshold){eC.toi=-1;eC.failed=true;return}var ka=eC.c1;var j9=eC.c2;var iH=eC.axis;var iQ=gR;var eS=0;while(true){var jc=iQ*h7;var ev=jc-kp.sweepTime;if(ev!=0){kp.sweepTime=jc;kp.posx+=kp.velx*ev;kp.posy+=kp.vely*ev;if(kp.angvel!=0){var jd=kp.sweep_angvel*ev;kp.rot+=jd;if(jd*jd>0.0001){kp.axisx=Math.sin(kp.rot);kp.axisy=Math.cos(kp.rot)}else{var jZ=jd*jd;var jC=1-0.5*jZ;var jF=1-jZ*jZ/8;var g6=(jC*kp.axisx+jd*kp.axisy)*jF;kp.axisy=(jC*kp.axisy-jd*kp.axisx)*jF;kp.axisx=g6}}}if(gx.type==0){gx.worldCOMx=kp.posx+(kp.axisy*gx.localCOMx-kp.axisx*gx.localCOMy);gx.worldCOMy=kp.posy+(gx.localCOMx*kp.axisx+gx.localCOMy*kp.axisy)}else{var hf=gx.polygon;var hs=hf.lverts.next;var iG=hf.gverts.next;while(iG!=null){var jL=iG;var jG=hs;hs=hs.next;jL.x=kp.posx+(kp.axisy*jG.x-kp.axisx*jG.y);jL.y=kp.posy+(jG.x*kp.axisx+jG.y*kp.axisy);iG=iG.next}var iw=hf.edges.head;var fv=hf.gverts.next;var jr=fv;fv=fv.next;while(fv!=null){var jp=fv;var jO=iw.elt;iw=iw.next;jO.gnormx=kp.axisy*jO.lnormx-kp.axisx*jO.lnormy;jO.gnormy=jO.lnormx*kp.axisx+jO.lnormy*kp.axisy;jO.gprojection=kp.posx*jO.gnormx+kp.posy*jO.gnormy+jO.lprojection;jO.tp0=jr.y*jO.gnormx-jr.x*jO.gnormy;jO.tp1=jp.y*jO.gnormx-jp.x*jO.gnormy;jr=jp;fv=fv.next}var fB=hf.gverts.next;var jD=iw.elt;jD.gnormx=kp.axisy*jD.lnormx-kp.axisx*jD.lnormy;jD.gnormy=jD.lnormx*kp.axisx+jD.lnormy*kp.axisy;jD.gprojection=kp.posx*jD.gnormx+kp.posy*jD.gnormy+jD.lprojection;jD.tp0=jr.y*jD.gnormx-jr.x*jD.gnormy;jD.tp1=fB.y*jD.gnormx-fB.x*jD.gnormy}var ki=iQ*h7;var km=ki-ko.sweepTime;if(km!=0){ko.sweepTime=ki;ko.posx+=ko.velx*km;ko.posy+=ko.vely*km;if(ko.angvel!=0){var eB=ko.sweep_angvel*km;ko.rot+=eB;if(eB*eB>0.0001){ko.axisx=Math.sin(ko.rot);ko.axisy=Math.cos(ko.rot)}else{var iv=eB*eB;var he=1-0.5*iv;var hG=1-iv*iv/8;var gk=(he*ko.axisx+eB*ko.axisy)*hG;ko.axisy=(he*ko.axisy-eB*ko.axisx)*hG;ko.axisx=gk}}}if(gv.type==0){gv.worldCOMx=ko.posx+(ko.axisy*gv.localCOMx-ko.axisx*gv.localCOMy);gv.worldCOMy=ko.posy+(gv.localCOMx*ko.axisx+gv.localCOMy*ko.axisy)}else{var hc=gv.polygon;var gX=hc.lverts.next;var ft=hc.gverts.next;while(ft!=null){var iZ=ft;var hZ=gX;gX=gX.next;iZ.x=ko.posx+(ko.axisy*hZ.x-ko.axisx*hZ.y);iZ.y=ko.posy+(hZ.x*ko.axisx+hZ.y*ko.axisy);ft=ft.next}var fM=hc.edges.head;var fr=hc.gverts.next;var fJ=fr;fr=fr.next;while(fr!=null){var fA=fr;var jB=fM.elt;fM=fM.next;jB.gnormx=ko.axisy*jB.lnormx-ko.axisx*jB.lnormy;jB.gnormy=jB.lnormx*ko.axisx+jB.lnormy*ko.axisy;jB.gprojection=ko.posx*jB.gnormx+ko.posy*jB.gnormy+jB.lprojection;jB.tp0=fJ.y*jB.gnormx-fJ.x*jB.gnormy;jB.tp1=fA.y*jB.gnormx-fA.x*jB.gnormy;fJ=fA;fr=fr.next}var fz=hc.gverts.next;var jz=fM.elt;jz.gnormx=ko.axisy*jz.lnormx-ko.axisx*jz.lnormy;jz.gnormy=jz.lnormx*ko.axisx+jz.lnormy*ko.axisy;jz.gprojection=ko.posx*jz.gnormx+ko.posy*jz.gnormy+jz.lprojection;jz.tp0=fJ.y*jz.gnormx-fJ.x*jz.gnormy;jz.tp1=fz.y*jz.gnormx-fz.x*jz.gnormy}var jP=gx;var jn=gv;var fe=ka;var fd=j9;var eY;if(gx.type==0&&gv.type==0){var j4=gx.circle;var jU=gv.circle;var hM;var gj=0;var g5=0;gj=jU.worldCOMx-j4.worldCOMx;g5=jU.worldCOMy-j4.worldCOMy;var ho=Math.sqrt(gj*gj+g5*g5);hM=ho-(j4.radius+jU.radius);if(hM<1e+100){if(ho==0){gj=1;g5=0}else{var ju=1/ho;gj*=ju;g5*=ju}var f4=j4.radius;ka.x=j4.worldCOMx+gj*f4;ka.y=j4.worldCOMy+g5*f4;var f2=-jU.radius;j9.x=jU.worldCOMx+gj*f2;j9.y=jU.worldCOMy+g5*f2;iH.x=gj;iH.y=g5}eY=hM}else{var jA=false;if(gx.type==0&&gv.type==1){var gB=gx;jP=gv;jn=gB;var gz=ka;fe=j9;fd=gz;jA=true}if(jP.type==1&&jn.type==0){var fN=jP.polygon;var h2=jn.circle;var fZ=-1e+100;var es=null;var fp=fN.edges.head;while(fp!=null){var jR=fp.elt;var kg=jR.gnormx*h2.worldCOMx+jR.gnormy*h2.worldCOMy-jR.gprojection-h2.radius;if(kg>1e+100){fZ=kg;break}if(kg>0){if(kg>fZ){fZ=kg;es=jR}}else{if(fZ<0&&kg>fZ){fZ=kg;es=jR}}fp=fp.next}if(fZ<1e+100){var fC=es.gp0;var eZ=es.gp1;var kh=h2.worldCOMy*es.gnormx-h2.worldCOMx*es.gnormy;if(kh<=fC.y*es.gnormx-fC.x*es.gnormy){var gi=0;var fS=0;gi=h2.worldCOMx-fC.x;fS=h2.worldCOMy-fC.y;var fc=Math.sqrt(gi*gi+fS*fS);fZ=fc-h2.radius;if(fZ<1e+100){if(fc==0){gi=1;fS=0}else{var f1=1/fc;gi*=f1;fS*=f1}fe.x=fC.x+gi*0;fe.y=fC.y+fS*0;var f0=-h2.radius;fd.x=h2.worldCOMx+gi*f0;fd.y=h2.worldCOMy+fS*f0;iH.x=gi;iH.y=fS}}else{if(kh>=eZ.y*es.gnormx-eZ.x*es.gnormy){var gh=0;var fR=0;gh=h2.worldCOMx-eZ.x;fR=h2.worldCOMy-eZ.y;var fb=Math.sqrt(gh*gh+fR*fR);fZ=fb-h2.radius;if(fZ<1e+100){if(fb==0){gh=1;fR=0}else{var fY=1/fb;gh*=fY;fR*=fY}fe.x=eZ.x+gh*0;fe.y=eZ.y+fR*0;var fX=-h2.radius;fd.x=h2.worldCOMx+gh*fX;fd.y=h2.worldCOMy+fR*fX;iH.x=gh;iH.y=fR}}else{var fW=-h2.radius;fd.x=h2.worldCOMx+es.gnormx*fW;fd.y=h2.worldCOMy+es.gnormy*fW;var fU=-fZ;fe.x=fd.x+es.gnormx*fU;fe.y=fd.y+es.gnormy*fU;iH.x=es.gnormx;iH.y=es.gnormy}}}if(jA){iH.x=-iH.x;iH.y=-iH.y}eY=fZ}else{var iz=jP.polygon;var h6=jn.polygon;var hn=-1e+100;var er=null;var eq=null;var g4=0;var fn=iz.edges.head;while(fn!=null){var eo=fn.elt;var eE=1e+100;var fm=h6.gverts.next;while(fm!=null){var fy=fm;var jH=eo.gnormx*fy.x+eo.gnormy*fy.y;if(jH<eE){eE=jH}fm=fm.next}eE-=eo.gprojection;if(eE>1e+100){hn=eE;break}if(eE>0){if(eE>hn){hn=eE;er=eo;g4=1}}else{if(hn<0&&eE>hn){hn=eE;er=eo;g4=1}}fn=fn.next}if(hn<1e+100){var fl=h6.edges.head;while(fl!=null){var en=fl.elt;var gq=1e+100;var fk=iz.gverts.next;while(fk!=null){var fx=fk;var ik=en.gnormx*fx.x+en.gnormy*fx.y;if(ik<gq){gq=ik}fk=fk.next}gq-=en.gprojection;if(gq>1e+100){hn=gq;break}if(gq>0){if(gq>hn){hn=gq;eq=en;g4=2}}else{if(hn<0&&gq>hn){hn=gq;eq=en;g4=2}}fl=fl.next}if(hn<1e+100){var gP;var j7;if(g4==1){gP=h6;j7=er}else{gP=iz;j7=eq;var gy=fe;fe=fd;fd=gy;jA=!jA}var j6=null;var go=1e+100;var fi=gP.edges.head;while(fi!=null){var em=fi.elt;var ii=j7.gnormx*em.gnormx+j7.gnormy*em.gnormy;if(ii<go){go=ii;j6=em}fi=fi.next}if(jA){iH.x=-j7.gnormx;iH.y=-j7.gnormy}else{iH.x=j7.gnormx;iH.y=j7.gnormy}if(hn>=0){var fj=j7.gp0;var eX=j7.gp1;var gT=j6.gp0;var gQ=j6.gp1;var eO=0;var eN=0;var gs=0;var gr=0;eO=eX.x-fj.x;eN=eX.y-fj.y;gs=gQ.x-gT.x;gr=gQ.y-gT.y;var jo=1/(eO*eO+eN*eN);var eF=1/(gs*gs+gr*gr);var io=-(eO*(fj.x-gT.x)+eN*(fj.y-gT.y))*jo;var h3=-(eO*(fj.x-gQ.x)+eN*(fj.y-gQ.y))*jo;var jN=-(gs*(gT.x-fj.x)+gr*(gT.y-fj.y))*eF;var jm=-(gs*(gT.x-eX.x)+gr*(gT.y-eX.y))*eF;if(io<0){io=0}else{if(io>1){io=1}}if(h3<0){h3=0}else{if(h3>1){h3=1}}if(jN<0){jN=0}else{if(jN>1){jN=1}}if(jm<0){jm=0}else{if(jm>1){jm=1}}var eJ=0;var eI=0;var fT=io;eJ=fj.x+eO*fT;eI=fj.y+eN*fT;var eu=0;var et=0;var iq=h3;eu=fj.x+eO*iq;et=fj.y+eN*iq;var jf=0;var je=0;var im=jN;jf=gT.x+gs*im;je=gT.y+gr*im;var iX=0;var iV=0;var il=jm;iX=gT.x+gs*il;iV=gT.y+gr*il;var jX=gT.x;var jW=gT.y;var jb=0;var ja=0;jb=eJ-jX;ja=eI-jW;var j0=jb*jb+ja*ja;var gH=gQ.x;var gf=gQ.y;var i9=0;var iU=0;i9=eu-gH;iU=et-gf;var iu=i9*i9+iU*iU;var gG=fj.x;var gd=fj.y;var i8=0;var iT=0;i8=jf-gG;iT=je-gd;var hg=i8*i8+iT*iT;var gF=eX.x;var gb=eX.y;var i7=0;var iS=0;i7=iX-gF;iS=iV-gb;var gS=i7*i7+iS*iS;var eL=0;var eK=0;var fE=null;if(j0<iu){eL=eJ;eK=eI;fE=gT}else{eL=eu;eK=et;fE=gQ;j0=iu}var ex=0;var ew=0;var fD=null;if(hg<gS){ex=jf;ew=je;fD=fj}else{ex=iX;ew=iV;fD=eX;hg=gS}if(j0<hg){fe.x=eL;fe.y=eK;fd.x=fE.x;fd.y=fE.y;hn=Math.sqrt(j0)}else{fd.x=ex;fd.y=ew;fe.x=fD.x;fe.y=fD.y;hn=Math.sqrt(hg)}if(hn!=0){iH.x=fd.x-fe.x;iH.y=fd.y-fe.y;var ij=1/hn;iH.x*=ij;iH.y*=ij;if(jA){iH.x=-iH.x;iH.y=-iH.y}}eY=hn}else{var jJ=0;var jI=0;jJ=j6.gp0.x;jI=j6.gp0.y;var jj=0;var jh=0;jj=j6.gp1.x;jh=j6.gp1.y;var i1=0;var i0=0;i1=jj-jJ;i0=jh-jI;var j1=j7.gnormy*jJ-j7.gnormx*jI;var iE=j7.gnormy*jj-j7.gnormx*jh;var hr=1/(iE-j1);var ih=(-j7.tp1-j1)*hr;if(ih>P.epsilon){jJ+=i1*ih;jI+=i0*ih}var ig=(-j7.tp0-iE)*hr;if(ig<-P.epsilon){jj+=i1*ig;jh+=i0*ig}var jY=jJ*j7.gnormx+jI*j7.gnormy-j7.gprojection;var jw=jj*j7.gnormx+jh*j7.gnormy-j7.gprojection;if(jY<jw){fd.x=jJ;fd.y=jI;var id=-jY;fe.x=fd.x+j7.gnormx*id;fe.y=fd.y+j7.gnormy*id;eY=jY}else{fd.x=jj;fd.y=jh;var ib=-jw;fe.x=fd.x+j7.gnormx*ib;fe.y=fd.y+j7.gnormy*ib;eY=jw}}}else{eY=1e+100}}else{eY=1e+100}}}var iI=eY+kq;var eM=jS*iH.x+jQ*iH.y;if(iI<P.distanceThresholdCCD){if(hj){break}var hV=0;var hS=0;hV=ka.x-kp.posx;hS=ka.y-kp.posy;var hD=0;var hA=0;hD=j9.x-ko.posx;hA=j9.y-ko.posy;var gN=eM-kp.sweep_angvel*(iH.y*hV-iH.x*hS)+ko.sweep_angvel*(iH.y*hD-iH.x*hA);if(gN>0){eC.slipped=true}if(gN<=0||iI<P.distanceThresholdCCD*0.5){break}}var iL=(fF-eM)*h7;if(iL<=0){iQ=-1;break}var kl=iI/iL;if(kl<0.000001){kl=0.000001}iQ+=kl;if(iQ>=1){iQ=1;var kf=iQ*h7;var kk=kf-kp.sweepTime;if(kk!=0){kp.sweepTime=kf;kp.posx+=kp.velx*kk;kp.posy+=kp.vely*kk;if(kp.angvel!=0){var ez=kp.sweep_angvel*kk;kp.rot+=ez;if(ez*ez>0.0001){kp.axisx=Math.sin(kp.rot);kp.axisy=Math.cos(kp.rot)}else{var it=ez*ez;var hb=1-0.5*it;var hE=1-it*it/8;var gg=(hb*kp.axisx+ez*kp.axisy)*hE;kp.axisy=(hb*kp.axisy-ez*kp.axisx)*hE;kp.axisx=gg}}}if(gx.type==0){gx.worldCOMx=kp.posx+(kp.axisy*gx.localCOMx-kp.axisx*gx.localCOMy);gx.worldCOMy=kp.posy+(gx.localCOMx*kp.axisx+gx.localCOMy*kp.axisy)}else{var ha=gx.polygon;var gW=ha.lverts.next;var el=ha.gverts.next;while(el!=null){var iY=el;var hX=gW;gW=gW.next;iY.x=kp.posx+(kp.axisy*hX.x-kp.axisx*hX.y);iY.y=kp.posy+(hX.x*kp.axisx+hX.y*kp.axisy);el=el.next}var fL=ha.edges.head;var ej=ha.gverts.next;var fI=ej;ej=ej.next;while(ej!=null){var fw=ej;var jy=fL.elt;fL=fL.next;jy.gnormx=kp.axisy*jy.lnormx-kp.axisx*jy.lnormy;jy.gnormy=jy.lnormx*kp.axisx+jy.lnormy*kp.axisy;jy.gprojection=kp.posx*jy.gnormx+kp.posy*jy.gnormy+jy.lprojection;jy.tp0=fI.y*jy.gnormx-fI.x*jy.gnormy;jy.tp1=fw.y*jy.gnormx-fw.x*jy.gnormy;fI=fw;ej=ej.next}var fu=ha.gverts.next;var jv=fL.elt;jv.gnormx=kp.axisy*jv.lnormx-kp.axisx*jv.lnormy;jv.gnormy=jv.lnormx*kp.axisx+jv.lnormy*kp.axisy;jv.gprojection=kp.posx*jv.gnormx+kp.posy*jv.gnormy+jv.lprojection;jv.tp0=fI.y*jv.gnormx-fI.x*jv.gnormy;jv.tp1=fu.y*jv.gnormx-fu.x*jv.gnormy}var kd=iQ*h7;var kj=kd-ko.sweepTime;if(kj!=0){ko.sweepTime=kd;ko.posx+=ko.velx*kj;ko.posy+=ko.vely*kj;if(ko.angvel!=0){var ey=ko.sweep_angvel*kj;ko.rot+=ey;if(ey*ey>0.0001){ko.axisx=Math.sin(ko.rot);ko.axisy=Math.cos(ko.rot)}else{var ir=ey*ey;var g9=1-0.5*ir;var hB=1-ir*ir/8;var ge=(g9*ko.axisx+ey*ko.axisy)*hB;ko.axisy=(g9*ko.axisy-ey*ko.axisx)*hB;ko.axisx=ge}}}if(gv.type==0){gv.worldCOMx=ko.posx+(ko.axisy*gv.localCOMx-ko.axisx*gv.localCOMy);gv.worldCOMy=ko.posy+(gv.localCOMx*ko.axisx+gv.localCOMy*ko.axisy)}else{var g8=gv.polygon;var gU=g8.lverts.next;var eh=g8.gverts.next;while(eh!=null){var iW=eh;var hU=gU;gU=gU.next;iW.x=ko.posx+(ko.axisy*hU.x-ko.axisx*hU.y);iW.y=ko.posy+(hU.x*ko.axisx+hU.y*ko.axisy);eh=eh.next}var fK=g8.edges.head;var eg=g8.gverts.next;var fH=eg;eg=eg.next;while(eg!=null){var fs=eg;var jt=fK.elt;fK=fK.next;jt.gnormx=ko.axisy*jt.lnormx-ko.axisx*jt.lnormy;jt.gnormy=jt.lnormx*ko.axisx+jt.lnormy*ko.axisy;jt.gprojection=ko.posx*jt.gnormx+ko.posy*jt.gnormy+jt.lprojection;jt.tp0=fH.y*jt.gnormx-fH.x*jt.gnormy;jt.tp1=fs.y*jt.gnormx-fs.x*jt.gnormy;fH=fs;eg=eg.next}var fq=g8.gverts.next;var jq=fK.elt;jq.gnormx=ko.axisy*jq.lnormx-ko.axisx*jq.lnormy;jq.gnormy=jq.lnormx*ko.axisx+jq.lnormy*ko.axisy;jq.gprojection=ko.posx*jq.gnormx+ko.posy*jq.gnormy+jq.lprojection;jq.tp0=fH.y*jq.gnormx-fH.x*jq.gnormy;jq.tp1=fq.y*jq.gnormx-fq.x*jq.gnormy}var jM=gx;var jl=gv;var jE=ka;var jg=j9;var gw;if(gx.type==0&&gv.type==0){var j3=gx.circle;var jT=gv.circle;var ke;var gc=0;var fQ=0;gc=jT.worldCOMx-j3.worldCOMx;fQ=jT.worldCOMy-j3.worldCOMy;var fa=Math.sqrt(gc*gc+fQ*fQ);ke=fa-(j3.radius+jT.radius);if(ke<1e+100){if(fa==0){gc=1;fQ=0}else{var h9=1/fa;gc*=h9;fQ*=h9}var h4=j3.radius;ka.x=j3.worldCOMx+gc*h4;ka.y=j3.worldCOMy+fQ*h4;var h1=-jT.radius;j9.x=jT.worldCOMx+gc*h1;j9.y=jT.worldCOMy+fQ*h1;iH.x=gc;iH.y=fQ}gw=ke}else{var hL=false;if(gx.type==0&&gv.type==1){var gu=gx;jM=gv;jl=gu;var j2=ka;jE=j9;jg=j2;hL=true}if(jM.type==1&&jl.type==0){var iA=jM.polygon;var eH=jl.circle;var hm=-1e+100;var hp=null;var ee=iA.edges.head;while(ee!=null){var ek=ee.elt;var kc=ek.gnormx*eH.worldCOMx+ek.gnormy*eH.worldCOMy-ek.gprojection-eH.radius;if(kc>1e+100){hm=kc;break}if(kc>0){if(kc>hm){hm=kc;hp=ek}}else{if(hm<0&&kc>hm){hm=kc;hp=ek}}ee=ee.next}if(hm<1e+100){var fh=hp.gp0;var eW=hp.gp1;var kb=eH.worldCOMy*hp.gnormx-eH.worldCOMx*hp.gnormy;if(kb<=fh.y*hp.gnormx-fh.x*hp.gnormy){var ga=0;var fP=0;ga=eH.worldCOMx-fh.x;fP=eH.worldCOMy-fh.y;var e9=Math.sqrt(ga*ga+fP*fP);hm=e9-eH.radius;if(hm<1e+100){if(e9==0){ga=1;fP=0}else{var h0=1/e9;ga*=h0;fP*=h0}jE.x=fh.x+ga*0;jE.y=fh.y+fP*0;var hY=-eH.radius;jg.x=eH.worldCOMx+ga*hY;jg.y=eH.worldCOMy+fP*hY;iH.x=ga;iH.y=fP}}else{if(kb>=eW.y*hp.gnormx-eW.x*hp.gnormy){var f8=0;var fO=0;f8=eH.worldCOMx-eW.x;fO=eH.worldCOMy-eW.y;var e8=Math.sqrt(f8*f8+fO*fO);hm=e8-eH.radius;if(hm<1e+100){if(e8==0){f8=1;fO=0}else{var hW=1/e8;f8*=hW;fO*=hW}jE.x=eW.x+f8*0;jE.y=eW.y+fO*0;var hT=-eH.radius;jg.x=eH.worldCOMx+f8*hT;jg.y=eH.worldCOMy+fO*hT;iH.x=f8;iH.y=fO}}else{var hR=-eH.radius;jg.x=eH.worldCOMx+hp.gnormx*hR;jg.y=eH.worldCOMy+hp.gnormy*hR;var hQ=-hm;jE.x=jg.x+hp.gnormx*hQ;jE.y=jg.y+hp.gnormy*hQ;iH.x=hp.gnormx;iH.y=hp.gnormy}}}if(hL){iH.x=-iH.x;iH.y=-iH.y}gw=hm}else{var iy=jM.polygon;var h5=jl.polygon;var hl=-1e+100;var hi=null;var g0=null;var eD=0;var ec=iy.edges.head;while(ec!=null){var ei=ec.elt;var gn=1e+100;var eb=h5.gverts.next;while(eb!=null){var e0=eb;var ie=ei.gnormx*e0.x+ei.gnormy*e0.y;if(ie<gn){gn=ie}eb=eb.next}gn-=ei.gprojection;if(gn>1e+100){hl=gn;break}if(gn>0){if(gn>hl){hl=gn;hi=ei;eD=1}}else{if(hl<0&&gn>hl){hl=gn;hi=ei;eD=1}}ec=ec.next}if(hl<1e+100){var ea=h5.edges.head;while(ea!=null){var ef=ea.elt;var gm=1e+100;var ks=iy.gverts.next;while(ks!=null){var eV=ks;var ic=ef.gnormx*eV.x+ef.gnormy*eV.y;if(ic<gm){gm=ic}ks=ks.next}gm-=ef.gprojection;if(gm>1e+100){hl=gm;break}if(gm>0){if(gm>hl){hl=gm;g0=ef;eD=2}}else{if(hl<0&&gm>hl){hl=gm;g0=ef;eD=2}}ea=ea.next}if(hl<1e+100){var gK;var hN;if(eD==1){gK=h5;hN=hi}else{gK=iy;hN=g0;var gt=jE;jE=jg;jg=gt;hL=!hL}var hv=null;var gl=1e+100;var kr=gK.edges.head;while(kr!=null){var ed=kr.elt;var ia=hN.gnormx*ed.gnormx+hN.gnormy*ed.gnormy;if(ia<gl){gl=ia;hv=ed}kr=kr.next}if(hL){iH.x=-hN.gnormx;iH.y=-hN.gnormy}else{iH.x=hN.gnormx;iH.y=hN.gnormy}if(hl>=0){var fg=hN.gp0;var eT=hN.gp1;var hh=hv.gp0;var gV=hv.gp1;var fV=0;var fG=0;var hu=0;var hq=0;fV=eT.x-fg.x;fG=eT.y-fg.y;hu=gV.x-hh.x;hq=gV.y-hh.y;var j8=1/(fV*fV+fG*fG);var gp=1/(hu*hu+hq*hq);var ep=-(fV*(fg.x-hh.x)+fG*(fg.y-hh.y))*j8;var hP=-(fV*(fg.x-gV.x)+fG*(fg.y-gV.y))*j8;var jK=-(hu*(hh.x-fg.x)+hq*(hh.y-fg.y))*gp;var jk=-(hu*(hh.x-eT.x)+hq*(hh.y-eT.y))*gp;if(ep<0){ep=0}else{if(ep>1){ep=1}}if(hP<0){hP=0}else{if(hP>1){hP=1}}if(jK<0){jK=0}else{if(jK>1){jK=1}}if(jk<0){jk=0}else{if(jk>1){jk=1}}var j5=0;var jV=0;var hK=ep;j5=fg.x+fV*hK;jV=fg.y+fG*hK;var iF=0;var ix=0;var hJ=hP;iF=fg.x+fV*hJ;ix=fg.y+fG*hJ;var eP=0;var eA=0;var hI=jK;eP=hh.x+hu*hI;eA=hh.y+hq*hI;var ji=0;var i2=0;var hH=jk;ji=hh.x+hu*hH;i2=hh.y+hq*hH;var gE=hh.x;var f9=hh.y;var i6=0;var iR=0;i6=j5-gE;iR=jV-f9;var iD=i6*i6+iR*iR;var gD=gV.x;var f7=gV.y;var i5=0;var iP=0;i5=iF-gD;iP=ix-f7;var ip=i5*i5+iP*iP;var gC=fg.x;var f6=fg.y;var i4=0;var iO=0;i4=eP-gC;iO=eA-f6;var hd=i4*i4+iO*iO;var gA=eT.x;var f5=eT.y;var i3=0;var iN=0;i3=ji-gA;iN=i2-f5;var gO=i3*i3+iN*iN;var gL=0;var gI=0;var iM=null;if(iD<ip){gL=j5;gI=jV;iM=hh}else{gL=iF;gI=ix;iM=gV;iD=ip}var eR=0;var eG=0;var hw=null;if(hd<gO){eR=eP;eG=eA;hw=fg}else{eR=ji;eG=i2;hw=eT;hd=gO}if(iD<hd){jE.x=gL;jE.y=gI;jg.x=iM.x;jg.y=iM.y;hl=Math.sqrt(iD)}else{jg.x=eR;jg.y=eG;jE.x=hw.x;jE.y=hw.y;hl=Math.sqrt(hd)}if(hl!=0){iH.x=jg.x-jE.x;iH.y=jg.y-jE.y;var hF=1/hl;iH.x*=hF;iH.y*=hF;if(hL){iH.x=-iH.x;iH.y=-iH.y}}gw=hl}else{var iJ=0;var iB=0;iJ=hv.gp0.x;iB=hv.gp0.y;var hk=0;var g7=0;hk=hv.gp1.x;g7=hv.gp1.y;var ff=0;var eU=0;ff=hk-iJ;eU=g7-iB;var iK=hN.gnormy*iJ-hN.gnormx*iB;var iC=hN.gnormy*hk-hN.gnormx*g7;var jx=1/(iC-iK);var hC=(-hN.tp1-iK)*jx;if(hC>P.epsilon){iJ+=ff*hC;iB+=eU*hC}var hz=(-hN.tp0-iC)*jx;if(hz<-P.epsilon){hk+=ff*hz;g7+=eU*hz}var ht=iJ*hN.gnormx+iB*hN.gnormy-hN.gprojection;var f3=hk*hN.gnormx+g7*hN.gnormy-hN.gprojection;if(ht<f3){jg.x=iJ;jg.y=iB;var hy=-ht;jE.x=jg.x+hN.gnormx*hy;jE.y=jg.y+hN.gnormy*hy;gw=ht}else{jg.x=hk;jg.y=g7;var hx=-f3;jE.x=jg.x+hN.gnormx*hx;jE.y=jg.y+hN.gnormy*hx;gw=f3}}}else{gw=1e+100}}else{gw=1e+100}}}var fo=gw+kq;var eQ=jS*iH.x+jQ*iH.y;if(fo<P.distanceThresholdCCD){if(hj){break}var h8=0;var hO=0;h8=ka.x-kp.posx;hO=ka.y-kp.posy;var gM=0;var gJ=0;gM=j9.x-ko.posx;gJ=j9.y-ko.posy;var kn=eQ-kp.sweep_angvel*(iH.y*h8-iH.x*hO)+ko.sweep_angvel*(iH.y*gM-iH.x*gJ);if(kn>0){eC.slipped=true}if(kn<=0||fo<P.distanceThresholdCCD*0.5){break}}iQ=-1;break}if(++eS>=40){if(iI>kq){eC.failed=true}break}}eC.toi=iQ};de.staticSweep=function(ey,hx,gy,jE){var gg=ey.s1;var ge=ey.s2;var jD=gg.body;var ja=0;var i8=0;ja=-jD.velx;i8=-jD.vely;var gC=jD.sweep_angvel;if(gC<0){gC=-gC}var fu=gg.sweepCoef*gC;var jt=ey.c1;var jr=ey.c2;var h2=ey.axis;var ib=gy;var eO=0;while(true){var iy=ib*hx;var et=iy-jD.sweepTime;if(et!=0){jD.sweepTime=iy;jD.posx+=jD.velx*et;jD.posy+=jD.vely*et;if(jD.angvel!=0){var iz=jD.sweep_angvel*et;jD.rot+=iz;if(iz*iz>0.0001){jD.axisx=Math.sin(jD.rot);jD.axisy=Math.cos(jD.rot)}else{var jh=iz*iz;var iU=1-0.5*jh;var iX=1-jh*jh/8;var gG=(iU*jD.axisx+iz*jD.axisy)*iX;jD.axisy=(iU*jD.axisy-iz*jD.axisx)*iX;jD.axisx=gG}}}if(gg.type==0){gg.worldCOMx=jD.posx+(jD.axisy*gg.localCOMx-jD.axisx*gg.localCOMy);gg.worldCOMy=jD.posy+(gg.localCOMx*jD.axisx+gg.localCOMy*jD.axisy)}else{var gM=gg.polygon;var gY=gM.lverts.next;var h1=gM.gverts.next;while(h1!=null){var i3=h1;var iY=gY;gY=gY.next;i3.x=jD.posx+(jD.axisy*iY.x-jD.axisx*iY.y);i3.y=jD.posy+(iY.x*jD.axisx+iY.y*jD.axisy);h1=h1.next}var hR=gM.edges.head;var fk=gM.gverts.next;var iM=fk;fk=fk.next;while(fk!=null){var iL=fk;var i6=hR.elt;hR=hR.next;i6.gnormx=jD.axisy*i6.lnormx-jD.axisx*i6.lnormy;i6.gnormy=i6.lnormx*jD.axisx+i6.lnormy*jD.axisy;i6.gprojection=jD.posx*i6.gnormx+jD.posy*i6.gnormy+i6.lprojection;i6.tp0=iM.y*i6.gnormx-iM.x*i6.gnormy;i6.tp1=iL.y*i6.gnormx-iL.x*i6.gnormy;iM=iL;fk=fk.next}var fq=gM.gverts.next;var iV=hR.elt;iV.gnormx=jD.axisy*iV.lnormx-jD.axisx*iV.lnormy;iV.gnormy=iV.lnormx*jD.axisx+iV.lnormy*jD.axisy;iV.gprojection=jD.posx*iV.gnormx+jD.posy*iV.gnormy+iV.lprojection;iV.tp0=iM.y*iV.gnormx-iM.x*iV.gnormy;iV.tp1=fq.y*iV.gnormx-fq.x*iV.gnormy}var i7=gg;var iJ=ge;var e5=jt;var e0=jr;var eT;if(gg.type==0&&ge.type==0){var jm=gg.circle;var jc=ge.circle;var hf;var f3=0;var gF=0;f3=jc.worldCOMx-jm.worldCOMx;gF=jc.worldCOMy-jm.worldCOMy;var gU=Math.sqrt(f3*f3+gF*gF);hf=gU-(jm.radius+jc.radius);if(hf<1e+100){if(gU==0){f3=1;gF=0}else{var iN=1/gU;f3*=iN;gF*=iN}var fP=jm.radius;jt.x=jm.worldCOMx+f3*fP;jt.y=jm.worldCOMy+gF*fP;var fN=-jc.radius;jr.x=jc.worldCOMx+f3*fN;jr.y=jc.worldCOMy+gF*fN;h2.x=f3;h2.y=gF}eT=hf}else{var iS=false;if(gg.type==0&&ge.type==1){var gk=gg;i7=ge;iJ=gk;var gi=jt;e5=jr;e0=gi;iS=true}if(i7.type==1&&iJ.type==0){var fy=i7.polygon;var ht=iJ.circle;var fK=-1e+100;var eq=null;var fi=fy.edges.head;while(fi!=null){var i9=fi.elt;var jx=i9.gnormx*ht.worldCOMx+i9.gnormy*ht.worldCOMy-i9.gprojection-ht.radius;if(jx>1e+100){fK=jx;break}if(jx>0){if(jx>fK){fK=jx;eq=i9}}else{if(fK<0&&jx>fK){fK=jx;eq=i9}}fi=fi.next}if(fK<1e+100){var fr=eq.gp0;var eU=eq.gp1;var jz=ht.worldCOMy*eq.gnormx-ht.worldCOMx*eq.gnormy;if(jz<=fr.y*eq.gnormx-fr.x*eq.gnormy){var f2=0;var fD=0;f2=ht.worldCOMx-fr.x;fD=ht.worldCOMy-fr.y;var eZ=Math.sqrt(f2*f2+fD*fD);fK=eZ-ht.radius;if(fK<1e+100){if(eZ==0){f2=1;fD=0}else{var fM=1/eZ;f2*=fM;fD*=fM}e5.x=fr.x+f2*0;e5.y=fr.y+fD*0;var fL=-ht.radius;e0.x=ht.worldCOMx+f2*fL;e0.y=ht.worldCOMy+fD*fL;h2.x=f2;h2.y=fD}}else{if(jz>=eU.y*eq.gnormx-eU.x*eq.gnormy){var f1=0;var fC=0;f1=ht.worldCOMx-eU.x;fC=ht.worldCOMy-eU.y;var eY=Math.sqrt(f1*f1+fC*fC);fK=eY-ht.radius;if(fK<1e+100){if(eY==0){f1=1;fC=0}else{var fJ=1/eY;f1*=fJ;fC*=fJ}e5.x=eU.x+f1*0;e5.y=eU.y+fC*0;var fI=-ht.radius;e0.x=ht.worldCOMx+f1*fI;e0.y=ht.worldCOMy+fC*fI;h2.x=f1;h2.y=fC}}else{var fG=-ht.radius;e0.x=ht.worldCOMx+eq.gnormx*fG;e0.y=ht.worldCOMy+eq.gnormy*fG;var fF=-fK;e5.x=e0.x+eq.gnormx*fF;e5.y=e0.y+eq.gnormy*fF;h2.x=eq.gnormx;h2.y=eq.gnormy}}}if(iS){h2.x=-h2.x;h2.y=-h2.y}eT=fK}else{var hU=i7.polygon;var gL=iJ.polygon;var gT=-1e+100;var ep=null;var eo=null;var gE=0;var fh=hU.edges.head;while(fh!=null){var em=fh.elt;var eA=1e+100;var fg=gL.gverts.next;while(fg!=null){var fp=fg;var iZ=em.gnormx*fp.x+em.gnormy*fp.y;if(iZ<eA){eA=iZ}fg=fg.next}eA-=em.gprojection;if(eA>1e+100){gT=eA;break}if(eA>0){if(eA>gT){gT=eA;ep=em;gE=1}}else{if(gT<0&&eA>gT){gT=eA;ep=em;gE=1}}fh=fh.next}if(gT<1e+100){var fe=gL.edges.head;while(fe!=null){var el=fe.elt;var f9=1e+100;var fd=hU.gverts.next;while(fd!=null){var fo=fd;var hJ=el.gnormx*fo.x+el.gnormy*fo.y;if(hJ<f9){f9=hJ}fd=fd.next}f9-=el.gprojection;if(f9>1e+100){gT=f9;break}if(f9>0){if(f9>gT){gT=f9;eo=el;gE=2}}else{if(gT<0&&f9>gT){gT=f9;eo=el;gE=2}}fe=fe.next}if(gT<1e+100){var gv;var jp;if(gE==1){gv=gL;jp=ep}else{gv=hU;jp=eo;var gh=e5;e5=e0;e0=gh;iS=!iS}var jo=null;var f7=1e+100;var fc=gv.edges.head;while(fc!=null){var ek=fc.elt;var hH=jp.gnormx*ek.gnormx+jp.gnormy*ek.gnormy;if(hH<f7){f7=hH;jo=ek}fc=fc.next}if(iS){h2.x=-jp.gnormx;h2.y=-jp.gnormy}else{h2.x=jp.gnormx;h2.y=jp.gnormy}if(gT>=0){var fa=jp.gp0;var eS=jp.gp1;var gz=jo.gp0;var gx=jo.gp1;var eK=0;var eJ=0;var gb=0;var ga=0;eK=eS.x-fa.x;eJ=eS.y-fa.y;gb=gx.x-gz.x;ga=gx.y-gz.y;var iK=1/(eK*eK+eJ*eJ);var eB=1/(gb*gb+ga*ga);var hM=-(eK*(fa.x-gz.x)+eJ*(fa.y-gz.y))*iK;var hu=-(eK*(fa.x-gx.x)+eJ*(fa.y-gx.y))*iK;var i5=-(gb*(gz.x-fa.x)+ga*(gz.y-fa.y))*eB;var iI=-(gb*(gz.x-eS.x)+ga*(gz.y-eS.y))*eB;if(hM<0){hM=0}else{if(hM>1){hM=1}}if(hu<0){hu=0}else{if(hu>1){hu=1}}if(i5<0){i5=0}else{if(i5>1){i5=1}}if(iI<0){iI=0}else{if(iI>1){iI=1}}var eF=0;var eE=0;var fE=hM;eF=fa.x+eK*fE;eE=fa.y+eJ*fE;var es=0;var er=0;var hN=hu;es=fa.x+eK*hN;er=fa.y+eJ*hN;var iB=0;var iA=0;var hL=i5;iB=gz.x+gb*hL;iA=gz.y+ga*hL;var ii=0;var ih=0;var hK=iI;ii=gz.x+gb*hK;ih=gz.y+ga*hK;var jf=gz.x;var je=gz.y;var ix=0;var iw=0;ix=eF-jf;iw=eE-je;var ji=ix*ix+iw*iw;var gq=gx.x;var fY=gx.y;var iv=0;var ig=0;iv=es-gq;ig=er-fY;var hQ=iv*iv+ig*ig;var gp=fa.x;var fW=fa.y;var iu=0;var ie=0;iu=iB-gp;ie=iA-fW;var gN=iu*iu+ie*ie;var go=eS.x;var fU=eS.y;var it=0;var id=0;it=ii-go;id=ih-fU;var iT=it*it+id*id;var eH=0;var eG=0;var ft=null;if(ji<hQ){eH=eF;eG=eE;ft=gz}else{eH=es;eG=er;ft=gx;ji=hQ}var ev=0;var eu=0;var fs=null;if(gN<iT){ev=iB;eu=iA;fs=fa}else{ev=ii;eu=ih;fs=eS;gN=iT}if(ji<gN){e5.x=eH;e5.y=eG;e0.x=ft.x;e0.y=ft.y;gT=Math.sqrt(ji)}else{e0.x=ev;e0.y=eu;e5.x=fs.x;e5.y=fs.y;gT=Math.sqrt(gN)}if(gT!=0){h2.x=e0.x-e5.x;h2.y=e0.y-e5.y;var hI=1/gT;h2.x*=hI;h2.y*=hI;if(iS){h2.x=-h2.x;h2.y=-h2.y}}eT=gT}else{var i1=0;var i0=0;i1=jo.gp0.x;i0=jo.gp0.y;var iE=0;var iD=0;iE=jo.gp1.x;iD=jo.gp1.y;var il=0;var ik=0;il=iE-i1;ik=iD-i0;var jj=jp.gnormy*i1-jp.gnormx*i0;var hZ=jp.gnormy*iE-jp.gnormx*iD;var gX=1/(hZ-jj);var hG=(-jp.tp1-jj)*gX;if(hG>P.epsilon){i1+=il*hG;i0+=ik*hG}var hE=(-jp.tp0-hZ)*gX;if(hE<-P.epsilon){iE+=il*hE;iD+=ik*hE}var jg=i1*jp.gnormx+i0*jp.gnormy-jp.gprojection;var iO=iE*jp.gnormx+iD*jp.gnormy-jp.gprojection;if(jg<iO){e0.x=i1;e0.y=i0;var hC=-jg;e5.x=e0.x+jp.gnormx*hC;e5.y=e0.y+jp.gnormy*hC;eT=jg}else{e0.x=iE;e0.y=iD;var hA=-iO;e5.x=e0.x+jp.gnormx*hA;e5.y=e0.y+jp.gnormy*hA;eT=iO}}}else{eT=1e+100}}else{eT=1e+100}}}var h3=eT+jE;var eI=ja*h2.x+i8*h2.y;if(h3<P.distanceThresholdCCD){var hn=0;var hl=0;hn=jt.x-jD.posx;hl=jt.y-jD.posy;var gu=eI-jD.sweep_angvel*(h2.y*hn-h2.x*hl);if(gu>0){ey.slipped=true}if(gu<=0||h3<P.distanceThresholdCCD*0.5){break}}var h6=(fu-eI)*hx;if(h6<=0){ib=-1;break}var jB=h3/h6;if(jB<0.000001){jB=0.000001}ib+=jB;if(ib>=1){ib=1;var jy=ib*hx;var jA=jy-jD.sweepTime;if(jA!=0){jD.sweepTime=jy;jD.posx+=jD.velx*jA;jD.posy+=jD.vely*jA;if(jD.angvel!=0){var ew=jD.sweep_angvel*jA;jD.rot+=ew;if(ew*ew>0.0001){jD.axisx=Math.sin(jD.rot);jD.axisy=Math.cos(jD.rot)}else{var hP=ew*ew;var gJ=1-0.5*hP;var g9=1-hP*hP/8;var f0=(gJ*jD.axisx+ew*jD.axisy)*g9;jD.axisy=(gJ*jD.axisy-ew*jD.axisx)*g9;jD.axisx=f0}}}if(gg.type==0){gg.worldCOMx=jD.posx+(jD.axisy*gg.localCOMx-jD.axisx*gg.localCOMy);gg.worldCOMy=jD.posy+(gg.localCOMx*jD.axisx+gg.localCOMy*jD.axisy)}else{var gI=gg.polygon;var gB=gI.lverts.next;var fb=gI.gverts.next;while(fb!=null){var ij=fb;var hq=gB;gB=gB.next;ij.x=jD.posx+(jD.axisy*hq.x-jD.axisx*hq.y);ij.y=jD.posy+(hq.x*jD.axisx+hq.y*jD.axisy);fb=fb.next}var fx=gI.edges.head;var e9=gI.gverts.next;var fw=e9;e9=e9.next;while(e9!=null){var fn=e9;var iR=fx.elt;fx=fx.next;iR.gnormx=jD.axisy*iR.lnormx-jD.axisx*iR.lnormy;iR.gnormy=iR.lnormx*jD.axisx+iR.lnormy*jD.axisy;iR.gprojection=jD.posx*iR.gnormx+jD.posy*iR.gnormy+iR.lprojection;iR.tp0=fw.y*iR.gnormx-fw.x*iR.gnormy;iR.tp1=fn.y*iR.gnormx-fn.x*iR.gnormy;fw=fn;e9=e9.next}var fm=gI.gverts.next;var iQ=fx.elt;iQ.gnormx=jD.axisy*iQ.lnormx-jD.axisx*iQ.lnormy;iQ.gnormy=iQ.lnormx*jD.axisx+iQ.lnormy*jD.axisy;iQ.gprojection=jD.posx*iQ.gnormx+jD.posy*iQ.gnormy+iQ.lprojection;iQ.tp0=fw.y*iQ.gnormx-fw.x*iQ.gnormy;iQ.tp1=fm.y*iQ.gnormx-fm.x*iQ.gnormy}var i4=gg;var iH=ge;var iW=jt;var iC=jr;var gf;if(gg.type==0&&ge.type==0){var jl=gg.circle;var jb=ge.circle;var jv;var fZ=0;var fB=0;fZ=jb.worldCOMx-jl.worldCOMx;fB=jb.worldCOMy-jl.worldCOMy;var eX=Math.sqrt(fZ*fZ+fB*fB);jv=eX-(jl.radius+jb.radius);if(jv<1e+100){if(eX==0){fZ=1;fB=0}else{var hz=1/eX;fZ*=hz;fB*=hz}var hv=jl.radius;jt.x=jl.worldCOMx+fZ*hv;jt.y=jl.worldCOMy+fB*hv;var hs=-jb.radius;jr.x=jb.worldCOMx+fZ*hs;jr.y=jb.worldCOMy+fB*hs;h2.x=fZ;h2.y=fB}gf=jv}else{var he=false;if(gg.type==0&&ge.type==1){var gd=gg;i4=ge;iH=gd;var jk=jt;iW=jr;iC=jk;he=true}if(i4.type==1&&iH.type==0){var hV=i4.polygon;var eD=iH.circle;var gS=-1e+100;var gV=null;var ej=hV.edges.head;while(ej!=null){var ei=ej.elt;var ju=ei.gnormx*eD.worldCOMx+ei.gnormy*eD.