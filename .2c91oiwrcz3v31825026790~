(function(){var bo,cv=function(){return dc.__string_rec(this,"")};function dX(ec,ea){var eb=function(){return eb.method.apply(eb.scope,arguments)};eb.scope=ec;eb.method=ea;return eb}window.js=js={_Boot:{}};window.zpp_nape=zpp_nape={shape:{},constraint:{},geom:{},phys:{},dynamics:{},callbacks:{},util:{},space:{}};window.sandbox=sandbox={};window.nape=nape={shape:{},constraint:{},geom:{},phys:{},dynamics:{},callbacks:{},space:{},util:{}};var bm=bm=function(){};bm.__name__=["Reflect"];bm.field=function(ec,eb){try{return ec[eb]}catch(ea){return null}};bm.fields=function(ed){var ea=[];if(ed!=null){var ec=Object.prototype.hasOwnProperty;for(var eb in ed){if(eb!="__id__"&&eb!="hx__closures__"&&ec.call(ed,eb)){ea.push(eb)}}}return ea};bm.copy=function(ee){var ea={};var ed=0;var ec=bm.fields(ee);while(ed<ec.length){var eb=ec[ed];++ed;ea[eb]=bm.field(ee,eb)}return ea};bm.prototype.__class__=bm;var ag=ag=function(){};ag.__name__=["Std"];ag.string=function(ea){return dc.__string_rec(ea,"")};ag.prototype.__class__=ag;var aY=aY=function(){};aY.__name__=["StringTools"];aY.hex=function(ec,eb){var ea="";while(true){ea="0123456789ABCDEF".charAt(ec&15)+ea;ec>>>=4;if(!(ec>0)){break}}if(eb!=null){while(ea.length<eb){ea="0"+ea}}return ea};aY.prototype.__class__=aY;var cE=js._Boot.HaxeError=function(ea){Error.call(this);this.val=ea;this.message=String(ea);if(Error.captureStackTrace){Error.captureStackTrace(this,cE)}};cE.__name__=["js","_Boot","HaxeError"];cE.__super__=Error;cE.prototype=Object.create(Error.prototype);cE.wrap=function(ea){if((ea instanceof Error)){return ea}else{return new cE(ea)}};cE.prototype.val=null;cE.prototype.__class__=cE;var dc=js.Boot=function(){};dc.__name__=["js","Boot"];dc.getClass=function(ec){if((ec instanceof Array)&&ec.__enum__==null){return Array}else{var ea=ec.__class__;if(ea!=null){return ea}var eb=dc.__nativeClassName(ec);if(eb!=null){return dc.__resolveNativeClass(eb)}return null}};dc.__string_rec=function(ei,ef){if(ei==null){return"null"}if(ef.length>=5){return"<...>"}var ee=typeof(ei);if(ee=="function"&&(ei.__name__||ei.__ename__)){ee="object"}switch(ee){case"function":return"<function>";case"object":if(ei instanceof Array){if(ei.__enum__){if(ei.length==2){return ei[0]}var ej=ei[0]+"(";ef+="\t";var eh=2;var ed=ei.length;while(eh<ed){var eo=eh++;if(eo!=2){ej+=","+dc.__string_rec(ei[eo],ef)}else{ej+=dc.__string_rec(ei[eo],ef)}}return ej+")"}var em=ei.length;var el;var eb="[";ef+="\t";var ep=0;var eg=em;while(ep<eg){var ek=ep++;eb+=(ek>0?",":"")+dc.__string_rec(ei[ek],ef)}eb+="]";return eb}var eq;try{eq=ei.toString}catch(er){return"???"}if(eq!=null&&eq!=Object.toString&&typeof(eq)=="function"){var ec=ei.toString();if(ec!="[object Object]"){return ec}}var en=null;var ea="{\n";ef+="\t";var es=ei.hasOwnProperty!=null;for(var en in ei){if(es&&!ei.hasOwnProperty(en)){continue}if(en=="prototype"||en=="__class__"||en=="__super__"||en=="__interfaces__"||en=="__properties__"){continue}if(ea.length!=2){ea+=", \n"}ea+=ef+en+" : "+dc.__string_rec(ei[en],ef)}ef=ef.substring(1);ea+="\n"+ef+"}";return ea;case"string":return ei;default:return String(ei)}};dc.__interfLoop=function(ef,eb){if(ef==null){return false}if(ef==eb){return true}var ea=ef.__interfaces__;if(ea!=null){var ed=0;var ee=ea.length;while(ed<ee){var ec=ea[ed++];if(ec==eb||dc.__interfLoop(ec,eb)){return true}}}return dc.__interfLoop(ef.__super__,eb)};dc.__instanceof=function(eb,ea){if(ea==null){return false}switch(ea){case Array:if((eb instanceof Array)){return eb.__enum__==null}else{return false}break;case dh:return typeof(eb)=="boolean";case dH:return true;case aj:return typeof(eb)=="number";case dR:if(typeof(eb)=="number"){return(eb|0)===eb}else{return false}break;case String:return typeof(eb)=="string";default:if(eb!=null){if(typeof(ea)=="function"){if(eb instanceof ea){return true}if(dc.__interfLoop(dc.getClass(eb),ea)){return true}}else{if(typeof(ea)=="object"&&dc.__isNativeObj(ea)){if(eb instanceof ea){return true}}}}else{return false}if(ea==aq&&eb.__name__!=null){return true}if(ea==aJ&&eb.__ename__!=null){return true}return eb.__enum__==ea}};dc.__nativeClassName=function(eb){var ea=dc.__toStr.call(eb).slice(8,-1);if(ea=="Object"||ea=="Function"||ea=="Math"||ea=="JSON"){return null}return ea};dc.__isNativeObj=function(ea){return dc.__nativeClassName(ea)!=null};dc.__resolveNativeClass=function(ea){return $global[ea]};dc.prototype.__class__=dc;var P=nape.Config=function(){};P.__name__=["nape","Config"];P.prototype.__class__=P;var bP=nape.callbacks.Callback=function(){this.zpp_inner=null};bP.__name__=["nape","callbacks","Callback"];bP.prototype.zpp_inner=null;bP.prototype.get_event=function(){return cc.events[this.zpp_inner.event]};bP.prototype.get_listener=function(){return this.zpp_inner.listener.outer};bP.prototype.toString=function(){return""};Object.defineProperty(bP.prototype,"event",{get:bP.prototype.get_event});Object.defineProperty(bP.prototype,"listener",{get:bP.prototype.get_listener});bP.prototype.__class__=bP;var dN=nape.callbacks.BodyCallback=function(){bP.call(this)};dN.__name__=["nape","callbacks","BodyCallback"];dN.__super__=bP;dN.prototype=Object.create(bP.prototype);dN.prototype.get_body=function(){return this.zpp_inner.body.outer};dN.prototype.toString=function(){var ea="Cb:";ea="Cb:"+["WAKE","SLEEP"][this.zpp_inner.event-2];ea+=":"+this.zpp_inner.body.outer.toString();ea+=" : listener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(dN.prototype,"body",{get:dN.prototype.get_body});dN.prototype.__class__=dN;var cN=nape.callbacks.Listener=function(){this.zpp_inner=null};cN.__name__=["nape","callbacks","Listener"];cN.prototype.zpp_inner=null;cN.prototype.get_type=function(){return cc.types[this.zpp_inner.type]};cN.prototype.get_event=function(){return cc.events[this.zpp_inner.event]};cN.prototype.set_event=function(ea){if(cc.events[this.zpp_inner.event]!=ea){var eb;if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}if(ea==br.CbEvent_BEGIN){eb=0}else{if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}if(ea==br.CbEvent_ONGOING){eb=6}else{if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}if(ea==br.CbEvent_END){eb=1}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(ea==br.CbEvent_SLEEP){eb=3}else{if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(ea==br.CbEvent_WAKE){eb=2}else{if(br.CbEvent_PRE==null){br.internal=true;br.CbEvent_PRE=new bU();br.internal=false}if(ea==br.CbEvent_PRE){eb=5}else{eb=4}}}}}}this.zpp_inner.swapEvent(eb)}return cc.events[this.zpp_inner.event]};cN.prototype.get_precedence=function(){return this.zpp_inner.precedence};cN.prototype.set_precedence=function(ea){if(this.zpp_inner.precedence!=ea){this.zpp_inner.precedence=ea;this.zpp_inner.invalidate_precedence()}return this.zpp_inner.precedence};cN.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cN.prototype.set_space=function(ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if(this.zpp_inner.space!=null){this.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_listeners;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}else{this.zpp_inner.space=null}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cN.prototype.toString=function(){var eb=["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];if(this.zpp_inner.type==0){return"BodyListener{"+eb+"::"+ag.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}"}else{if(this.zpp_inner.type==1){return"ConstraintListener{"+eb+"::"+ag.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}"}else{var ea=this.zpp_inner.interaction;var ec;switch(ea.itype){case 1:ec="COLLISION";break;case 2:ec="SENSOR";break;case 4:ec="FLUID";break;default:ec="ALL"}return(this.zpp_inner.type==2?"InteractionListener{"+eb+"#"+ec+"::"+ag.string(ea.outer_zni.zpp_inner_zn.options1.outer)+":"+ag.string(ea.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+ec+"::"+ag.string(ea.outer_znp.zpp_inner_zn.options1.outer)+":"+ag.string(ea.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence}}};Object.defineProperty(cN.prototype,"type",{get:cN.prototype.get_type});Object.defineProperty(cN.prototype,"event",{get:cN.prototype.get_event,set:cN.prototype.set_event});Object.defineProperty(cN.prototype,"precedence",{get:cN.prototype.get_precedence,set:cN.prototype.set_precedence});Object.defineProperty(cN.prototype,"space",{get:cN.prototype.get_space,set:cN.prototype.set_space});cN.prototype.__class__=cN;var dj=nape.callbacks.BodyListener=function(ed,eb,ec,ea){if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);var ee=-1;if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(ed==br.CbEvent_WAKE){ee=2}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(ed==br.CbEvent_SLEEP){ee=3}}this.zpp_inner_zn=new bW(cP.argument(eb),ee,ec);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner.precedence=ea};dj.__name__=["nape","callbacks","BodyListener"];dj.__super__=cN;dj.prototype=Object.create(cN.prototype);dj.prototype.zpp_inner_zn=null;dj.prototype.get_options=function(){return this.zpp_inner_zn.options.outer};dj.prototype.set_options=function(ea){this.zpp_inner_zn.options.set(ea.zpp_inner);return this.zpp_inner_zn.options.outer};dj.prototype.get_handler=function(){return this.zpp_inner_zn.handler};dj.prototype.set_handler=function(ea){this.zpp_inner_zn.handler=ea;return this.zpp_inner_zn.handler};Object.defineProperty(dj.prototype,"options",{get:dj.prototype.get_options,set:dj.prototype.set_options});Object.defineProperty(dj.prototype,"handler",{get:dj.prototype.get_handler,set:dj.prototype.set_handler});dj.prototype.__class__=dj;var bU=nape.callbacks.CbEvent=function(){};bU.__name__=["nape","callbacks","CbEvent"];bU.BEGIN=null;bU.get_BEGIN=function(){if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}return br.CbEvent_BEGIN};bU.ONGOING=null;bU.get_ONGOING=function(){if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}return br.CbEvent_ONGOING};bU.END=null;bU.get_END=function(){if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}return br.CbEvent_END};bU.WAKE=null;bU.get_WAKE=function(){if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}return br.CbEvent_WAKE};bU.SLEEP=null;bU.get_SLEEP=function(){if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}return br.CbEvent_SLEEP};bU.BREAK=null;bU.get_BREAK=function(){if(br.CbEvent_BREAK==null){br.internal=true;br.CbEvent_BREAK=new bU();br.internal=false}return br.CbEvent_BREAK};bU.PRE=null;bU.get_PRE=function(){if(br.CbEvent_PRE==null){br.internal=true;br.CbEvent_PRE=new bU();br.internal=false}return br.CbEvent_PRE};bU.prototype.toString=function(){if(br.CbEvent_PRE==null){br.internal=true;br.CbEvent_PRE=new bU();br.internal=false}if(this==br.CbEvent_PRE){return"PRE"}else{if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}if(this==br.CbEvent_BEGIN){return"BEGIN"}else{if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}if(this==br.CbEvent_ONGOING){return"ONGOING"}else{if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}if(this==br.CbEvent_END){return"END"}else{if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(this==br.CbEvent_WAKE){return"WAKE"}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(this==br.CbEvent_SLEEP){return"SLEEP"}else{if(br.CbEvent_BREAK==null){br.internal=true;br.CbEvent_BREAK=new bU();br.internal=false}if(this==br.CbEvent_BREAK){return"BREAK"}else{return""}}}}}}}};Object.defineProperty(bU,"BEGIN",{get:bU.get_BEGIN});Object.defineProperty(bU,"ONGOING",{get:bU.get_ONGOING});Object.defineProperty(bU,"END",{get:bU.get_END});Object.defineProperty(bU,"WAKE",{get:bU.get_WAKE});Object.defineProperty(bU,"SLEEP",{get:bU.get_SLEEP});Object.defineProperty(bU,"BREAK",{get:bU.get_BREAK});Object.defineProperty(bU,"PRE",{get:bU.get_PRE});bU.prototype.__class__=bU;var dk=nape.callbacks.CbType=function(){this.zpp_inner=null;this.zpp_inner=new db();this.zpp_inner.outer=this};dk.__name__=["nape","callbacks","CbType"];dk.ANY_BODY=null;dk.get_ANY_BODY=function(){return db.ANY_BODY};dk.ANY_CONSTRAINT=null;dk.get_ANY_CONSTRAINT=function(){return db.ANY_CONSTRAINT};dk.ANY_SHAPE=null;dk.get_ANY_SHAPE=function(){return db.ANY_SHAPE};dk.ANY_COMPOUND=null;dk.get_ANY_COMPOUND=function(){return db.ANY_COMPOUND};dk.prototype.zpp_inner=null;dk.prototype.get_id=function(){return this.zpp_inner.id};dk.prototype.including=function(ea){return new R(this).including(ea)};dk.prototype.excluding=function(ea){return new R(this).excluding(ea)};dk.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};dk.prototype.get_interactors=function(){if(this.zpp_inner.wrap_interactors==null){this.zpp_inner.wrap_interactors=i.get(this.zpp_inner.interactors,true)}return this.zpp_inner.wrap_interactors};dk.prototype.get_constraints=function(){if(this.zpp_inner.wrap_constraints==null){this.zpp_inner.wrap_constraints=aZ.get(this.zpp_inner.constraints,true)}return this.zpp_inner.wrap_constraints};dk.prototype.toString=function(){if(this==db.ANY_BODY){return"ANY_BODY"}else{if(this==db.ANY_SHAPE){return"ANY_SHAPE"}else{if(this==db.ANY_COMPOUND){return"ANY_COMPOUND"}else{if(this==db.ANY_CONSTRAINT){return"ANY_CONSTRAINT"}else{return"CbType#"+this.zpp_inner.id}}}}};Object.defineProperty(dk,"ANY_BODY",{get:dk.get_ANY_BODY});Object.defineProperty(dk,"ANY_CONSTRAINT",{get:dk.get_ANY_CONSTRAINT});Object.defineProperty(dk,"ANY_SHAPE",{get:dk.get_ANY_SHAPE});Object.defineProperty(dk,"ANY_COMPOUND",{get:dk.get_ANY_COMPOUND});Object.defineProperty(dk.prototype,"id",{get:dk.prototype.get_id});Object.defineProperty(dk.prototype,"userData",{get:dk.prototype.get_userData});Object.defineProperty(dk.prototype,"interactors",{get:dk.prototype.get_interactors});Object.defineProperty(dk.prototype,"constraints",{get:dk.prototype.get_constraints});dk.prototype.__class__=dk;var Y=nape.callbacks.CbTypeIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};Y.__name__=["nape","callbacks","CbTypeIterator"];Y.get=function(ec){var ea;if(Y.zpp_pool==null){cy.internal=true;var ed=new Y();cy.internal=false;ea=ed}else{var eb=Y.zpp_pool;Y.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};Y.prototype.zpp_inner=null;Y.prototype.zpp_i=null;Y.prototype.zpp_critical=null;Y.prototype.zpp_next=null;Y.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=Y.zpp_pool;Y.zpp_pool=this;this.zpp_inner=null;return false}};Y.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};Y.prototype.__class__=Y;var C=nape.callbacks.CbTypeList=function(){this.zpp_inner=null;this.zpp_inner=new cy();this.zpp_inner.outer=this};C.__name__=["nape","callbacks","CbTypeList"];C.fromArray=function(ed){var ea=new C();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};C.prototype.zpp_inner=null;C.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};C.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};C.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};C.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};C.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};C.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};C.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};C.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};C.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};C.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};C.prototype.empty=function(){return this.zpp_inner.inner.head==null};C.prototype.iterator=function(){this.zpp_inner.valmod();return Y.get(this)};C.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new C();this.zpp_inner.valmod();var ef=Y.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=Y.zpp_pool;Y.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};C.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=Y.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=Y.zpp_pool;Y.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};C.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=Y.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=Y.zpp_pool;Y.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};C.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=Y.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=Y.zpp_pool;Y.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=Y.zpp_pool;Y.zpp_pool=ec;ec.zpp_inner=null;break}}return this};C.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(C.prototype,"length",{get:C.prototype.get_length});C.prototype.__class__=C;var dm=nape.callbacks.ConstraintCallback=function(){bP.call(this)};dm.__name__=["nape","callbacks","ConstraintCallback"];dm.__super__=bP;dm.prototype=Object.create(bP.prototype);dm.prototype.get_constraint=function(){return this.zpp_inner.constraint.outer};dm.prototype.toString=function(){var ea="Cb:";ea="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-2];ea+=":"+this.zpp_inner.constraint.outer.toString();ea+=" : listener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(dm.prototype,"constraint",{get:dm.prototype.get_constraint});dm.prototype.__class__=dm;var d1=nape.callbacks.ConstraintListener=function(ed,eb,ec,ea){if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);var ee=-1;if(br.CbEvent_WAKE==null){br.internal=true;br.CbEvent_WAKE=new bU();br.internal=false}if(ed==br.CbEvent_WAKE){ee=2}else{if(br.CbEvent_SLEEP==null){br.internal=true;br.CbEvent_SLEEP=new bU();br.internal=false}if(ed==br.CbEvent_SLEEP){ee=3}else{if(br.CbEvent_BREAK==null){br.internal=true;br.CbEvent_BREAK=new bU();br.internal=false}if(ed==br.CbEvent_BREAK){ee=4}}}this.zpp_inner_zn=new O(cP.argument(eb),ee,ec);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner.precedence=ea};d1.__name__=["nape","callbacks","ConstraintListener"];d1.__super__=cN;d1.prototype=Object.create(cN.prototype);d1.prototype.zpp_inner_zn=null;d1.prototype.get_options=function(){return this.zpp_inner_zn.options.outer};d1.prototype.set_options=function(ea){this.zpp_inner_zn.options.set(ea.zpp_inner);return this.zpp_inner_zn.options.outer};d1.prototype.get_handler=function(){return this.zpp_inner_zn.handler};d1.prototype.set_handler=function(ea){this.zpp_inner_zn.handler=ea;return this.zpp_inner_zn.handler};Object.defineProperty(d1.prototype,"options",{get:d1.prototype.get_options,set:d1.prototype.set_options});Object.defineProperty(d1.prototype,"handler",{get:d1.prototype.get_handler,set:d1.prototype.set_handler});d1.prototype.__class__=d1;var ay=nape.callbacks.InteractionCallback=function(){bP.call(this)};ay.__name__=["nape","callbacks","InteractionCallback"];ay.__super__=bP;ay.prototype=Object.create(bP.prototype);ay.prototype.get_int1=function(){return this.zpp_inner.int1.outer_i};ay.prototype.get_int2=function(){return this.zpp_inner.int2.outer_i};ay.prototype.get_arbiters=function(){return this.zpp_inner.wrap_arbiters};ay.prototype.toString=function(){var ea="Cb:";ea="Cb:"+["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event];ea+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();ea+=" : "+this.zpp_inner.wrap_arbiters.toString();ea+=" : listener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(ay.prototype,"int1",{get:ay.prototype.get_int1});Object.defineProperty(ay.prototype,"int2",{get:ay.prototype.get_int2});Object.defineProperty(ay.prototype,"arbiters",{get:ay.prototype.get_arbiters});ay.prototype.__class__=ay;var bp=nape.callbacks.InteractionListener=function(eb,ec,ek,ei,ej,ea){if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);var eh=-1;if(br.CbEvent_BEGIN==null){br.internal=true;br.CbEvent_BEGIN=new bU();br.internal=false}if(eb==br.CbEvent_BEGIN){eh=0}else{if(br.CbEvent_END==null){br.internal=true;br.CbEvent_END=new bU();br.internal=false}if(eb==br.CbEvent_END){eh=1}else{if(br.CbEvent_ONGOING==null){br.internal=true;br.CbEvent_ONGOING=new bU();br.internal=false}if(eb==br.CbEvent_ONGOING){eh=6}}}this.zpp_inner_zn=new c1(cP.argument(ek),cP.argument(ei),eh,2);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zni=this;this.zpp_inner.precedence=ea;this.zpp_inner_zn.handleri=ej;var ef=this.zpp_inner_zn.itype;var ee;if(ef==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}ee=br.InteractionType_COLLISION}else{if(ef==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}ee=br.InteractionType_SENSOR}else{if(ef==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}ee=br.InteractionType_FLUID}else{if(ef==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}ee=br.InteractionType_ANY}else{ee=null}}}}if(ee!=ec){var ed;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(ec==br.InteractionType_COLLISION){ed=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(ec==br.InteractionType_SENSOR){ed=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(ec==br.InteractionType_FLUID){ed=4}else{ed=7}}}this.zpp_inner_zn.itype=ed}var eg=this.zpp_inner_zn.itype;if(eg==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}}else{if(eg==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}}else{if(eg==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}}else{if(eg==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}}}}}};bp.__name__=["nape","callbacks","InteractionListener"];bp.__super__=cN;bp.prototype=Object.create(cN.prototype);bp.prototype.zpp_inner_zn=null;bp.prototype.get_options1=function(){return this.zpp_inner_zn.options1.outer};bp.prototype.set_options1=function(ea){this.zpp_inner_zn.options1.set(ea.zpp_inner);return this.zpp_inner_zn.options1.outer};bp.prototype.get_options2=function(){return this.zpp_inner_zn.options2.outer};bp.prototype.set_options2=function(ea){this.zpp_inner_zn.options2.set(ea.zpp_inner);return this.zpp_inner_zn.options2.outer};bp.prototype.get_interactionType=function(){var ea=this.zpp_inner_zn.itype;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};bp.prototype.set_interactionType=function(ec){var ea=this.zpp_inner_zn.itype;var eb;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}eb=br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}eb=br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}eb=br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}eb=br.InteractionType_ANY}else{eb=null}}}}if(eb!=ec){var ee;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(ec==br.InteractionType_COLLISION){ee=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(ec==br.InteractionType_SENSOR){ee=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(ec==br.InteractionType_FLUID){ee=4}else{ee=7}}}this.zpp_inner_zn.itype=ee}var ed=this.zpp_inner_zn.itype;if(ed==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ed==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ed==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ed==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};bp.prototype.get_handler=function(){return this.zpp_inner_zn.handleri};bp.prototype.set_handler=function(ea){this.zpp_inner_zn.handleri=ea;return this.zpp_inner_zn.handleri};bp.prototype.get_allowSleepingCallbacks=function(){return this.zpp_inner_zn.allowSleepingCallbacks};bp.prototype.set_allowSleepingCallbacks=function(ea){this.zpp_inner_zn.allowSleepingCallbacks=ea;return this.zpp_inner_zn.allowSleepingCallbacks};Object.defineProperty(bp.prototype,"options1",{get:bp.prototype.get_options1,set:bp.prototype.set_options1});Object.defineProperty(bp.prototype,"options2",{get:bp.prototype.get_options2,set:bp.prototype.set_options2});Object.defineProperty(bp.prototype,"interactionType",{get:bp.prototype.get_interactionType,set:bp.prototype.set_interactionType});Object.defineProperty(bp.prototype,"handler",{get:bp.prototype.get_handler,set:bp.prototype.set_handler});Object.defineProperty(bp.prototype,"allowSleepingCallbacks",{get:bp.prototype.get_allowSleepingCallbacks,set:bp.prototype.set_allowSleepingCallbacks});bp.prototype.__class__=bp;var b3=nape.callbacks.InteractionType=function(){};b3.__name__=["nape","callbacks","InteractionType"];b3.COLLISION=null;b3.get_COLLISION=function(){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION};b3.SENSOR=null;b3.get_SENSOR=function(){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR};b3.FLUID=null;b3.get_FLUID=function(){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID};b3.ANY=null;b3.get_ANY=function(){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY};b3.prototype.toString=function(){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(this==br.InteractionType_COLLISION){return"COLLISION"}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(this==br.InteractionType_SENSOR){return"SENSOR"}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(this==br.InteractionType_FLUID){return"FLUID"}else{if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}if(this==br.InteractionType_ANY){return"ANY"}else{return""}}}}};Object.defineProperty(b3,"COLLISION",{get:b3.get_COLLISION});Object.defineProperty(b3,"SENSOR",{get:b3.get_SENSOR});Object.defineProperty(b3,"FLUID",{get:b3.get_FLUID});Object.defineProperty(b3,"ANY",{get:b3.get_ANY});b3.prototype.__class__=b3;var cV=nape.callbacks.ListenerIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};cV.__name__=["nape","callbacks","ListenerIterator"];cV.get=function(ec){var ea;if(cV.zpp_pool==null){a1.internal=true;var ed=new cV();a1.internal=false;ea=ed}else{var eb=cV.zpp_pool;cV.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};cV.prototype.zpp_inner=null;cV.prototype.zpp_i=null;cV.prototype.zpp_critical=null;cV.prototype.zpp_next=null;cV.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=cV.zpp_pool;cV.zpp_pool=this;this.zpp_inner=null;return false}};cV.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};cV.prototype.__class__=cV;var ci=nape.callbacks.ListenerList=function(){this.zpp_inner=null;this.zpp_inner=new a1();this.zpp_inner.outer=this};ci.__name__=["nape","callbacks","ListenerList"];ci.fromArray=function(ed){var ea=new ci();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};ci.prototype.zpp_inner=null;ci.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};ci.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};ci.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};ci.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};ci.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};ci.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};ci.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};ci.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};ci.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};ci.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};ci.prototype.empty=function(){return this.zpp_inner.inner.head==null};ci.prototype.iterator=function(){this.zpp_inner.valmod();return cV.get(this)};ci.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new ci();this.zpp_inner.valmod();var ef=cV.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cV.zpp_pool;cV.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};ci.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=cV.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=cV.zpp_pool;cV.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};ci.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=cV.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cV.zpp_pool;cV.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};ci.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=cV.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=cV.zpp_pool;cV.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=cV.zpp_pool;cV.zpp_pool=ec;ec.zpp_inner=null;break}}return this};ci.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(ci.prototype,"length",{get:ci.prototype.get_length});ci.prototype.__class__=ci;var dZ=nape.callbacks.ListenerType=function(){};dZ.__name__=["nape","callbacks","ListenerType"];dZ.BODY=null;dZ.get_BODY=function(){if(br.ListenerType_BODY==null){br.internal=true;br.ListenerType_BODY=new dZ();br.internal=false}return br.ListenerType_BODY};dZ.CONSTRAINT=null;dZ.get_CONSTRAINT=function(){if(br.ListenerType_CONSTRAINT==null){br.internal=true;br.ListenerType_CONSTRAINT=new dZ();br.internal=false}return br.ListenerType_CONSTRAINT};dZ.INTERACTION=null;dZ.get_INTERACTION=function(){if(br.ListenerType_INTERACTION==null){br.internal=true;br.ListenerType_INTERACTION=new dZ();br.internal=false}return br.ListenerType_INTERACTION};dZ.PRE=null;dZ.get_PRE=function(){if(br.ListenerType_PRE==null){br.internal=true;br.ListenerType_PRE=new dZ();br.internal=false}return br.ListenerType_PRE};dZ.prototype.toString=function(){if(br.ListenerType_BODY==null){br.internal=true;br.ListenerType_BODY=new dZ();br.internal=false}if(this==br.ListenerType_BODY){return"BODY"}else{if(br.ListenerType_CONSTRAINT==null){br.internal=true;br.ListenerType_CONSTRAINT=new dZ();br.internal=false}if(this==br.ListenerType_CONSTRAINT){return"CONSTRAINT"}else{if(br.ListenerType_INTERACTION==null){br.internal=true;br.ListenerType_INTERACTION=new dZ();br.internal=false}if(this==br.ListenerType_INTERACTION){return"INTERACTION"}else{if(br.ListenerType_PRE==null){br.internal=true;br.ListenerType_PRE=new dZ();br.internal=false}if(this==br.ListenerType_PRE){return"PRE"}else{return""}}}}};Object.defineProperty(dZ,"BODY",{get:dZ.get_BODY});Object.defineProperty(dZ,"CONSTRAINT",{get:dZ.get_CONSTRAINT});Object.defineProperty(dZ,"INTERACTION",{get:dZ.get_INTERACTION});Object.defineProperty(dZ,"PRE",{get:dZ.get_PRE});dZ.prototype.__class__=dZ;var R=nape.callbacks.OptionType=function(ea,eb){this.zpp_inner=null;this.zpp_inner=new cP();this.zpp_inner.outer=this;if(ea!=null){this.including(ea)}if(eb!=null){this.excluding(eb)}};R.__name__=["nape","callbacks","OptionType"];R.prototype.zpp_inner=null;R.prototype.get_includes=function(){if(this.zpp_inner.wrap_includes==null){this.zpp_inner.setup_includes()}return this.zpp_inner.wrap_includes};R.prototype.get_excludes=function(){if(this.zpp_inner.wrap_excludes==null){this.zpp_inner.setup_excludes()}return this.zpp_inner.wrap_excludes};R.prototype.including=function(ea){this.zpp_inner.append(this.zpp_inner.includes,ea);return this};R.prototype.excluding=function(ea){this.zpp_inner.append(this.zpp_inner.excludes,ea);return this};R.prototype.toString=function(){if(this.zpp_inner.wrap_includes==null){this.zpp_inner.setup_includes()}var ea=this.zpp_inner.wrap_includes.toString();if(this.zpp_inner.wrap_excludes==null){this.zpp_inner.setup_excludes()}return"@{"+ea+" excluding "+this.zpp_inner.wrap_excludes.toString()+"}"};Object.defineProperty(R.prototype,"includes",{get:R.prototype.get_includes});Object.defineProperty(R.prototype,"excludes",{get:R.prototype.get_excludes});R.prototype.__class__=R;var a9=nape.callbacks.PreCallback=function(){bP.call(this)};a9.__name__=["nape","callbacks","PreCallback"];a9.__super__=bP;a9.prototype=Object.create(bP.prototype);a9.prototype.get_arbiter=function(){return this.zpp_inner.pre_arbiter.wrapper()};a9.prototype.get_int1=function(){return this.zpp_inner.int1.outer_i};a9.prototype.get_int2=function(){return this.zpp_inner.int2.outer_i};a9.prototype.get_swapped=function(){return this.zpp_inner.pre_swapped};a9.prototype.toString=function(){var ea="Cb:PRE:";ea="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());ea+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();ea+=" : listnener: "+ag.string(this.zpp_inner.listener.outer);return ea};Object.defineProperty(a9.prototype,"arbiter",{get:a9.prototype.get_arbiter});Object.defineProperty(a9.prototype,"int1",{get:a9.prototype.get_int1});Object.defineProperty(a9.prototype,"int2",{get:a9.prototype.get_int2});Object.defineProperty(a9.prototype,"swapped",{get:a9.prototype.get_swapped});a9.prototype.__class__=a9;var bq=nape.callbacks.PreFlag=function(){};bq.__name__=["nape","callbacks","PreFlag"];bq.ACCEPT=null;bq.get_ACCEPT=function(){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}return br.PreFlag_ACCEPT};bq.IGNORE=null;bq.get_IGNORE=function(){if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}return br.PreFlag_IGNORE};bq.ACCEPT_ONCE=null;bq.get_ACCEPT_ONCE=function(){if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}return br.PreFlag_ACCEPT_ONCE};bq.IGNORE_ONCE=null;bq.get_IGNORE_ONCE=function(){if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}return br.PreFlag_IGNORE_ONCE};bq.prototype.toString=function(){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}if(this==br.PreFlag_ACCEPT){return"ACCEPT"}else{if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}if(this==br.PreFlag_IGNORE){return"IGNORE"}else{if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}if(this==br.PreFlag_ACCEPT_ONCE){return"ACCEPT_ONCE"}else{if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}if(this==br.PreFlag_IGNORE_ONCE){return"IGNORE_ONCE"}else{return""}}}}};Object.defineProperty(bq,"ACCEPT",{get:bq.get_ACCEPT});Object.defineProperty(bq,"IGNORE",{get:bq.get_IGNORE});Object.defineProperty(bq,"ACCEPT_ONCE",{get:bq.get_ACCEPT_ONCE});Object.defineProperty(bq,"IGNORE_ONCE",{get:bq.get_IGNORE_ONCE});bq.prototype.__class__=bq;var b2=nape.callbacks.PreListener=function(eb,ej,eh,ei,ea,ec){if(ec==null){ec=false}if(ea==null){ea=0}this.zpp_inner_zn=null;cN.call(this);this.zpp_inner_zn=new c1(cP.argument(ej),cP.argument(eh),5,3);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_znp=this;this.zpp_inner.precedence=ea;this.zpp_inner_zn.pure=ec;this.zpp_inner_zn.handlerp=ei;var ef=this.zpp_inner_zn.itype;var ee;if(ef==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}ee=br.InteractionType_COLLISION}else{if(ef==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}ee=br.InteractionType_SENSOR}else{if(ef==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}ee=br.InteractionType_FLUID}else{if(ef==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}ee=br.InteractionType_ANY}else{ee=null}}}}if(ee!=eb){var ed;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(eb==br.InteractionType_COLLISION){ed=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(eb==br.InteractionType_SENSOR){ed=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(eb==br.InteractionType_FLUID){ed=4}else{ed=7}}}this.zpp_inner_zn.itype=ed}var eg=this.zpp_inner_zn.itype;if(eg==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}}else{if(eg==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}}else{if(eg==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}}else{if(eg==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}}}}}};b2.__name__=["nape","callbacks","PreListener"];b2.__super__=cN;b2.prototype=Object.create(cN.prototype);b2.prototype.zpp_inner_zn=null;b2.prototype.get_options1=function(){return this.zpp_inner_zn.options1.outer};b2.prototype.set_options1=function(ea){this.zpp_inner_zn.options1.set(ea.zpp_inner);return this.zpp_inner_zn.options1.outer};b2.prototype.get_options2=function(){return this.zpp_inner_zn.options2.outer};b2.prototype.set_options2=function(ea){this.zpp_inner_zn.options2.set(ea.zpp_inner);return this.zpp_inner_zn.options2.outer};b2.prototype.get_handler=function(){return this.zpp_inner_zn.handlerp};b2.prototype.set_handler=function(ea){this.zpp_inner_zn.handlerp=ea;this.zpp_inner_zn.wake();return this.zpp_inner_zn.handlerp};b2.prototype.get_pure=function(){return this.zpp_inner_zn.pure};b2.prototype.set_pure=function(ea){if(!ea){this.zpp_inner_zn.wake()}this.zpp_inner_zn.pure=ea;return this.zpp_inner_zn.pure};b2.prototype.get_interactionType=function(){var ea=this.zpp_inner_zn.itype;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};b2.prototype.set_interactionType=function(ec){var ea=this.zpp_inner_zn.itype;var eb;if(ea==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}eb=br.InteractionType_COLLISION}else{if(ea==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}eb=br.InteractionType_SENSOR}else{if(ea==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}eb=br.InteractionType_FLUID}else{if(ea==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}eb=br.InteractionType_ANY}else{eb=null}}}}if(eb!=ec){var ee;if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(ec==br.InteractionType_COLLISION){ee=1}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(ec==br.InteractionType_SENSOR){ee=2}else{if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}if(ec==br.InteractionType_FLUID){ee=4}else{ee=7}}}this.zpp_inner_zn.itype=ee}var ed=this.zpp_inner_zn.itype;if(ed==1){if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}return br.InteractionType_COLLISION}else{if(ed==2){if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}return br.InteractionType_SENSOR}else{if(ed==4){if(br.InteractionType_FLUID==null){br.internal=true;br.InteractionType_FLUID=new b3();br.internal=false}return br.InteractionType_FLUID}else{if(ed==7){if(br.InteractionType_ANY==null){br.internal=true;br.InteractionType_ANY=new b3();br.internal=false}return br.InteractionType_ANY}else{return null}}}}};Object.defineProperty(b2.prototype,"options1",{get:b2.prototype.get_options1,set:b2.prototype.set_options1});Object.defineProperty(b2.prototype,"options2",{get:b2.prototype.get_options2,set:b2.prototype.set_options2});Object.defineProperty(b2.prototype,"handler",{get:b2.prototype.get_handler,set:b2.prototype.set_handler});Object.defineProperty(b2.prototype,"pure",{get:b2.prototype.get_pure,set:b2.prototype.set_pure});Object.defineProperty(b2.prototype,"interactionType",{get:b2.prototype.get_interactionType,set:b2.prototype.set_interactionType});b2.prototype.__class__=b2;var cK=nape.constraint.Constraint=function(){this.debugDraw=true;this.zpp_inner.insert_cbtype(db.ANY_CONSTRAINT.zpp_inner)};cK.__name__=["nape","constraint","Constraint"];cK.prototype.zpp_inner=null;cK.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};cK.prototype.debugDraw=null;cK.prototype.get_compound=function(){if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};cK.prototype.set_compound=function(ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=null){(this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_constraints;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};cK.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cK.prototype.set_space=function(ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if(this.zpp_inner.component!=null){this.zpp_inner.component.woken=false}this.zpp_inner.clearcache();if(this.zpp_inner.space!=null){this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_constraints;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}else{this.zpp_inner.space=null}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};cK.prototype.get_isSleeping=function(){return this.zpp_inner.component.sleeping};cK.prototype.get_active=function(){return this.zpp_inner.active};cK.prototype.set_active=function(ea){if(this.zpp_inner.active!=ea){if(this.zpp_inner.component!=null){this.zpp_inner.component.woken=false}this.zpp_inner.clearcache();if(ea){this.zpp_inner.active=ea;this.zpp_inner.activate();if(this.zpp_inner.space!=null){if(this.zpp_inner.component!=null){this.zpp_inner.component.sleeping=true}this.zpp_inner.space.wake_constraint(this.zpp_inner,true)}}else{if(this.zpp_inner.space!=null){this.zpp_inner.wake();this.zpp_inner.space.live_constraints.remove(this.zpp_inner)}this.zpp_inner.active=ea;this.zpp_inner.deactivate()}}return this.zpp_inner.active};cK.prototype.get_ignore=function(){return this.zpp_inner.ignore};cK.prototype.set_ignore=function(ea){if(this.zpp_inner.ignore!=ea){this.zpp_inner.ignore=ea;this.zpp_inner.wake()}return this.zpp_inner.ignore};cK.prototype.get_stiff=function(){return this.zpp_inner.stiff};cK.prototype.set_stiff=function(ea){if(this.zpp_inner.stiff!=ea){this.zpp_inner.stiff=ea;this.zpp_inner.wake()}return this.zpp_inner.stiff};cK.prototype.get_frequency=function(){return this.zpp_inner.frequency};cK.prototype.set_frequency=function(ea){if(this.zpp_inner.frequency!=ea){this.zpp_inner.frequency=ea;if(!this.zpp_inner.stiff){this.zpp_inner.wake()}}return this.zpp_inner.frequency};cK.prototype.get_damping=function(){return this.zpp_inner.damping};cK.prototype.set_damping=function(ea){if(this.zpp_inner.damping!=ea){this.zpp_inner.damping=ea;if(!this.zpp_inner.stiff){this.zpp_inner.wake()}}return this.zpp_inner.damping};cK.prototype.get_maxForce=function(){return this.zpp_inner.maxForce};cK.prototype.set_maxForce=function(ea){if(this.zpp_inner.maxForce!=ea){this.zpp_inner.maxForce=ea;this.zpp_inner.wake()}return this.zpp_inner.maxForce};cK.prototype.get_maxError=function(){return this.zpp_inner.maxError};cK.prototype.set_maxError=function(ea){if(this.zpp_inner.maxError!=ea){this.zpp_inner.maxError=ea;this.zpp_inner.wake()}return this.zpp_inner.maxError};cK.prototype.get_breakUnderForce=function(){return this.zpp_inner.breakUnderForce};cK.prototype.set_breakUnderForce=function(ea){if(this.zpp_inner.breakUnderForce!=ea){this.zpp_inner.breakUnderForce=ea;this.zpp_inner.wake()}return this.zpp_inner.breakUnderForce};cK.prototype.get_breakUnderError=function(){return this.zpp_inner.breakUnderError};cK.prototype.set_breakUnderError=function(ea){if(this.zpp_inner.breakUnderError!=ea){this.zpp_inner.breakUnderError=ea;this.zpp_inner.wake()}return this.zpp_inner.breakUnderError};cK.prototype.get_removeOnBreak=function(){return this.zpp_inner.removeOnBreak};cK.prototype.set_removeOnBreak=function(ea){this.zpp_inner.removeOnBreak=ea;return this.zpp_inner.removeOnBreak};cK.prototype.impulse=function(){return null};cK.prototype.bodyImpulse=function(ea){return null};cK.prototype.visitBodies=function(ea){};cK.prototype.get_cbTypes=function(){if(this.zpp_inner.wrap_cbTypes==null){this.zpp_inner.setupcbTypes()}return this.zpp_inner.wrap_cbTypes};cK.prototype.toString=function(){return"{Constraint}"};cK.prototype.copy=function(){return this.zpp_inner.copy()};Object.defineProperty(cK.prototype,"userData",{get:cK.prototype.get_userData});Object.defineProperty(cK.prototype,"compound",{get:cK.prototype.get_compound,set:cK.prototype.set_compound});Object.defineProperty(cK.prototype,"space",{get:cK.prototype.get_space,set:cK.prototype.set_space});Object.defineProperty(cK.prototype,"isSleeping",{get:cK.prototype.get_isSleeping});Object.defineProperty(cK.prototype,"active",{get:cK.prototype.get_active,set:cK.prototype.set_active});Object.defineProperty(cK.prototype,"ignore",{get:cK.prototype.get_ignore,set:cK.prototype.set_ignore});Object.defineProperty(cK.prototype,"stiff",{get:cK.prototype.get_stiff,set:cK.prototype.set_stiff});Object.defineProperty(cK.prototype,"frequency",{get:cK.prototype.get_frequency,set:cK.prototype.set_frequency});Object.defineProperty(cK.prototype,"damping",{get:cK.prototype.get_damping,set:cK.prototype.set_damping});Object.defineProperty(cK.prototype,"maxForce",{get:cK.prototype.get_maxForce,set:cK.prototype.set_maxForce});Object.defineProperty(cK.prototype,"maxError",{get:cK.prototype.get_maxError,set:cK.prototype.set_maxError});Object.defineProperty(cK.prototype,"breakUnderForce",{get:cK.prototype.get_breakUnderForce,set:cK.prototype.set_breakUnderForce});Object.defineProperty(cK.prototype,"breakUnderError",{get:cK.prototype.get_breakUnderError,set:cK.prototype.set_breakUnderError});Object.defineProperty(cK.prototype,"removeOnBreak",{get:cK.prototype.get_removeOnBreak,set:cK.prototype.set_removeOnBreak});Object.defineProperty(cK.prototype,"cbTypes",{get:cK.prototype.get_cbTypes});cK.prototype.__class__=cK;var aA=nape.constraint.AngleJoint=function(ec,ea,eg,ef,ee){if(ee==null){ee=1}this.zpp_inner_zn=null;this.zpp_inner_zn=new dt();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var ed=ec==null?null:ec.zpp_inner;if(ed!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=ed;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ed!=null&&this.zpp_inner_zn.b2!=ed){if(ed!=null){ed.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ed!=null){ed.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}this.zpp_inner.immutable_midstep("AngleJoint::jointMin");if(this.zpp_inner_zn.jointMin!=eg){this.zpp_inner_zn.jointMin=eg;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("AngleJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ef){this.zpp_inner_zn.jointMax=ef;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("AngleJoint::ratio");if(this.zpp_inner_zn.ratio!=ee){this.zpp_inner_zn.ratio=ee;this.zpp_inner.wake()}};aA.__name__=["nape","constraint","AngleJoint"];aA.__super__=cK;aA.prototype=Object.create(cK.prototype);aA.prototype.zpp_inner_zn=null;aA.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aA.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aA.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aA.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aA.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};aA.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("AngleJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};aA.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};aA.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("AngleJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};aA.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio};aA.prototype.set_ratio=function(ea){this.zpp_inner.immutable_midstep("AngleJoint::ratio");if(this.zpp_inner_zn.ratio!=ea){this.zpp_inner_zn.ratio=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.ratio};aA.prototype.isSlack=function(){var ec=this.zpp_inner_zn;var ea;var eb=ec.ratio*ec.b2.rot-ec.b1.rot;if(ec.equal){ea=false;ec.scale=1}else{if(eb<ec.jointMin){ec.scale=-1;ea=false}else{if(eb>ec.jointMax){eb-=ec.jointMax;ec.scale=1;ea=false}else{ec.scale=0;eb=0;ea=true}}}return ea};aA.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};aA.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get(0,0,0)}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};aA.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(aA.prototype,"body1",{get:aA.prototype.get_body1,set:aA.prototype.set_body1});Object.defineProperty(aA.prototype,"body2",{get:aA.prototype.get_body2,set:aA.prototype.set_body2});Object.defineProperty(aA.prototype,"jointMin",{get:aA.prototype.get_jointMin,set:aA.prototype.set_jointMin});Object.defineProperty(aA.prototype,"jointMax",{get:aA.prototype.get_jointMax,set:aA.prototype.set_jointMax});Object.defineProperty(aA.prototype,"ratio",{get:aA.prototype.get_ratio,set:aA.prototype.set_ratio});aA.prototype.__class__=aA;var bO=nape.constraint.ConstraintIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};bO.__name__=["nape","constraint","ConstraintIterator"];bO.get=function(ec){var ea;if(bO.zpp_pool==null){aZ.internal=true;var ed=new bO();aZ.internal=false;ea=ed}else{var eb=bO.zpp_pool;bO.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};bO.prototype.zpp_inner=null;bO.prototype.zpp_i=null;bO.prototype.zpp_critical=null;bO.prototype.zpp_next=null;bO.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=bO.zpp_pool;bO.zpp_pool=this;this.zpp_inner=null;return false}};bO.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};bO.prototype.__class__=bO;var bg=nape.constraint.ConstraintList=function(){this.zpp_inner=null;this.zpp_inner=new aZ();this.zpp_inner.outer=this};bg.__name__=["nape","constraint","ConstraintList"];bg.fromArray=function(ed){var ea=new bg();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};bg.prototype.zpp_inner=null;bg.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};bg.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};bg.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};bg.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};bg.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};bg.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};bg.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};bg.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};bg.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};bg.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};bg.prototype.empty=function(){return this.zpp_inner.inner.head==null};bg.prototype.iterator=function(){this.zpp_inner.valmod();return bO.get(this)};bg.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new bg();this.zpp_inner.valmod();var ef=bO.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bO.zpp_pool;bO.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};bg.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=bO.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=bO.zpp_pool;bO.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};bg.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=bO.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bO.zpp_pool;bO.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};bg.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=bO.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=bO.zpp_pool;bO.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=bO.zpp_pool;bO.zpp_pool=ec;ec.zpp_inner=null;break}}return this};bg.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(bg.prototype,"length",{get:bg.prototype.get_length});bg.prototype.__class__=bg;var dx=nape.constraint.DistanceJoint=function(ee,ec,eB,ez,es,ex){this.zpp_inner_zn=null;this.zpp_inner_zn=new J();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var el=ee==null?null:ee.zpp_inner;if(el!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=el;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&el!=null&&this.zpp_inner_zn.b2!=el){if(el!=null){el.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(el!=null){el.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ei=ec==null?null:ec.zpp_inner;if(ei!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ei;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ei!=null&&this.zpp_inner_zn.b1!=ei){if(ei!=null){ei.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ei!=null){ei.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var eo=this.zpp_inner_zn.wrap_a1;var ew=eB.zpp_inner;if(ew._validate!=null){ew._validate()}var ed=eB.zpp_inner.x;var ev=eB.zpp_inner;if(ev._validate!=null){ev._validate()}var eb=eB.zpp_inner.y;var ey;var et=eo.zpp_inner;if(et._validate!=null){et._validate()}if(eo.zpp_inner.x==ed){var er=eo.zpp_inner;if(er._validate!=null){er._validate()}ey=eo.zpp_inner.y==eb}else{ey=false}if(!ey){eo.zpp_inner.x=ed;eo.zpp_inner.y=eb;var eq=eo.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}}if(eB.zpp_inner.weak){var eA=eB.zpp_inner;eB.zpp_inner.outer=null;eB.zpp_inner=null;eB.zpp_pool=au.poolVec2;au.poolVec2=eB;if(eA.outer!=null){eA.outer.zpp_inner=null;eA.outer=null}eA._isimmutable=null;eA._validate=null;eA._invalidate=null;eA.next=bB.zpp_pool;bB.zpp_pool=eA}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var en=this.zpp_inner_zn.wrap_a2;var ek=ez.zpp_inner;if(ek._validate!=null){ek._validate()}var eu=ez.zpp_inner.x;var eh=ez.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ez.zpp_inner.y;var eg;var ef=en.zpp_inner;if(ef._validate!=null){ef._validate()}if(en.zpp_inner.x==eu){var em=en.zpp_inner;if(em._validate!=null){em._validate()}eg=en.zpp_inner.y==ea}else{eg=false}if(!eg){en.zpp_inner.x=eu;en.zpp_inner.y=ea;var ej=en.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}if(ez.zpp_inner.weak){var ep=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;ez.zpp_pool=au.poolVec2;au.poolVec2=ez;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");if(this.zpp_inner_zn.jointMin!=es){this.zpp_inner_zn.jointMin=es;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ex){this.zpp_inner_zn.jointMax=ex;this.zpp_inner.wake()}};dx.__name__=["nape","constraint","DistanceJoint"];dx.__super__=cK;dx.prototype=Object.create(cK.prototype);dx.prototype.zpp_inner_zn=null;dx.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dx.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dx.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dx.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dx.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dx.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dx.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dx.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dx.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};dx.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};dx.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};dx.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};dx.prototype.isSlack=function(){return this.zpp_inner_zn.slack};dx.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};dx.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};dx.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(dx.prototype,"body1",{get:dx.prototype.get_body1,set:dx.prototype.set_body1});Object.defineProperty(dx.prototype,"body2",{get:dx.prototype.get_body2,set:dx.prototype.set_body2});Object.defineProperty(dx.prototype,"anchor1",{get:dx.prototype.get_anchor1,set:dx.prototype.set_anchor1});Object.defineProperty(dx.prototype,"anchor2",{get:dx.prototype.get_anchor2,set:dx.prototype.set_anchor2});Object.defineProperty(dx.prototype,"jointMin",{get:dx.prototype.get_jointMin,set:dx.prototype.set_jointMin});Object.defineProperty(dx.prototype,"jointMax",{get:dx.prototype.get_jointMax,set:dx.prototype.set_jointMax});dx.prototype.__class__=dx;var aO=nape.constraint.LineJoint=function(ee,ed,eb,ea,eh,eK,ek){this.zpp_inner_zn=null;this.zpp_inner_zn=new bR();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var eg=ee==null?null:ee.zpp_inner;if(eg!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eg;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eg!=null&&this.zpp_inner_zn.b2!=eg){if(eg!=null){eg.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eg!=null){eg.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ef=ed==null?null:ed.zpp_inner;if(ef!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ef;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ef!=null&&this.zpp_inner_zn.b1!=ef){if(ef!=null){ef.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ef!=null){ef.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ec=this.zpp_inner_zn.wrap_a1;var ew=eb.zpp_inner;if(ew._validate!=null){ew._validate()}var es=eb.zpp_inner.x;var ev=eb.zpp_inner;if(ev._validate!=null){ev._validate()}var eq=eb.zpp_inner.y;var ey;var eu=ec.zpp_inner;if(eu._validate!=null){eu._validate()}if(ec.zpp_inner.x==es){var et=ec.zpp_inner;if(et._validate!=null){et._validate()}ey=ec.zpp_inner.y==eq}else{ey=false}if(!ey){ec.zpp_inner.x=es;ec.zpp_inner.y=eq;var er=ec.zpp_inner;if(er._invalidate!=null){er._invalidate(er)}}if(eb.zpp_inner.weak){var el=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(el.outer!=null){el.outer.zpp_inner=null;el.outer=null}el._isimmutable=null;el._validate=null;el._invalidate=null;el.next=bB.zpp_pool;bB.zpp_pool=el}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ep=this.zpp_inner_zn.wrap_a2;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ej=ea.zpp_inner.x;var en=ea.zpp_inner;if(en._validate!=null){en._validate()}var eM=ea.zpp_inner.y;var eJ;var em=ep.zpp_inner;if(em._validate!=null){em._validate()}if(ep.zpp_inner.x==ej){var eH=ep.zpp_inner;if(eH._validate!=null){eH._validate()}eJ=ep.zpp_inner.y==eM}else{eJ=false}if(!eJ){ep.zpp_inner.x=ej;ep.zpp_inner.y=eM;var eG=ep.zpp_inner;if(eG._invalidate!=null){eG._invalidate(eG)}}if(ea.zpp_inner.weak){var ez=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}var eF=this.zpp_inner_zn.wrap_n;var eE=eh.zpp_inner;if(eE._validate!=null){eE._validate()}var ei=eh.zpp_inner.x;var eD=eh.zpp_inner;if(eD._validate!=null){eD._validate()}var eL=eh.zpp_inner.y;var eI;var eC=eF.zpp_inner;if(eC._validate!=null){eC._validate()}if(eF.zpp_inner.x==ei){var eB=eF.zpp_inner;if(eB._validate!=null){eB._validate()}eI=eF.zpp_inner.y==eL}else{eI=false}if(!eI){eF.zpp_inner.x=ei;eF.zpp_inner.y=eL;var eA=eF.zpp_inner;if(eA._invalidate!=null){eA._invalidate(eA)}}if(eh.zpp_inner.weak){var ex=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ex.outer!=null){ex.outer.zpp_inner=null;ex.outer=null}ex._isimmutable=null;ex._validate=null;ex._invalidate=null;ex.next=bB.zpp_pool;bB.zpp_pool=ex}if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}this.zpp_inner.immutable_midstep("LineJoint::jointMin");if(this.zpp_inner_zn.jointMin!=eK){this.zpp_inner_zn.jointMin=eK;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("LineJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ek){this.zpp_inner_zn.jointMax=ek;this.zpp_inner.wake()}};aO.__name__=["nape","constraint","LineJoint"];aO.__super__=cK;aO.prototype=Object.create(cK.prototype);aO.prototype.zpp_inner_zn=null;aO.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aO.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};aO.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aO.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};aO.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};aO.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};aO.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};aO.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};aO.prototype.get_direction=function(){if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}return this.zpp_inner_zn.wrap_n};aO.prototype.set_direction=function(ei){if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}var ed=this.zpp_inner_zn.wrap_n;var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=ei.zpp_inner.x;var ef=ei.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ei.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ei.zpp_inner.weak){var ek=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_n==null){this.zpp_inner_zn.setup_n()}return this.zpp_inner_zn.wrap_n};aO.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};aO.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("LineJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};aO.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};aO.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("LineJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};aO.prototype.impulse=function(){var ea=new bY(2,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAccx;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccy;return ea};aO.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};aO.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(aO.prototype,"body1",{get:aO.prototype.get_body1,set:aO.prototype.set_body1});Object.defineProperty(aO.prototype,"body2",{get:aO.prototype.get_body2,set:aO.prototype.set_body2});Object.defineProperty(aO.prototype,"anchor1",{get:aO.prototype.get_anchor1,set:aO.prototype.set_anchor1});Object.defineProperty(aO.prototype,"anchor2",{get:aO.prototype.get_anchor2,set:aO.prototype.set_anchor2});Object.defineProperty(aO.prototype,"direction",{get:aO.prototype.get_direction,set:aO.prototype.set_direction});Object.defineProperty(aO.prototype,"jointMin",{get:aO.prototype.get_jointMin,set:aO.prototype.set_jointMin});Object.defineProperty(aO.prototype,"jointMax",{get:aO.prototype.get_jointMax,set:aO.prototype.set_jointMax});aO.prototype.__class__=aO;var bQ=nape.constraint.MotorJoint=function(ec,ea,ef,ee){if(ee==null){ee=1}if(ef==null){ef=0}this.zpp_inner_zn=null;this.zpp_inner_zn=new y();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var ed=ec==null?null:ec.zpp_inner;if(ed!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=ed;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ed!=null&&this.zpp_inner_zn.b2!=ed){if(ed!=null){ed.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ed!=null){ed.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}this.zpp_inner.immutable_midstep("MotorJoint::rate");if(this.zpp_inner_zn.rate!=ef){this.zpp_inner_zn.rate=ef;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("MotorJoint::ratio");if(this.zpp_inner_zn.ratio!=ee){this.zpp_inner_zn.ratio=ee;this.zpp_inner.wake()}};bQ.__name__=["nape","constraint","MotorJoint"];bQ.__super__=cK;bQ.prototype=Object.create(cK.prototype);bQ.prototype.zpp_inner_zn=null;bQ.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bQ.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bQ.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bQ.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bQ.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio};bQ.prototype.set_ratio=function(ea){this.zpp_inner.immutable_midstep("MotorJoint::ratio");if(this.zpp_inner_zn.ratio!=ea){this.zpp_inner_zn.ratio=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.ratio};bQ.prototype.get_rate=function(){return this.zpp_inner_zn.rate};bQ.prototype.set_rate=function(ea){this.zpp_inner.immutable_midstep("MotorJoint::rate");if(this.zpp_inner_zn.rate!=ea){this.zpp_inner_zn.rate=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.rate};bQ.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};bQ.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};bQ.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(bQ.prototype,"body1",{get:bQ.prototype.get_body1,set:bQ.prototype.set_body1});Object.defineProperty(bQ.prototype,"body2",{get:bQ.prototype.get_body2,set:bQ.prototype.set_body2});Object.defineProperty(bQ.prototype,"ratio",{get:bQ.prototype.get_ratio,set:bQ.prototype.set_ratio});Object.defineProperty(bQ.prototype,"rate",{get:bQ.prototype.get_rate,set:bQ.prototype.set_rate});bQ.prototype.__class__=bQ;var bV=nape.constraint.PivotJoint=function(ee,ec,ez,ex){this.zpp_inner_zn=null;this.zpp_inner_zn=new D();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var el=ee==null?null:ee.zpp_inner;if(el!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=el;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&el!=null&&this.zpp_inner_zn.b2!=el){if(el!=null){el.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(el!=null){el.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ei=ec==null?null:ec.zpp_inner;if(ei!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ei;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ei!=null&&this.zpp_inner_zn.b1!=ei){if(ei!=null){ei.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ei!=null){ei.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var en=this.zpp_inner_zn.wrap_a1;var ev=ez.zpp_inner;if(ev._validate!=null){ev._validate()}var ed=ez.zpp_inner.x;var eu=ez.zpp_inner;if(eu._validate!=null){eu._validate()}var eb=ez.zpp_inner.y;var ew;var es=en.zpp_inner;if(es._validate!=null){es._validate()}if(en.zpp_inner.x==ed){var er=en.zpp_inner;if(er._validate!=null){er._validate()}ew=en.zpp_inner.y==eb}else{ew=false}if(!ew){en.zpp_inner.x=ed;en.zpp_inner.y=eb;var eq=en.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}}if(ez.zpp_inner.weak){var ey=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;ez.zpp_pool=au.poolVec2;au.poolVec2=ez;if(ey.outer!=null){ey.outer.zpp_inner=null;ey.outer=null}ey._isimmutable=null;ey._validate=null;ey._invalidate=null;ey.next=bB.zpp_pool;bB.zpp_pool=ey}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var eo=this.zpp_inner_zn.wrap_a2;var ek=ex.zpp_inner;if(ek._validate!=null){ek._validate()}var et=ex.zpp_inner.x;var eh=ex.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ex.zpp_inner.y;var eg;var ef=eo.zpp_inner;if(ef._validate!=null){ef._validate()}if(eo.zpp_inner.x==et){var em=eo.zpp_inner;if(em._validate!=null){em._validate()}eg=eo.zpp_inner.y==ea}else{eg=false}if(!eg){eo.zpp_inner.x=et;eo.zpp_inner.y=ea;var ej=eo.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}if(ex.zpp_inner.weak){var ep=ex.zpp_inner;ex.zpp_inner.outer=null;ex.zpp_inner=null;ex.zpp_pool=au.poolVec2;au.poolVec2=ex;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}};bV.__name__=["nape","constraint","PivotJoint"];bV.__super__=cK;bV.prototype=Object.create(cK.prototype);bV.prototype.zpp_inner_zn=null;bV.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bV.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};bV.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bV.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};bV.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};bV.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};bV.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};bV.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};bV.prototype.impulse=function(){var ea=new bY(2,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAccx;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccy;return ea};bV.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};bV.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(bV.prototype,"body1",{get:bV.prototype.get_body1,set:bV.prototype.set_body1});Object.defineProperty(bV.prototype,"body2",{get:bV.prototype.get_body2,set:bV.prototype.set_body2});Object.defineProperty(bV.prototype,"anchor1",{get:bV.prototype.get_anchor1,set:bV.prototype.set_anchor1});Object.defineProperty(bV.prototype,"anchor2",{get:bV.prototype.get_anchor2,set:bV.prototype.set_anchor2});bV.prototype.__class__=bV;var dy=nape.constraint.PulleyJoint=function(ek,ei,eg,ef,ed,ec,eb,ea,eZ,eq,eF){if(eF==null){eF=1}this.zpp_inner_zn=null;this.zpp_inner_zn=new N();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var em=ek==null?null:ek.zpp_inner;if(em!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=em;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&em!=null&&this.zpp_inner_zn.b2!=em&&this.zpp_inner_zn.b3!=em&&this.zpp_inner_zn.b4!=em){if(em!=null){em.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(em!=null){em.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var el=ei==null?null:ei.zpp_inner;if(el!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=el;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&el!=null&&this.zpp_inner_zn.b1!=el&&this.zpp_inner_zn.b3!=el&&this.zpp_inner_zn.b4!=el){if(el!=null){el.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(el!=null){el.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body3");var ej=eg==null?null:eg.zpp_inner;if(ej!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b3.wake()}}this.zpp_inner_zn.b3=ej;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ej!=null&&this.zpp_inner_zn.b1!=ej&&this.zpp_inner_zn.b2!=ej&&this.zpp_inner_zn.b4!=ej){if(ej!=null){ej.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ej!=null){ej.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body4");var eh=ef==null?null:ef.zpp_inner;if(eh!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b4.wake()}}this.zpp_inner_zn.b4=eh;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eh!=null&&this.zpp_inner_zn.b1!=eh&&this.zpp_inner_zn.b2!=eh&&this.zpp_inner_zn.b3!=eh){if(eh!=null){eh.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eh!=null){eh.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ee=this.zpp_inner_zn.wrap_a1;var eH=ed.zpp_inner;if(eH._validate!=null){eH._validate()}var eC=ed.zpp_inner.x;var eG=ed.zpp_inner;if(eG._validate!=null){eG._validate()}var eA=ed.zpp_inner.y;var eK;var eE=ee.zpp_inner;if(eE._validate!=null){eE._validate()}if(ee.zpp_inner.x==eC){var eD=ee.zpp_inner;if(eD._validate!=null){eD._validate()}eK=ee.zpp_inner.y==eA}else{eK=false}if(!eK){ee.zpp_inner.x=eC;ee.zpp_inner.y=eA;var eB=ee.zpp_inner;if(eB._invalidate!=null){eB._invalidate(eB)}}if(ed.zpp_inner.weak){var er=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(er.outer!=null){er.outer.zpp_inner=null;er.outer=null}er._isimmutable=null;er._validate=null;er._invalidate=null;er.next=bB.zpp_pool;bB.zpp_pool=er}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ez=this.zpp_inner_zn.wrap_a2;var ey=ec.zpp_inner;if(ey._validate!=null){ey._validate()}var ep=ec.zpp_inner.x;var ex=ec.zpp_inner;if(ex._validate!=null){ex._validate()}var e2=ec.zpp_inner.y;var eY;var ew=ez.zpp_inner;if(ew._validate!=null){ew._validate()}if(ez.zpp_inner.x==ep){var eX=ez.zpp_inner;if(eX._validate!=null){eX._validate()}eY=ez.zpp_inner.y==e2}else{eY=false}if(!eY){ez.zpp_inner.x=ep;ez.zpp_inner.y=e2;var eV=ez.zpp_inner;if(eV._invalidate!=null){eV._invalidate(eV)}}if(ec.zpp_inner.weak){var eM=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(eM.outer!=null){eM.outer.zpp_inner=null;eM.outer=null}eM._isimmutable=null;eM._validate=null;eM._invalidate=null;eM.next=bB.zpp_pool;bB.zpp_pool=eM}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}var eT=this.zpp_inner_zn.wrap_a3;var eS=eb.zpp_inner;if(eS._validate!=null){eS._validate()}var eo=eb.zpp_inner.x;var eR=eb.zpp_inner;if(eR._validate!=null){eR._validate()}var e1=eb.zpp_inner.y;var eW;var eQ=eT.zpp_inner;if(eQ._validate!=null){eQ._validate()}if(eT.zpp_inner.x==eo){var eP=eT.zpp_inner;if(eP._validate!=null){eP._validate()}eW=eT.zpp_inner.y==e1}else{eW=false}if(!eW){eT.zpp_inner.x=eo;eT.zpp_inner.y=e1;var eO=eT.zpp_inner;if(eO._invalidate!=null){eO._invalidate(eO)}}if(eb.zpp_inner.weak){var eJ=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(eJ.outer!=null){eJ.outer.zpp_inner=null;eJ.outer=null}eJ._isimmutable=null;eJ._validate=null;eJ._invalidate=null;eJ.next=bB.zpp_pool;bB.zpp_pool=eJ}if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}var eN=this.zpp_inner_zn.wrap_a4;var eL=ea.zpp_inner;if(eL._validate!=null){eL._validate()}var en=ea.zpp_inner.x;var ev=ea.zpp_inner;if(ev._validate!=null){ev._validate()}var e0=ea.zpp_inner.y;var eU;var eu=eN.zpp_inner;if(eu._validate!=null){eu._validate()}if(eN.zpp_inner.x==en){var et=eN.zpp_inner;if(et._validate!=null){et._validate()}eU=eN.zpp_inner.y==e0}else{eU=false}if(!eU){eN.zpp_inner.x=en;eN.zpp_inner.y=e0;var es=eN.zpp_inner;if(es._invalidate!=null){es._invalidate(es)}}if(ea.zpp_inner.weak){var eI=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eI.outer!=null){eI.outer.zpp_inner=null;eI.outer=null}eI._isimmutable=null;eI._validate=null;eI._invalidate=null;eI.next=bB.zpp_pool;bB.zpp_pool=eI}if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}this.zpp_inner.immutable_midstep("PulleyJoint::ratio");if(this.zpp_inner_zn.ratio!=eF){this.zpp_inner_zn.ratio=eF;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");if(this.zpp_inner_zn.jointMin!=eZ){this.zpp_inner_zn.jointMin=eZ;this.zpp_inner.wake()}this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");if(this.zpp_inner_zn.jointMax!=eq){this.zpp_inner_zn.jointMax=eq;this.zpp_inner.wake()}};dy.__name__=["nape","constraint","PulleyJoint"];dy.__super__=cK;dy.prototype=Object.create(cK.prototype);dy.prototype.zpp_inner_zn=null;dy.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dy.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb&&this.zpp_inner_zn.b3!=eb&&this.zpp_inner_zn.b4!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};dy.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dy.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb&&this.zpp_inner_zn.b3!=eb&&this.zpp_inner_zn.b4!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};dy.prototype.get_body3=function(){if(this.zpp_inner_zn.b3==null){return null}else{return this.zpp_inner_zn.b3.outer}};dy.prototype.set_body3=function(ea){this.zpp_inner.immutable_midstep("Constraint::body3");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3){if(this.zpp_inner_zn.b3!=null){this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b3.wake()}}this.zpp_inner_zn.b3=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb&&this.zpp_inner_zn.b2!=eb&&this.zpp_inner_zn.b4!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b3==null){return null}else{return this.zpp_inner_zn.b3.outer}};dy.prototype.get_body4=function(){if(this.zpp_inner_zn.b4==null){return null}else{return this.zpp_inner_zn.b4.outer}};dy.prototype.set_body4=function(ea){this.zpp_inner.immutable_midstep("Constraint::body4");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4){if(this.zpp_inner_zn.b4!=null){this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b4.wake()}}this.zpp_inner_zn.b4=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb&&this.zpp_inner_zn.b2!=eb&&this.zpp_inner_zn.b3!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b4==null){return null}else{return this.zpp_inner_zn.b4.outer}};dy.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dy.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};dy.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dy.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};dy.prototype.get_anchor3=function(){if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}return this.zpp_inner_zn.wrap_a3};dy.prototype.set_anchor3=function(ej){if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}var ed=this.zpp_inner_zn.wrap_a3;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a3==null){this.zpp_inner_zn.setup_a3()}return this.zpp_inner_zn.wrap_a3};dy.prototype.get_anchor4=function(){if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}return this.zpp_inner_zn.wrap_a4};dy.prototype.set_anchor4=function(ej){if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}var ed=this.zpp_inner_zn.wrap_a4;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a4==null){this.zpp_inner_zn.setup_a4()}return this.zpp_inner_zn.wrap_a4};dy.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin};dy.prototype.set_jointMin=function(ea){this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");if(this.zpp_inner_zn.jointMin!=ea){this.zpp_inner_zn.jointMin=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMin};dy.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax};dy.prototype.set_jointMax=function(ea){this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");if(this.zpp_inner_zn.jointMax!=ea){this.zpp_inner_zn.jointMax=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.jointMax};dy.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio};dy.prototype.set_ratio=function(ea){this.zpp_inner.immutable_midstep("PulleyJoint::ratio");if(this.zpp_inner_zn.ratio!=ea){this.zpp_inner_zn.ratio=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.ratio};dy.prototype.isSlack=function(){return this.zpp_inner_zn.slack};dy.prototype.impulse=function(){var ea=new bY(1,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc;return ea};dy.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};dy.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}if((this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)!=null&&(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)&&(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)!=(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)){ea(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)}if((this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=null&&(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)&&(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)&&(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)!=(this.zpp_inner_zn.b3==null?null:this.zpp_inner_zn.b3.outer)){ea(this.zpp_inner_zn.b4==null?null:this.zpp_inner_zn.b4.outer)}};Object.defineProperty(dy.prototype,"body1",{get:dy.prototype.get_body1,set:dy.prototype.set_body1});Object.defineProperty(dy.prototype,"body2",{get:dy.prototype.get_body2,set:dy.prototype.set_body2});Object.defineProperty(dy.prototype,"body3",{get:dy.prototype.get_body3,set:dy.prototype.set_body3});Object.defineProperty(dy.prototype,"body4",{get:dy.prototype.get_body4,set:dy.prototype.set_body4});Object.defineProperty(dy.prototype,"anchor1",{get:dy.prototype.get_anchor1,set:dy.prototype.set_anchor1});Object.defineProperty(dy.prototype,"anchor2",{get:dy.prototype.get_anchor2,set:dy.prototype.set_anchor2});Object.defineProperty(dy.prototype,"anchor3",{get:dy.prototype.get_anchor3,set:dy.prototype.set_anchor3});Object.defineProperty(dy.prototype,"anchor4",{get:dy.prototype.get_anchor4,set:dy.prototype.set_anchor4});Object.defineProperty(dy.prototype,"jointMin",{get:dy.prototype.get_jointMin,set:dy.prototype.set_jointMin});Object.defineProperty(dy.prototype,"jointMax",{get:dy.prototype.get_jointMax,set:dy.prototype.set_jointMax});Object.defineProperty(dy.prototype,"ratio",{get:dy.prototype.get_ratio,set:dy.prototype.set_ratio});dy.prototype.__class__=dy;var aU=nape.constraint.UserConstraint=function(eb,ea){if(ea==null){ea=false}this.zpp_inner_zn=null;this.zpp_inner_zn=new b4(eb,ea);this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this)};aU.__name__=["nape","constraint","UserConstraint"];aU.__super__=cK;aU.prototype=Object.create(cK.prototype);aU.prototype.zpp_inner_zn=null;aU.prototype.__bindVec2=function(){var ea=new r();ea.zpp_inner._inuse=true;ea.zpp_inner._invalidate=(bo=this.zpp_inner_zn,dX(bo,bo.bindVec2_invalidate));return ea};aU.prototype.__copy=function(){return null};aU.prototype.__broken=function(){};aU.prototype.__validate=function(){};aU.prototype.__draw=function(ea){};aU.prototype.__prepare=function(){};aU.prototype.__position=function(ea){};aU.prototype.__velocity=function(ea){};aU.prototype.__eff_mass=function(ea){};aU.prototype.__clamp=function(ea){};aU.prototype.__impulse=function(ec,ea,eb){};aU.prototype.impulse=function(){var ea=new bY(this.zpp_inner_zn.dim,1);var ec=0;var ed=this.zpp_inner_zn.dim;while(ec<ed){var eb=ec++;ea.zpp_inner.x[eb*ea.zpp_inner.n]=this.zpp_inner_zn.jAcc[eb]}return ea};aU.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};aU.prototype.visitBodies=function(eb){var ed=0;var ec=this.zpp_inner_zn.bodies.length;while(ed<ec){var ea=this.zpp_inner_zn.bodies[ed];if(ea.body!=null){var ef=false;var ee=ed+1;while(ee<ec){if(this.zpp_inner_zn.bodies[ee++].body==ea.body){ef=true;break}}if(!ef){eb(ea.body.outer)}}++ed}};aU.prototype.__invalidate=function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()");if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake()}};aU.prototype.__registerBody=function(ea,eb){this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)");if(ea!=eb){if(ea!=null){this.zpp_inner_zn.remBody(ea.zpp_inner);if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){ea.zpp_inner.wake()}}if(eb!=null){this.zpp_inner_zn.addBody(eb.zpp_inner)}this.zpp_inner.wake();if(eb!=null){eb.zpp_inner.wake()}}return eb};aU.prototype.__class__=aU;var cX=nape.constraint.WeldJoint=function(ef,ed,eA,ey,eb){if(eb==null){eb=0}this.zpp_inner_zn=null;this.zpp_inner_zn=new aC();this.zpp_inner=this.zpp_inner_zn;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cK.call(this);this.zpp_inner.immutable_midstep("Constraint::body1");var em=ef==null?null:ef.zpp_inner;if(em!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=em;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&em!=null&&this.zpp_inner_zn.b2!=em){if(em!=null){em.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(em!=null){em.wake()}}}this.zpp_inner.immutable_midstep("Constraint::body2");var ej=ed==null?null:ed.zpp_inner;if(ej!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=ej;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&ej!=null&&this.zpp_inner_zn.b1!=ej){if(ej!=null){ej.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(ej!=null){ej.wake()}}}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ep=this.zpp_inner_zn.wrap_a1;var ew=eA.zpp_inner;if(ew._validate!=null){ew._validate()}var ee=eA.zpp_inner.x;var ev=eA.zpp_inner;if(ev._validate!=null){ev._validate()}var ec=eA.zpp_inner.y;var ex;var et=ep.zpp_inner;if(et._validate!=null){et._validate()}if(ep.zpp_inner.x==ee){var es=ep.zpp_inner;if(es._validate!=null){es._validate()}ex=ep.zpp_inner.y==ec}else{ex=false}if(!ex){ep.zpp_inner.x=ee;ep.zpp_inner.y=ec;var er=ep.zpp_inner;if(er._invalidate!=null){er._invalidate(er)}}if(eA.zpp_inner.weak){var ez=eA.zpp_inner;eA.zpp_inner.outer=null;eA.zpp_inner=null;eA.zpp_pool=au.poolVec2;au.poolVec2=eA;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var eo=this.zpp_inner_zn.wrap_a2;var el=ey.zpp_inner;if(el._validate!=null){el._validate()}var eu=ey.zpp_inner.x;var ei=ey.zpp_inner;if(ei._validate!=null){ei._validate()}var ea=ey.zpp_inner.y;var eh;var eg=eo.zpp_inner;if(eg._validate!=null){eg._validate()}if(eo.zpp_inner.x==eu){var en=eo.zpp_inner;if(en._validate!=null){en._validate()}eh=eo.zpp_inner.y==ea}else{eh=false}if(!eh){eo.zpp_inner.x=eu;eo.zpp_inner.y=ea;var ek=eo.zpp_inner;if(ek._invalidate!=null){ek._invalidate(ek)}}if(ey.zpp_inner.weak){var eq=ey.zpp_inner;ey.zpp_inner.outer=null;ey.zpp_inner=null;ey.zpp_pool=au.poolVec2;au.poolVec2=ey;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}this.zpp_inner.immutable_midstep("WeldJoint::phase");if(this.zpp_inner_zn.phase!=eb){this.zpp_inner_zn.phase=eb;this.zpp_inner.wake()}};cX.__name__=["nape","constraint","WeldJoint"];cX.__super__=cK;cX.prototype=Object.create(cK.prototype);cX.prototype.zpp_inner_zn=null;cX.prototype.get_body1=function(){if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};cX.prototype.set_body1=function(ea){this.zpp_inner.immutable_midstep("Constraint::body1");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1){if(this.zpp_inner_zn.b1!=null){this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b1.wake()}}this.zpp_inner_zn.b1=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b2!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b1==null){return null}else{return this.zpp_inner_zn.b1.outer}};cX.prototype.get_body2=function(){if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};cX.prototype.set_body2=function(ea){this.zpp_inner.immutable_midstep("Constraint::body2");var eb=ea==null?null:ea.zpp_inner;if(eb!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2){if(this.zpp_inner_zn.b2!=null){this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner_zn.b2.wake()}}this.zpp_inner_zn.b2=eb;if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null&&eb!=null&&this.zpp_inner_zn.b1!=eb){if(eb!=null){eb.constraints.add(this.zpp_inner)}}if(this.zpp_inner.active&&(this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.wake();if(eb!=null){eb.wake()}}}if(this.zpp_inner_zn.b2==null){return null}else{return this.zpp_inner_zn.b2.outer}};cX.prototype.get_anchor1=function(){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};cX.prototype.set_anchor1=function(ej){if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}var ed=this.zpp_inner_zn.wrap_a1;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a1==null){this.zpp_inner_zn.setup_a1()}return this.zpp_inner_zn.wrap_a1};cX.prototype.get_anchor2=function(){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};cX.prototype.set_anchor2=function(ej){if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}var ed=this.zpp_inner_zn.wrap_a2;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner_zn.wrap_a2==null){this.zpp_inner_zn.setup_a2()}return this.zpp_inner_zn.wrap_a2};cX.prototype.get_phase=function(){return this.zpp_inner_zn.phase};cX.prototype.set_phase=function(ea){this.zpp_inner.immutable_midstep("WeldJoint::phase");if(this.zpp_inner_zn.phase!=ea){this.zpp_inner_zn.phase=ea;this.zpp_inner.wake()}return this.zpp_inner_zn.phase};cX.prototype.impulse=function(){var ea=new bY(3,1);ea.zpp_inner.x[0*ea.zpp_inner.n]=this.zpp_inner_zn.jAccx;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccy;ea.zpp_inner.x[ea.zpp_inner.n]=this.zpp_inner_zn.jAccz;return ea};cX.prototype.bodyImpulse=function(ea){if(!this.zpp_inner.active){return q.get()}else{return this.zpp_inner_zn.bodyImpulse(ea.zpp_inner)}};cX.prototype.visitBodies=function(ea){if((this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)!=null){ea(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)}if((this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=null&&(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)!=(this.zpp_inner_zn.b1==null?null:this.zpp_inner_zn.b1.outer)){ea(this.zpp_inner_zn.b2==null?null:this.zpp_inner_zn.b2.outer)}};Object.defineProperty(cX.prototype,"body1",{get:cX.prototype.get_body1,set:cX.prototype.set_body1});Object.defineProperty(cX.prototype,"body2",{get:cX.prototype.get_body2,set:cX.prototype.set_body2});Object.defineProperty(cX.prototype,"anchor1",{get:cX.prototype.get_anchor1,set:cX.prototype.set_anchor1});Object.defineProperty(cX.prototype,"anchor2",{get:cX.prototype.get_anchor2,set:cX.prototype.set_anchor2});Object.defineProperty(cX.prototype,"phase",{get:cX.prototype.get_phase,set:cX.prototype.set_phase});cX.prototype.__class__=cX;var aD=nape.dynamics.Arbiter=function(){this.zpp_inner=null};aD.__name__=["nape","dynamics","Arbiter"];aD.prototype.zpp_inner=null;aD.prototype.get_isSleeping=function(){return this.zpp_inner.sleeping};aD.prototype.get_type=function(){return j.types[this.zpp_inner.type]};aD.prototype.isCollisionArbiter=function(){return this.zpp_inner.type==j.COL};aD.prototype.isFluidArbiter=function(){return this.zpp_inner.type==j.FLUID};aD.prototype.isSensorArbiter=function(){return this.zpp_inner.type==j.SENSOR};aD.prototype.get_collisionArbiter=function(){if(this.zpp_inner.type==j.COL){return this.zpp_inner.colarb.outer_zn}else{return null}};aD.prototype.get_fluidArbiter=function(){if(this.zpp_inner.type==j.FLUID){return this.zpp_inner.fluidarb.outer_zn}else{return null}};aD.prototype.get_shape1=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.ws2.outer}else{return this.zpp_inner.ws1.outer}};aD.prototype.get_shape2=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.ws1.outer}else{return this.zpp_inner.ws2.outer}};aD.prototype.get_body1=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.b2.outer}else{return this.zpp_inner.b1.outer}};aD.prototype.get_body2=function(){if(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id){return this.zpp_inner.b1.outer}else{return this.zpp_inner.b2.outer}};aD.prototype.get_state=function(){var ea=this.zpp_inner.immState;if(ea==5){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}return br.PreFlag_ACCEPT}else{if(ea==1){if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}return br.PreFlag_ACCEPT_ONCE}else{if(ea==6){if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}return br.PreFlag_IGNORE}else{if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}return br.PreFlag_IGNORE_ONCE}}}};aD.prototype.totalImpulse=function(ea,eb){if(eb==null){eb=false}return q.get(0,0,0)};aD.prototype.toString=function(){var ea=this.zpp_inner.type==j.COL?"CollisionArbiter":this.zpp_inner.type==j.FLUID?"FluidArbiter":"SensorArbiter";if(this.zpp_inner.cleared){return ea+"(object-pooled)"}else{var eb=ea+"("+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|"+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==j.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-";var ed=this.zpp_inner.immState;var ec;if(ed==5){if(br.PreFlag_ACCEPT==null){br.internal=true;br.PreFlag_ACCEPT=new bq();br.internal=false}ec=br.PreFlag_ACCEPT}else{if(ed==1){if(br.PreFlag_ACCEPT_ONCE==null){br.internal=true;br.PreFlag_ACCEPT_ONCE=new bq();br.internal=false}ec=br.PreFlag_ACCEPT_ONCE}else{if(ed==6){if(br.PreFlag_IGNORE==null){br.internal=true;br.PreFlag_IGNORE=new bq();br.internal=false}ec=br.PreFlag_IGNORE}else{if(br.PreFlag_IGNORE_ONCE==null){br.internal=true;br.PreFlag_IGNORE_ONCE=new bq();br.internal=false}ec=br.PreFlag_IGNORE_ONCE}}}return eb+ec.toString()}};Object.defineProperty(aD.prototype,"isSleeping",{get:aD.prototype.get_isSleeping});Object.defineProperty(aD.prototype,"type",{get:aD.prototype.get_type});Object.defineProperty(aD.prototype,"collisionArbiter",{get:aD.prototype.get_collisionArbiter});Object.defineProperty(aD.prototype,"fluidArbiter",{get:aD.prototype.get_fluidArbiter});Object.defineProperty(aD.prototype,"shape1",{get:aD.prototype.get_shape1});Object.defineProperty(aD.prototype,"shape2",{get:aD.prototype.get_shape2});Object.defineProperty(aD.prototype,"body1",{get:aD.prototype.get_body1});Object.defineProperty(aD.prototype,"body2",{get:aD.prototype.get_body2});Object.defineProperty(aD.prototype,"state",{get:aD.prototype.get_state});aD.prototype.__class__=aD;var d0=nape.dynamics.ArbiterIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};d0.__name__=["nape","dynamics","ArbiterIterator"];d0.get=function(ec){var ea;if(d0.zpp_pool==null){U.internal=true;var ed=new d0();U.internal=false;ea=ed}else{var eb=d0.zpp_pool;d0.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};d0.prototype.zpp_inner=null;d0.prototype.zpp_i=null;d0.prototype.zpp_critical=null;d0.prototype.zpp_next=null;d0.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var ea=this.zpp_inner.zpp_gl();this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=d0.zpp_pool;d0.zpp_pool=this;this.zpp_inner=null;return false}};d0.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};d0.prototype.__class__=d0;var dD=nape.dynamics.ArbiterList=function(){this.zpp_inner=null;this.zpp_inner=new U();this.zpp_inner.outer=this};dD.__name__=["nape","dynamics","ArbiterList"];dD.fromArray=function(ed){var ea=new dD();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};dD.prototype.zpp_inner=null;dD.prototype.get_length=function(){return this.zpp_gl()};dD.prototype.zpp_gl=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ea=this.zpp_inner.inner.head;while(ea!=null){if(ea.elt.active){this.zpp_inner.user_length++}ea=ea.next}}return this.zpp_inner.user_length};dD.prototype.zpp_vm=function(){this.zpp_inner.valmod()};dD.prototype.has=function(ea){this.zpp_vm();return this.zpp_inner.inner.has(ea.zpp_inner)};dD.prototype.at=function(ea){this.zpp_vm();if(this.zpp_inner.reverse_flag){ea=this.zpp_gl()-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=0;this.zpp_inner.at_ite=this.zpp_inner.inner.head;while(!this.zpp_inner.at_ite.elt.active){this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;while(!this.zpp_inner.at_ite.elt.active){this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.wrapper()};dD.prototype.push=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(eb.zpp_inner)}else{if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};dD.prototype.unshift=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}else{this.zpp_inner.inner.add(eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};dD.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.wrapper()};dD.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.wrapper()};dD.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};dD.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_vm();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};dD.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(!this.empty()){this.pop()}}else{while(!this.empty()){this.shift()}}};dD.prototype.empty=function(){return this.zpp_gl()==0};dD.prototype.iterator=function(){this.zpp_vm();return d0.get(this)};dD.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new dD();var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ee=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};dD.prototype.merge=function(eb){var ee=eb.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){this.add(ea)}}};dD.prototype.toString=function(){var eb="[";var ea=true;var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ee=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};dD.prototype.foreach=function(ea){var ec=this.iterator();while(true){ec.zpp_inner.zpp_inner.valmod();var ed=ec.zpp_inner.zpp_gl();ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=d0.zpp_pool;d0.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=d0.zpp_pool;d0.zpp_pool=ec;ec.zpp_inner=null;break}}return this};dD.prototype.filter=function(eb){var ec=0;while(ec<this.zpp_gl()){var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(dD.prototype,"length",{get:dD.prototype.get_length});dD.prototype.__class__=dD;var av=nape.dynamics.ArbiterType=function(){};av.__name__=["nape","dynamics","ArbiterType"];av.COLLISION=null;av.get_COLLISION=function(){if(br.ArbiterType_COLLISION==null){br.internal=true;br.ArbiterType_COLLISION=new av();br.internal=false}return br.ArbiterType_COLLISION};av.SENSOR=null;av.get_SENSOR=function(){if(br.ArbiterType_SENSOR==null){br.internal=true;br.ArbiterType_SENSOR=new av();br.internal=false}return br.ArbiterType_SENSOR};av.FLUID=null;av.get_FLUID=function(){if(br.ArbiterType_FLUID==null){br.internal=true;br.ArbiterType_FLUID=new av();br.internal=false}return br.ArbiterType_FLUID};av.prototype.toString=function(){if(br.ArbiterType_COLLISION==null){br.internal=true;br.ArbiterType_COLLISION=new av();br.internal=false}if(this==br.ArbiterType_COLLISION){return"COLLISION"}else{if(br.ArbiterType_SENSOR==null){br.internal=true;br.ArbiterType_SENSOR=new av();br.internal=false}if(this==br.ArbiterType_SENSOR){return"SENSOR"}else{if(br.ArbiterType_FLUID==null){br.internal=true;br.ArbiterType_FLUID=new av();br.internal=false}if(this==br.ArbiterType_FLUID){return"FLUID"}else{return""}}}};Object.defineProperty(av,"COLLISION",{get:av.get_COLLISION});Object.defineProperty(av,"SENSOR",{get:av.get_SENSOR});Object.defineProperty(av,"FLUID",{get:av.get_FLUID});av.prototype.__class__=av;var ak=nape.dynamics.CollisionArbiter=function(){aD.call(this)};ak.__name__=["nape","dynamics","CollisionArbiter"];ak.__super__=aD;ak.prototype=Object.create(aD.prototype);ak.prototype.get_contacts=function(){if(this.zpp_inner.colarb.wrap_contacts==null){this.zpp_inner.colarb.setupcontacts()}return this.zpp_inner.colarb.wrap_contacts};ak.prototype.get_normal=function(){if(this.zpp_inner.colarb.wrap_normal==null){this.zpp_inner.colarb.getnormal()}return this.zpp_inner.colarb.wrap_normal};ak.prototype.get_radius=function(){return this.zpp_inner.colarb.radius};ak.prototype.get_referenceEdge1=function(){var ea=this.zpp_inner.colarb.__ref_edge1;if(ea!=null&&((this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).zpp_inner.type!=1||(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).zpp_inner!=ea.polygon)){ea=this.zpp_inner.colarb.__ref_edge2}if(ea==null){return null}else{return ea.wrapper()}};ak.prototype.get_referenceEdge2=function(){var ea=this.zpp_inner.colarb.__ref_edge1;if(ea!=null&&((this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).zpp_inner.type!=1||(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).zpp_inner!=ea.polygon)){ea=this.zpp_inner.colarb.__ref_edge2}if(ea==null){return null}else{return ea.wrapper()}};ak.prototype.firstVertex=function(){if(this.zpp_inner.colarb.__ref_edge1!=null!=(this.zpp_inner.colarb.__ref_edge2!=null)){return this.zpp_inner.colarb.__ref_vertex==-1}else{return false}};ak.prototype.secondVertex=function(){if(this.zpp_inner.colarb.__ref_edge1!=null!=(this.zpp_inner.colarb.__ref_edge2!=null)){return this.zpp_inner.colarb.__ref_vertex==1}else{return false}};ak.prototype.normalImpulse=function(ef,eb){if(eb==null){eb=false}var em=0;var ek=0;var ei=0;var en=this.zpp_inner.colarb;if(!eb||en.oc1.fresh){var ea=en.oc1.wrapper().normalImpulse(ef);var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}em+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ek+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ei+=ea.zpp_inner.z;ea.dispose()}if(en.hc2){if(!eb||en.oc2.fresh){var ec=en.oc2.wrapper().normalImpulse(ef);var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}em+=ec.zpp_inner.x;var ee=ec.zpp_inner;if(ee._validate!=null){ee._validate()}ek+=ec.zpp_inner.y;var ed=ec.zpp_inner;if(ed._validate!=null){ed._validate()}ei+=ec.zpp_inner.z;ec.dispose()}}return q.get(em,ek,ei)};ak.prototype.tangentImpulse=function(ef,eb){if(eb==null){eb=false}var em=0;var ek=0;var ei=0;var en=this.zpp_inner.colarb;if(!eb||en.oc1.fresh){var ea=en.oc1.wrapper().tangentImpulse(ef);var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}em+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ek+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ei+=ea.zpp_inner.z;ea.dispose()}if(en.hc2){if(!eb||en.oc2.fresh){var ec=en.oc2.wrapper().tangentImpulse(ef);var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}em+=ec.zpp_inner.x;var ee=ec.zpp_inner;if(ee._validate!=null){ee._validate()}ek+=ec.zpp_inner.y;var ed=ec.zpp_inner;if(ed._validate!=null){ed._validate()}ei+=ec.zpp_inner.z;ec.dispose()}}return q.get(em,ek,ei)};ak.prototype.totalImpulse=function(ef,eb){if(eb==null){eb=false}var em=0;var ek=0;var ei=0;var en=this.zpp_inner.colarb;if(!eb||en.oc1.fresh){var ea=en.oc1.wrapper().totalImpulse(ef);var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}em+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ek+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ei+=ea.zpp_inner.z;ea.dispose()}if(en.hc2){if(!eb||en.oc2.fresh){var ec=en.oc2.wrapper().totalImpulse(ef);var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}em+=ec.zpp_inner.x;var ee=ec.zpp_inner;if(ee._validate!=null){ee._validate()}ek+=ec.zpp_inner.y;var ed=ec.zpp_inner;if(ed._validate!=null){ed._validate()}ei+=ec.zpp_inner.z;ec.dispose()}}return q.get(em,ek,ei)};ak.prototype.rollingImpulse=function(ea,eb){if(eb==null){eb=false}var ec=this.zpp_inner.colarb;if(!eb||ec.oc1.fresh){return ec.oc1.wrapper().rollingImpulse(ea)}else{return 0}};ak.prototype.get_elasticity=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.restitution};ak.prototype.set_elasticity=function(eb){var ea=this.zpp_inner.colarb;ea.restitution=eb;ea.userdef_restitution=true;var ec=this.zpp_inner.colarb;if(ec.invalidated){ec.invalidated=false;if(!ec.userdef_restitution){if(ec.s1.material.elasticity<=-Infinity||ec.s2.material.elasticity<=-Infinity){ec.restitution=0}else{if(ec.s1.material.elasticity>=Infinity||ec.s2.material.elasticity>=Infinity){ec.restitution=1}else{ec.restitution=(ec.s1.material.elasticity+ec.s2.material.elasticity)/2}}if(ec.restitution<0){ec.restitution=0}if(ec.restitution>1){ec.restitution=1}}if(!ec.userdef_dyn_fric){ec.dyn_fric=Math.sqrt(ec.s1.material.dynamicFriction*ec.s2.material.dynamicFriction)}if(!ec.userdef_stat_fric){ec.stat_fric=Math.sqrt(ec.s1.material.staticFriction*ec.s2.material.staticFriction)}if(!ec.userdef_rfric){ec.rfric=Math.sqrt(ec.s1.material.rollingFriction*ec.s2.material.rollingFriction)}}return ec.restitution};ak.prototype.get_dynamicFriction=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.dyn_fric};ak.prototype.set_dynamicFriction=function(ea){var eb=this.zpp_inner.colarb;eb.dyn_fric=ea;eb.userdef_dyn_fric=true;var ec=this.zpp_inner.colarb;if(ec.invalidated){ec.invalidated=false;if(!ec.userdef_restitution){if(ec.s1.material.elasticity<=-Infinity||ec.s2.material.elasticity<=-Infinity){ec.restitution=0}else{if(ec.s1.material.elasticity>=Infinity||ec.s2.material.elasticity>=Infinity){ec.restitution=1}else{ec.restitution=(ec.s1.material.elasticity+ec.s2.material.elasticity)/2}}if(ec.restitution<0){ec.restitution=0}if(ec.restitution>1){ec.restitution=1}}if(!ec.userdef_dyn_fric){ec.dyn_fric=Math.sqrt(ec.s1.material.dynamicFriction*ec.s2.material.dynamicFriction)}if(!ec.userdef_stat_fric){ec.stat_fric=Math.sqrt(ec.s1.material.staticFriction*ec.s2.material.staticFriction)}if(!ec.userdef_rfric){ec.rfric=Math.sqrt(ec.s1.material.rollingFriction*ec.s2.material.rollingFriction)}}return ec.dyn_fric};ak.prototype.get_staticFriction=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.stat_fric};ak.prototype.set_staticFriction=function(ec){var ea=this.zpp_inner.colarb;ea.stat_fric=ec;ea.userdef_stat_fric=true;var eb=this.zpp_inner.colarb;if(eb.invalidated){eb.invalidated=false;if(!eb.userdef_restitution){if(eb.s1.material.elasticity<=-Infinity||eb.s2.material.elasticity<=-Infinity){eb.restitution=0}else{if(eb.s1.material.elasticity>=Infinity||eb.s2.material.elasticity>=Infinity){eb.restitution=1}else{eb.restitution=(eb.s1.material.elasticity+eb.s2.material.elasticity)/2}}if(eb.restitution<0){eb.restitution=0}if(eb.restitution>1){eb.restitution=1}}if(!eb.userdef_dyn_fric){eb.dyn_fric=Math.sqrt(eb.s1.material.dynamicFriction*eb.s2.material.dynamicFriction)}if(!eb.userdef_stat_fric){eb.stat_fric=Math.sqrt(eb.s1.material.staticFriction*eb.s2.material.staticFriction)}if(!eb.userdef_rfric){eb.rfric=Math.sqrt(eb.s1.material.rollingFriction*eb.s2.material.rollingFriction)}}return eb.stat_fric};ak.prototype.get_rollingFriction=function(){var ea=this.zpp_inner.colarb;if(ea.invalidated){ea.invalidated=false;if(!ea.userdef_restitution){if(ea.s1.material.elasticity<=-Infinity||ea.s2.material.elasticity<=-Infinity){ea.restitution=0}else{if(ea.s1.material.elasticity>=Infinity||ea.s2.material.elasticity>=Infinity){ea.restitution=1}else{ea.restitution=(ea.s1.material.elasticity+ea.s2.material.elasticity)/2}}if(ea.restitution<0){ea.restitution=0}if(ea.restitution>1){ea.restitution=1}}if(!ea.userdef_dyn_fric){ea.dyn_fric=Math.sqrt(ea.s1.material.dynamicFriction*ea.s2.material.dynamicFriction)}if(!ea.userdef_stat_fric){ea.stat_fric=Math.sqrt(ea.s1.material.staticFriction*ea.s2.material.staticFriction)}if(!ea.userdef_rfric){ea.rfric=Math.sqrt(ea.s1.material.rollingFriction*ea.s2.material.rollingFriction)}}return ea.rfric};ak.prototype.set_rollingFriction=function(ec){var ea=this.zpp_inner.colarb;ea.rfric=ec;ea.userdef_rfric=true;var eb=this.zpp_inner.colarb;if(eb.invalidated){eb.invalidated=false;if(!eb.userdef_restitution){if(eb.s1.material.elasticity<=-Infinity||eb.s2.material.elasticity<=-Infinity){eb.restitution=0}else{if(eb.s1.material.elasticity>=Infinity||eb.s2.material.elasticity>=Infinity){eb.restitution=1}else{eb.restitution=(eb.s1.material.elasticity+eb.s2.material.elasticity)/2}}if(eb.restitution<0){eb.restitution=0}if(eb.restitution>1){eb.restitution=1}}if(!eb.userdef_dyn_fric){eb.dyn_fric=Math.sqrt(eb.s1.material.dynamicFriction*eb.s2.material.dynamicFriction)}if(!eb.userdef_stat_fric){eb.stat_fric=Math.sqrt(eb.s1.material.staticFriction*eb.s2.material.staticFriction)}if(!eb.userdef_rfric){eb.rfric=Math.sqrt(eb.s1.material.rollingFriction*eb.s2.material.rollingFriction)}}return eb.rfric};Object.defineProperty(ak.prototype,"contacts",{get:ak.prototype.get_contacts});Object.defineProperty(ak.prototype,"normal",{get:ak.prototype.get_normal});Object.defineProperty(ak.prototype,"radius",{get:ak.prototype.get_radius});Object.defineProperty(ak.prototype,"referenceEdge1",{get:ak.prototype.get_referenceEdge1});Object.defineProperty(ak.prototype,"referenceEdge2",{get:ak.prototype.get_referenceEdge2});Object.defineProperty(ak.prototype,"elasticity",{get:ak.prototype.get_elasticity,set:ak.prototype.set_elasticity});Object.defineProperty(ak.prototype,"dynamicFriction",{get:ak.prototype.get_dynamicFriction,set:ak.prototype.set_dynamicFriction});Object.defineProperty(ak.prototype,"staticFriction",{get:ak.prototype.get_staticFriction,set:ak.prototype.set_staticFriction});Object.defineProperty(ak.prototype,"rollingFriction",{get:ak.prototype.get_rollingFriction,set:ak.prototype.set_rollingFriction});ak.prototype.__class__=ak;var d8=nape.dynamics.Contact=function(){this.zpp_inner=null};d8.__name__=["nape","dynamics","Contact"];d8.prototype.zpp_inner=null;d8.prototype.get_arbiter=function(){if(this.zpp_inner.arbiter==null){return null}else{var ea=this.zpp_inner.arbiter.outer;if(ea.zpp_inner.type==j.COL){return ea.zpp_inner.colarb.outer_zn}else{return null}}};d8.prototype.get_penetration=function(){return -this.zpp_inner.dist};d8.prototype.get_position=function(){if(this.zpp_inner.wrap_position==null){this.zpp_inner.getposition()}return this.zpp_inner.wrap_position};d8.prototype.get_fresh=function(){return this.zpp_inner.fresh};d8.prototype.normalImpulse=function(eb){var ed=this.zpp_inner.arbiter.colarb;var ea=this.zpp_inner.inner;var ec=ea.jnAcc;if(eb==null){return q.get(ed.nx*ec,ed.ny*ec)}else{if(eb==ed.b1.outer){return q.get(ed.nx*-ec,ed.ny*-ec,-(ed.ny*ea.r1x-ed.nx*ea.r1y)*ec)}else{return q.get(ed.nx*ec,ed.ny*ec,(ed.ny*ea.r2x-ed.nx*ea.r2y)*ec)}}};d8.prototype.tangentImpulse=function(eb){var ed=this.zpp_inner.arbiter.colarb;var ea=this.zpp_inner.inner;var ec=ea.jtAcc;if(eb==null){return q.get(-ed.ny*ec,ed.nx*ec)}else{if(eb==ed.b1.outer){return q.get(ed.ny*ec,-ed.nx*ec,-(ea.r1x*ed.nx+ea.r1y*ed.ny)*ec)}else{return q.get(-ed.ny*ec,ed.nx*ec,(ea.r2x*ed.nx+ea.r2y*ed.ny)*ec)}}};d8.prototype.rollingImpulse=function(eb){var ec=this.zpp_inner.arbiter.colarb;var ea=this.zpp_inner.arbiter.colarb.jrAcc;if(eb==null){return ea}else{if(eb==ec.b1.outer){return -ea}else{return ea}}};d8.prototype.totalImpulse=function(ec){var eh=this.zpp_inner.arbiter.colarb;var eb=this.zpp_inner.inner;var ed=eb.jnAcc;var eg=eb.jtAcc;var ea=eh.jrAcc;if(ec==null){return q.get(eh.nx*ed-eh.ny*eg,eh.ny*ed+eh.nx*eg,ea)}else{var ef=eh.nx*ed-eh.ny*eg;var ee=eh.ny*ed+eh.nx*eg;if(ec==eh.b1.outer){return q.get(-ef,-ee,-(ee*eb.r1x-ef*eb.r1y)-ea)}else{return q.get(ef,ee,ee*eb.r2x-ef*eb.r2y+ea)}}};d8.prototype.get_friction=function(){return this.zpp_inner.inner.friction};d8.prototype.toString=function(){if(this.zpp_inner.arbiter==null||this.zpp_inner.arbiter.cleared){return"{object-pooled}"}else{return"{Contact}"}};Object.defineProperty(d8.prototype,"arbiter",{get:d8.prototype.get_arbiter});Object.defineProperty(d8.prototype,"penetration",{get:d8.prototype.get_penetration});Object.defineProperty(d8.prototype,"position",{get:d8.prototype.get_position});Object.defineProperty(d8.prototype,"fresh",{get:d8.prototype.get_fresh});Object.defineProperty(d8.prototype,"friction",{get:d8.prototype.get_friction});d8.prototype.__class__=d8;var d5=nape.dynamics.ContactIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};d5.__name__=["nape","dynamics","ContactIterator"];d5.get=function(ec){var ea;if(d5.zpp_pool==null){aB.internal=true;var ed=new d5();aB.internal=false;ea=ed}else{var eb=d5.zpp_pool;d5.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};d5.prototype.zpp_inner=null;d5.prototype.zpp_i=null;d5.prototype.zpp_critical=null;d5.prototype.zpp_next=null;d5.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var ed=this.zpp_inner;ed.zpp_inner.valmod();if(ed.zpp_inner.zip_length){ed.zpp_inner.zip_length=false;ed.zpp_inner.user_length=0;var eb=ed.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){ed.zpp_inner.user_length++}eb=eb.next}}var ec=ed.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ec){return true}else{this.zpp_next=d5.zpp_pool;d5.zpp_pool=this;this.zpp_inner=null;return false}};d5.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};d5.prototype.__class__=d5;var d7=nape.dynamics.ContactList=function(){this.zpp_inner=null;this.zpp_inner=new aB();this.zpp_inner.outer=this};d7.__name__=["nape","dynamics","ContactList"];d7.fromArray=function(ed){var ea=new d7();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};d7.prototype.zpp_inner=null;d7.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var eb=this.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){this.zpp_inner.user_length++}eb=eb.next}}return this.zpp_inner.user_length};d7.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};d7.prototype.at=function(ec){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ee=this.zpp_inner.inner.next;while(ee!=null){var ed=ee;if(ed.active&&ed.arbiter.active){this.zpp_inner.user_length++}ee=ee.next}}ec=this.zpp_inner.user_length-1-ec}if(ec<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=0;this.zpp_inner.at_ite=this.zpp_inner.inner.next;while(true){var ea=this.zpp_inner.at_ite;if(ea.active&&ea.arbiter.active){break}this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}while(this.zpp_inner.at_index!=ec){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;while(true){var eb=this.zpp_inner.at_ite;if(eb.active&&eb.arbiter.active){break}this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.wrapper()};d7.prototype.push=function(eg){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eg):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(eg.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var ed;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ec=this.zpp_inner.inner.next;while(ec!=null){var eb=ec;if(eb.active&&eb.arbiter.active){this.zpp_inner.user_length++}ec=ec.next}}if(this.zpp_inner.user_length==0){ed=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}ed=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=ed}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eg.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eg)}}return ea};d7.prototype.unshift=function(eg){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eg):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var ed;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ec=this.zpp_inner.inner.next;while(ec!=null){var eb=ec;if(eb.active&&eb.arbiter.active){this.zpp_inner.user_length++}ec=ec.next}}if(this.zpp_inner.user_length==0){ed=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}ed=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=ed}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eg.zpp_inner)}else{this.zpp_inner.inner.add(eg.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eg)}}return ea};d7.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.next;var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var eg;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ed=this.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){this.zpp_inner.user_length++}ed=ed.next}}if(this.zpp_inner.user_length==1){eg=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}eg=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(eg==null){eb=this.zpp_inner.inner.next}else{eb=eg.next}var eh=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(eh)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(eg)}}this.zpp_inner.invalidate();return eb.wrapper()};d7.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var eg;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ed=this.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){this.zpp_inner.user_length++}ed=ed.next}}if(this.zpp_inner.user_length==1){eg=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ef=this.zpp_inner.inner.next;while(ef!=null){var ee=ef;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ef=ef.next}}eg=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(eg==null){eb=this.zpp_inner.inner.next}else{eb=eg.next}var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(eg)}}else{eb=this.zpp_inner.inner.next;var eh=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(eh)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.wrapper()};d7.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};d7.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.next;while(eb!=null){if(eb==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};d7.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var eb=this.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){this.zpp_inner.user_length++}eb=eb.next}}if(!(this.zpp_inner.user_length!=0)){break}this.pop()}}else{while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ed=this.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){this.zpp_inner.user_length++}ed=ed.next}}if(!(this.zpp_inner.user_length!=0)){break}this.shift()}}};d7.prototype.empty=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var eb=this.zpp_inner.inner.next;while(eb!=null){var ea=eb;if(ea.active&&ea.arbiter.active){this.zpp_inner.user_length++}eb=eb.next}}return this.zpp_inner.user_length==0};d7.prototype.iterator=function(){this.zpp_inner.valmod();return d5.get(this)};d7.prototype.copy=function(ei){if(ei==null){ei=false}var eh=new d7();this.zpp_inner.valmod();var ef=d5.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=0;var eb=eg.zpp_inner.inner.next;while(eb!=null){var ed=eb;if(ed.active&&ed.arbiter.active){eg.zpp_inner.user_length++}eb=eb.next}}var ea=eg.zpp_inner.user_length;ef.zpp_critical=true;var ee;if(ef.zpp_i<ea){ee=true}else{ef.zpp_next=d5.zpp_pool;d5.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eh.push(ei?null:ec)}return eh};d7.prototype.merge=function(eb){eb.zpp_inner.valmod();var eg=d5.get(eb);while(true){eg.zpp_inner.zpp_inner.valmod();var eh=eg.zpp_inner;eh.zpp_inner.valmod();if(eh.zpp_inner.zip_length){eh.zpp_inner.zip_length=false;eh.zpp_inner.user_length=0;var ee=eh.zpp_inner.inner.next;while(ee!=null){var ed=ee;if(ed.active&&ed.arbiter.active){eh.zpp_inner.user_length++}ee=ee.next}}var ef=eh.zpp_inner.user_length;eg.zpp_critical=true;var ec;if(eg.zpp_i<ef){ec=true}else{eg.zpp_next=d5.zpp_pool;d5.zpp_pool=eg;eg.zpp_inner=null;ec=false}if(!ec){break}eg.zpp_critical=false;var ea=eg.zpp_inner.at(eg.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};d7.prototype.toString=function(){var ei="[";var ea=true;this.zpp_inner.valmod();var eg=d5.get(this);while(true){eg.zpp_inner.zpp_inner.valmod();var eh=eg.zpp_inner;eh.zpp_inner.valmod();if(eh.zpp_inner.zip_length){eh.zpp_inner.zip_length=false;eh.zpp_inner.user_length=0;var ec=eh.zpp_inner.inner.next;while(ec!=null){var ee=ec;if(ee.active&&ee.arbiter.active){eh.zpp_inner.user_length++}ec=ec.next}}var eb=eh.zpp_inner.user_length;eg.zpp_critical=true;var ef;if(eg.zpp_i<eb){ef=true}else{eg.zpp_next=d5.zpp_pool;d5.zpp_pool=eg;eg.zpp_inner=null;ef=false}if(!ef){break}eg.zpp_critical=false;var ed=eg.zpp_inner.at(eg.zpp_i++);if(!ea){ei+=","}ei+=ed==null?"NULL":ed.toString();ea=false}return ei+"]"};d7.prototype.foreach=function(ea){this.zpp_inner.valmod();var ee=d5.get(this);while(true){ee.zpp_inner.zpp_inner.valmod();var eh=ee.zpp_inner;eh.zpp_inner.valmod();if(eh.zpp_inner.zip_length){eh.zpp_inner.zip_length=false;eh.zpp_inner.user_length=0;var ed=eh.zpp_inner.inner.next;while(ed!=null){var ec=ed;if(ec.active&&ec.arbiter.active){eh.zpp_inner.user_length++}ed=ed.next}}var ef=eh.zpp_inner.user_length;ee.zpp_critical=true;var eb;if(ee.zpp_i<ef){eb=true}else{ee.zpp_next=d5.zpp_pool;d5.zpp_pool=ee;ee.zpp_inner=null;eb=false}if(!eb){break}try{ee.zpp_critical=false;ea(ee.zpp_inner.at(ee.zpp_i++))}catch(eg){ee.zpp_next=d5.zpp_pool;d5.zpp_pool=ee;ee.zpp_inner=null;break}}return this};d7.prototype.filter=function(eb){var ed=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=0;var ec=this.zpp_inner.inner.next;while(ec!=null){var ee=ec;if(ee.active&&ee.arbiter.active){this.zpp_inner.user_length++}ec=ec.next}}if(!(ed<this.zpp_inner.user_length)){break}var ea=this.at(ed);try{if(eb(ea)){++ed}else{this.remove(ea)}}catch(ef){break}}return this};Object.defineProperty(d7.prototype,"length",{get:d7.prototype.get_length});d7.prototype.__class__=d7;var ab=nape.dynamics.FluidArbiter=function(){aD.call(this)};ab.__name__=["nape","dynamics","FluidArbiter"];ab.__super__=aD;ab.prototype=Object.create(aD.prototype);ab.prototype.get_position=function(){if(this.zpp_inner.fluidarb.wrap_position==null){this.zpp_inner.fluidarb.getposition()}return this.zpp_inner.fluidarb.wrap_position};ab.prototype.set_position=function(ec){if(this.zpp_inner.fluidarb.wrap_position==null){this.zpp_inner.fluidarb.getposition()}var ee=this.zpp_inner.fluidarb.wrap_position;var eh=ec.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ec.zpp_inner.x;var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ec.zpp_inner.y;var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==ei}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ec.zpp_inner.weak){var ek=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.fluidarb.wrap_position==null){this.zpp_inner.fluidarb.getposition()}return this.zpp_inner.fluidarb.wrap_position};ab.prototype.get_overlap=function(){return this.zpp_inner.fluidarb.overlap};ab.prototype.set_overlap=function(ea){this.zpp_inner.fluidarb.overlap=ea;return this.zpp_inner.fluidarb.overlap};ab.prototype.buoyancyImpulse=function(ea){var eb=this.zpp_inner.fluidarb;if(ea==null){return q.get(eb.buoyx,eb.buoyy,0)}else{if(ea.zpp_inner==this.zpp_inner.b2){return q.get(eb.buoyx,eb.buoyy,eb.buoyy*eb.r2x-eb.buoyx*eb.r2y)}else{return q.get(-eb.buoyx,-eb.buoyy,-(eb.buoyy*eb.r1x-eb.buoyx*eb.r1y))}}};ab.prototype.dragImpulse=function(ea){var eb=this.zpp_inner.fluidarb;var ec=ea==null||ea.zpp_inner==this.zpp_inner.b2?1:-1;return q.get(eb.dampx*ec,eb.dampy*ec,eb.adamp*ec)};ab.prototype.totalImpulse=function(ek,ea){if(ea==null){ea=false}var eh=this.buoyancyImpulse(ek);var eo=this.dragImpulse(ek);var em=eo.zpp_inner;if(em._validate!=null){em._validate()}var ee=eo.zpp_inner.x;var ep=eh.zpp_inner;if(ep._validate!=null){ep._validate()}eo.zpp_inner.x=ee+eh.zpp_inner.x;var en=eo.zpp_inner;if(en._validate!=null){en._validate()}var el=eo.zpp_inner;if(el._validate!=null){el._validate()}var ec=eo.zpp_inner.y;var ej=eh.zpp_inner;if(ej._validate!=null){ej._validate()}eo.zpp_inner.y=ec+eh.zpp_inner.y;var ei=eo.zpp_inner;if(ei._validate!=null){ei._validate()}var eg=eo.zpp_inner;if(eg._validate!=null){eg._validate()}var eb=eo.zpp_inner.z;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}eo.zpp_inner.z=eb+eh.zpp_inner.z;var ed=eo.zpp_inner;if(ed._validate!=null){ed._validate()}eh.dispose();return eo};Object.defineProperty(ab.prototype,"position",{get:ab.prototype.get_position,set:ab.prototype.set_position});Object.defineProperty(ab.prototype,"overlap",{get:ab.prototype.get_overlap,set:ab.prototype.set_overlap});ab.prototype.__class__=ab;var G=nape.dynamics.InteractionFilter=function(ef,ee,ec,eb,ed,ea){if(ea==null){ea=-1}if(ed==null){ed=1}if(eb==null){eb=-1}if(ec==null){ec=1}if(ee==null){ee=-1}if(ef==null){ef=1}this.zpp_inner=null;if(cA.zpp_pool==null){this.zpp_inner=new cA()}else{this.zpp_inner=cA.zpp_pool;cA.zpp_pool=this.zpp_inner.next;this.zpp_inner.next=null}this.zpp_inner.outer=this;if(this.zpp_inner.collisionGroup!=ef){this.zpp_inner.collisionGroup=ef;this.zpp_inner.invalidate()}if(this.zpp_inner.collisionMask!=ee){this.zpp_inner.collisionMask=ee;this.zpp_inner.invalidate()}if(this.zpp_inner.sensorGroup!=ec){this.zpp_inner.sensorGroup=ec;this.zpp_inner.invalidate()}if(this.zpp_inner.sensorMask!=eb){this.zpp_inner.sensorMask=eb;this.zpp_inner.invalidate()}if(this.zpp_inner.fluidGroup!=ed){this.zpp_inner.fluidGroup=ed;this.zpp_inner.invalidate()}if(this.zpp_inner.fluidMask!=ea){this.zpp_inner.fluidMask=ea;this.zpp_inner.invalidate()}};G.__name__=["nape","dynamics","InteractionFilter"];G.prototype.zpp_inner=null;G.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};G.prototype.get_shapes=function(){if(this.zpp_inner.wrap_shapes==null){this.zpp_inner.wrap_shapes=aI.get(this.zpp_inner.shapes,true)}return this.zpp_inner.wrap_shapes};G.prototype.get_collisionGroup=function(){return this.zpp_inner.collisionGroup};G.prototype.set_collisionGroup=function(ea){if(this.zpp_inner.collisionGroup!=ea){this.zpp_inner.collisionGroup=ea;this.zpp_inner.invalidate()}return this.zpp_inner.collisionGroup};G.prototype.get_collisionMask=function(){return this.zpp_inner.collisionMask};G.prototype.set_collisionMask=function(ea){if(this.zpp_inner.collisionMask!=ea){this.zpp_inner.collisionMask=ea;this.zpp_inner.invalidate()}return this.zpp_inner.collisionMask};G.prototype.get_sensorGroup=function(){return this.zpp_inner.sensorGroup};G.prototype.set_sensorGroup=function(ea){if(this.zpp_inner.sensorGroup!=ea){this.zpp_inner.sensorGroup=ea;this.zpp_inner.invalidate()}return this.zpp_inner.sensorGroup};G.prototype.get_sensorMask=function(){return this.zpp_inner.sensorMask};G.prototype.set_sensorMask=function(ea){if(this.zpp_inner.sensorMask!=ea){this.zpp_inner.sensorMask=ea;this.zpp_inner.invalidate()}return this.zpp_inner.sensorMask};G.prototype.get_fluidGroup=function(){return this.zpp_inner.fluidGroup};G.prototype.set_fluidGroup=function(ea){if(this.zpp_inner.fluidGroup!=ea){this.zpp_inner.fluidGroup=ea;this.zpp_inner.invalidate()}return this.zpp_inner.fluidGroup};G.prototype.get_fluidMask=function(){return this.zpp_inner.fluidMask};G.prototype.set_fluidMask=function(ea){if(this.zpp_inner.fluidMask!=ea){this.zpp_inner.fluidMask=ea;this.zpp_inner.invalidate()}return this.zpp_inner.fluidMask};G.prototype.shouldCollide=function(eb){var ec=this.zpp_inner;var ea=eb.zpp_inner;if((ec.collisionMask&ea.collisionGroup)!=0){return(ea.collisionMask&ec.collisionGroup)!=0}else{return false}};G.prototype.shouldSense=function(eb){var ec=this.zpp_inner;var ea=eb.zpp_inner;if((ec.sensorMask&ea.sensorGroup)!=0){return(ea.sensorMask&ec.sensorGroup)!=0}else{return false}};G.prototype.shouldFlow=function(eb){var ec=this.zpp_inner;var ea=eb.zpp_inner;if((ec.fluidMask&ea.fluidGroup)!=0){return(ea.fluidMask&ec.fluidGroup)!=0}else{return false}};G.prototype.copy=function(){return new G(this.zpp_inner.collisionGroup,this.zpp_inner.collisionMask,this.zpp_inner.sensorGroup,this.zpp_inner.sensorMask,this.zpp_inner.fluidGroup,this.zpp_inner.fluidMask)};G.prototype.toString=function(){return"{ collision: "+aY.hex(this.zpp_inner.collisionGroup,8)+"~"+aY.hex(this.zpp_inner.collisionMask,8)+" sensor: "+aY.hex(this.zpp_inner.sensorGroup,8)+"~"+aY.hex(this.zpp_inner.sensorMask,8)+" fluid: "+aY.hex(this.zpp_inner.fluidGroup,8)+"~"+aY.hex(this.zpp_inner.fluidMask,8)+" }"};Object.defineProperty(G.prototype,"userData",{get:G.prototype.get_userData});Object.defineProperty(G.prototype,"shapes",{get:G.prototype.get_shapes});Object.defineProperty(G.prototype,"collisionGroup",{get:G.prototype.get_collisionGroup,set:G.prototype.set_collisionGroup});Object.defineProperty(G.prototype,"collisionMask",{get:G.prototype.get_collisionMask,set:G.prototype.set_collisionMask});Object.defineProperty(G.prototype,"sensorGroup",{get:G.prototype.get_sensorGroup,set:G.prototype.set_sensorGroup});Object.defineProperty(G.prototype,"sensorMask",{get:G.prototype.get_sensorMask,set:G.prototype.set_sensorMask});Object.defineProperty(G.prototype,"fluidGroup",{get:G.prototype.get_fluidGroup,set:G.prototype.set_fluidGroup});Object.defineProperty(G.prototype,"fluidMask",{get:G.prototype.get_fluidMask,set:G.prototype.set_fluidMask});G.prototype.__class__=G;var c=nape.dynamics.InteractionGroup=function(ea){if(ea==null){ea=false}this.zpp_inner=null;this.zpp_inner=new ax();this.zpp_inner.outer=this;if(this.zpp_inner.ignore!=ea){this.zpp_inner.invalidate(true);this.zpp_inner.ignore=ea}};c.__name__=["nape","dynamics","InteractionGroup"];c.prototype.zpp_inner=null;c.prototype.get_group=function(){if(this.zpp_inner.group==null){return null}else{return this.zpp_inner.group.outer}};c.prototype.set_group=function(ea){this.zpp_inner.setGroup(ea==null?null:ea.zpp_inner);if(this.zpp_inner.group==null){return null}else{return this.zpp_inner.group.outer}};c.prototype.get_ignore=function(){return this.zpp_inner.ignore};c.prototype.set_ignore=function(ea){if(this.zpp_inner.ignore!=ea){this.zpp_inner.invalidate(true);this.zpp_inner.ignore=ea}return this.zpp_inner.ignore};c.prototype.get_interactors=function(){if(this.zpp_inner.wrap_interactors==null){this.zpp_inner.wrap_interactors=i.get(this.zpp_inner.interactors,true)}return this.zpp_inner.wrap_interactors};c.prototype.get_groups=function(){if(this.zpp_inner.wrap_groups==null){this.zpp_inner.wrap_groups=bt.get(this.zpp_inner.groups,true)}return this.zpp_inner.wrap_groups};c.prototype.toString=function(){var ea="InteractionGroup";if(this.zpp_inner.ignore){ea="InteractionGroup:ignore"}return ea};Object.defineProperty(c.prototype,"group",{get:c.prototype.get_group,set:c.prototype.set_group});Object.defineProperty(c.prototype,"ignore",{get:c.prototype.get_ignore,set:c.prototype.set_ignore});Object.defineProperty(c.prototype,"interactors",{get:c.prototype.get_interactors});Object.defineProperty(c.prototype,"groups",{get:c.prototype.get_groups});c.prototype.__class__=c;var cL=nape.dynamics.InteractionGroupIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};cL.__name__=["nape","dynamics","InteractionGroupIterator"];cL.get=function(ec){var ea;if(cL.zpp_pool==null){bt.internal=true;var ed=new cL();bt.internal=false;ea=ed}else{var eb=cL.zpp_pool;cL.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};cL.prototype.zpp_inner=null;cL.prototype.zpp_i=null;cL.prototype.zpp_critical=null;cL.prototype.zpp_next=null;cL.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=cL.zpp_pool;cL.zpp_pool=this;this.zpp_inner=null;return false}};cL.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};cL.prototype.__class__=cL;var aS=nape.dynamics.InteractionGroupList=function(){this.zpp_inner=null;this.zpp_inner=new bt();this.zpp_inner.outer=this};aS.__name__=["nape","dynamics","InteractionGroupList"];aS.fromArray=function(ed){var ea=new aS();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};aS.prototype.zpp_inner=null;aS.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};aS.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};aS.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};aS.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aS.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aS.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};aS.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};aS.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};aS.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};aS.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};aS.prototype.empty=function(){return this.zpp_inner.inner.head==null};aS.prototype.iterator=function(){this.zpp_inner.valmod();return cL.get(this)};aS.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new aS();this.zpp_inner.valmod();var ef=cL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cL.zpp_pool;cL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};aS.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=cL.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=cL.zpp_pool;cL.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};aS.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=cL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=cL.zpp_pool;cL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};aS.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=cL.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=cL.zpp_pool;cL.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=cL.zpp_pool;cL.zpp_pool=ec;ec.zpp_inner=null;break}}return this};aS.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(aS.prototype,"length",{get:aS.prototype.get_length});aS.prototype.__class__=aS;var S=nape.geom.AABB=function(eb,ee,ed,ea){if(ea==null){ea=0}if(ed==null){ed=0}if(ee==null){ee=0}if(eb==null){eb=0}this.zpp_inner=null;var ec;if(bT.zpp_pool==null){ec=new bT()}else{ec=bT.zpp_pool;bT.zpp_pool=ec.next;ec.next=null}ec.minx=eb;ec.miny=ee;ec.maxx=eb+ed;ec.maxy=ee+ea;this.zpp_inner=ec;this.zpp_inner.outer=this};S.__name__=["nape","geom","AABB"];S.prototype.zpp_inner=null;S.prototype.copy=function(){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ed=this.zpp_inner;var eb=ed.minx;var ea=ed.miny;var ef=ed.maxx;var ee=ed.maxy;var ec;if(bT.zpp_pool==null){ec=new bT()}else{ec=bT.zpp_pool;bT.zpp_pool=ec.next;ec.next=null}ec.minx=eb;ec.miny=ea;ec.maxx=ef;ec.maxy=ee;return ec.wrapper()};S.prototype.get_min=function(){return this.zpp_inner.getmin()};S.prototype.set_min=function(ea){var ee=this.zpp_inner.getmin();var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return this.zpp_inner.getmin()};S.prototype.get_max=function(){return this.zpp_inner.getmax()};S.prototype.set_max=function(ei){var ed=this.zpp_inner.getmax();var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=ei.zpp_inner.x;var ef=ei.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ei.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ei.zpp_inner.weak){var ek=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return this.zpp_inner.getmax()};S.prototype.get_x=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.minx};S.prototype.set_x=function(ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}if(this.zpp_inner.minx!=ea){this.zpp_inner.maxx+=ea-this.zpp_inner.minx;this.zpp_inner.minx=ea;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.minx};S.prototype.get_y=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.miny};S.prototype.set_y=function(ed){var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}if(this.zpp_inner.miny!=ed){this.zpp_inner.maxy+=ed-this.zpp_inner.miny;this.zpp_inner.miny=ed;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.miny};S.prototype.get_width=function(){var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=this.zpp_inner;return ea.maxx-ea.minx};S.prototype.set_width=function(ed){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ef=this.zpp_inner;if(ef.maxx-ef.minx!=ed){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.maxx=this.zpp_inner.minx+ed;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=this.zpp_inner;return ea.maxx-ea.minx};S.prototype.get_height=function(){var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}var ea=this.zpp_inner;return ea.maxy-ea.miny};S.prototype.set_height=function(ea){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ef=this.zpp_inner;if(ef.maxy-ef.miny!=ea){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.maxy=this.zpp_inner.miny+ea;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}var eb=this.zpp_inner;return eb.maxy-eb.miny};S.prototype.toString=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.toString()};Object.defineProperty(S.prototype,"min",{get:S.prototype.get_min,set:S.prototype.set_min});Object.defineProperty(S.prototype,"max",{get:S.prototype.get_max,set:S.prototype.set_max});Object.defineProperty(S.prototype,"x",{get:S.prototype.get_x,set:S.prototype.set_x});Object.defineProperty(S.prototype,"y",{get:S.prototype.get_y,set:S.prototype.set_y});Object.defineProperty(S.prototype,"width",{get:S.prototype.get_width,set:S.prototype.set_width});Object.defineProperty(S.prototype,"height",{get:S.prototype.get_height,set:S.prototype.set_height});S.prototype.__class__=S;var bJ=nape.geom.ConvexResult=function(){this.zpp_inner=null};bJ.__name__=["nape","geom","ConvexResult"];bJ.prototype.zpp_inner=null;bJ.prototype.get_normal=function(){return this.zpp_inner.normal};bJ.prototype.get_position=function(){return this.zpp_inner.position};bJ.prototype.get_toi=function(){return this.zpp_inner.toiDistance};bJ.prototype.get_shape=function(){return this.zpp_inner.shape};bJ.prototype.dispose=function(){this.zpp_inner.free()};bJ.prototype.toString=function(){return"{ shape: "+ag.string(this.zpp_inner.shape)+" toi: "+this.zpp_inner.toiDistance+" }"};Object.defineProperty(bJ.prototype,"normal",{get:bJ.prototype.get_normal});Object.defineProperty(bJ.prototype,"position",{get:bJ.prototype.get_position});Object.defineProperty(bJ.prototype,"toi",{get:bJ.prototype.get_toi});Object.defineProperty(bJ.prototype,"shape",{get:bJ.prototype.get_shape});bJ.prototype.__class__=bJ;var v=nape.geom.ConvexResultIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};v.__name__=["nape","geom","ConvexResultIterator"];v.get=function(ec){var ea;if(v.zpp_pool==null){dE.internal=true;var ed=new v();dE.internal=false;ea=ed}else{var eb=v.zpp_pool;v.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};v.prototype.zpp_inner=null;v.prototype.zpp_i=null;v.prototype.zpp_critical=null;v.prototype.zpp_next=null;v.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=v.zpp_pool;v.zpp_pool=this;this.zpp_inner=null;return false}};v.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};v.prototype.__class__=v;var cs=nape.geom.ConvexResultList=function(){this.zpp_inner=null;this.zpp_inner=new dE();this.zpp_inner.outer=this};cs.__name__=["nape","geom","ConvexResultList"];cs.fromArray=function(ed){var ea=new cs();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};cs.prototype.zpp_inner=null;cs.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};cs.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea)};cs.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt};cs.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cs.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}else{this.zpp_inner.inner.add(ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cs.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb};cs.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb};cs.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};cs.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec)}this.zpp_inner.invalidate()}return ea};cs.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};cs.prototype.empty=function(){return this.zpp_inner.inner.head==null};cs.prototype.iterator=function(){this.zpp_inner.valmod();return v.get(this)};cs.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new cs();this.zpp_inner.valmod();var ef=v.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=v.zpp_pool;v.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};cs.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=v.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=v.zpp_pool;v.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};cs.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=v.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=v.zpp_pool;v.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};cs.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=v.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=v.zpp_pool;v.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=v.zpp_pool;v.zpp_pool=ec;ec.zpp_inner=null;break}}return this};cs.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(cs.prototype,"length",{get:cs.prototype.get_length});cs.prototype.__class__=cs;var K=nape.geom.Geom=function(){};K.__name__=["nape","geom","Geom"];K.distanceBody=function(eb,ea,ef,ee){var ec=eb.zpp_inner.shapes.head;while(ec!=null){bM.validateShape(ec.elt);ec=ec.next}var ed=ea.zpp_inner.shapes.head;while(ed!=null){bM.validateShape(ed.elt);ed=ed.next}return de.distanceBody(eb.zpp_inner,ea.zpp_inner,ef.zpp_inner,ee.zpp_inner)};K.distance=function(f4,f3,eJ,eH){bM.validateShape(f4.zpp_inner);bM.validateShape(f3.zpp_inner);var eq;if(bB.zpp_pool==null){eq=new bB()}else{eq=bB.zpp_pool;bB.zpp_pool=eq.next;eq.next=null}eq.weak=false;var ep=f4.zpp_inner;var en=f3.zpp_inner;var fp=eJ.zpp_inner;var fo=eH.zpp_inner;var fn;if(ep.type==0&&en.type==0){var f2=ep.circle;var f1=en.circle;var ek;var fE=0;var fC=0;fE=f1.worldCOMx-f2.worldCOMx;fC=f1.worldCOMy-f2.worldCOMy;var fW=Math.sqrt(fE*fE+fC*fC);ek=fW-(f2.radius+f1.radius);if(ek<1e+100){if(fW==0){fE=1;fC=0}else{var ff=1/fW;fE*=ff;fC*=ff}var gg=f2.radius;fp.x=f2.worldCOMx+fE*gg;fp.y=f2.worldCOMy+fC*gg;var gf=-f1.radius;fo.x=f1.worldCOMx+fE*gf;fo.y=f1.worldCOMy+fC*gf;eq.x=fE;eq.y=fC}fn=ek}else{var eZ=false;if(ep.type==0&&en.type==1){var eR=ep;ep=en;en=eR;var eN=fp;fp=fo;fo=eN;eZ=true}if(ep.type==1&&en.type==0){var e6=ep.polygon;var fu=en.circle;var ez=-1e+100;var ea=null;var f0=e6.edges.head;while(f0!=null){var fz=f0.elt;var eX=fz.gnormx*fu.worldCOMx+fz.gnormy*fu.worldCOMy-fz.gprojection-fu.radius;if(eX>1e+100){ez=eX;break}if(eX>0){if(eX>ez){ez=eX;ea=fz}}else{if(ez<0&&eX>ez){ez=eX;ea=fz}}f0=f0.next}if(ez<1e+100){var fR=ea.gp0;var fP=ea.gp1;var eL=fu.worldCOMy*ea.gnormx-fu.worldCOMx*ea.gnormy;if(eL<=fR.y*ea.gnormx-fR.x*ea.gnormy){var f6=0;var fZ=0;f6=fu.worldCOMx-fR.x;fZ=fu.worldCOMy-fR.y;var fG=Math.sqrt(f6*f6+fZ*fZ);ez=fG-fu.radius;if(ez<1e+100){if(fG==0){f6=1;fZ=0}else{var ge=1/fG;f6*=ge;fZ*=ge}fp.x=fR.x+f6*0;fp.y=fR.y+fZ*0;var gd=-fu.radius;fo.x=fu.worldCOMx+f6*gd;fo.y=fu.worldCOMy+fZ*gd;eq.x=f6;eq.y=fZ}}else{if(eL>=fP.y*ea.gnormx-fP.x*ea.gnormy){var f5=0;var fX=0;f5=fu.worldCOMx-fP.x;fX=fu.worldCOMy-fP.y;var fF=Math.sqrt(f5*f5+fX*fX);ez=fF-fu.radius;if(ez<1e+100){if(fF==0){f5=1;fX=0}else{var gc=1/fF;f5*=gc;fX*=gc}fp.x=fP.x+f5*0;fp.y=fP.y+fX*0;var gb=-fu.radius;fo.x=fu.worldCOMx+f5*gb;fo.y=fu.worldCOMy+fX*gb;eq.x=f5;eq.y=fX}}else{var f9=-fu.radius;fo.x=fu.worldCOMx+ea.gnormx*f9;fo.y=fu.worldCOMy+ea.gnormy*f9;var f8=-ez;fp.x=fo.x+ea.gnormx*f8;fp.y=fo.y+ea.gnormy*f8;eq.x=ea.gnormx;eq.y=ea.gnormy}}}if(eZ){eq.x=-eq.x;eq.y=-eq.y}fn=ez}else{var fK=ep.polygon;var fI=en.polygon;var fy=-1e+100;var gq=null;var gp=null;var eU=0;var fT=fK.edges.head;while(fT!=null){var go=fT.elt;var gj=1e+100;var fS=fI.gverts.next;while(fS!=null){var fe=fS;var fq=go.gnormx*fe.x+go.gnormy*fe.y;if(fq<gj){gj=fq}fS=fS.next}gj-=go.gprojection;if(gj>1e+100){fy=gj;break}if(gj>0){if(gj>fy){fy=gj;gq=go;eU=1}}else{if(fy<0&&gj>fy){fy=gj;gq=go;eU=1}}fT=fT.next}if(fy<1e+100){var fQ=fI.edges.head;while(fQ!=null){var gn=fQ.elt;var fs=1e+100;var fO=fK.gverts.next;while(fO!=null){var fN=fO;var fd=gn.gnormx*fN.x+gn.gnormy*fN.y;if(fd<fs){fs=fd}fO=fO.next}fs-=gn.gprojection;if(fs>1e+100){fy=fs;break}if(fs>0){if(fs>fy){fy=fs;gp=gn;eU=2}}else{if(fy<0&&fs>fy){fy=fs;gp=gn;eU=2}}fQ=fQ.next}if(fy<1e+100){var fh;var fV;if(eU==1){fh=fI;fV=gq}else{fh=fK;fV=gp;var eM=fp;fp=fo;fo=eM;eZ=!eZ}var fU=null;var fr=1e+100;var fM=fh.edges.head;while(fM!=null){var gl=fM.elt;var fc=fV.gnormx*gl.gnormx+fV.gnormy*gl.gnormy;if(fc<fr){fr=fc;fU=gl}fM=fM.next}if(eZ){eq.x=-fV.gnormx;eq.y=-fV.gnormy}else{eq.x=fV.gnormx;eq.y=fV.gnormy}if(fy>=0){var e5=fV.gp0;var es=fV.gp1;var fk=fU.gp0;var fj=fU.gp1;var e4=0;var e3=0;var ei=0;var eh=0;e4=es.x-e5.x;e3=es.y-e5.y;ei=fj.x-fk.x;eh=fj.y-fk.y;var e9=1/(e4*e4+e3*e3);var eW=1/(ei*ei+eh*eh);var eI=-(e4*(e5.x-fk.x)+e3*(e5.y-fk.y))*e9;var gm=-(e4*(e5.x-fj.x)+e3*(e5.y-fj.y))*e9;var eQ=-(ei*(fk.x-e5.x)+eh*(fk.y-e5.y))*eW;var ed=-(ei*(fk.x-es.x)+eh*(fk.y-es.y))*eW;if(eI<0){eI=0}else{if(eI>1){eI=1}}if(gm<0){gm=0}else{if(gm>1){gm=1}}if(eQ<0){eQ=0}else{if(eQ>1){eQ=1}}if(ed<0){ed=0}else{if(ed>1){ed=1}}var e0=0;var eY=0;var f7=eI;e0=e5.x+e4*f7;eY=e5.y+e3*f7;var el=0;var ej=0;var eK=gm;el=e5.x+e4*eK;ej=e5.y+e3*eK;var eT=0;var eP=0;var eG=eQ;eT=fk.x+ei*eG;eP=fk.y+eh*eG;var ef=0;var ec=0;var eE=ed;ef=fk.x+ei*eE;ec=fk.y+eh*eE;var fw=fk.x;var ft=fk.y;var eF=0;var eD=0;eF=e0-fw;eD=eY-ft;var fB=eF*eF+eD*eD;var eV=fj.x;var eg=fj.y;var eB=0;var gk=0;eB=el-eV;gk=ej-eg;var fA=eB*eB+gk*gk;var eS=e5.x;var ee=e5.y;var ey=0;var gi=0;ey=eT-eS;gi=eP-ee;var fb=ey*ey+gi*gi;var eO=es.x;var eb=es.y;var ew=0;var gh=0;ew=ef-eO;gh=ec-eb;var fa=ew*ew+gh*gh;var fJ=0;var fH=0;var eu=null;if(fB<fA){fJ=e0;fH=eY;eu=fk}else{fJ=el;fH=ej;eu=fj;fB=fA}var fi=0;var fg=0;var er=null;if(fb<fa){fi=eT;fg=eP;er=e5}else{fi=ef;fg=ec;er=es;fb=fa}if(fB<fb){fp.x=fJ;fp.y=fH;fo.x=eu.x;fo.y=eu.y;fy=Math.sqrt(fB)}else{fo.x=fi;fo.y=fg;fp.x=er.x;fp.y=er.y;fy=Math.sqrt(fb)}if(fy!=0){eq.x=fo.x-fp.x;eq.y=fo.y-fp.y;var eC=1/fy;eq.x*=eC;eq.y*=eC;if(eZ){eq.x=-eq.x;eq.y=-eq.y}}fn=fy}else{var fx=0;var fv=0;fx=fU.gp0.x;fv=fU.gp0.y;var e8=0;var e7=0;e8=fU.gp1.x;e7=fU.gp1.y;var eo=0;var em=0;eo=e8-fx;em=e7-fv;var fD=fV.gnormy*fx-fV.gnormx*fv;var fY=fV.gnormy*e8-fV.gnormx*e7;var ga=1/(fY-fD);var eA=(-fV.tp1-fD)*ga;if(eA>P.epsilon){fx+=eo*eA;fv+=em*eA}var ex=(-fV.tp0-fY)*ga;if(ex<-P.epsilon){e8+=eo*ex;e7+=em*ex}var fL=fx*fV.gnormx+fv*fV.gnormy-fV.gprojection;var fl=e8*fV.gnormx+e7*fV.gnormy-fV.gprojection;if(fL<fl){fo.x=fx;fo.y=fv;var ev=-fL;fp.x=fo.x+fV.gnormx*ev;fp.y=fo.y+fV.gnormy*ev;fn=fL}else{fo.x=e8;fo.y=e7;var et=-fl;fp.x=fo.x+fV.gnormx*et;fp.y=fo.y+fV.gnormy*et;fn=fl}}}else{fn=1e+100}}else{fn=1e+100}}}var fm=eq;if(fm.outer!=null){fm.outer.zpp_inner=null;fm.outer=null}fm._isimmutable=null;fm._validate=null;fm._invalidate=null;fm.next=bB.zpp_pool;bB.zpp_pool=fm;return fn};K.intersectsBody=function(ea,ei){var eb=ea.zpp_inner.shapes.head;while(eb!=null){bM.validateShape(eb.elt);eb=eb.next}var eg=ei.zpp_inner.shapes.head;while(eg!=null){bM.validateShape(eg.elt);eg=eg.next}var ec=ea.zpp_inner.aabb;var ef=ei.zpp_inner.aabb;if(!(ef.miny<=ec.maxy&&ec.miny<=ef.maxy&&ef.minx<=ec.maxx&&ec.minx<=ef.maxx)){return false}else{var ee=ea.zpp_inner.shapes.head;while(ee!=null){var eh=ee.elt;var ed=ei.zpp_inner.shapes.head;while(ed!=null){if(b7.testCollide_safe(eh,ed.elt)){return true}ed=ed.next}ee=ee.next}return false}};K.intersects=function(ec,eb){bM.validateShape(ec.zpp_inner);bM.validateShape(eb.zpp_inner);var ed=ec.zpp_inner.aabb;var ea=eb.zpp_inner.aabb;if(ea.miny<=ed.maxy&&ed.miny<=ea.maxy&&ea.minx<=ed.maxx&&ed.minx<=ea.maxx){return b7.testCollide_safe(ec.zpp_inner,eb.zpp_inner)}else{return false}};K.contains=function(eb,ea){bM.validateShape(eb.zpp_inner);bM.validateShape(ea.zpp_inner);return b7.containTest(eb.zpp_inner,ea.zpp_inner)};K.prototype.__class__=K;var a7=nape.geom.GeomPoly=function(eb){this.zpp_inner=null;this.zpp_pool=null;this.zpp_inner=new b5(this);if(eb!=null){if((eb instanceof Array)&&eb.__enum__==null){var ew=eb;var eZ=0;while(eZ<ew.length){var ep=ew[eZ];++eZ;var eN=ep;var ed=eN.zpp_inner;if(ed._validate!=null){ed._validate()}var eJ=eN.zpp_inner.x;var eQ=eN.zpp_inner;if(eQ._validate!=null){eQ._validate()}var eF=eN.zpp_inner.y;var ey;if(dr.zpp_pool==null){ey=new dr()}else{ey=dr.zpp_pool;dr.zpp_pool=ey.next;ey.next=null}ey.forced=false;ey.x=eJ;ey.y=eF;var ea=ey;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ea.prev=ea.next=ea}else{ea.prev=this.zpp_inner.vertices;ea.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ea;this.zpp_inner.vertices.next=ea}this.zpp_inner.vertices=ea}}else{if(dc.__instanceof(eb,aN)){var ev=eb;var eV=ev.iterator();while(true){eV.zpp_inner.zpp_inner.valmod();var er=eV.zpp_inner.zpp_gl();eV.zpp_critical=true;var eS;if(eV.zpp_i<er){eS=true}else{eV.zpp_next=dW.zpp_pool;dW.zpp_pool=eV;eV.zpp_inner=null;eS=false}if(!eS){break}eV.zpp_critical=false;var e4=eV.zpp_inner.at(eV.zpp_i++);var eP=e4.zpp_inner;if(eP._validate!=null){eP._validate()}var eo=e4.zpp_inner.x;var eM=e4.zpp_inner;if(eM._validate!=null){eM._validate()}var e6=e4.zpp_inner.y;var eK;if(dr.zpp_pool==null){eK=new dr()}else{eK=dr.zpp_pool;dr.zpp_pool=eK.next;eK.next=null}eK.forced=false;eK.x=eo;eK.y=e6;var ee=eK;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ee.prev=ee.next=ee}else{ee.prev=this.zpp_inner.vertices;ee.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ee;this.zpp_inner.vertices.next=ee}this.zpp_inner.vertices=ee}}else{if(dc.__instanceof(eb,a7)){var eu=eb;var eX=eu.zpp_inner.vertices;if(eX!=null){var eY=eX;while(true){var en=eY.x;var e5=eY.y;var eG;if(au.poolVec2==null){eG=new r()}else{eG=au.poolVec2;au.poolVec2=eG.zpp_pool;eG.zpp_pool=null}if(eG.zpp_inner==null){var eD;if(bB.zpp_pool==null){eD=new bB()}else{eD=bB.zpp_pool;bB.zpp_pool=eD.next;eD.next=null}eD.weak=false;eD._immutable=false;eD.x=en;eD.y=e5;eG.zpp_inner=eD;eG.zpp_inner.outer=eG}else{var e1;var eL=eG.zpp_inner;if(eL._validate!=null){eL._validate()}if(eG.zpp_inner.x==en){var eI=eG.zpp_inner;if(eI._validate!=null){eI._validate()}e1=eG.zpp_inner.y==e5}else{e1=false}if(!e1){eG.zpp_inner.x=en;eG.zpp_inner.y=e5;var eE=eG.zpp_inner;if(eE._invalidate!=null){eE._invalidate(eE)}}}eG.zpp_inner.weak=false;var e2=eG;eY=eY.next;var eC=e2.zpp_inner;if(eC._validate!=null){eC._validate()}var em=e2.zpp_inner.x;var eB=e2.zpp_inner;if(eB._validate!=null){eB._validate()}var e3=e2.zpp_inner.y;var eA;if(dr.zpp_pool==null){eA=new dr()}else{eA=dr.zpp_pool;dr.zpp_pool=eA.next;eA.next=null}eA.forced=false;eA.x=em;eA.y=e3;var ec=eA;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ec.prev=ec.next=ec}else{ec.prev=this.zpp_inner.vertices;ec.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ec;this.zpp_inner.vertices.next=ec}this.zpp_inner.vertices=ec;var ex=e2.zpp_inner;e2.zpp_inner.outer=null;e2.zpp_inner=null;var eU=e2;eU.zpp_pool=au.poolVec2;au.poolVec2=eU;var ek=ex;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek;if(eY==eX){break}}}}}}this.skipForward(1);if((eb instanceof Array)&&eb.__enum__==null){var et=eb;var eW=0;while(eW<et.length){var ef=et[eW];var e0;if(ef.zpp_inner.weak){var eT=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;var ej=ef;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;var ei=eT;if(ei.outer!=null){ei.outer.zpp_inner=null;ei.outer=null}ei._isimmutable=null;ei._validate=null;ei._invalidate=null;ei.next=bB.zpp_pool;bB.zpp_pool=ei;e0=true}else{e0=false}if(e0){et.splice(eW,1);continue}++eW}}else{if(dc.__instanceof(eb,aN)){var es=eb;if(es.zpp_inner._validate!=null){es.zpp_inner._validate()}var eH=es.zpp_inner.inner;var eO=null;var eq=eH.head;while(eq!=null){var el=eq.elt;if(el.outer.zpp_inner.weak){eq=eH.erase(eO);if(el.outer.zpp_inner.weak){var ez=el.outer;var eR=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;var eh=ez;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;var eg=eR;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg}}else{eO=eq;eq=eq.next}}}}}};a7.__name__=["nape","geom","GeomPoly"];a7.get=function(eb){var ey;if(au.poolGeomPoly==null){ey=new a7()}else{ey=au.poolGeomPoly;au.poolGeomPoly=ey.zpp_pool;ey.zpp_pool=null}if(eb!=null){if((eb instanceof Array)&&eb.__enum__==null){var ew=eb;var e0=0;while(e0<ew.length){var ep=ew[e0];++e0;var eO=ep;var ed=eO.zpp_inner;if(ed._validate!=null){ed._validate()}var eK=eO.zpp_inner.x;var eR=eO.zpp_inner;if(eR._validate!=null){eR._validate()}var eG=eO.zpp_inner.y;var eL;if(dr.zpp_pool==null){eL=new dr()}else{eL=dr.zpp_pool;dr.zpp_pool=eL.next;eL.next=null}eL.forced=false;eL.x=eK;eL.y=eG;var ea=eL;if(ey.zpp_inner.vertices==null){ey.zpp_inner.vertices=ea.prev=ea.next=ea}else{ea.prev=ey.zpp_inner.vertices;ea.next=ey.zpp_inner.vertices.next;ey.zpp_inner.vertices.next.prev=ea;ey.zpp_inner.vertices.next=ea}ey.zpp_inner.vertices=ea}}else{if(dc.__instanceof(eb,aN)){var ev=eb;var eW=ev.iterator();while(true){eW.zpp_inner.zpp_inner.valmod();var er=eW.zpp_inner.zpp_gl();eW.zpp_critical=true;var eT;if(eW.zpp_i<er){eT=true}else{eW.zpp_next=dW.zpp_pool;dW.zpp_pool=eW;eW.zpp_inner=null;eT=false}if(!eT){break}eW.zpp_critical=false;var e5=eW.zpp_inner.at(eW.zpp_i++);var eQ=e5.zpp_inner;if(eQ._validate!=null){eQ._validate()}var eo=e5.zpp_inner.x;var eN=e5.zpp_inner;if(eN._validate!=null){eN._validate()}var e7=e5.zpp_inner.y;var eH;if(dr.zpp_pool==null){eH=new dr()}else{eH=dr.zpp_pool;dr.zpp_pool=eH.next;eH.next=null}eH.forced=false;eH.x=eo;eH.y=e7;var ee=eH;if(ey.zpp_inner.vertices==null){ey.zpp_inner.vertices=ee.prev=ee.next=ee}else{ee.prev=ey.zpp_inner.vertices;ee.next=ey.zpp_inner.vertices.next;ey.zpp_inner.vertices.next.prev=ee;ey.zpp_inner.vertices.next=ee}ey.zpp_inner.vertices=ee}}else{if(dc.__instanceof(eb,a7)){var eu=eb;var eY=eu.zpp_inner.vertices;if(eY!=null){var eZ=eY;while(true){var en=eZ.x;var e6=eZ.y;var eE;if(au.poolVec2==null){eE=new r()}else{eE=au.poolVec2;au.poolVec2=eE.zpp_pool;eE.zpp_pool=null}if(eE.zpp_inner==null){var eC;if(bB.zpp_pool==null){eC=new bB()}else{eC=bB.zpp_pool;bB.zpp_pool=eC.next;eC.next=null}eC.weak=false;eC._immutable=false;eC.x=en;eC.y=e6;eE.zpp_inner=eC;eE.zpp_inner.outer=eE}else{var e2;var eM=eE.zpp_inner;if(eM._validate!=null){eM._validate()}if(eE.zpp_inner.x==en){var eJ=eE.zpp_inner;if(eJ._validate!=null){eJ._validate()}e2=eE.zpp_inner.y==e6}else{e2=false}if(!e2){eE.zpp_inner.x=en;eE.zpp_inner.y=e6;var eF=eE.zpp_inner;if(eF._invalidate!=null){eF._invalidate(eF)}}}eE.zpp_inner.weak=false;var e3=eE;eZ=eZ.next;var eD=e3.zpp_inner;if(eD._validate!=null){eD._validate()}var em=e3.zpp_inner.x;var eB=e3.zpp_inner;if(eB._validate!=null){eB._validate()}var e4=e3.zpp_inner.y;var eA;if(dr.zpp_pool==null){eA=new dr()}else{eA=dr.zpp_pool;dr.zpp_pool=eA.next;eA.next=null}eA.forced=false;eA.x=em;eA.y=e4;var ec=eA;if(ey.zpp_inner.vertices==null){ey.zpp_inner.vertices=ec.prev=ec.next=ec}else{ec.prev=ey.zpp_inner.vertices;ec.next=ey.zpp_inner.vertices.next;ey.zpp_inner.vertices.next.prev=ec;ey.zpp_inner.vertices.next=ec}ey.zpp_inner.vertices=ec;var ex=e3.zpp_inner;e3.zpp_inner.outer=null;e3.zpp_inner=null;var eV=e3;eV.zpp_pool=au.poolVec2;au.poolVec2=eV;var ek=ex;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek;if(!(eZ!=eY)){break}}}}}}ey.skipForward(1);if((eb instanceof Array)&&eb.__enum__==null){var et=eb;var eX=0;while(eX<et.length){var ef=et[eX];var e1;if(ef.zpp_inner.weak){var eU=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;var ej=ef;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;var ei=eU;if(ei.outer!=null){ei.outer.zpp_inner=null;ei.outer=null}ei._isimmutable=null;ei._validate=null;ei._invalidate=null;ei.next=bB.zpp_pool;bB.zpp_pool=ei;e1=true}else{e1=false}if(e1){et.splice(eX,1);continue}++eX}}else{if(dc.__instanceof(eb,aN)){var es=eb;if(es.zpp_inner._validate!=null){es.zpp_inner._validate()}var eI=es.zpp_inner.inner;var eP=null;var eq=eI.head;while(eq!=null){var el=eq.elt;if(el.outer.zpp_inner.weak){eq=eI.erase(eP);if(el.outer.zpp_inner.weak){var ez=el.outer;var eS=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;var eh=ez;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;var eg=eS;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg}}else{eP=eq;eq=eq.next}}}}}return ey};a7.prototype.zpp_pool=null;a7.prototype.zpp_inner=null;a7.prototype.empty=function(){return this.zpp_inner.vertices==null};a7.prototype.size=function(){var eb=0;var ec=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ec!=null){var ed=ec;while(true){++eb;ed=ed.next;if(!(ed!=ea)){break}}}return eb};a7.prototype.iterator=function(){return dn.get(this.zpp_inner.vertices,true)};a7.prototype.forwardIterator=function(){return dn.get(this.zpp_inner.vertices,true)};a7.prototype.backwardsIterator=function(){return dn.get(this.zpp_inner.vertices,false)};a7.prototype.current=function(){var ec=this.zpp_inner.vertices;if(ec.wrap==null){var ei=ec.x;var eg=ec.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ei;eh.y=eg;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ei){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==eg}else{ea=false}if(!ea){ee.zpp_inner.x=ei;ee.zpp_inner.y=eg;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}ee.zpp_inner.weak=false;ec.wrap=ee;ec.wrap.zpp_inner._inuse=true;ec.wrap.zpp_inner._invalidate=dX(ec,ec.modwrap);ec.wrap.zpp_inner._validate=dX(ec,ec.getwrap)}return ec.wrap};a7.prototype.push=function(ee){var eh=ee.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ee.zpp_inner.x;var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}var eg=ee.zpp_inner.y;var ec;if(dr.zpp_pool==null){ec=new dr()}else{ec=dr.zpp_pool;dr.zpp_pool=ec.next;ec.next=null}ec.forced=false;ec.x=ea;ec.y=eg;var ef=ec;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ef.prev=ef.next=ef}else{ef.prev=this.zpp_inner.vertices;ef.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=ef;this.zpp_inner.vertices.next=ef}this.zpp_inner.vertices=ef;if(ee.zpp_inner.weak){var eb=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return this};a7.prototype.pop=function(){var ec=this.zpp_inner.vertices;var eb;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;eb=null}else{var ed=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;eb=ed}this.zpp_inner.vertices=eb;if(ec.wrap!=null){ec.wrap.zpp_inner._inuse=false;var ee=ec.wrap;var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;ec.wrap=null}ec.prev=ec.next=null;ec.next=dr.zpp_pool;dr.zpp_pool=ec;return this};a7.prototype.unshift=function(ee){var eh=ee.zpp_inner;if(eh._validate!=null){eh._validate()}var ea=ee.zpp_inner.x;var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}var eg=ee.zpp_inner.y;var ec;if(dr.zpp_pool==null){ec=new dr()}else{ec=dr.zpp_pool;dr.zpp_pool=ec.next;ec.next=null}ec.forced=false;ec.x=ea;ec.y=eg;var ef=ec;if(this.zpp_inner.vertices==null){this.zpp_inner.vertices=ef.prev=ef.next=ef}else{ef.next=this.zpp_inner.vertices;ef.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=ef;this.zpp_inner.vertices.prev=ef}this.zpp_inner.vertices=ef;if(ee.zpp_inner.weak){var eb=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return this};a7.prototype.shift=function(){var ec=this.zpp_inner.vertices;var eb;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;eb=this.zpp_inner.vertices=null}else{var ed=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;eb=ed}this.zpp_inner.vertices=eb;if(ec.wrap!=null){ec.wrap.zpp_inner._inuse=false;var ee=ec.wrap;var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;ec.wrap=null}ec.prev=ec.next=null;ec.next=dr.zpp_pool;dr.zpp_pool=ec;return this};a7.prototype.skipForward=function(ea){if(this.zpp_inner.vertices!=null){if(ea>0){while(ea-->0){this.zpp_inner.vertices=this.zpp_inner.vertices.next}}else{if(ea<0){while(ea++<0){this.zpp_inner.vertices=this.zpp_inner.vertices.prev}}}}return this};a7.prototype.skipBackwards=function(ea){return this.skipForward(-ea)};a7.prototype.erase=function(ef){while(ef!=0&&this.zpp_inner.vertices!=null){var ed=this.zpp_inner.vertices;if(ef>0){var ec;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;ec=this.zpp_inner.vertices=null}else{var eg=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;ec=eg}this.zpp_inner.vertices=ec;--ef}else{if(ef<0){var ee;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;ee=null}else{var eb=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;ee=eb}this.zpp_inner.vertices=ee;++ef}}if(ed.wrap!=null){ed.wrap.zpp_inner._inuse=false;var eh=ed.wrap;var ea=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;ed.wrap=null}ed.prev=ed.next=null;ed.next=dr.zpp_pool;dr.zpp_pool=ed}return this};a7.prototype.clear=function(){while(this.zpp_inner.vertices!=null){var eb=this.zpp_inner.vertices;var ec;if(this.zpp_inner.vertices!=null&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices){this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;ec=this.zpp_inner.vertices=null}else{var ed=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;ec=ed}this.zpp_inner.vertices=ec;if(eb.wrap!=null){eb.wrap.zpp_inner._inuse=false;var ee=eb.wrap;var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;eb.wrap=null}eb.prev=eb.next=null;eb.next=dr.zpp_pool;dr.zpp_pool=eb}return this};a7.prototype.copy=function(){var ec=a7.get();var ei=this.zpp_inner.vertices;var ed=this.zpp_inner.vertices;if(ei!=null){var ea=ei;while(true){var eh=ea;var eg=eh.x;var ee=eh.y;var ef;if(dr.zpp_pool==null){ef=new dr()}else{ef=dr.zpp_pool;dr.zpp_pool=ef.next;ef.next=null}ef.forced=false;ef.x=eg;ef.y=ee;var eb=ef;if(ec.zpp_inner.vertices==null){ec.zpp_inner.vertices=eb.prev=eb.next=eb}else{eb.prev=ec.zpp_inner.vertices;eb.next=ec.zpp_inner.vertices.next;ec.zpp_inner.vertices.next.prev=eb;ec.zpp_inner.vertices.next=eb}ec.zpp_inner.vertices=eb;ea=ea.next;if(!(ea!=ed)){break}}}return ec.skipForward(1)};a7.prototype.dispose=function(){this.clear();var ea=this;ea.zpp_pool=au.poolGeomPoly;au.poolGeomPoly=ea};a7.prototype.toString=function(){var ec="GeomPoly[";var ed=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ed!=null){var ee=ed;while(true){var eb=ee;if(eb!=this.zpp_inner.vertices){ec+=","}ec+="{"+eb.x+","+eb.y+"}";ee=ee.next;if(!(ee!=ea)){break}}}return ec+"]"};a7.prototype.area=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return 0}else{var ee=0;var ed=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ed!=null){var ef=ed;while(true){var eb=ef;ee+=eb.x*(eb.next.y-eb.prev.y);ef=ef.next;if(!(ef!=ea)){break}}}var ec=ee*0.5;if(ec<0){return -ec}else{return ec}}};a7.prototype.winding=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}return br.Winding_UNDEFINED}else{var ee=0;var ed=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ed!=null){var ef=ed;while(true){var ec=ef;ee+=ec.x*(ec.next.y-ec.prev.y);ef=ef.next;if(!(ef!=ea)){break}}}var eb=ee*0.5;if(eb>0){if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}return br.Winding_CLOCKWISE}else{if(eb==0){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}return br.Winding_UNDEFINED}else{if(br.Winding_ANTICLOCKWISE==null){br.internal=true;br.Winding_ANTICLOCKWISE=new X();br.internal=false}return br.Winding_ANTICLOCKWISE}}}};a7.prototype.contains=function(ek){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}var ej=ek.zpp_inner.x;var ef=ek.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=ek.zpp_inner.y;var ee=false;var el=this.zpp_inner.vertices;var eg=this.zpp_inner.vertices;if(el!=null){var ec=el;while(true){var eb=ec;var ea=eb.prev;if((eb.y<ei&&ea.y>=ei||ea.y<ei&&eb.y>=ei)&&(eb.x<=ej||ea.x<=ej)){if(eb.x+(ei-eb.y)/(ea.y-eb.y)*(ea.x-eb.x)<ej){ee=!ee}}ec=ec.next;if(!(ec!=eg)){break}}}var eh=ee;if(ek.zpp_inner.weak){var em=ek.zpp_inner;ek.zpp_inner.outer=null;ek.zpp_inner=null;ek.zpp_pool=au.poolVec2;au.poolVec2=ek;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}return eh};a7.prototype.isClockwise=function(){var ea=this.winding();if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}return ea==br.Winding_CLOCKWISE};a7.prototype.isConvex=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{var ec=false;var ei=false;var ee=true;var em=this.zpp_inner.vertices;var eh=this.zpp_inner.vertices;if(em!=null){var ed=em;while(true){var ek=ed;var el=ek.prev;var ej=ek.next;var ea=0;var en=0;ea=ej.x-ek.x;en=ej.y-ek.y;var eg=0;var ef=0;eg=ek.x-el.x;ef=ek.y-el.y;var eb=ef*ea-eg*en;if(eb>0){ei=true}else{if(eb<0){ec=true}}if(ei&&ec){ee=false;break}ed=ed.next;if(!(ed!=eh)){break}}}return ee}};a7.prototype.isSimple=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{return bv.isSimple(this.zpp_inner.vertices)}};a7.prototype.isMonotone=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{return aE.isMonotone(this.zpp_inner.vertices)}};a7.prototype.isDegenerate=function(){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return true}else{return this.area()<P.epsilon}};a7.prototype.simplify=function(ec){if(this.zpp_inner.vertices==null||this.zpp_inner.vertices.next==null||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next){return this.copy()}else{var ea=aL.simplify(this.zpp_inner.vertices,ec);var eb=a7.get();eb.zpp_inner.vertices=ea;return eb}};a7.prototype.simpleDecomposition=function(ec){if(a.sharedGVList==null){a.sharedGVList=new dA()}var eb=bv.decompose(this.zpp_inner.vertices,a.sharedGVList);var ed=ec==null?new u():ec;while(eb.head!=null){var ee=eb.pop_unsafe();var ea=a7.get();ea.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(ea)}else{ed.unshift(ea)}}return ed};a7.prototype.monotoneDecomposition=function(ec){if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}var ef=aE.decompose(this.zpp_inner.vertices,aE.sharedPPoly);if(a.sharedGVList==null){a.sharedGVList=new dA()}var eb=ef.extract(a.sharedGVList);var ed=ec==null?new u():ec;while(eb.head!=null){var ee=eb.pop_unsafe();var ea=a7.get();ea.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(ea)}else{ed.unshift(ea)}}return ed};a7.prototype.convexDecomposition=function(ei,eb){if(ei==null){ei=false}if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}var ea=aE.decompose(this.zpp_inner.vertices,aE.sharedPPoly);if(a.sharedPPList==null){a.sharedPPList=new bu()}var eh=ea.extract_partitions(a.sharedPPList);var ed=eb==null?new u():eb;while(eh.head!=null){var ef=eh.pop_unsafe();z.triangulate(ef);if(ei){z.optimise(ef)}an.optimise(ef);if(a.sharedGVList==null){a.sharedGVList=new dA()}var ec=ef.extract(a.sharedGVList);ef.next=a.zpp_pool;a.zpp_pool=ef;while(ec.head!=null){var ee=ec.pop_unsafe();var eg=a7.get();eg.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(eg)}else{ed.unshift(eg)}}}return ed};a7.prototype.triangularDecomposition=function(ei,eb){if(ei==null){ei=false}if(aE.sharedPPoly==null){aE.sharedPPoly=new a()}var ea=aE.decompose(this.zpp_inner.vertices,aE.sharedPPoly);if(a.sharedPPList==null){a.sharedPPList=new bu()}var eh=ea.extract_partitions(a.sharedPPList);var ed=eb==null?new u():eb;while(eh.head!=null){var ef=eh.pop_unsafe();z.triangulate(ef);if(ei){z.optimise(ef)}if(a.sharedGVList==null){a.sharedGVList=new dA()}var ec=ef.extract(a.sharedGVList);ef.next=a.zpp_pool;a.zpp_pool=ef;while(ec.head!=null){var ee=ec.pop_unsafe();var eg=a7.get();eg.zpp_inner.vertices=ee;if(ed.zpp_inner.reverse_flag){ed.push(eg)}else{ed.unshift(eg)}}}return ed};a7.prototype.inflate=function(eF){var ep=a7.get();var eB=this.winding();if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}if(eB==br.Winding_CLOCKWISE){eF=-eF}var ek=this.zpp_inner.vertices;var ej=this.zpp_inner.vertices;if(ek!=null){var eb=ek;while(true){var eC=eb;var el=eC.prev;var ec=eC.next;var ed=0;var ea=0;var ex=0;var ev=0;ed=eC.x-el.x;ea=eC.y-el.y;ex=ec.x-eC.x;ev=ec.y-eC.y;var eJ=0;var eI=0;var eE=0;var eD=0;eJ=ed;eI=ea;var ew=1/Math.sqrt(eJ*eJ+eI*eI);eJ*=ew;eI*=ew;var eA=eJ;eJ=-eI;eI=eA;var er=eF;eJ*=er;eI*=er;eE=ex;eD=ev;var es=1/Math.sqrt(eE*eE+eD*eD);eE*=es;eD*=es;var eq=eE;eE=-eD;eD=eq;var eo=eF;eE*=eo;eD*=eo;var eh=0;var ef=0;eh=eE-eJ;ef=eD-eI;var eH=ev*eh-ex*ef;var en=eH==0?0:eH/(ev*ed-ex*ea);var ei=0;var eg=0;ei=eC.x+eJ;eg=eC.y+eI;var em=en;ei+=ed*em;eg+=ea*em;var eu;if(au.poolVec2==null){eu=new r()}else{eu=au.poolVec2;au.poolVec2=eu.zpp_pool;eu.zpp_pool=null}if(eu.zpp_inner==null){var et;if(bB.zpp_pool==null){et=new bB()}else{et=bB.zpp_pool;bB.zpp_pool=et.next;et.next=null}et.weak=false;et._immutable=false;et.x=ei;et.y=eg;eu.zpp_inner=et;eu.zpp_inner.outer=eu}else{var eG;var ee=eu.zpp_inner;if(ee._validate!=null){ee._validate()}if(eu.zpp_inner.x==ei){var ez=eu.zpp_inner;if(ez._validate!=null){ez._validate()}eG=eu.zpp_inner.y==eg}else{eG=false}if(!eG){eu.zpp_inner.x=ei;eu.zpp_inner.y=eg;var ey=eu.zpp_inner;if(ey._invalidate!=null){ey._invalidate(ey)}}}eu.zpp_inner.weak=false;ep.push(eu);eb=eb.next;if(!(eb!=ej)){break}}}return ep.skipForward(1)};a7.prototype.cut=function(eh,ec,eb,eg,ee){if(eg==null){eg=false}if(eb==null){eb=false}var ef=az.run(this.zpp_inner.vertices,eh,ec,eb,eg,ee);if(eh.zpp_inner.weak){var ed=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ed.outer!=null){ed.outer.zpp_inner=null;ed.outer=null}ed._isimmutable=null;ed._validate=null;ed._invalidate=null;ed.next=bB.zpp_pool;bB.zpp_pool=ed}if(ec.zpp_inner.weak){var ea=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return ef};a7.prototype.transform=function(ec){var ee=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ee!=null){var ef=ee;while(true){var eb=ef;var ed=ec.zpp_inner.a*eb.x+ec.zpp_inner.b*eb.y+ec.zpp_inner.tx;eb.y=ec.zpp_inner.c*eb.x+ec.zpp_inner.d*eb.y+ec.zpp_inner.ty;eb.x=ed;ef=ef.next;if(!(ef!=ea)){break}}}return this};a7.prototype.bounds=function(){var ec=1e+100;var eb=1e+100;var eh=-1e+100;var eg=-1e+100;var ee=this.zpp_inner.vertices;var ea=this.zpp_inner.vertices;if(ee!=null){var ef=ee;while(true){var ed=ef;if(ed.x<ec){ec=ed.x}if(ed.y<eb){eb=ed.y}if(ed.x>eh){eh=ed.x}if(ed.y>eg){eg=ed.y}ef=ef.next;if(!(ef!=ea)){break}}}return new S(ec,eb,eh-ec,eg-eb)};a7.prototype.top=function(){var eb=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eh=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.y<eb.y){eb=el}ea=ea.next;if(!(ea!=eh)){break}}}if(eb.wrap==null){var ek=eb.x;var ej=eb.y;var ef;if(au.poolVec2==null){ef=new r()}else{ef=au.poolVec2;au.poolVec2=ef.zpp_pool;ef.zpp_pool=null}if(ef.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=ek;ei.y=ej;ef.zpp_inner=ei;ef.zpp_inner.outer=ef}else{var ec;var ed=ef.zpp_inner;if(ed._validate!=null){ed._validate()}if(ef.zpp_inner.x==ek){var eg=ef.zpp_inner;if(eg._validate!=null){eg._validate()}ec=ef.zpp_inner.y==ej}else{ec=false}if(!ec){ef.zpp_inner.x=ek;ef.zpp_inner.y=ej;var ee=ef.zpp_inner;if(ee._invalidate!=null){ee._invalidate(ee)}}}ef.zpp_inner.weak=false;eb.wrap=ef;eb.wrap.zpp_inner._inuse=true;eb.wrap.zpp_inner._invalidate=dX(eb,eb.modwrap);eb.wrap.zpp_inner._validate=dX(eb,eb.getwrap)}return eb.wrap};a7.prototype.bottom=function(){var ej=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eg=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.y>ej.y){ej=el}ea=ea.next;if(!(ea!=eg)){break}}}if(ej.wrap==null){var ek=ej.x;var ei=ej.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ek;eh.y=ei;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var eb;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==ek){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ek;ee.zpp_inner.y=ei;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=false;ej.wrap=ee;ej.wrap.zpp_inner._inuse=true;ej.wrap.zpp_inner._invalidate=dX(ej,ej.modwrap);ej.wrap.zpp_inner._validate=dX(ej,ej.getwrap)}return ej.wrap};a7.prototype.left=function(){var eb=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eh=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.x<eb.x){eb=el}ea=ea.next;if(!(ea!=eh)){break}}}if(eb.wrap==null){var ek=eb.x;var ej=eb.y;var ef;if(au.poolVec2==null){ef=new r()}else{ef=au.poolVec2;au.poolVec2=ef.zpp_pool;ef.zpp_pool=null}if(ef.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=ek;ei.y=ej;ef.zpp_inner=ei;ef.zpp_inner.outer=ef}else{var ec;var ed=ef.zpp_inner;if(ed._validate!=null){ed._validate()}if(ef.zpp_inner.x==ek){var eg=ef.zpp_inner;if(eg._validate!=null){eg._validate()}ec=ef.zpp_inner.y==ej}else{ec=false}if(!ec){ef.zpp_inner.x=ek;ef.zpp_inner.y=ej;var ee=ef.zpp_inner;if(ee._invalidate!=null){ee._invalidate(ee)}}}ef.zpp_inner.weak=false;eb.wrap=ef;eb.wrap.zpp_inner._inuse=true;eb.wrap.zpp_inner._invalidate=dX(eb,eb.modwrap);eb.wrap.zpp_inner._validate=dX(eb,eb.getwrap)}return eb.wrap};a7.prototype.right=function(){var ej=this.zpp_inner.vertices;var em=this.zpp_inner.vertices.next;var eg=this.zpp_inner.vertices;if(em!=null){var ea=em;while(true){var el=ea;if(el.x>ej.x){ej=el}ea=ea.next;if(!(ea!=eg)){break}}}if(ej.wrap==null){var ek=ej.x;var ei=ej.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ek;eh.y=ei;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var eb;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==ek){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ek;ee.zpp_inner.y=ei;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=false;ej.wrap=ee;ej.wrap.zpp_inner._inuse=true;ej.wrap.zpp_inner._invalidate=dX(ej,ej.modwrap);ej.wrap.zpp_inner._validate=dX(ej,ej.getwrap)}return ej.wrap};a7.prototype.__class__=a7;var bL=nape.geom.GeomPolyIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};bL.__name__=["nape","geom","GeomPolyIterator"];bL.get=function(ec){var ea;if(bL.zpp_pool==null){dl.internal=true;var ed=new bL();dl.internal=false;ea=ed}else{var eb=bL.zpp_pool;bL.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};bL.prototype.zpp_inner=null;bL.prototype.zpp_i=null;bL.prototype.zpp_critical=null;bL.prototype.zpp_next=null;bL.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=bL.zpp_pool;bL.zpp_pool=this;this.zpp_inner=null;return false}};bL.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};bL.prototype.__class__=bL;var u=nape.geom.GeomPolyList=function(){this.zpp_inner=null;this.zpp_inner=new dl();this.zpp_inner.outer=this};u.__name__=["nape","geom","GeomPolyList"];u.fromArray=function(ed){var ea=new u();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};u.prototype.zpp_inner=null;u.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};u.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};u.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};u.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};u.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};u.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};u.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};u.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};u.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};u.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};u.prototype.empty=function(){return this.zpp_inner.inner.head==null};u.prototype.iterator=function(){this.zpp_inner.valmod();return bL.get(this)};u.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new u();this.zpp_inner.valmod();var ef=bL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bL.zpp_pool;bL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};u.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=bL.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=bL.zpp_pool;bL.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};u.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=bL.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bL.zpp_pool;bL.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};u.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=bL.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=bL.zpp_pool;bL.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=bL.zpp_pool;bL.zpp_pool=ec;ec.zpp_inner=null;break}}return this};u.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(u.prototype,"length",{get:u.prototype.get_length});u.prototype.__class__=u;var cz=nape.geom.GeomVertexIterator=function(){};cz.__name__=["nape","geom","GeomVertexIterator"];cz.prototype.zpp_inner=null;cz.prototype.hasNext=function(){var ea=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;this.zpp_inner.first=false;if(!ea){var eb=this.zpp_inner;eb.outer.zpp_inner=null;eb.ptr=eb.start=null;eb.next=dn.zpp_pool;dn.zpp_pool=eb}return ea};cz.prototype.next=function(){var ec=this.zpp_inner.ptr;if(ec.wrap==null){var ej=ec.x;var eh=ec.y;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=ej;ei.y=eh;ee.zpp_inner=ei;ee.zpp_inner.outer=ee}else{var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==eh}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=eh;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}ee.zpp_inner.weak=false;ec.wrap=ee;ec.wrap.zpp_inner._inuse=true;ec.wrap.zpp_inner._invalidate=dX(ec,ec.modwrap);ec.wrap.zpp_inner._validate=dX(ec,ec.getwrap)}var eg=ec.wrap;this.zpp_inner.ptr=this.zpp_inner.forward?this.zpp_inner.ptr.next:this.zpp_inner.ptr.prev;return eg};cz.prototype.__class__=cz;var F=nape.geom.MarchingSquares=function(){};F.__name__=["nape","geom","MarchingSquares"];F.run=function(ec,ep,eh,ed,eo,eD,ej){if(eD==null){eD=true}if(ed==null){ed=2}var en=ej!=null?ej:new u();if(eo==null){var eb=ep.zpp_inner;if(eb._validate!=null){eb._validate()}var eE=ep.zpp_inner.minx;var eC=ep.zpp_inner;if(eC._validate!=null){eC._validate()}var eZ=ep.zpp_inner.miny;var eB=ep.zpp_inner.getmax();var eA=eB.zpp_inner;if(eA._validate!=null){eA._validate()}var eY=eB.zpp_inner.x;var ez=ep.zpp_inner.getmax();var ex=ez.zpp_inner;if(ex._validate!=null){ex._validate()}bc.run(ec,eE,eZ,eY,ez.zpp_inner.y,eh,ed,eD,en)}else{var ew=ep.zpp_inner;if(ew._validate!=null){ew._validate()}var eu=ep.zpp_inner;var eV=eu.maxx-eu.minx;var et=eo.zpp_inner;if(et._validate!=null){et._validate()}var eq=eV/eo.zpp_inner.x;var es=ep.zpp_inner;if(es._validate!=null){es._validate()}var eX=ep.zpp_inner;var eT=eX.maxy-eX.miny;var eU=eo.zpp_inner;if(eU._validate!=null){eU._validate()}var eg=eT/eo.zpp_inner.y;var er=eq|0;var ei=eg|0;if(er!=eq){++er}if(ei!=eg){++ei}var eN=0;var eW=er;while(eN<eW){var ey=eN++;var eS=ep.zpp_inner;if(eS._validate!=null){eS._validate()}var eR=ep.zpp_inner.minx;var eQ=eo.zpp_inner;if(eQ._validate!=null){eQ._validate()}var ef=eR+eo.zpp_inner.x*ey;var ee;if(ey==er-1){var eP=ep.zpp_inner.getmax();var eM=eP.zpp_inner;if(eM._validate!=null){eM._validate()}ee=eP.zpp_inner.x}else{var eL=eo.zpp_inner;if(eL._validate!=null){eL._validate()}ee=ef+eo.zpp_inner.x}var eJ=0;var eK=ei;while(eJ<eK){var ev=eJ++;var eI=ep.zpp_inner;if(eI._validate!=null){eI._validate()}var eO=ep.zpp_inner.miny;var eH=eo.zpp_inner;if(eH._validate!=null){eH._validate()}var ea=eO+eo.zpp_inner.y*ev;var e0;if(ev==ei-1){var eG=ep.zpp_inner.getmax();var em=eG.zpp_inner;if(em._validate!=null){em._validate()}e0=eG.zpp_inner.y}else{var el=eo.zpp_inner;if(el._validate!=null){el._validate()}e0=ea+eo.zpp_inner.y}bc.run(ec,ef,ea,ee,e0,eh,ed,eD,en)}}}if(eh.zpp_inner.weak){var ek=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(eo!=null){if(eo.zpp_inner.weak){var eF=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(eF.outer!=null){eF.outer.zpp_inner=null;eF.outer=null}eF._isimmutable=null;eF._validate=null;eF._invalidate=null;eF.next=bB.zpp_pool;bB.zpp_pool=eF}}return en};F.prototype.__class__=F;var cI=nape.geom.Mat23=function(el,ek,ej,eh,eb,ea){if(ea==null){ea=0}if(eb==null){eb=0}if(eh==null){eh=1}if(ej==null){ej=0}if(ek==null){ek=0}if(el==null){el=1}this.zpp_inner=null;this.zpp_inner=cm.get();this.zpp_inner.outer=this;this.zpp_inner.a=el;var ef=this.zpp_inner;if(ef._invalidate!=null){ef._invalidate()}this.zpp_inner.b=ek;var ei=this.zpp_inner;if(ei._invalidate!=null){ei._invalidate()}this.zpp_inner.tx=eb;var eg=this.zpp_inner;if(eg._invalidate!=null){eg._invalidate()}this.zpp_inner.c=ej;var ee=this.zpp_inner;if(ee._invalidate!=null){ee._invalidate()}this.zpp_inner.d=eh;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate()}this.zpp_inner.ty=ea;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate()}};cI.__name__=["nape","geom","Mat23"];cI.rotation=function(ec){var eb=Math.cos(ec);var ea=Math.sin(ec);return new cI(eb,-ea,ea,eb,0,0)};cI.translation=function(eb,ea){return new cI(1,0,0,1,eb,ea)};cI.scale=function(eb,ea){return new cI(eb,0,0,ea,0,0)};cI.prototype.zpp_inner=null;cI.prototype.get_a=function(){return this.zpp_inner.a};cI.prototype.set_a=function(ea){this.zpp_inner.a=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.a};cI.prototype.get_b=function(){return this.zpp_inner.b};cI.prototype.set_b=function(ea){this.zpp_inner.b=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.b};cI.prototype.get_c=function(){return this.zpp_inner.c};cI.prototype.set_c=function(eb){this.zpp_inner.c=eb;var ea=this.zpp_inner;if(ea._invalidate!=null){ea._invalidate()}return this.zpp_inner.c};cI.prototype.get_d=function(){return this.zpp_inner.d};cI.prototype.set_d=function(ea){this.zpp_inner.d=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.d};cI.prototype.get_tx=function(){return this.zpp_inner.tx};cI.prototype.set_tx=function(ea){this.zpp_inner.tx=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.tx};cI.prototype.get_ty=function(){return this.zpp_inner.ty};cI.prototype.set_ty=function(ea){this.zpp_inner.ty=ea;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate()}return this.zpp_inner.ty};cI.prototype.copy=function(){return new cI(this.zpp_inner.a,this.zpp_inner.b,this.zpp_inner.c,this.zpp_inner.d,this.zpp_inner.tx,this.zpp_inner.ty)};cI.prototype.set=function(eb){var ea=eb.zpp_inner;this.zpp_inner.setas(ea.a,ea.b,ea.c,ea.d,ea.tx,ea.ty);var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate()}return this};cI.prototype.setAs=function(ed,eb,eg,ee,ec,ea){if(ea==null){ea=0}if(ec==null){ec=0}if(ee==null){ee=1}if(eg==null){eg=0}if(eb==null){eb=0}if(ed==null){ed=1}this.zpp_inner.setas(ed,eb,eg,ee,ec,ea);var ef=this.zpp_inner;if(ef._invalidate!=null){ef._invalidate()}return this};cI.prototype.reset=function(){return this.setAs()};cI.prototype.get_determinant=function(){return this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c};cI.prototype.singular=function(){var eb=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d;var ea=this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c;if(ea<0){ea=-ea}return eb>P.illConditionedThreshold*ea};cI.prototype.inverse=function(){var ea=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);return new cI(this.zpp_inner.d*ea,-this.zpp_inner.b*ea,-this.zpp_inner.c*ea,this.zpp_inner.a*ea,(this.zpp_inner.b*this.zpp_inner.ty-this.zpp_inner.d*this.zpp_inner.tx)*ea,(this.zpp_inner.c*this.zpp_inner.tx-this.zpp_inner.a*this.zpp_inner.ty)*ea)};cI.prototype.transpose=function(){return new cI(this.zpp_inner.a,this.zpp_inner.c,this.zpp_inner.b,this.zpp_inner.d,-this.zpp_inner.a*this.zpp_inner.tx-this.zpp_inner.c*this.zpp_inner.ty,-this.zpp_inner.b*this.zpp_inner.tx-this.zpp_inner.d*this.zpp_inner.ty)};cI.prototype.concat=function(ea){return new cI(ea.zpp_inner.a*this.zpp_inner.a+ea.zpp_inner.b*this.zpp_inner.c,ea.zpp_inner.a*this.zpp_inner.b+ea.zpp_inner.b*this.zpp_inner.d,ea.zpp_inner.c*this.zpp_inner.a+ea.zpp_inner.d*this.zpp_inner.c,ea.zpp_inner.c*this.zpp_inner.b+ea.zpp_inner.d*this.zpp_inner.d,ea.zpp_inner.a*this.zpp_inner.tx+ea.zpp_inner.b*this.zpp_inner.ty+ea.zpp_inner.tx,ea.zpp_inner.c*this.zpp_inner.tx+ea.zpp_inner.d*this.zpp_inner.ty+ea.zpp_inner.ty)};cI.prototype.transform=function(eu,el,ef){if(ef==null){ef=false}if(el==null){el=false}var eG;if(el){var ex=eu.zpp_inner;if(ex._validate!=null){ex._validate()}var eE=eu.zpp_inner.x*this.zpp_inner.a;var eD=eu.zpp_inner;if(eD._validate!=null){eD._validate()}var eh=eE+eu.zpp_inner.y*this.zpp_inner.b;var eC=eu.zpp_inner;if(eC._validate!=null){eC._validate()}var ep=eu.zpp_inner.x*this.zpp_inner.c;var eA=eu.zpp_inner;if(eA._validate!=null){eA._validate()}var eg=ep+eu.zpp_inner.y*this.zpp_inner.d;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ed;if(bB.zpp_pool==null){ed=new bB()}else{ed=bB.zpp_pool;bB.zpp_pool=ed.next;ed.next=null}ed.weak=false;ed._immutable=false;ed.x=eh;ed.y=eg;ee.zpp_inner=ed;ee.zpp_inner.outer=ee}else{var em;var ez=ee.zpp_inner;if(ez._validate!=null){ez._validate()}if(ee.zpp_inner.x==eh){var ey=ee.zpp_inner;if(ey._validate!=null){ey._validate()}em=ee.zpp_inner.y==eg}else{em=false}if(!em){ee.zpp_inner.x=eh;ee.zpp_inner.y=eg;var ew=ee.zpp_inner;if(ew._invalidate!=null){ew._invalidate(ew)}}}ee.zpp_inner.weak=ef;eG=ee}else{var et=eu.zpp_inner;if(et._validate!=null){et._validate()}var ek=eu.zpp_inner.x*this.zpp_inner.a;var er=eu.zpp_inner;if(er._validate!=null){er._validate()}var eB=ek+eu.zpp_inner.y*this.zpp_inner.b+this.zpp_inner.tx;var eo=eu.zpp_inner;if(eo._validate!=null){eo._validate()}var ej=eu.zpp_inner.x*this.zpp_inner.c;var ev=eu.zpp_inner;if(ev._validate!=null){ev._validate()}var ea=ej+eu.zpp_inner.y*this.zpp_inner.d+this.zpp_inner.ty;var ec;if(au.poolVec2==null){ec=new r()}else{ec=au.poolVec2;au.poolVec2=ec.zpp_pool;ec.zpp_pool=null}if(ec.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=eB;eb.y=ea;ec.zpp_inner=eb;ec.zpp_inner.outer=ec}else{var ei;var es=ec.zpp_inner;if(es._validate!=null){es._validate()}if(ec.zpp_inner.x==eB){var eq=ec.zpp_inner;if(eq._validate!=null){eq._validate()}ei=ec.zpp_inner.y==ea}else{ei=false}if(!ei){ec.zpp_inner.x=eB;ec.zpp_inner.y=ea;var en=ec.zpp_inner;if(en._invalidate!=null){en._invalidate(en)}}}ec.zpp_inner.weak=ef;eG=ec}if(eu.zpp_inner.weak){var eF=eu.zpp_inner;eu.zpp_inner.outer=null;eu.zpp_inner=null;eu.zpp_pool=au.poolVec2;au.poolVec2=eu;if(eF.outer!=null){eF.outer.zpp_inner=null;eF.outer=null}eF._isimmutable=null;eF._validate=null;eF._invalidate=null;eF.next=bB.zpp_pool;bB.zpp_pool=eF}return eG};cI.prototype.inverseTransform=function(es,el,ef){if(ef==null){ef=false}if(el==null){el=false}var eC=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);var eF;if(el){var ev=es.zpp_inner;if(ev._validate!=null){ev._validate()}var eD=es.zpp_inner.x*this.zpp_inner.d;var eB=es.zpp_inner;if(eB._validate!=null){eB._validate()}var eh=(eD-es.zpp_inner.y*this.zpp_inner.b)*eC;var eA=es.zpp_inner;if(eA._validate!=null){eA._validate()}var eo=es.zpp_inner.y*this.zpp_inner.a;var ey=es.zpp_inner;if(ey._validate!=null){ey._validate()}var eg=(eo-es.zpp_inner.x*this.zpp_inner.c)*eC;var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ed;if(bB.zpp_pool==null){ed=new bB()}else{ed=bB.zpp_pool;bB.zpp_pool=ed.next;ed.next=null}ed.weak=false;ed._immutable=false;ed.x=eh;ed.y=eg;ee.zpp_inner=ed;ee.zpp_inner.outer=ee}else{var em;var ex=ee.zpp_inner;if(ex._validate!=null){ex._validate()}if(ee.zpp_inner.x==eh){var ew=ee.zpp_inner;if(ew._validate!=null){ew._validate()}em=ee.zpp_inner.y==eg}else{em=false}if(!em){ee.zpp_inner.x=eh;ee.zpp_inner.y=eg;var eu=ee.zpp_inner;if(eu._invalidate!=null){eu._invalidate(eu)}}}ee.zpp_inner.weak=ef;eF=ee}else{var er=es.zpp_inner;if(er._validate!=null){er._validate()}var ej=es.zpp_inner.x-this.zpp_inner.tx;var ep=es.zpp_inner;if(ep._validate!=null){ep._validate()}var ei=es.zpp_inner.y-this.zpp_inner.ty;var ez=(ej*this.zpp_inner.d-ei*this.zpp_inner.b)*eC;var ea=(ei*this.zpp_inner.a-ej*this.zpp_inner.c)*eC;var ec;if(au.poolVec2==null){ec=new r()}else{ec=au.poolVec2;au.poolVec2=ec.zpp_pool;ec.zpp_pool=null}if(ec.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ez;eb.y=ea;ec.zpp_inner=eb;ec.zpp_inner.outer=ec}else{var ek;var en=ec.zpp_inner;if(en._validate!=null){en._validate()}if(ec.zpp_inner.x==ez){var et=ec.zpp_inner;if(et._validate!=null){et._validate()}ek=ec.zpp_inner.y==ea}else{ek=false}if(!ek){ec.zpp_inner.x=ez;ec.zpp_inner.y=ea;var eq=ec.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}}}ec.zpp_inner.weak=ef;eF=ec}if(es.zpp_inner.weak){var eE=es.zpp_inner;es.zpp_inner.outer=null;es.zpp_inner=null;es.zpp_pool=au.poolVec2;au.poolVec2=es;if(eE.outer!=null){eE.outer.zpp_inner=null;eE.outer=null}eE._isimmutable=null;eE._validate=null;eE._invalidate=null;eE.next=bB.zpp_pool;bB.zpp_pool=eE}return eF};cI.prototype.toString=function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+" tx: "+this.zpp_inner.tx+" ty: "+this.zpp_inner.ty+" }"};cI.prototype.equiorthogonal=function(){if(this.singular()){return false}else{var ea=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(ea*ea<P.epsilon){var eb=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-this.zpp_inner.c*this.zpp_inner.c-this.zpp_inner.d*this.zpp_inner.d;return eb*eb<P.epsilon}else{return false}}};cI.prototype.orthogonal=function(){var ea=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(ea*ea<P.epsilon){var ec=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-1;var eb=this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d-1;if(ec*ec<P.epsilon){return eb*eb<P.epsilon}else{return false}}else{return false}};cI.prototype.equiorthogonalise=function(){if(!this.equiorthogonal()){var ef=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c);var ee=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);var en=(ef+ee)/2;ef=en/ef;ee=en/ee;var ec=this;ec.zpp_inner.a=ec.zpp_inner.a*ef;var em=ec.zpp_inner;if(em._invalidate!=null){em._invalidate()}var ei=this;ei.zpp_inner.c=ei.zpp_inner.c*ef;var es=ei.zpp_inner;if(es._invalidate!=null){es._invalidate()}var eh=this;eh.zpp_inner.b=eh.zpp_inner.b*ee;var er=eh.zpp_inner;if(er._invalidate!=null){er._invalidate()}var eg=this;eg.zpp_inner.d=eg.zpp_inner.d*ee;var eq=eg.zpp_inner;if(eq._invalidate!=null){eq._invalidate()}var et=0.25*Math.PI-0.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/(en*en));if(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c>0){et=-et}var ea=Math.sin(et);var eb=Math.cos(et);var eu=this.zpp_inner.a*eb-this.zpp_inner.c*ea;var ed=this.zpp_inner.b*eb+this.zpp_inner.d*ea;this.zpp_inner.c=this.zpp_inner.c*eb+this.zpp_inner.a*ea;var ep=this.zpp_inner;if(ep._invalidate!=null){ep._invalidate()}this.zpp_inner.a=eu;var eo=this.zpp_inner;if(eo._invalidate!=null){eo._invalidate()}this.zpp_inner.d=this.zpp_inner.d*eb-this.zpp_inner.b*ea;var el=this.zpp_inner;if(el._invalidate!=null){el._invalidate()}this.zpp_inner.b=ed;var ek=this.zpp_inner;if(ek._invalidate!=null){ek._invalidate()}var ej=this.zpp_inner;if(ej._invalidate!=null){ej._invalidate()}}return this};cI.prototype.orthogonalise=function(){if(!this.orthogonal()){var ef=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c);var ee=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);ef=1/ef;ee=1/ee;var ec=this;ec.zpp_inner.a=ec.zpp_inner.a*ef;var em=ec.zpp_inner;if(em._invalidate!=null){em._invalidate()}var ei=this;ei.zpp_inner.c=ei.zpp_inner.c*ef;var er=ei.zpp_inner;if(er._invalidate!=null){er._invalidate()}var eh=this;eh.zpp_inner.b=eh.zpp_inner.b*ee;var eq=eh.zpp_inner;if(eq._invalidate!=null){eq._invalidate()}var eg=this;eg.zpp_inner.d=eg.zpp_inner.d*ee;var ep=eg.zpp_inner;if(ep._invalidate!=null){ep._invalidate()}var es=0.25*Math.PI-0.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/1);if(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c>0){es=-es}var ea=Math.sin(es);var eb=Math.cos(es);var et=this.zpp_inner.a*eb-this.zpp_inner.c*ea;var ed=this.zpp_inner.b*eb+this.zpp_inner.d*ea;this.zpp_inner.c=this.zpp_inner.c*eb+this.zpp_inner.a*ea;var eo=this.zpp_inner;if(eo._invalidate!=null){eo._invalidate()}this.zpp_inner.a=et;var en=this.zpp_inner;if(en._invalidate!=null){en._invalidate()}this.zpp_inner.d=this.zpp_inner.d*eb-this.zpp_inner.b*ea;var el=this.zpp_inner;if(el._invalidate!=null){el._invalidate()}this.zpp_inner.b=ed;var ek=this.zpp_inner;if(ek._invalidate!=null){ek._invalidate()}var ej=this.zpp_inner;if(ej._invalidate!=null){ej._invalidate()}}return this};Object.defineProperty(cI.prototype,"a",{get:cI.prototype.get_a,set:cI.prototype.set_a});Object.defineProperty(cI.prototype,"b",{get:cI.prototype.get_b,set:cI.prototype.set_b});Object.defineProperty(cI.prototype,"c",{get:cI.prototype.get_c,set:cI.prototype.set_c});Object.defineProperty(cI.prototype,"d",{get:cI.prototype.get_d,set:cI.prototype.set_d});Object.defineProperty(cI.prototype,"tx",{get:cI.prototype.get_tx,set:cI.prototype.set_tx});Object.defineProperty(cI.prototype,"ty",{get:cI.prototype.get_ty,set:cI.prototype.set_ty});Object.defineProperty(cI.prototype,"determinant",{get:cI.prototype.get_determinant});cI.prototype.__class__=cI;var bY=nape.geom.MatMN=function(ea,eb){this.zpp_inner=null;this.zpp_inner=new bI(ea,eb);this.zpp_inner.outer=this};bY.__name__=["nape","geom","MatMN"];bY.prototype.zpp_inner=null;bY.prototype.get_rows=function(){return this.zpp_inner.m};bY.prototype.get_cols=function(){return this.zpp_inner.n};bY.prototype.x=function(eb,ea){return this.zpp_inner.x[eb*this.zpp_inner.n+ea]};bY.prototype.setx=function(ec,eb,ea){return this.zpp_inner.x[ec*this.zpp_inner.n+eb]=ea};bY.prototype.toString=function(){var eb="{ ";var ea=true;var ef=0;var eg=this.zpp_inner.m;while(ef<eg){var ec=ef++;if(!ea){eb+="; "}ea=false;var ed=0;var ee=this.zpp_inner.n;while(ed<ee){eb+=this.zpp_inner.x[ec*this.zpp_inner.n+ed++]+" "}}eb+="}";return eb};bY.prototype.transpose=function(){var eb=new bY(this.zpp_inner.n,this.zpp_inner.m);var ef=0;var eg=this.zpp_inner.m;while(ef<eg){var ec=ef++;var ed=0;var ee=this.zpp_inner.n;while(ed<ee){var ea=ed++;eb.zpp_inner.x[ea*eb.zpp_inner.n+ec]=this.zpp_inner.x[ec*this.zpp_inner.n+ea]}}return eb};bY.prototype.mul=function(ek){var eh=new bY(this.zpp_inner.m,ek.zpp_inner.n);var ej=0;var ed=this.zpp_inner.m;while(ej<ed){var ec=ej++;var eg=0;var ei=ek.zpp_inner.n;while(eg<ei){var eb=eg++;var el=0;var ee=0;var ef=this.zpp_inner.n;while(ee<ef){var ea=ee++;el+=this.zpp_inner.x[ec*this.zpp_inner.n+ea]*ek.zpp_inner.x[ea*ek.zpp_inner.n+eb]}eh.zpp_inner.x[ec*eh.zpp_inner.n+eb]=el}}return eh};Object.defineProperty(bY.prototype,"rows",{get:bY.prototype.get_rows});Object.defineProperty(bY.prototype,"cols",{get:bY.prototype.get_cols});bY.prototype.__class__=bY;var ad=nape.geom.Ray=function(ev,et){this.zpp_inner=null;this.zpp_inner=new bf();var ej=this.zpp_inner.origin;var er=ev.zpp_inner;if(er._validate!=null){er._validate()}var ec=ev.zpp_inner.x;var ep=ev.zpp_inner;if(ep._validate!=null){ep._validate()}var eb=ev.zpp_inner.y;var es;var eo=ej.zpp_inner;if(eo._validate!=null){eo._validate()}if(ej.zpp_inner.x==ec){var en=ej.zpp_inner;if(en._validate!=null){en._validate()}es=ej.zpp_inner.y==eb}else{es=false}if(!es){ej.zpp_inner.x=ec;ej.zpp_inner.y=eb;var em=ej.zpp_inner;if(em._invalidate!=null){em._invalidate(em)}}if(ev.zpp_inner.weak){var eu=ev.zpp_inner;ev.zpp_inner.outer=null;ev.zpp_inner=null;ev.zpp_pool=au.poolVec2;au.poolVec2=ev;if(eu.outer!=null){eu.outer.zpp_inner=null;eu.outer=null}eu._isimmutable=null;eu._validate=null;eu._invalidate=null;eu.next=bB.zpp_pool;bB.zpp_pool=eu}var ek=this.zpp_inner.direction;var eh=et.zpp_inner;if(eh._validate!=null){eh._validate()}var eq=et.zpp_inner.x;var ef=et.zpp_inner;if(ef._validate!=null){ef._validate()}var ea=et.zpp_inner.y;var ee;var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}if(ek.zpp_inner.x==eq){var ei=ek.zpp_inner;if(ei._validate!=null){ei._validate()}ee=ek.zpp_inner.y==ea}else{ee=false}if(!ee){ek.zpp_inner.x=eq;ek.zpp_inner.y=ea;var eg=ek.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}if(et.zpp_inner.weak){var el=et.zpp_inner;et.zpp_inner.outer=null;et.zpp_inner=null;et.zpp_pool=au.poolVec2;au.poolVec2=et;if(el.outer!=null){el.outer.zpp_inner=null;el.outer=null}el._isimmutable=null;el._validate=null;el._invalidate=null;el.next=bB.zpp_pool;bB.zpp_pool=el}this.zpp_inner.zip_dir=true;this.zpp_inner.maxdist=Infinity};ad.__name__=["nape","geom","Ray"];ad.fromSegment=function(ec,ed){var eh=new ad(ec,ed.sub(ec,true));var ef=ec.zpp_inner;if(ef._validate!=null){ef._validate()}var ea=ec.zpp_inner.x;var ej=ec.zpp_inner;if(ej._validate!=null){ej._validate()}var eo=ec.zpp_inner.y;var eg=ed.zpp_inner;if(eg._validate!=null){eg._validate()}var ek=ed.zpp_inner.x;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}var ei=ed.zpp_inner.y;var en=0;var el=0;en=ea-ek;el=eo-ei;eh.zpp_inner.maxdist=Math.sqrt(en*en+el*el);if(ec.zpp_inner.weak){var em=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}if(ed.zpp_inner.weak){var eb=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return eh};ad.prototype.zpp_inner=null;ad.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};ad.prototype.get_origin=function(){return this.zpp_inner.origin};ad.prototype.set_origin=function(ej){var ed=this.zpp_inner.origin;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return this.zpp_inner.origin};ad.prototype.get_direction=function(){return this.zpp_inner.direction};ad.prototype.set_direction=function(ei){var ed=this.zpp_inner.direction;var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=ei.zpp_inner.x;var ef=ei.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ei.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ei.zpp_inner.weak){var ek=ei.zpp_inner;ei.zpp_inner.outer=null;ei.zpp_inner=null;ei.zpp_pool=au.poolVec2;au.poolVec2=ei;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}this.zpp_inner.zip_dir=true;return this.zpp_inner.direction};ad.prototype.get_maxDistance=function(){return this.zpp_inner.maxdist};ad.prototype.set_maxDistance=function(ea){this.zpp_inner.maxdist=ea;return this.zpp_inner.maxdist};ad.prototype.aabb=function(){return this.zpp_inner.rayAABB().wrapper()};ad.prototype.at=function(ea,ef){if(ef==null){ef=false}this.zpp_inner.validate_dir();var eg=this.zpp_inner.origin;var ek=eg.zpp_inner;if(ek._validate!=null){ek._validate()}var en=eg.zpp_inner.x+ea*this.zpp_inner.dirx;var ej=this.zpp_inner.origin;var eh=ej.zpp_inner;if(eh._validate!=null){eh._validate()}var em=ej.zpp_inner.y+ea*this.zpp_inner.diry;var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var el;if(bB.zpp_pool==null){el=new bB()}else{el=bB.zpp_pool;bB.zpp_pool=el.next;el.next=null}el.weak=false;el._immutable=false;el.x=en;el.y=em;ei.zpp_inner=el;ei.zpp_inner.outer=ei}else{var ec;var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}if(ei.zpp_inner.x==en){var ed=ei.zpp_inner;if(ed._validate!=null){ed._validate()}ec=ei.zpp_inner.y==em}else{ec=false}if(!ec){ei.zpp_inner.x=en;ei.zpp_inner.y=em;var eb=ei.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}ei.zpp_inner.weak=ef;return ei};ad.prototype.copy=function(){var ea=new ad(this.zpp_inner.origin,this.zpp_inner.direction);ea.zpp_inner.maxdist=this.zpp_inner.maxdist;return ea};Object.defineProperty(ad.prototype,"userData",{get:ad.prototype.get_userData});Object.defineProperty(ad.prototype,"origin",{get:ad.prototype.get_origin,set:ad.prototype.set_origin});Object.defineProperty(ad.prototype,"direction",{get:ad.prototype.get_direction,set:ad.prototype.set_direction});Object.defineProperty(ad.prototype,"maxDistance",{get:ad.prototype.get_maxDistance,set:ad.prototype.set_maxDistance});ad.prototype.__class__=ad;var df=nape.geom.RayResult=function(){this.zpp_inner=null};df.__name__=["nape","geom","RayResult"];df.prototype.zpp_inner=null;df.prototype.get_normal=function(){return this.zpp_inner.normal};df.prototype.get_distance=function(){return this.zpp_inner.toiDistance};df.prototype.get_inner=function(){return this.zpp_inner.inner};df.prototype.get_shape=function(){return this.zpp_inner.shape};df.prototype.dispose=function(){this.zpp_inner.free()};df.prototype.toString=function(){return"{ shape: "+ag.string(this.zpp_inner.shape)+" distance: "+this.zpp_inner.toiDistance+" ?inner: "+ag.string(this.zpp_inner.inner)+" }"};Object.defineProperty(df.prototype,"normal",{get:df.prototype.get_normal});Object.defineProperty(df.prototype,"distance",{get:df.prototype.get_distance});Object.defineProperty(df.prototype,"inner",{get:df.prototype.get_inner});Object.defineProperty(df.prototype,"shape",{get:df.prototype.get_shape});df.prototype.__class__=df;var du=nape.geom.RayResultIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};du.__name__=["nape","geom","RayResultIterator"];du.get=function(ec){var ea;if(du.zpp_pool==null){bw.internal=true;var ed=new du();bw.internal=false;ea=ed}else{var eb=du.zpp_pool;du.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};du.prototype.zpp_inner=null;du.prototype.zpp_i=null;du.prototype.zpp_critical=null;du.prototype.zpp_next=null;du.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=du.zpp_pool;du.zpp_pool=this;this.zpp_inner=null;return false}};du.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};du.prototype.__class__=du;var aa=nape.geom.RayResultList=function(){this.zpp_inner=null;this.zpp_inner=new bw();this.zpp_inner.outer=this};aa.__name__=["nape","geom","RayResultList"];aa.fromArray=function(ed){var ea=new aa();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};aa.prototype.zpp_inner=null;aa.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};aa.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea)};aa.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt};aa.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aa.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec)}else{this.zpp_inner.inner.add(ec)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};aa.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb};aa.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb};aa.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};aa.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec)}this.zpp_inner.invalidate()}return ea};aa.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};aa.prototype.empty=function(){return this.zpp_inner.inner.head==null};aa.prototype.iterator=function(){this.zpp_inner.valmod();return du.get(this)};aa.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new aa();this.zpp_inner.valmod();var ef=du.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=du.zpp_pool;du.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};aa.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=du.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=du.zpp_pool;du.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};aa.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=du.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=du.zpp_pool;du.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};aa.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=du.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=du.zpp_pool;du.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=du.zpp_pool;du.zpp_pool=ec;ec.zpp_inner=null;break}}return this};aa.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(aa.prototype,"length",{get:aa.prototype.get_length});aa.prototype.__class__=aa;var r=nape.geom.Vec2=function(ea,ec){if(ec==null){ec=0}if(ea==null){ea=0}this.zpp_pool=null;this.zpp_inner=null;var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ea;eb.y=ec;this.zpp_inner=eb;this.zpp_inner.outer=this};r.__name__=["nape","geom","Vec2"];r.weak=function(ea,eh){if(eh==null){eh=0}if(ea==null){ea=0}var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=true;return eb};r.get=function(ei,eg,eb){if(eb==null){eb=false}if(eg==null){eg=0}if(ei==null){ei=0}var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=ei;eh.y=eg;ee.zpp_inner=eh;ee.zpp_inner.outer=ee}else{var ea;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==ei){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}ea=ee.zpp_inner.y==eg}else{ea=false}if(!ea){ee.zpp_inner.x=ei;ee.zpp_inner.y=eg;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=eb;return ee};r.fromPolar=function(ea,eb,ed){if(ed==null){ed=false}var ek=ea*Math.cos(eb);var ei=ea*Math.sin(eb);var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ec;var ee=eg.zpp_inner;if(ee._validate!=null){ee._validate()}if(eg.zpp_inner.x==ek){var eh=eg.zpp_inner;if(eh._validate!=null){eh._validate()}ec=eg.zpp_inner.y==ei}else{ec=false}if(!ec){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var ef=eg.zpp_inner;if(ef._invalidate!=null){ef._invalidate(ef)}}}eg.zpp_inner.weak=ed;return eg};r.dsq=function(ek,ej){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}var ea=ek.zpp_inner.x;var eh=ek.zpp_inner;if(eh._validate!=null){eh._validate()}var eo=ek.zpp_inner.y;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=ej.zpp_inner.x;var ec=ej.zpp_inner;if(ec._validate!=null){ec._validate()}var eg=ej.zpp_inner.y;var en=0;var el=0;en=ea-ei;el=eo-eg;var ee=en*en+el*el;if(ek.zpp_inner.weak){var em=ek.zpp_inner;ek.zpp_inner.outer=null;ek.zpp_inner=null;ek.zpp_pool=au.poolVec2;au.poolVec2=ek;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}if(ej.zpp_inner.weak){var eb=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ee};r.distance=function(ek,ej){var ed=ek.zpp_inner;if(ed._validate!=null){ed._validate()}var ea=ek.zpp_inner.x;var eh=ek.zpp_inner;if(eh._validate!=null){eh._validate()}var eo=ek.zpp_inner.y;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=ej.zpp_inner.x;var ec=ej.zpp_inner;if(ec._validate!=null){ec._validate()}var eg=ej.zpp_inner.y;var en=0;var el=0;en=ea-ei;el=eo-eg;var ee=Math.sqrt(en*en+el*el);if(ek.zpp_inner.weak){var em=ek.zpp_inner;ek.zpp_inner.outer=null;ek.zpp_inner=null;ek.zpp_pool=au.poolVec2;au.poolVec2=ek;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em}if(ej.zpp_inner.weak){var eb=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ee};r.prototype.zpp_inner=null;r.prototype.zpp_pool=null;r.prototype.dispose=function(){var ea=this.zpp_inner;this.zpp_inner.outer=null;this.zpp_inner=null;var eb=this;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea};r.prototype.copy=function(ec){if(ec==null){ec=false}var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ek=this.zpp_inner.x;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=this.zpp_inner.y;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ea;var ef=eg.zpp_inner;if(ef._validate!=null){ef._validate()}if(eg.zpp_inner.x==ek){var ed=eg.zpp_inner;if(ed._validate!=null){ed._validate()}ea=eg.zpp_inner.y==ei}else{ea=false}if(!ea){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var eb=eg.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}eg.zpp_inner.weak=ec;return eg};r.prototype.get_x=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.x};r.prototype.set_x=function(ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}if(this.zpp_inner.x!=ea){this.zpp_inner.x=ea;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.x};r.prototype.get_y=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};r.prototype.set_y=function(ed){var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}if(this.zpp_inner.y!=ed){this.zpp_inner.y=ed;var eb=this.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};r.prototype.get_length=function(){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.x;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var ee=ea*this.zpp_inner.x;var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=this.zpp_inner.y;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return Math.sqrt(ee+ec*this.zpp_inner.y)};r.prototype.set_length=function(eb){var ev=this.zpp_inner;if(ev._validate!=null){ev._validate()}var eC=this.zpp_inner.x;var eB=this.zpp_inner;if(eB._validate!=null){eB._validate()}var ep=eC*this.zpp_inner.x;var eA=this.zpp_inner;if(eA._validate!=null){eA._validate()}var em=this.zpp_inner.y;var ez=this.zpp_inner;if(ez._validate!=null){ez._validate()}var ee=eb/Math.sqrt(ep+em*this.zpp_inner.y);var ea=this;var ey=ea.zpp_inner;if(ey._validate!=null){ey._validate()}var ed=ea.zpp_inner.x*ee;var ex=ea.zpp_inner;if(ex._validate!=null){ex._validate()}if(ea.zpp_inner.x!=ed){ea.zpp_inner.x=ed;var ew=ea.zpp_inner;if(ew._invalidate!=null){ew._invalidate(ew)}}var et=ea.zpp_inner;if(et._validate!=null){et._validate()}var eg=this;var er=eg.zpp_inner;if(er._validate!=null){er._validate()}var ec=eg.zpp_inner.y*ee;var eo=eg.zpp_inner;if(eo._validate!=null){eo._validate()}if(eg.zpp_inner.y!=ec){eg.zpp_inner.y=ec;var eu=eg.zpp_inner;if(eu._invalidate!=null){eu._invalidate(eu)}}var es=eg.zpp_inner;if(es._validate!=null){es._validate()}var eq=this.zpp_inner;if(eq._invalidate!=null){eq._invalidate(eq)}var en=this.zpp_inner;if(en._validate!=null){en._validate()}var ek=this.zpp_inner.x;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ei=ek*this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ef=this.zpp_inner.y;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}return Math.sqrt(ei+ef*this.zpp_inner.y)};r.prototype.lsq=function(){var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.x;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var ee=ea*this.zpp_inner.x;var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=this.zpp_inner.y;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return ee+ec*this.zpp_inner.y};r.prototype.set=function(ea){var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}var ej=ea.zpp_inner.x;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=ea.zpp_inner.y;var eb;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(this.zpp_inner.x==ej){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}eb=this.zpp_inner.y==ei}else{eb=false}if(!eb){this.zpp_inner.x=ej;this.zpp_inner.y=ei;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}var ef=this;if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}return ef};r.prototype.setxy=function(ea,ef){var eb;var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}if(this.zpp_inner.x==ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}eb=this.zpp_inner.y==ef}else{eb=false}if(!eb){this.zpp_inner.x=ea;this.zpp_inner.y=ef;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}return this};r.prototype.get_angle=function(){var eb;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ef=this.zpp_inner.x;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(ef==this.zpp_inner.y){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}eb=this.zpp_inner.x==0}else{eb=false}if(eb){return 0}else{var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=this.zpp_inner.y;var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return Math.atan2(ec,this.zpp_inner.x)}};r.prototype.set_angle=function(ev){var eo=this.zpp_inner;if(eo._validate!=null){eo._validate()}var ew=this.zpp_inner.x;var eu=this.zpp_inner;if(eu._validate!=null){eu._validate()}var ei=ew*this.zpp_inner.x;var et=this.zpp_inner;if(et._validate!=null){et._validate()}var eg=this.zpp_inner.y;var es=this.zpp_inner;if(es._validate!=null){es._validate()}var em=Math.sqrt(ei+eg*this.zpp_inner.y);var eb=em*Math.cos(ev);var ea=em*Math.sin(ev);var ef;var er=this.zpp_inner;if(er._validate!=null){er._validate()}if(this.zpp_inner.x==eb){var eq=this.zpp_inner;if(eq._validate!=null){eq._validate()}ef=this.zpp_inner.y==ea}else{ef=false}if(!ef){this.zpp_inner.x=eb;this.zpp_inner.y=ea;var ep=this.zpp_inner;if(ep._invalidate!=null){ep._invalidate(ep)}}var ee;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ed=this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}if(ed==this.zpp_inner.y){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}ee=this.zpp_inner.x==0}else{ee=false}if(ee){return 0}else{var en=this.zpp_inner;if(en._validate!=null){en._validate()}var ec=this.zpp_inner.y;var ek=this.zpp_inner;if(ek._validate!=null){ek._validate()}return Math.atan2(ec,this.zpp_inner.x)}};r.prototype.rotate=function(ed){if(ed%(Math.PI*2)!=0){var ec=Math.sin(ed);var eb=Math.cos(ed);var ea=eb*this.zpp_inner.x-ec*this.zpp_inner.y;this.zpp_inner.y=this.zpp_inner.x*ec+this.zpp_inner.y*eb;this.zpp_inner.x=ea;var ee=this.zpp_inner;if(ee._invalidate!=null){ee._invalidate(ee)}}return this};r.prototype.reflect=function(ea,ed){if(ed==null){ed=false}var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var en=this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var el=this.zpp_inner.y;var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var em;if(bB.zpp_pool==null){em=new bB()}else{em=bB.zpp_pool;bB.zpp_pool=em.next;em.next=null}em.weak=false;em._immutable=false;em.x=en;em.y=el;ei.zpp_inner=em;ei.zpp_inner.outer=ei}else{var eb;var eh=ei.zpp_inner;if(eh._validate!=null){eh._validate()}if(ei.zpp_inner.x==en){var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}eb=ei.zpp_inner.y==el}else{eb=false}if(!eb){ei.zpp_inner.x=en;ei.zpp_inner.y=el;var ec=ei.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}ei.zpp_inner.weak=true;var eg=ei.normalise();var ek=ea.sub(eg.muleq(2*eg.dot(ea)),ed);if(ea.zpp_inner.weak){var eo=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eo.outer!=null){eo.outer.zpp_inner=null;eo.outer=null}eo._isimmutable=null;eo._validate=null;eo._invalidate=null;eo.next=bB.zpp_pool;bB.zpp_pool=eo}return ek};r.prototype.normalise=function(){var em=this.zpp_inner;if(em._validate!=null){em._validate()}var eu=this.zpp_inner.x;var et=this.zpp_inner;if(et._validate!=null){et._validate()}var eg=eu*this.zpp_inner.x;var es=this.zpp_inner;if(es._validate!=null){es._validate()}var ee=this.zpp_inner.y;var er=this.zpp_inner;if(er._validate!=null){er._validate()}var eq=1/Math.sqrt(eg+ee*this.zpp_inner.y);var ea=this;var ep=ea.zpp_inner;if(ep._validate!=null){ep._validate()}var ec=ea.zpp_inner.x*eq;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}if(ea.zpp_inner.x!=ec){ea.zpp_inner.x=ec;var en=ea.zpp_inner;if(en._invalidate!=null){en._invalidate(en)}}var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}var ed=this;var ei=ed.zpp_inner;if(ei._validate!=null){ei._validate()}var eb=ed.zpp_inner.y*eq;var ef=ed.zpp_inner;if(ef._validate!=null){ef._validate()}if(ed.zpp_inner.y!=eb){ed.zpp_inner.y=eb;var el=ed.zpp_inner;if(el._invalidate!=null){el._invalidate(el)}}var ej=ed.zpp_inner;if(ej._validate!=null){ej._validate()}var eh=this.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}return this};r.prototype.unit=function(eb){if(eb==null){eb=false}var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var eq=this.zpp_inner.x;var ep=this.zpp_inner;if(ep._validate!=null){ep._validate()}var eg=eq*this.zpp_inner.x;var eo=this.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=this.zpp_inner.y;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var es=1/Math.sqrt(eg+ef*this.zpp_inner.y);var em=this.zpp_inner;if(em._validate!=null){em._validate()}var ed=this.zpp_inner.x*es;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ec=this.zpp_inner.y*es;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ea;if(bB.zpp_pool==null){ea=new bB()}else{ea=bB.zpp_pool;bB.zpp_pool=ea.next;ea.next=null}ea.weak=false;ea._immutable=false;ea.x=ed;ea.y=ec;er.zpp_inner=ea;er.zpp_inner.outer=er}else{var ee;var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}if(er.zpp_inner.x==ed){var ei=er.zpp_inner;if(ei._validate!=null){ei._validate()}ee=er.zpp_inner.y==ec}else{ee=false}if(!ee){er.zpp_inner.x=ed;er.zpp_inner.y=ec;var eh=er.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}er.zpp_inner.weak=eb;return er};r.prototype.add=function(ea,ed){if(ed==null){ed=false}var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=this.zpp_inner.x;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=ep+ea.zpp_inner.x;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var eh=this.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var ee=eh+ea.zpp_inner.y;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ec;if(bB.zpp_pool==null){ec=new bB()}else{ec=bB.zpp_pool;bB.zpp_pool=ec.next;ec.next=null}ec.weak=false;ec._immutable=false;ec.x=ef;ec.y=ee;er.zpp_inner=ec;er.zpp_inner.outer=er}else{var eg;var el=er.zpp_inner;if(el._validate!=null){el._validate()}if(er.zpp_inner.x==ef){var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}eg=er.zpp_inner.y==ee}else{eg=false}if(!eg){er.zpp_inner.x=ef;er.zpp_inner.y=ee;var ej=er.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}}er.zpp_inner.weak=ed;var eb=er;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}return eb};r.prototype.addMul=function(ea,es,ed){if(ed==null){ed=false}var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=this.zpp_inner.x;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=ep+ea.zpp_inner.x*es;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var eh=this.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var ee=eh+ea.zpp_inner.y*es;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ec;if(bB.zpp_pool==null){ec=new bB()}else{ec=bB.zpp_pool;bB.zpp_pool=ec.next;ec.next=null}ec.weak=false;ec._immutable=false;ec.x=ef;ec.y=ee;er.zpp_inner=ec;er.zpp_inner.outer=er}else{var eg;var el=er.zpp_inner;if(el._validate!=null){el._validate()}if(er.zpp_inner.x==ef){var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}eg=er.zpp_inner.y==ee}else{eg=false}if(!eg){er.zpp_inner.x=ef;er.zpp_inner.y=ee;var ej=er.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}}er.zpp_inner.weak=ed;var eb=er;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}return eb};r.prototype.sub=function(ea,ed){if(ed==null){ed=false}var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=this.zpp_inner.x;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ef=ep-ea.zpp_inner.x;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var eh=this.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var ee=eh-ea.zpp_inner.y;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var ec;if(bB.zpp_pool==null){ec=new bB()}else{ec=bB.zpp_pool;bB.zpp_pool=ec.next;ec.next=null}ec.weak=false;ec._immutable=false;ec.x=ef;ec.y=ee;er.zpp_inner=ec;er.zpp_inner.outer=er}else{var eg;var el=er.zpp_inner;if(el._validate!=null){el._validate()}if(er.zpp_inner.x==ef){var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}eg=er.zpp_inner.y==ee}else{eg=false}if(!eg){er.zpp_inner.x=ef;er.zpp_inner.y=ee;var ej=er.zpp_inner;if(ej._invalidate!=null){ej._invalidate(ej)}}}er.zpp_inner.weak=ed;var eb=er;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}return eb};r.prototype.mul=function(ea,ed){if(ed==null){ed=false}var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var el=this.zpp_inner.x*ea;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ej=this.zpp_inner.y*ea;var eh;if(au.poolVec2==null){eh=new r()}else{eh=au.poolVec2;au.poolVec2=eh.zpp_pool;eh.zpp_pool=null}if(eh.zpp_inner==null){var ek;if(bB.zpp_pool==null){ek=new bB()}else{ek=bB.zpp_pool;bB.zpp_pool=ek.next;ek.next=null}ek.weak=false;ek._immutable=false;ek.x=el;ek.y=ej;eh.zpp_inner=ek;eh.zpp_inner.outer=eh}else{var eb;var eg=eh.zpp_inner;if(eg._validate!=null){eg._validate()}if(eh.zpp_inner.x==el){var ee=eh.zpp_inner;if(ee._validate!=null){ee._validate()}eb=eh.zpp_inner.y==ej}else{eb=false}if(!eb){eh.zpp_inner.x=el;eh.zpp_inner.y=ej;var ec=eh.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}}eh.zpp_inner.weak=ed;return eh};r.prototype.addeq=function(ea){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}var em=ee+ea.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=ea.zpp_inner;if(ei._validate!=null){ei._validate()}var el=ec+ea.zpp_inner.y;var eb;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(this.zpp_inner.x==em){var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}eb=this.zpp_inner.y==el}else{eb=false}if(!eb){this.zpp_inner.x=em;this.zpp_inner.y=el;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}if(ea.zpp_inner.weak){var en=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en}return this};r.prototype.subeq=function(ea){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}var em=ee-ea.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=ea.zpp_inner;if(ei._validate!=null){ei._validate()}var el=ec-ea.zpp_inner.y;var eb;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}if(this.zpp_inner.x==em){var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}eb=this.zpp_inner.y==el}else{eb=false}if(!eb){this.zpp_inner.x=em;this.zpp_inner.y=el;var ed=this.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}if(ea.zpp_inner.weak){var en=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en}return this};r.prototype.muleq=function(ea){var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ei=this.zpp_inner.x*ea;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var eh=this.zpp_inner.y*ea;var eb;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}if(this.zpp_inner.x==ei){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}eb=this.zpp_inner.y==eh}else{eb=false}if(!eb){this.zpp_inner.x=ei;this.zpp_inner.y=eh;var ec=this.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}return this};r.prototype.dot=function(ea){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=this.zpp_inner.x;var ei=ea.zpp_inner;if(ei._validate!=null){ei._validate()}var ec=ed*ea.zpp_inner.x;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var eb=this.zpp_inner.y;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}var eg=ec+eb*ea.zpp_inner.y;if(ea.zpp_inner.weak){var ej=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej}return eg};r.prototype.cross=function(ea){var ee=ea.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=ea.zpp_inner.y;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var ec=ed*this.zpp_inner.x;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var eb=ea.zpp_inner.x;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}var eg=ec-eb*this.zpp_inner.y;if(ea.zpp_inner.weak){var ej=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej}return eg};r.prototype.perp=function(ec){if(ec==null){ec=false}var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ek=-this.zpp_inner.y;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=this.zpp_inner.x;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ea;var ef=eg.zpp_inner;if(ef._validate!=null){ef._validate()}if(eg.zpp_inner.x==ek){var ed=eg.zpp_inner;if(ed._validate!=null){ed._validate()}ea=eg.zpp_inner.y==ei}else{ea=false}if(!ea){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var eb=eg.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}eg.zpp_inner.weak=ec;return eg};r.prototype.toString=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.toString()};Object.defineProperty(r.prototype,"x",{get:r.prototype.get_x,set:r.prototype.set_x});Object.defineProperty(r.prototype,"y",{get:r.prototype.get_y,set:r.prototype.set_y});Object.defineProperty(r.prototype,"length",{get:r.prototype.get_length,set:r.prototype.set_length});Object.defineProperty(r.prototype,"angle",{get:r.prototype.get_angle,set:r.prototype.set_angle});r.prototype.__class__=r;var dW=nape.geom.Vec2Iterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};dW.__name__=["nape","geom","Vec2Iterator"];dW.get=function(ec){var ea;if(dW.zpp_pool==null){bF.internal=true;var ed=new dW();bF.internal=false;ea=ed}else{var eb=dW.zpp_pool;dW.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};dW.prototype.zpp_inner=null;dW.prototype.zpp_i=null;dW.prototype.zpp_critical=null;dW.prototype.zpp_next=null;dW.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var ea=this.zpp_inner.zpp_gl();this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=dW.zpp_pool;dW.zpp_pool=this;this.zpp_inner=null;return false}};dW.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};dW.prototype.__class__=dW;var aN=nape.geom.Vec2List=function(){this.zpp_inner=null;this.zpp_inner=new bF();this.zpp_inner.outer=this};aN.__name__=["nape","geom","Vec2List"];aN.fromArray=function(ed){var ea=new aN();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};aN.prototype.zpp_inner=null;aN.prototype.get_length=function(){return this.zpp_gl()};aN.prototype.zpp_gl=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};aN.prototype.zpp_vm=function(){this.zpp_inner.valmod()};aN.prototype.has=function(ea){this.zpp_vm();return this.zpp_inner.inner.has(ea.zpp_inner)};aN.prototype.at=function(ea){this.zpp_vm();if(this.zpp_inner.reverse_flag){ea=this.zpp_gl()-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}var ec=this.zpp_inner.at_ite.elt;if(ec.outer==null){ec.outer=new r();var eb=ec.outer.zpp_inner;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ec.outer.zpp_inner=ec}return ec.outer};aN.prototype.push=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(eb.zpp_inner)}else{if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};aN.prototype.unshift=function(eb){this.zpp_inner.modify_test();this.zpp_vm();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(eb):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,eb.zpp_inner)}else{this.zpp_inner.inner.add(eb.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(eb)}}return ea};aN.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;if(eb.outer==null){eb.outer=new r();var eg=eb.outer.zpp_inner;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg;eb.outer.zpp_inner=eb}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ee=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ee==null){eb=this.zpp_inner.inner.head.elt}else{eb=ee.next.elt}if(eb.outer==null){eb.outer=new r();var ed=eb.outer.zpp_inner;if(ed.outer!=null){ed.outer.zpp_inner=null;ed.outer=null}ed._isimmutable=null;ed._validate=null;ed._invalidate=null;ed.next=bB.zpp_pool;bB.zpp_pool=ed;eb.outer.zpp_inner=eb}var ef=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ef)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ee)}}this.zpp_inner.invalidate();if(eb.outer==null){eb.outer=new r();var ec=eb.outer.zpp_inner;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec;eb.outer.zpp_inner=eb}return eb.outer};aN.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_vm();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ee=this.zpp_gl()==1?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);if(ee==null){eb=this.zpp_inner.inner.head.elt}else{eb=ee.next.elt}if(eb.outer==null){eb.outer=new r();var eg=eb.outer.zpp_inner;if(eg.outer!=null){eg.outer.zpp_inner=null;eg.outer=null}eg._isimmutable=null;eg._validate=null;eg._invalidate=null;eg.next=bB.zpp_pool;bB.zpp_pool=eg;eb.outer.zpp_inner=eb}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ee)}}else{eb=this.zpp_inner.inner.head.elt;if(eb.outer==null){eb.outer=new r();var ed=eb.outer.zpp_inner;if(ed.outer!=null){ed.outer.zpp_inner=null;ed.outer=null}ed._isimmutable=null;ed._validate=null;ed._invalidate=null;ed.next=bB.zpp_pool;bB.zpp_pool=ed;eb.outer.zpp_inner=eb}var ef=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ef)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();if(eb.outer==null){eb.outer=new r();var ec=eb.outer.zpp_inner;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec;eb.outer.zpp_inner=eb}return eb.outer};aN.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};aN.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_vm();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};aN.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(!this.empty()){this.pop()}}else{while(!this.empty()){this.shift()}}};aN.prototype.empty=function(){return this.zpp_gl()==0};aN.prototype.iterator=function(){this.zpp_vm();return dW.get(this)};aN.prototype.copy=function(eq){if(eq==null){eq=false}var ek=new aN();var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ea=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ea){ed=true}else{ef.zpp_next=dW.zpp_pool;dW.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ee=ef.zpp_inner.at(ef.zpp_i++);var ec;if(eq){var ei=ee.zpp_inner;if(ei._validate!=null){ei._validate()}var ep=ee.zpp_inner.x;var el=ee.zpp_inner;if(el._validate!=null){el._validate()}var eo=ee.zpp_inner.y;var en;if(au.poolVec2==null){en=new r()}else{en=au.poolVec2;au.poolVec2=en.zpp_pool;en.zpp_pool=null}if(en.zpp_inner==null){var em;if(bB.zpp_pool==null){em=new bB()}else{em=bB.zpp_pool;bB.zpp_pool=em.next;em.next=null}em.weak=false;em._immutable=false;em.x=ep;em.y=eo;en.zpp_inner=em;en.zpp_inner.outer=en}else{var eb;var ej=en.zpp_inner;if(ej._validate!=null){ej._validate()}if(en.zpp_inner.x==ep){var eh=en.zpp_inner;if(eh._validate!=null){eh._validate()}eb=en.zpp_inner.y==eo}else{eb=false}if(!eb){en.zpp_inner.x=ep;en.zpp_inner.y=eo;var eg=en.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}}en.zpp_inner.weak=false;ec=en}else{ec=ee}ek.push(ec)}return ek};aN.prototype.merge=function(eb){var ee=eb.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=dW.zpp_pool;dW.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){this.add(ea)}}};aN.prototype.toString=function(){var eb="[";var ea=true;var ef=this.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ee=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=dW.zpp_pool;dW.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};aN.prototype.foreach=function(ea){var ec=this.iterator();while(true){ec.zpp_inner.zpp_inner.valmod();var ed=ec.zpp_inner.zpp_gl();ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=dW.zpp_pool;dW.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=dW.zpp_pool;dW.zpp_pool=ec;ec.zpp_inner=null;break}}return this};aN.prototype.filter=function(eb){var ec=0;while(ec<this.zpp_gl()){var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(aN.prototype,"length",{get:aN.prototype.get_length});aN.prototype.__class__=aN;var q=nape.geom.Vec3=function(ea,ef,ed){if(ed==null){ed=0}if(ef==null){ef=0}if(ea==null){ea=0}this.zpp_pool=null;this.zpp_inner=null;this.zpp_inner=new bA();this.zpp_inner.outer=this;this.zpp_inner.x=ea;var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.y=ef;var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.z=ed;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}};q.__name__=["nape","geom","Vec3"];q.get=function(ea,ed,ec){if(ec==null){ec=0}if(ed==null){ed=0}if(ea==null){ea=0}var eb;if(au.poolVec3==null){eb=new q()}else{eb=au.poolVec3;au.poolVec3=eb.zpp_pool;eb.zpp_pool=null}eb.setxyz(ea,ed,ec);eb.zpp_inner.immutable=false;eb.zpp_inner._validate=null;return eb};q.prototype.zpp_inner=null;q.prototype.zpp_pool=null;q.prototype.get_x=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.x};q.prototype.set_x=function(ea){this.zpp_inner.x=ea;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.x};q.prototype.get_y=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};q.prototype.set_y=function(eb){this.zpp_inner.y=eb;var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.y};q.prototype.get_z=function(){var ea=this.zpp_inner;if(ea._validate!=null){ea._validate()}return this.zpp_inner.z};q.prototype.set_z=function(ea){this.zpp_inner.z=ea;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this.zpp_inner.z};q.prototype.dispose=function(){var ea=this;ea.zpp_pool=au.poolVec3;au.poolVec3=ea};q.prototype.get_length=function(){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=this.zpp_inner;if(ek._validate!=null){ek._validate()}var ed=ee*this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var eb=ed+ec*this.zpp_inner.y;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.z;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}return Math.sqrt(eb+ea*this.zpp_inner.z)};q.prototype.set_length=function(eb){var ez=this.zpp_inner;if(ez._validate!=null){ez._validate()}var eG=this.zpp_inner.x;var eF=this.zpp_inner;if(eF._validate!=null){eF._validate()}var et=eG*this.zpp_inner.x;var eE=this.zpp_inner;if(eE._validate!=null){eE._validate()}var eq=this.zpp_inner.y;var eD=this.zpp_inner;if(eD._validate!=null){eD._validate()}var eo=et+eq*this.zpp_inner.y;var eC=this.zpp_inner;if(eC._validate!=null){eC._validate()}var em=this.zpp_inner.z;var eB=this.zpp_inner;if(eB._validate!=null){eB._validate()}var ef=eb/Math.sqrt(eo+em*this.zpp_inner.z);var ea=this;var eA=ea.zpp_inner;if(eA._validate!=null){eA._validate()}ea.zpp_inner.x=ea.zpp_inner.x*ef;var ex=ea.zpp_inner;if(ex._validate!=null){ex._validate()}var ek=this;var ev=ek.zpp_inner;if(ev._validate!=null){ev._validate()}ek.zpp_inner.y=ek.zpp_inner.y*ef;var es=ek.zpp_inner;if(es._validate!=null){es._validate()}var eh=this;var ey=eh.zpp_inner;if(ey._validate!=null){ey._validate()}eh.zpp_inner.z=eh.zpp_inner.z*ef;var ew=eh.zpp_inner;if(ew._validate!=null){ew._validate()}var eu=this.zpp_inner;if(eu._validate!=null){eu._validate()}var ej=this.zpp_inner.x;var er=this.zpp_inner;if(er._validate!=null){er._validate()}var eg=ej*this.zpp_inner.x;var ep=this.zpp_inner;if(ep._validate!=null){ep._validate()}var ee=this.zpp_inner.y;var en=this.zpp_inner;if(en._validate!=null){en._validate()}var ed=eg+ee*this.zpp_inner.y;var el=this.zpp_inner;if(el._validate!=null){el._validate()}var ec=this.zpp_inner.z;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}return Math.sqrt(ed+ec*this.zpp_inner.z)};q.prototype.lsq=function(){var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ee=this.zpp_inner.x;var ek=this.zpp_inner;if(ek._validate!=null){ek._validate()}var ed=ee*this.zpp_inner.x;var ej=this.zpp_inner;if(ej._validate!=null){ej._validate()}var ec=this.zpp_inner.y;var ei=this.zpp_inner;if(ei._validate!=null){ei._validate()}var eb=ed+ec*this.zpp_inner.y;var eg=this.zpp_inner;if(eg._validate!=null){eg._validate()}var ea=this.zpp_inner.z;var ef=this.zpp_inner;if(ef._validate!=null){ef._validate()}return eb+ea*this.zpp_inner.z};q.prototype.set=function(ea){var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}var eb=ea.zpp_inner.x;var ee=ea.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=ea.zpp_inner.y;var ec=ea.zpp_inner;if(ec._validate!=null){ec._validate()}return this.setxyz(eb,ed,ea.zpp_inner.z)};q.prototype.setxyz=function(ea,ef,ed){this.zpp_inner.x=ea;var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}this.zpp_inner.y=ef;var ec=this.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.z=ed;var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return this};q.prototype.xy=function(ec){if(ec==null){ec=false}var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ek=this.zpp_inner.x;var eh=this.zpp_inner;if(eh._validate!=null){eh._validate()}var ei=this.zpp_inner.y;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var ea;var ef=eg.zpp_inner;if(ef._validate!=null){ef._validate()}if(eg.zpp_inner.x==ek){var ed=eg.zpp_inner;if(ed._validate!=null){ed._validate()}ea=eg.zpp_inner.y==ei}else{ea=false}if(!ea){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var eb=eg.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}}eg.zpp_inner.weak=ec;return eg};q.prototype.toString=function(){var ee=this.zpp_inner;if(ee._validate!=null){ee._validate()}var ea="{ x: "+this.zpp_inner.x+" y: ";var ed=this.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=ea+this.zpp_inner.y+" z: ";var eb=this.zpp_inner;if(eb._validate!=null){eb._validate()}return ec+this.zpp_inner.z+" }"};Object.defineProperty(q.prototype,"x",{get:q.prototype.get_x,set:q.prototype.set_x});Object.defineProperty(q.prototype,"y",{get:q.prototype.get_y,set:q.prototype.set_y});Object.defineProperty(q.prototype,"z",{get:q.prototype.get_z,set:q.prototype.set_z});Object.defineProperty(q.prototype,"length",{get:q.prototype.get_length,set:q.prototype.set_length});q.prototype.__class__=q;var X=nape.geom.Winding=function(){};X.__name__=["nape","geom","Winding"];X.UNDEFINED=null;X.get_UNDEFINED=function(){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}return br.Winding_UNDEFINED};X.CLOCKWISE=null;X.get_CLOCKWISE=function(){if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}return br.Winding_CLOCKWISE};X.ANTICLOCKWISE=null;X.get_ANTICLOCKWISE=function(){if(br.Winding_ANTICLOCKWISE==null){br.internal=true;br.Winding_ANTICLOCKWISE=new X();br.internal=false}return br.Winding_ANTICLOCKWISE};X.prototype.toString=function(){if(br.Winding_UNDEFINED==null){br.internal=true;br.Winding_UNDEFINED=new X();br.internal=false}if(this==br.Winding_UNDEFINED){return"UNDEFINED"}else{if(br.Winding_CLOCKWISE==null){br.internal=true;br.Winding_CLOCKWISE=new X();br.internal=false}if(this==br.Winding_CLOCKWISE){return"CLOCKWISE"}else{if(br.Winding_ANTICLOCKWISE==null){br.internal=true;br.Winding_ANTICLOCKWISE=new X();br.internal=false}if(this==br.Winding_ANTICLOCKWISE){return"ANTICLOCKWISE"}else{return""}}}};Object.defineProperty(X,"UNDEFINED",{get:X.get_UNDEFINED});Object.defineProperty(X,"CLOCKWISE",{get:X.get_CLOCKWISE});Object.defineProperty(X,"ANTICLOCKWISE",{get:X.get_ANTICLOCKWISE});X.prototype.__class__=X;var a6=nape.phys.Interactor=function(){this.zpp_inner_i=null};a6.__name__=["nape","phys","Interactor"];a6.prototype.zpp_inner_i=null;a6.prototype.get_id=function(){return this.zpp_inner_i.id};a6.prototype.get_userData=function(){if(this.zpp_inner_i.userData==null){this.zpp_inner_i.userData={}}return this.zpp_inner_i.userData};a6.prototype.isShape=function(){return this.zpp_inner_i.ishape!=null};a6.prototype.isBody=function(){return this.zpp_inner_i.ibody!=null};a6.prototype.isCompound=function(){return this.zpp_inner_i.icompound!=null};a6.prototype.get_castShape=function(){if(this.zpp_inner_i.ishape!=null){return this.zpp_inner_i.ishape.outer}else{return null}};a6.prototype.get_castBody=function(){if(this.zpp_inner_i.ibody!=null){return this.zpp_inner_i.ibody.outer}else{return null}};a6.prototype.get_castCompound=function(){if(this.zpp_inner_i.icompound!=null){return this.zpp_inner_i.icompound.outer}else{return null}};a6.prototype.get_group=function(){if(this.zpp_inner_i.group==null){return null}else{return this.zpp_inner_i.group.outer}};a6.prototype.set_group=function(ea){this.zpp_inner_i.immutable_midstep("Interactor::group");this.zpp_inner_i.setGroup(ea==null?null:ea.zpp_inner);if(this.zpp_inner_i.group==null){return null}else{return this.zpp_inner_i.group.outer}};a6.prototype.get_cbTypes=function(){if(this.zpp_inner_i.wrap_cbTypes==null){this.zpp_inner_i.setupcbTypes()}return this.zpp_inner_i.wrap_cbTypes};a6.prototype.toString=function(){return""};Object.defineProperty(a6.prototype,"id",{get:a6.prototype.get_id});Object.defineProperty(a6.prototype,"userData",{get:a6.prototype.get_userData});Object.defineProperty(a6.prototype,"castShape",{get:a6.prototype.get_castShape});Object.defineProperty(a6.prototype,"castBody",{get:a6.prototype.get_castBody});Object.defineProperty(a6.prototype,"castCompound",{get:a6.prototype.get_castCompound});Object.defineProperty(a6.prototype,"group",{get:a6.prototype.get_group,set:a6.prototype.set_group});Object.defineProperty(a6.prototype,"cbTypes",{get:a6.prototype.get_cbTypes});a6.prototype.__class__=a6;var at=nape.phys.Body=function(ee,ea){this.debugDraw=true;this.zpp_inner=null;a6.call(this);this.zpp_inner=new cj();this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;if(ea!=null){var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}this.zpp_inner.posx=ea.zpp_inner.x;var ef=ea.zpp_inner;if(ef._validate!=null){ef._validate()}this.zpp_inner.posy=ea.zpp_inner.y}else{this.zpp_inner.posx=0;this.zpp_inner.posy=0}var ec;if(ee==null){if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}ec=br.BodyType_DYNAMIC}else{ec=ee}this.zpp_inner.immutable_midstep("Body::type");if(cj.types[this.zpp_inner.type]!=ec){var ed;if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}if(ec==br.BodyType_DYNAMIC){ed=2}else{if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}if(ec==br.BodyType_KINEMATIC){ed=3}else{ed=1}}if(ed==1&&this.zpp_inner.space!=null){this.zpp_inner.velx=0;this.zpp_inner.vely=0;this.zpp_inner.angvel=0}this.zpp_inner.invalidate_type();if(this.zpp_inner.space!=null){this.zpp_inner.space.transmitType(this.zpp_inner,ed)}else{this.zpp_inner.type=ed}}if(ea!=null){if(ea.zpp_inner.weak){var eb=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}}this.zpp_inner_i.insert_cbtype(db.ANY_BODY.zpp_inner)};at.__name__=["nape","phys","Body"];at.__super__=a6;at.prototype=Object.create(a6.prototype);at.prototype.zpp_inner=null;at.prototype.debugDraw=null;at.prototype.get_type=function(){return cj.types[this.zpp_inner.type]};at.prototype.set_type=function(eb){this.zpp_inner.immutable_midstep("Body::type");if(cj.types[this.zpp_inner.type]!=eb){var ea;if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}if(eb==br.BodyType_DYNAMIC){ea=2}else{if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}if(eb==br.BodyType_KINEMATIC){ea=3}else{ea=1}}if(ea==1&&this.zpp_inner.space!=null){this.zpp_inner.velx=0;this.zpp_inner.vely=0;this.zpp_inner.angvel=0}this.zpp_inner.invalidate_type();if(this.zpp_inner.space!=null){this.zpp_inner.space.transmitType(this.zpp_inner,ea)}else{this.zpp_inner.type=ea}}return cj.types[this.zpp_inner.type]};at.prototype.get_isBullet=function(){return this.zpp_inner.bulletEnabled};at.prototype.set_isBullet=function(ea){this.zpp_inner.bulletEnabled=ea;return this.zpp_inner.bulletEnabled};at.prototype.get_disableCCD=function(){return this.zpp_inner.disableCCD};at.prototype.set_disableCCD=function(ea){this.zpp_inner.disableCCD=ea;return this.zpp_inner.disableCCD};at.prototype.integrate=function(eg){this.zpp_inner.immutable_midstep("Body::space");if(eg==0){return this}var ek=this.zpp_inner;ek.sweepTime=0;ek.sweep_angvel=ek.angvel;var ej=eg-ek.sweepTime;if(ej!=0){ek.sweepTime=eg;ek.posx+=ek.velx*ej;ek.posy+=ek.vely*ej;if(ek.angvel!=0){var ed=ek.sweep_angvel*ej;ek.rot+=ed;if(ed*ed>0.0001){ek.axisx=Math.sin(ek.rot);ek.axisy=Math.cos(ek.rot)}else{var ea=ed*ed;var eb=1-0.5*ea;var ee=1-ea*ea/8;var ef=(eb*ek.axisx+ed*ek.axisy)*ee;ek.axisy=(eb*ek.axisy-ed*ek.axisx)*ee;ek.axisx=ef}}}var ec=ek.shapes.head;while(ec!=null){var el=ec.elt;if(el.type==1){el.polygon.invalidate_gverts();el.polygon.invalidate_gaxi()}el.invalidate_worldCOM();ec=ec.next}ek.zip_worldCOM=true;ek.zip_axis=true;var eh=ek.shapes.head;while(eh!=null){var ei=eh.elt;if(ei.type==1){ei.polygon.invalidate_gverts();ei.polygon.invalidate_gaxi()}ei.invalidate_worldCOM();eh=eh.next}ek.zip_worldCOM=true;ek.sweepTime=0;return this};at.prototype.isStatic=function(){return this.zpp_inner.type==1};at.prototype.isDynamic=function(){return this.zpp_inner.type==2};at.prototype.isKinematic=function(){return this.zpp_inner.type==3};at.prototype.get_shapes=function(){return this.zpp_inner.wrap_shapes};at.prototype.get_compound=function(){if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};at.prototype.set_compound=function(ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=null){(this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_bodies;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};at.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};at.prototype.set_space=function(ea){this.zpp_inner.immutable_midstep("Body::space");if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){this.zpp_inner.component.woken=false}if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){(this.zpp_inner.space==null?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_bodies;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};at.prototype.get_arbiters=function(){if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}return this.zpp_inner.wrap_arbiters};at.prototype.get_isSleeping=function(){return this.zpp_inner.component.sleeping};at.prototype.get_constraints=function(){if(this.zpp_inner.wrap_constraints==null){this.zpp_inner.wrap_constraints=aZ.get(this.zpp_inner.constraints,true)}return this.zpp_inner.wrap_constraints};at.prototype.copy=function(){return this.zpp_inner.copy()};at.prototype.get_position=function(){if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}return this.zpp_inner.wrap_pos};at.prototype.set_position=function(ec){if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var ee=this.zpp_inner.wrap_pos;var eh=ec.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ec.zpp_inner.x;var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ec.zpp_inner.y;var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}ea=ee.zpp_inner.y==ei}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ec.zpp_inner.weak){var ek=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}return this.zpp_inner.wrap_pos};at.prototype.get_velocity=function(){if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}return this.zpp_inner.wrap_vel};at.prototype.set_velocity=function(ea){if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}var ee=this.zpp_inner.wrap_vel;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}return this.zpp_inner.wrap_vel};at.prototype.setVelocityFromTarget=function(ee,ec,el){var eq=1/el;if(this.zpp_inner.wrap_vel==null){this.zpp_inner.setupVelocity()}var ej=this.zpp_inner.wrap_vel;if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var ed=ee.sub(this.zpp_inner.wrap_pos,true).muleq(eq);var em=ed.zpp_inner;if(em._validate!=null){em._validate()}var eo=ed.zpp_inner.x;var ek=ed.zpp_inner;if(ek._validate!=null){ek._validate()}var en=ed.zpp_inner.y;var ef;var ei=ej.zpp_inner;if(ei._validate!=null){ei._validate()}if(ej.zpp_inner.x==eo){var eh=ej.zpp_inner;if(eh._validate!=null){eh._validate()}ef=ej.zpp_inner.y==en}else{ef=false}if(!ef){ej.zpp_inner.x=eo;ej.zpp_inner.y=en;var eg=ej.zpp_inner;if(eg._invalidate!=null){eg._invalidate(eg)}}if(ed.zpp_inner.weak){var ep=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}var eb=(ec-this.zpp_inner.rot)*eq;if(this.zpp_inner.angvel!=eb){this.zpp_inner.angvel=eb;this.zpp_inner.wake()}if(ee.zpp_inner.weak){var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};at.prototype.get_kinematicVel=function(){if(this.zpp_inner.wrap_kinvel==null){this.zpp_inner.setupkinvel()}return this.zpp_inner.wrap_kinvel};at.prototype.set_kinematicVel=function(eh){if(this.zpp_inner.wrap_kinvel==null){this.zpp_inner.setupkinvel()}var ed=this.zpp_inner.wrap_kinvel;var eg=eh.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=eh.zpp_inner.x;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}var ei=eh.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ej){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==ei}else{ea=false}if(!ea){ed.zpp_inner.x=ej;ed.zpp_inner.y=ei;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(eh.zpp_inner.weak){var ek=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_kinvel==null){this.zpp_inner.setupkinvel()}return this.zpp_inner.wrap_kinvel};at.prototype.get_surfaceVel=function(){if(this.zpp_inner.wrap_svel==null){this.zpp_inner.setupsvel()}return this.zpp_inner.wrap_svel};at.prototype.set_surfaceVel=function(ed){if(this.zpp_inner.wrap_svel==null){this.zpp_inner.setupsvel()}var ee=this.zpp_inner.wrap_svel;var eh=ed.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ed.zpp_inner.x;var eg=ed.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ed.zpp_inner.y;var ea;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ee.zpp_inner.y==ei}else{ea=false}if(!ea){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var eb=ee.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ed.zpp_inner.weak){var ek=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_svel==null){this.zpp_inner.setupsvel()}return this.zpp_inner.wrap_svel};at.prototype.get_force=function(){if(this.zpp_inner.wrap_force==null){this.zpp_inner.setupForce()}return this.zpp_inner.wrap_force};at.prototype.set_force=function(ea){if(this.zpp_inner.wrap_force==null){this.zpp_inner.setupForce()}var ee=this.zpp_inner.wrap_force;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_force==null){this.zpp_inner.setupForce()}return this.zpp_inner.wrap_force};at.prototype.get_constraintVelocity=function(){if(this.zpp_inner.wrapcvel==null){this.zpp_inner.setup_cvel()}return this.zpp_inner.wrapcvel};at.prototype.get_rotation=function(){return this.zpp_inner.rot};at.prototype.set_rotation=function(eb){this.zpp_inner.immutable_midstep("Body::rotation");if(this.zpp_inner.rot!=eb){this.zpp_inner.rot=eb;var ed=this.zpp_inner;ed.zip_axis=true;var ea=ed.shapes.head;while(ea!=null){var ec=ea.elt;if(ec.type==1){ec.polygon.invalidate_gverts();ec.polygon.invalidate_gaxi()}ec.invalidate_worldCOM();ea=ea.next}ed.zip_worldCOM=true;this.zpp_inner.wake()}return this.zpp_inner.rot};at.prototype.get_angularVel=function(){return this.zpp_inner.angvel};at.prototype.set_angularVel=function(ea){if(this.zpp_inner.angvel!=ea){this.zpp_inner.angvel=ea;this.zpp_inner.wake()}return this.zpp_inner.angvel};at.prototype.get_kinAngVel=function(){return this.zpp_inner.kinangvel};at.prototype.set_kinAngVel=function(ea){if(this.zpp_inner.kinangvel!=ea){this.zpp_inner.kinangvel=ea;this.zpp_inner.wake()}return this.zpp_inner.kinangvel};at.prototype.get_torque=function(){return this.zpp_inner.torque};at.prototype.set_torque=function(ea){if(this.zpp_inner.torque!=ea){this.zpp_inner.torque=ea;this.zpp_inner.wake()}return this.zpp_inner.torque};at.prototype.get_bounds=function(){return this.zpp_inner.aabb.wrapper()};at.prototype.get_allowMovement=function(){return !this.zpp_inner.nomove};at.prototype.set_allowMovement=function(ea){this.zpp_inner.immutable_midstep("Body::"+(ea==null?"null":""+ea));if(!this.zpp_inner.nomove!=ea){this.zpp_inner.nomove=!ea;this.zpp_inner.invalidate_mass()}return !this.zpp_inner.nomove};at.prototype.get_allowRotation=function(){return !this.zpp_inner.norotate};at.prototype.set_allowRotation=function(ea){this.zpp_inner.immutable_midstep("Body::"+(ea==null?"null":""+ea));if(!this.zpp_inner.norotate!=ea){this.zpp_inner.norotate=!ea;this.zpp_inner.invalidate_inertia()}return !this.zpp_inner.norotate};at.prototype.get_massMode=function(){if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}var ea=br.MassMode_DEFAULT;if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}return[ea,br.MassMode_FIXED][this.zpp_inner.massMode]};at.prototype.set_massMode=function(ea){this.zpp_inner.immutable_midstep("Body::massMode");var eb;if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}if(ea==br.MassMode_DEFAULT){eb=0}else{eb=1}this.zpp_inner.massMode=eb;this.zpp_inner.invalidate_mass();if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}var ec=br.MassMode_DEFAULT;if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}return[ec,br.MassMode_FIXED][this.zpp_inner.massMode]};at.prototype.get_constraintMass=function(){if(!this.zpp_inner.world){this.zpp_inner.validate_mass()}return this.zpp_inner.smass};at.prototype.get_mass=function(){this.zpp_inner.validate_mass();return this.zpp_inner.cmass};at.prototype.set_mass=function(ea){this.zpp_inner.immutable_midstep("Body::mass");this.zpp_inner.massMode=1;this.zpp_inner.cmass=ea;this.zpp_inner.invalidate_mass();this.zpp_inner.validate_mass();return this.zpp_inner.cmass};at.prototype.get_gravMassMode=function(){if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}var ea=br.GravMassMode_DEFAULT;if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}var eb=br.GravMassMode_FIXED;if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}return[ea,eb,br.GravMassMode_SCALED][this.zpp_inner.massMode]};at.prototype.set_gravMassMode=function(ea){this.zpp_inner.immutable_midstep("Body::gravMassMode");var eb;if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}if(ea==br.GravMassMode_SCALED){eb=2}else{if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}if(ea==br.GravMassMode_DEFAULT){eb=0}else{eb=1}}this.zpp_inner.gravMassMode=eb;this.zpp_inner.invalidate_gravMass();if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}var ed=br.GravMassMode_DEFAULT;if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}var ec=br.GravMassMode_FIXED;if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}return[ed,ec,br.GravMassMode_SCALED][this.zpp_inner.massMode]};at.prototype.get_gravMass=function(){this.zpp_inner.validate_gravMass();return this.zpp_inner.gravMass};at.prototype.set_gravMass=function(ea){this.zpp_inner.immutable_midstep("Body::gravMass");this.zpp_inner.gravMassMode=1;this.zpp_inner.gravMass=ea;this.zpp_inner.invalidate_gravMass();this.zpp_inner.validate_gravMass();return this.zpp_inner.gravMass};at.prototype.get_gravMassScale=function(){this.zpp_inner.validate_gravMassScale();return this.zpp_inner.gravMassScale};at.prototype.set_gravMassScale=function(ea){this.zpp_inner.immutable_midstep("Body::gravMassScale");this.zpp_inner.gravMassMode=2;this.zpp_inner.gravMassScale=ea;this.zpp_inner.invalidate_gravMassScale();this.zpp_inner.validate_gravMassScale();return this.zpp_inner.gravMassScale};at.prototype.get_inertiaMode=function(){if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}var ea=br.InertiaMode_DEFAULT;if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}return[ea,br.InertiaMode_FIXED][this.zpp_inner.inertiaMode]};at.prototype.set_inertiaMode=function(ec){this.zpp_inner.immutable_midstep("Body::inertiaMode");var ea;if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}if(ec==br.InertiaMode_FIXED){ea=1}else{ea=0}this.zpp_inner.inertiaMode=ea;this.zpp_inner.invalidate_inertia();if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}var eb=br.InertiaMode_DEFAULT;if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}return[eb,br.InertiaMode_FIXED][this.zpp_inner.inertiaMode]};at.prototype.get_constraintInertia=function(){if(!this.zpp_inner.world){this.zpp_inner.validate_inertia()}return this.zpp_inner.sinertia};at.prototype.get_inertia=function(){this.zpp_inner.validate_inertia();return this.zpp_inner.cinertia};at.prototype.set_inertia=function(ea){this.zpp_inner.immutable_midstep("Body::inertia");this.zpp_inner.inertiaMode=1;this.zpp_inner.cinertia=ea;this.zpp_inner.invalidate_inertia();this.zpp_inner.validate_inertia();return this.zpp_inner.cinertia};at.prototype.connectedBodies=function(eb,ea){if(eb==null){eb=-1}return this.zpp_inner.connectedBodies(eb,ea)};at.prototype.interactingBodies=function(eb,ed,ea){if(ed==null){ed=-1}var ec;if(eb==null){ec=j.COL|j.SENSOR|j.FLUID}else{if(br.InteractionType_COLLISION==null){br.internal=true;br.InteractionType_COLLISION=new b3();br.internal=false}if(eb==br.InteractionType_COLLISION){ec=j.COL}else{if(br.InteractionType_SENSOR==null){br.internal=true;br.InteractionType_SENSOR=new b3();br.internal=false}if(eb==br.InteractionType_SENSOR){ec=j.SENSOR}else{ec=j.FLUID}}}return this.zpp_inner.interactingBodies(ec,ed,ea)};at.prototype.crushFactor=function(){var ec=0;var ek;if(au.poolVec2==null){ek=new r()}else{ek=au.poolVec2;au.poolVec2=ek.zpp_pool;ek.zpp_pool=null}if(ek.zpp_inner==null){var es;if(bB.zpp_pool==null){es=new bB()}else{es=bB.zpp_pool;bB.zpp_pool=es.next;es.next=null}es.weak=false;es._immutable=false;es.x=0;es.y=0;ek.zpp_inner=es;ek.zpp_inner.outer=ek}else{var ey;var eb=ek.zpp_inner;if(eb._validate!=null){eb._validate()}if(ek.zpp_inner.x==0){var ew=ek.zpp_inner;if(ew._validate!=null){ew._validate()}ey=ek.zpp_inner.y==0}else{ey=false}if(!ey){ek.zpp_inner.x=0;ek.zpp_inner.y=0;var ev=ek.zpp_inner;if(ev._invalidate!=null){ev._invalidate(ev)}}}ek.zpp_inner.weak=false;var eE=ek;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var eQ=this.zpp_inner.wrap_arbiters.iterator();while(true){eQ.zpp_inner.zpp_inner.valmod();var ed=eQ.zpp_inner.zpp_gl();eQ.zpp_critical=true;var eT;if(eQ.zpp_i<ed){eT=true}else{eQ.zpp_next=d0.zpp_pool;d0.zpp_pool=eQ;eQ.zpp_inner=null;eT=false}if(!eT){break}eQ.zpp_critical=false;var ee=eQ.zpp_inner.at(eQ.zpp_i++).totalImpulse(this);var ea=ee.xy();eE.addeq(ea);var eu=ea.zpp_inner;if(eu._validate!=null){eu._validate()}var eS=ea.zpp_inner.x;var et=ea.zpp_inner;if(et._validate!=null){et._validate()}var eP=eS*ea.zpp_inner.x;var er=ea.zpp_inner;if(er._validate!=null){er._validate()}var eN=ea.zpp_inner.y;var eq=ea.zpp_inner;if(eq._validate!=null){eq._validate()}ec+=Math.sqrt(eP+eN*ea.zpp_inner.y);var ei=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ei.outer!=null){ei.outer.zpp_inner=null;ei.outer=null}ei._isimmutable=null;ei._validate=null;ei._invalidate=null;ei.next=bB.zpp_pool;bB.zpp_pool=ei;ee.dispose()}if(this.zpp_inner.wrap_constraints==null){this.zpp_inner.wrap_constraints=aZ.get(this.zpp_inner.constraints,true)}var eo=this.zpp_inner.wrap_constraints;eo.zpp_inner.valmod();var eF=bO.get(eo);while(true){eF.zpp_inner.zpp_inner.valmod();var em=eF.zpp_inner;em.zpp_inner.valmod();if(em.zpp_inner.zip_length){em.zpp_inner.zip_length=false;em.zpp_inner.user_length=em.zpp_inner.inner.length}var en=em.zpp_inner.user_length;eF.zpp_critical=true;var eL;if(eF.zpp_i<en){eL=true}else{eF.zpp_next=bO.zpp_pool;bO.zpp_pool=eF;eF.zpp_inner=null;eL=false}if(!eL){break}eF.zpp_critical=false;var eJ=eF.zpp_inner.at(eF.zpp_i++).bodyImpulse(this);var ef=eJ.xy();eE.addeq(ef);var el=ef.zpp_inner;if(el._validate!=null){el._validate()}var eI=ef.zpp_inner.x;var eR=ef.zpp_inner;if(eR._validate!=null){eR._validate()}var eG=eI*ef.zpp_inner.x;var eO=ef.zpp_inner;if(eO._validate!=null){eO._validate()}var eC=ef.zpp_inner.y;var eM=ef.zpp_inner;if(eM._validate!=null){eM._validate()}ec+=Math.sqrt(eG+eC*ef.zpp_inner.y);var ez=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(ez.outer!=null){ez.outer.zpp_inner=null;ez.outer=null}ez._isimmutable=null;ez._validate=null;ez._invalidate=null;ez.next=bB.zpp_pool;bB.zpp_pool=ez;eJ.dispose()}var eK=eE.zpp_inner;if(eK._validate!=null){eK._validate()}var eA=eE.zpp_inner.x;var eH=eE.zpp_inner;if(eH._validate!=null){eH._validate()}var ej=eA*eE.zpp_inner.x;var eD=eE.zpp_inner;if(eD._validate!=null){eD._validate()}var eh=eE.zpp_inner.y;var eB=eE.zpp_inner;if(eB._validate!=null){eB._validate()}var eg=ec-Math.sqrt(ej+eh*eE.zpp_inner.y);this.zpp_inner.validate_mass();var ep=eg/(this.zpp_inner.cmass*(this.zpp_inner.space==null?null:this.zpp_inner.space.outer).zpp_inner.pre_dt);var ex=eE.zpp_inner;eE.zpp_inner.outer=null;eE.zpp_inner=null;eE.zpp_pool=au.poolVec2;au.poolVec2=eE;if(ex.outer!=null){ex.outer.zpp_inner=null;ex.outer=null}ex._isimmutable=null;ex._validate=null;ex._invalidate=null;ex.next=bB.zpp_pool;bB.zpp_pool=ex;return ep};at.prototype.localPointToWorld=function(ej,eb){if(eb==null){eb=false}var el=this.zpp_inner;if(el.zip_axis){el.zip_axis=false;el.axisx=Math.sin(el.rot);el.axisy=Math.cos(el.rot)}var ef=0;var ee=0;var eq=ej.zpp_inner;if(eq._validate!=null){eq._validate()}var er=this.zpp_inner.axisy*ej.zpp_inner.x;var ep=ej.zpp_inner;if(ep._validate!=null){ep._validate()}ef=er-this.zpp_inner.axisx*ej.zpp_inner.y;var eo=ej.zpp_inner;if(eo._validate!=null){eo._validate()}var eh=ej.zpp_inner.x*this.zpp_inner.axisx;var en=ej.zpp_inner;if(en._validate!=null){en._validate()}ee=eh+ej.zpp_inner.y*this.zpp_inner.axisy;if(ej.zpp_inner.weak){var es=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(es.outer!=null){es.outer.zpp_inner=null;es.outer=null}es._isimmutable=null;es._validate=null;es._invalidate=null;es.next=bB.zpp_pool;bB.zpp_pool=es}var ed=ef+this.zpp_inner.posx;var ec=ee+this.zpp_inner.posy;var et;if(au.poolVec2==null){et=new r()}else{et=au.poolVec2;au.poolVec2=et.zpp_pool;et.zpp_pool=null}if(et.zpp_inner==null){var ea;if(bB.zpp_pool==null){ea=new bB()}else{ea=bB.zpp_pool;bB.zpp_pool=ea.next;ea.next=null}ea.weak=false;ea._immutable=false;ea.x=ed;ea.y=ec;et.zpp_inner=ea;et.zpp_inner.outer=et}else{var eg;var em=et.zpp_inner;if(em._validate!=null){em._validate()}if(et.zpp_inner.x==ed){var ek=et.zpp_inner;if(ek._validate!=null){ek._validate()}eg=et.zpp_inner.y==ec}else{eg=false}if(!eg){et.zpp_inner.x=ed;et.zpp_inner.y=ec;var ei=et.zpp_inner;if(ei._invalidate!=null){ei._invalidate(ei)}}}et.zpp_inner.weak=eb;return et};at.prototype.worldPointToLocal=function(eo,ef){if(ef==null){ef=false}var eh=this.zpp_inner;if(eh.zip_axis){eh.zip_axis=false;eh.axisx=Math.sin(eh.rot);eh.axisy=Math.cos(eh.rot)}var eb=0;var ea=0;var em=0;var ek=0;var el=eo.zpp_inner;if(el._validate!=null){el._validate()}em=eo.zpp_inner.x-this.zpp_inner.posx;var ej=eo.zpp_inner;if(ej._validate!=null){ej._validate()}ek=eo.zpp_inner.y-this.zpp_inner.posy;eb=em*this.zpp_inner.axisy+ek*this.zpp_inner.axisx;ea=ek*this.zpp_inner.axisy-em*this.zpp_inner.axisx;if(eo.zpp_inner.weak){var ep=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(ep.outer!=null){ep.outer.zpp_inner=null;ep.outer=null}ep._isimmutable=null;ep._validate=null;ep._invalidate=null;ep.next=bB.zpp_pool;bB.zpp_pool=ep}var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var en;if(bB.zpp_pool==null){en=new bB()}else{en=bB.zpp_pool;bB.zpp_pool=en.next;en.next=null}en.weak=false;en._immutable=false;en.x=eb;en.y=ea;ei.zpp_inner=en;ei.zpp_inner.outer=ei}else{var ec;var eg=ei.zpp_inner;if(eg._validate!=null){eg._validate()}if(ei.zpp_inner.x==eb){var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}ec=ei.zpp_inner.y==ea}else{ec=false}if(!ec){ei.zpp_inner.x=eb;ei.zpp_inner.y=ea;var ed=ei.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ei.zpp_inner.weak=ef;return ei};at.prototype.localVectorToWorld=function(ea,ec){if(ec==null){ec=false}var ei=this.zpp_inner;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var ee=0;var ed=0;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ep=this.zpp_inner.axisy*ea.zpp_inner.x;var en=ea.zpp_inner;if(en._validate!=null){en._validate()}ee=ep-this.zpp_inner.axisx*ea.zpp_inner.y;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var eg=ea.zpp_inner.x*this.zpp_inner.axisx;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ed=eg+ea.zpp_inner.y*this.zpp_inner.axisy;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ee;eb.y=ed;er.zpp_inner=eb;er.zpp_inner.outer=er}else{var ef;var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}if(er.zpp_inner.x==ee){var ej=er.zpp_inner;if(ej._validate!=null){ej._validate()}ef=er.zpp_inner.y==ed}else{ef=false}if(!ef){er.zpp_inner.x=ee;er.zpp_inner.y=ed;var eh=er.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}er.zpp_inner.weak=ec;return er};at.prototype.worldVectorToLocal=function(ea,ec){if(ec==null){ec=false}var ei=this.zpp_inner;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var ee=0;var ed=0;var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}var ep=ea.zpp_inner.x*this.zpp_inner.axisy;var en=ea.zpp_inner;if(en._validate!=null){en._validate()}ee=ep+ea.zpp_inner.y*this.zpp_inner.axisx;var em=ea.zpp_inner;if(em._validate!=null){em._validate()}var eg=ea.zpp_inner.y*this.zpp_inner.axisy;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}ed=eg-ea.zpp_inner.x*this.zpp_inner.axisx;if(ea.zpp_inner.weak){var eq=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var eb;if(bB.zpp_pool==null){eb=new bB()}else{eb=bB.zpp_pool;bB.zpp_pool=eb.next;eb.next=null}eb.weak=false;eb._immutable=false;eb.x=ee;eb.y=ed;er.zpp_inner=eb;er.zpp_inner.outer=er}else{var ef;var ek=er.zpp_inner;if(ek._validate!=null){ek._validate()}if(er.zpp_inner.x==ee){var ej=er.zpp_inner;if(ej._validate!=null){ej._validate()}ef=er.zpp_inner.y==ed}else{ef=false}if(!ef){er.zpp_inner.x=ee;er.zpp_inner.y=ed;var eh=er.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}er.zpp_inner.weak=ec;return er};at.prototype.applyImpulse=function(ee,eo,eg){if(eg==null){eg=false}if(eg&&this.zpp_inner.component.sleeping){if(ee.zpp_inner.weak){var eq=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(eq.outer!=null){eq.outer.zpp_inner=null;eq.outer=null}eq._isimmutable=null;eq._validate=null;eq._invalidate=null;eq.next=bB.zpp_pool;bB.zpp_pool=eq}if(eo!=null){if(eo.zpp_inner.weak){var ef=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(ef.outer!=null){ef.outer.zpp_inner=null;ef.outer=null}ef._isimmutable=null;ef._validate=null;ef._invalidate=null;ef.next=bB.zpp_pool;bB.zpp_pool=ef}}return this}this.zpp_inner.validate_mass();var ep=this.zpp_inner.imass;var el=ee.zpp_inner;if(el._validate!=null){el._validate()}this.zpp_inner.velx+=ee.zpp_inner.x*ep;var en=ee.zpp_inner;if(en._validate!=null){en._validate()}this.zpp_inner.vely+=ee.zpp_inner.y*ep;if(eo!=null){var ed=0;var ec=0;var em=eo.zpp_inner;if(em._validate!=null){em._validate()}ed=eo.zpp_inner.x-this.zpp_inner.posx;var ek=eo.zpp_inner;if(ek._validate!=null){ek._validate()}ec=eo.zpp_inner.y-this.zpp_inner.posy;this.zpp_inner.validate_inertia();var ej=ee.zpp_inner;if(ej._validate!=null){ej._validate()}var eh=ee.zpp_inner.y*ed;var ei=ee.zpp_inner;if(ei._validate!=null){ei._validate()}this.zpp_inner.angvel+=(eh-ee.zpp_inner.x*ec)*this.zpp_inner.iinertia;if(eo.zpp_inner.weak){var eb=eo.zpp_inner;eo.zpp_inner.outer=null;eo.zpp_inner=null;eo.zpp_pool=au.poolVec2;au.poolVec2=eo;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}}if(!eg){if(this.zpp_inner.type==2){this.zpp_inner.wake()}}if(ee.zpp_inner.weak){var ea=ee.zpp_inner;ee.zpp_inner.outer=null;ee.zpp_inner=null;ee.zpp_pool=au.poolVec2;au.poolVec2=ee;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};at.prototype.applyAngularImpulse=function(eb,ea){if(ea==null){ea=false}if(ea&&this.zpp_inner.component.sleeping){return this}this.zpp_inner.validate_inertia();this.zpp_inner.angvel+=eb*this.zpp_inner.iinertia;if(!ea){if(this.zpp_inner.type==2){this.zpp_inner.wake()}}return this};at.prototype.translateShapes=function(ed){this.zpp_inner.immutable_midstep("Body::translateShapes()");var ec=ed.zpp_inner.weak;ed.zpp_inner.weak=false;var eb=this.zpp_inner.shapes.head;while(eb!=null){eb.elt.outer.translate(ed);eb=eb.next}ed.zpp_inner.weak=ec;if(ed.zpp_inner.weak){var ea=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};at.prototype.rotateShapes=function(eb){this.zpp_inner.immutable_midstep("Body::rotateShapes()");var ea=this.zpp_inner.shapes.head;while(ea!=null){ea.elt.outer.rotate(eb);ea=ea.next}return this};at.prototype.scaleShapes=function(eb,ea){this.zpp_inner.immutable_midstep("Body::scaleShapes()");var ec=this.zpp_inner.shapes.head;while(ec!=null){ec.elt.outer.scale(eb,ea);ec=ec.next}return this};at.prototype.transformShapes=function(ea){this.zpp_inner.immutable_midstep("Body::transformShapes()");var eb=this.zpp_inner.shapes.head;while(eb!=null){eb.elt.outer.transform(ea);eb=eb.next}return this};at.prototype.align=function(){this.zpp_inner.immutable_midstep("Body::align()");this.zpp_inner.validate_localCOM();var ek=-this.zpp_inner.localCOMx;var ei=-this.zpp_inner.localCOMy;var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var ej;if(bB.zpp_pool==null){ej=new bB()}else{ej=bB.zpp_pool;bB.zpp_pool=ej.next;ej.next=null}ej.weak=false;ej._immutable=false;ej.x=ek;ej.y=ei;eg.zpp_inner=ej;eg.zpp_inner.outer=eg}else{var eb;var ee=eg.zpp_inner;if(ee._validate!=null){ee._validate()}if(eg.zpp_inner.x==ek){var eh=eg.zpp_inner;if(eh._validate!=null){eh._validate()}eb=eg.zpp_inner.y==ei}else{eb=false}if(!eb){eg.zpp_inner.x=ek;eg.zpp_inner.y=ei;var ef=eg.zpp_inner;if(ef._invalidate!=null){ef._invalidate(ef)}}}eg.zpp_inner.weak=false;var en=eg;this.translateShapes(en);var el=this.localVectorToWorld(en);if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}this.zpp_inner.wrap_pos.subeq(el);if(this.zpp_inner.pre_posx<Infinity){var ed=el.zpp_inner;if(ed._validate!=null){ed._validate()}this.zpp_inner.pre_posx-=el.zpp_inner.x;var ec=el.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.pre_posy-=el.zpp_inner.y}var em=en.zpp_inner;en.zpp_inner.outer=null;en.zpp_inner=null;en.zpp_pool=au.poolVec2;au.poolVec2=en;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em;var ea=el.zpp_inner;el.zpp_inner.outer=null;el.zpp_inner=null;el.zpp_pool=au.poolVec2;au.poolVec2=el;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;return this};at.prototype.rotate=function(eg,es){var eb=eg.zpp_inner.weak;eg.zpp_inner.weak=false;if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var ec=this.zpp_inner.wrap_pos.sub(eg);ec.rotate(es);var ev=eg.add(ec,true);if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var el=this.zpp_inner.wrap_pos;var er=ev.zpp_inner;if(er._validate!=null){er._validate()}var ee=ev.zpp_inner.x;var eq=ev.zpp_inner;if(eq._validate!=null){eq._validate()}var ed=ev.zpp_inner.y;var et;var ep=el.zpp_inner;if(ep._validate!=null){ep._validate()}if(el.zpp_inner.x==ee){var eo=el.zpp_inner;if(eo._validate!=null){eo._validate()}et=el.zpp_inner.y==ed}else{et=false}if(!et){el.zpp_inner.x=ee;el.zpp_inner.y=ed;var em=el.zpp_inner;if(em._invalidate!=null){em._invalidate(em)}}if(ev.zpp_inner.weak){var eu=ev.zpp_inner;ev.zpp_inner.outer=null;ev.zpp_inner=null;ev.zpp_pool=au.poolVec2;au.poolVec2=ev;if(eu.outer!=null){eu.outer.zpp_inner=null;eu.outer=null}eu._isimmutable=null;eu._validate=null;eu._invalidate=null;eu.next=bB.zpp_pool;bB.zpp_pool=eu}if(this.zpp_inner.wrap_pos==null){this.zpp_inner.setupPosition()}var en=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en;var ea=this;var ei=ea.zpp_inner.rot+es;ea.zpp_inner.immutable_midstep("Body::rotation");if(ea.zpp_inner.rot!=ei){ea.zpp_inner.rot=ei;var ek=ea.zpp_inner;ek.zip_axis=true;var eh=ek.shapes.head;while(eh!=null){var ef=eh.elt;if(ef.type==1){ef.polygon.invalidate_gverts();ef.polygon.invalidate_gaxi()}ef.invalidate_worldCOM();eh=eh.next}ek.zip_worldCOM=true;ea.zpp_inner.wake()}eg.zpp_inner.weak=eb;if(eg.zpp_inner.weak){var ej=eg.zpp_inner;eg.zpp_inner.outer=null;eg.zpp_inner=null;eg.zpp_pool=au.poolVec2;au.poolVec2=eg;if(ej.outer!=null){ej.outer.zpp_inner=null;ej.outer=null}ej._isimmutable=null;ej._validate=null;ej._invalidate=null;ej.next=bB.zpp_pool;bB.zpp_pool=ej}return this};at.prototype.setShapeMaterials=function(eb){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");var ea=this.zpp_inner.shapes.head;while(ea!=null){var ec=ea.elt.outer;ec.zpp_inner.immutable_midstep("Shape::material");ec.zpp_inner.setMaterial(eb.zpp_inner);ec.zpp_inner.material.wrapper();ea=ea.next}return this};at.prototype.setShapeFilters=function(eb){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");var ea=this.zpp_inner.shapes.head;while(ea!=null){var ec=ea.elt.outer;ec.zpp_inner.immutable_midstep("Shape::filter");ec.zpp_inner.setFilter(eb.zpp_inner);ec.zpp_inner.filter.wrapper();ea=ea.next}return this};at.prototype.setShapeFluidProperties=function(ea){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");var eb=this.zpp_inner.shapes.head;while(eb!=null){var ec=eb.elt.outer;ec.zpp_inner.setFluid(ea.zpp_inner);ec.zpp_inner.immutable_midstep("Shape::fluidProperties");if(ec.zpp_inner.fluidProperties==null){ec.zpp_inner.setFluid(new aM().zpp_inner)}ec.zpp_inner.fluidProperties.wrapper();eb=eb.next}return this};at.prototype.get_localCOM=function(){if(this.zpp_inner.wrap_localCOM==null){var ea=this.zpp_inner.localCOMx;var eh=this.zpp_inner.localCOMy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.zpp_inner.wrap_localCOM=eb;this.zpp_inner.wrap_localCOM.zpp_inner._inuse=true;this.zpp_inner.wrap_localCOM.zpp_inner._immutable=true;this.zpp_inner.wrap_localCOM.zpp_inner._validate=(bo=this.zpp_inner,dX(bo,bo.getlocalCOM))}return this.zpp_inner.wrap_localCOM};at.prototype.get_worldCOM=function(){if(this.zpp_inner.wrap_worldCOM==null){var ea=this.zpp_inner.worldCOMx;var eh=this.zpp_inner.worldCOMy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.zpp_inner.wrap_worldCOM=eb;this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=true;this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=true;this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(bo=this.zpp_inner,dX(bo,bo.getworldCOM))}return this.zpp_inner.wrap_worldCOM};at.prototype.normalImpulse=function(eg,eb){if(eb==null){eb=false}var en=0;var el=0;var ej=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ef=this.zpp_inner.wrap_arbiters.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ed=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ee;if(ef.zpp_i<ed){ee=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++).zpp_inner;if(ec.type!=j.COL){continue}if(eg!=null&&ec.b2!=eg.zpp_inner&&ec.b1!=eg.zpp_inner){continue}var ei=ec.wrapper();var ea=(ei.zpp_inner.type==j.COL?ei.zpp_inner.colarb.outer_zn:null).normalImpulse(this,eb);var em=ea.zpp_inner;if(em._validate!=null){em._validate()}en+=ea.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}el+=ea.zpp_inner.y;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}ej+=ea.zpp_inner.z;ea.dispose()}return q.get(en,el,ej)};at.prototype.tangentImpulse=function(eg,eb){if(eb==null){eb=false}var en=0;var el=0;var ej=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ef=this.zpp_inner.wrap_arbiters.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ed=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ee;if(ef.zpp_i<ed){ee=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++).zpp_inner;if(ec.type!=j.COL){continue}if(eg!=null&&ec.b2!=eg.zpp_inner&&ec.b1!=eg.zpp_inner){continue}var ei=ec.wrapper();var ea=(ei.zpp_inner.type==j.COL?ei.zpp_inner.colarb.outer_zn:null).tangentImpulse(this,eb);var em=ea.zpp_inner;if(em._validate!=null){em._validate()}en+=ea.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}el+=ea.zpp_inner.y;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}ej+=ea.zpp_inner.z;ea.dispose()}return q.get(en,el,ej)};at.prototype.totalContactsImpulse=function(eg,eb){if(eb==null){eb=false}var en=0;var el=0;var ej=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ef=this.zpp_inner.wrap_arbiters.iterator();while(true){ef.zpp_inner.zpp_inner.valmod();var ed=ef.zpp_inner.zpp_gl();ef.zpp_critical=true;var ee;if(ef.zpp_i<ed){ee=true}else{ef.zpp_next=d0.zpp_pool;d0.zpp_pool=ef;ef.zpp_inner=null;ee=false}if(!ee){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++).zpp_inner;if(ec.type!=j.COL){continue}if(eg!=null&&ec.b2!=eg.zpp_inner&&ec.b1!=eg.zpp_inner){continue}var ei=ec.wrapper();var ea=(ei.zpp_inner.type==j.COL?ei.zpp_inner.colarb.outer_zn:null).totalImpulse(this,eb);var em=ea.zpp_inner;if(em._validate!=null){em._validate()}en+=ea.zpp_inner.x;var ek=ea.zpp_inner;if(ek._validate!=null){ek._validate()}el+=ea.zpp_inner.y;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}ej+=ea.zpp_inner.z;ea.dispose()}return q.get(en,el,ej)};at.prototype.rollingImpulse=function(ea,eb){if(eb==null){eb=false}var ec=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var eg=this.zpp_inner.wrap_arbiters.iterator();while(true){eg.zpp_inner.zpp_inner.valmod();var ef=eg.zpp_inner.zpp_gl();eg.zpp_critical=true;var ed;if(eg.zpp_i<ef){ed=true}else{eg.zpp_next=d0.zpp_pool;d0.zpp_pool=eg;eg.zpp_inner=null;ed=false}if(!ed){break}eg.zpp_critical=false;var ee=eg.zpp_inner.at(eg.zpp_i++).zpp_inner;if(ee.type!=j.COL){continue}if(ea!=null&&ee.b2!=ea.zpp_inner&&ee.b1!=ea.zpp_inner){continue}var eh=ee.wrapper();ec+=(eh.zpp_inner.type==j.COL?eh.zpp_inner.colarb.outer_zn:null).rollingImpulse(this,eb)}return ec};at.prototype.buoyancyImpulse=function(ef){var em=0;var ek=0;var ei=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ee=this.zpp_inner.wrap_arbiters.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var eb=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;var ec=ee.zpp_inner.at(ee.zpp_i++).zpp_inner;if(ec.type!=j.FLUID){continue}if(ef!=null&&ec.b2!=ef.zpp_inner&&ec.b1!=ef.zpp_inner){continue}var eh=ec.wrapper();var ea=(eh.zpp_inner.type==j.FLUID?eh.zpp_inner.fluidarb.outer_zn:null).buoyancyImpulse(this);var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.x;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.y;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}ei+=ea.zpp_inner.z;ea.dispose()}return q.get(em,ek,ei)};at.prototype.dragImpulse=function(ef){var em=0;var ek=0;var ei=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ee=this.zpp_inner.wrap_arbiters.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var eb=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;var ec=ee.zpp_inner.at(ee.zpp_i++).zpp_inner;if(ec.type!=j.FLUID){continue}if(ef!=null&&ec.b2!=ef.zpp_inner&&ec.b1!=ef.zpp_inner){continue}var eh=ec.wrapper();var ea=(eh.zpp_inner.type==j.FLUID?eh.zpp_inner.fluidarb.outer_zn:null).dragImpulse(this);var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.x;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.y;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}ei+=ea.zpp_inner.z;ea.dispose()}return q.get(em,ek,ei)};at.prototype.totalFluidImpulse=function(ef){var em=0;var ek=0;var ei=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var ee=this.zpp_inner.wrap_arbiters.iterator();while(true){ee.zpp_inner.zpp_inner.valmod();var eb=ee.zpp_inner.zpp_gl();ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=d0.zpp_pool;d0.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;var ec=ee.zpp_inner.at(ee.zpp_i++).zpp_inner;if(ec.type!=j.FLUID){continue}if(ef!=null&&ec.b2!=ef.zpp_inner&&ec.b1!=ef.zpp_inner){continue}var eh=ec.wrapper();var ea=(eh.zpp_inner.type==j.FLUID?eh.zpp_inner.fluidarb.outer_zn:null).totalImpulse(this);var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.x;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.y;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}ei+=ea.zpp_inner.z;ea.dispose()}return q.get(em,ek,ei)};at.prototype.constraintsImpulse=function(){var ec=0;var eb=0;var ea=0;var ee=this.zpp_inner.constraints.head;while(ee!=null){var ed=ee.elt.outer.bodyImpulse(this);var eh=ed.zpp_inner;if(eh._validate!=null){eh._validate()}ec+=ed.zpp_inner.x;var eg=ed.zpp_inner;if(eg._validate!=null){eg._validate()}eb+=ed.zpp_inner.y;var ef=ed.zpp_inner;if(ef._validate!=null){ef._validate()}ea+=ed.zpp_inner.z;ed.dispose();ee=ee.next}return q.get(ec,eb,ea)};at.prototype.totalImpulse=function(ef,eg){if(eg==null){eg=false}var en=0;var em=0;var ek=0;if(this.zpp_inner.wrap_arbiters==null){this.zpp_inner.wrap_arbiters=U.get(this.zpp_inner.arbiters,true)}var eb=this.zpp_inner.wrap_arbiters.iterator();while(true){eb.zpp_inner.zpp_inner.valmod();var ec=eb.zpp_inner.zpp_gl();eb.zpp_critical=true;var es;if(eb.zpp_i<ec){es=true}else{eb.zpp_next=d0.zpp_pool;d0.zpp_pool=eb;eb.zpp_inner=null;es=false}if(!es){break}eb.zpp_critical=false;var ee=eb.zpp_inner.at(eb.zpp_i++).zpp_inner;if(ee.type==j.SENSOR){continue}if(ef!=null&&ee.b2!=ef.zpp_inner&&ee.b1!=ef.zpp_inner){continue}var eq=ee.wrapper().totalImpulse(this,eg);var ei=eq.zpp_inner;if(ei._validate!=null){ei._validate()}en+=eq.zpp_inner.x;var er=eq.zpp_inner;if(er._validate!=null){er._validate()}em+=eq.zpp_inner.y;var ep=eq.zpp_inner;if(ep._validate!=null){ep._validate()}ek+=eq.zpp_inner.z;eq.dispose()}var eh=this.zpp_inner.constraints.head;while(eh!=null){var ed=eh.elt;if(ed.active){var ea=ed.outer.bodyImpulse(this);var eo=ea.zpp_inner;if(eo._validate!=null){eo._validate()}en+=ea.zpp_inner.x;var el=ea.zpp_inner;if(el._validate!=null){el._validate()}em+=ea.zpp_inner.y;var ej=ea.zpp_inner;if(ej._validate!=null){ej._validate()}ek+=ea.zpp_inner.z;ea.dispose()}eh=eh.next}return q.get(en,em,ek)};at.prototype.contains=function(eb){var ea=eb.zpp_inner.weak;eb.zpp_inner.weak=false;var ee;ee=false;var ed=this.zpp_inner.shapes.head;while(ed!=null){if(ed.elt.outer.contains(eb)){ee=true;break}ed=ed.next}eb.zpp_inner.weak=ea;if(eb.zpp_inner.weak){var ec=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;eb.zpp_pool=au.poolVec2;au.poolVec2=eb;if(ec.outer!=null){ec.outer.zpp_inner=null;ec.outer=null}ec._isimmutable=null;ec._validate=null;ec._invalidate=null;ec.next=bB.zpp_pool;bB.zpp_pool=ec}return ee};at.prototype.toString=function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==2?"dynamic":this.zpp_inner.type==1?"static":"kinematic"))+")#"+this.zpp_inner_i.id};Object.defineProperty(at.prototype,"type",{get:at.prototype.get_type,set:at.prototype.set_type});Object.defineProperty(at.prototype,"isBullet",{get:at.prototype.get_isBullet,set:at.prototype.set_isBullet});Object.defineProperty(at.prototype,"disableCCD",{get:at.prototype.get_disableCCD,set:at.prototype.set_disableCCD});Object.defineProperty(at.prototype,"shapes",{get:at.prototype.get_shapes});Object.defineProperty(at.prototype,"compound",{get:at.prototype.get_compound,set:at.prototype.set_compound});Object.defineProperty(at.prototype,"space",{get:at.prototype.get_space,set:at.prototype.set_space});Object.defineProperty(at.prototype,"arbiters",{get:at.prototype.get_arbiters});Object.defineProperty(at.prototype,"isSleeping",{get:at.prototype.get_isSleeping});Object.defineProperty(at.prototype,"constraints",{get:at.prototype.get_constraints});Object.defineProperty(at.prototype,"position",{get:at.prototype.get_position,set:at.prototype.set_position});Object.defineProperty(at.prototype,"velocity",{get:at.prototype.get_velocity,set:at.prototype.set_velocity});Object.defineProperty(at.prototype,"kinematicVel",{get:at.prototype.get_kinematicVel,set:at.prototype.set_kinematicVel});Object.defineProperty(at.prototype,"surfaceVel",{get:at.prototype.get_surfaceVel,set:at.prototype.set_surfaceVel});Object.defineProperty(at.prototype,"force",{get:at.prototype.get_force,set:at.prototype.set_force});Object.defineProperty(at.prototype,"constraintVelocity",{get:at.prototype.get_constraintVelocity});Object.defineProperty(at.prototype,"rotation",{get:at.prototype.get_rotation,set:at.prototype.set_rotation});Object.defineProperty(at.prototype,"angularVel",{get:at.prototype.get_angularVel,set:at.prototype.set_angularVel});Object.defineProperty(at.prototype,"kinAngVel",{get:at.prototype.get_kinAngVel,set:at.prototype.set_kinAngVel});Object.defineProperty(at.prototype,"torque",{get:at.prototype.get_torque,set:at.prototype.set_torque});Object.defineProperty(at.prototype,"bounds",{get:at.prototype.get_bounds});Object.defineProperty(at.prototype,"allowMovement",{get:at.prototype.get_allowMovement,set:at.prototype.set_allowMovement});Object.defineProperty(at.prototype,"allowRotation",{get:at.prototype.get_allowRotation,set:at.prototype.set_allowRotation});Object.defineProperty(at.prototype,"massMode",{get:at.prototype.get_massMode,set:at.prototype.set_massMode});Object.defineProperty(at.prototype,"constraintMass",{get:at.prototype.get_constraintMass});Object.defineProperty(at.prototype,"mass",{get:at.prototype.get_mass,set:at.prototype.set_mass});Object.defineProperty(at.prototype,"gravMassMode",{get:at.prototype.get_gravMassMode,set:at.prototype.set_gravMassMode});Object.defineProperty(at.prototype,"gravMass",{get:at.prototype.get_gravMass,set:at.prototype.set_gravMass});Object.defineProperty(at.prototype,"gravMassScale",{get:at.prototype.get_gravMassScale,set:at.prototype.set_gravMassScale});Object.defineProperty(at.prototype,"inertiaMode",{get:at.prototype.get_inertiaMode,set:at.prototype.set_inertiaMode});Object.defineProperty(at.prototype,"constraintInertia",{get:at.prototype.get_constraintInertia});Object.defineProperty(at.prototype,"inertia",{get:at.prototype.get_inertia,set:at.prototype.set_inertia});Object.defineProperty(at.prototype,"localCOM",{get:at.prototype.get_localCOM});Object.defineProperty(at.prototype,"worldCOM",{get:at.prototype.get_worldCOM});at.prototype.__class__=at;var aX=nape.phys.BodyIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};aX.__name__=["nape","phys","BodyIterator"];aX.get=function(ec){var ea;if(aX.zpp_pool==null){b0.internal=true;var ed=new aX();b0.internal=false;ea=ed}else{var eb=aX.zpp_pool;aX.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};aX.prototype.zpp_inner=null;aX.prototype.zpp_i=null;aX.prototype.zpp_critical=null;aX.prototype.zpp_next=null;aX.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=aX.zpp_pool;aX.zpp_pool=this;this.zpp_inner=null;return false}};aX.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};aX.prototype.__class__=aX;var a5=nape.phys.BodyList=function(){this.zpp_inner=null;this.zpp_inner=new b0();this.zpp_inner.outer=this};a5.__name__=["nape","phys","BodyList"];a5.fromArray=function(ed){var ea=new a5();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};a5.prototype.zpp_inner=null;a5.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};a5.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};a5.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};a5.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a5.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a5.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};a5.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};a5.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};a5.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};a5.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};a5.prototype.empty=function(){return this.zpp_inner.inner.head==null};a5.prototype.iterator=function(){this.zpp_inner.valmod();return aX.get(this)};a5.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new a5();this.zpp_inner.valmod();var ef=aX.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=aX.zpp_pool;aX.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};a5.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=aX.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=aX.zpp_pool;aX.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};a5.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=aX.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=aX.zpp_pool;aX.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};a5.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=aX.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=aX.zpp_pool;aX.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=aX.zpp_pool;aX.zpp_pool=ec;ec.zpp_inner=null;break}}return this};a5.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(a5.prototype,"length",{get:a5.prototype.get_length});a5.prototype.__class__=a5;var cU=nape.phys.BodyType=function(){};cU.__name__=["nape","phys","BodyType"];cU.STATIC=null;cU.get_STATIC=function(){if(br.BodyType_STATIC==null){br.internal=true;br.BodyType_STATIC=new cU();br.internal=false}return br.BodyType_STATIC};cU.DYNAMIC=null;cU.get_DYNAMIC=function(){if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}return br.BodyType_DYNAMIC};cU.KINEMATIC=null;cU.get_KINEMATIC=function(){if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}return br.BodyType_KINEMATIC};cU.prototype.toString=function(){if(br.BodyType_STATIC==null){br.internal=true;br.BodyType_STATIC=new cU();br.internal=false}if(this==br.BodyType_STATIC){return"STATIC"}else{if(br.BodyType_DYNAMIC==null){br.internal=true;br.BodyType_DYNAMIC=new cU();br.internal=false}if(this==br.BodyType_DYNAMIC){return"DYNAMIC"}else{if(br.BodyType_KINEMATIC==null){br.internal=true;br.BodyType_KINEMATIC=new cU();br.internal=false}if(this==br.BodyType_KINEMATIC){return"KINEMATIC"}else{return""}}}};Object.defineProperty(cU,"STATIC",{get:cU.get_STATIC});Object.defineProperty(cU,"DYNAMIC",{get:cU.get_DYNAMIC});Object.defineProperty(cU,"KINEMATIC",{get:cU.get_KINEMATIC});cU.prototype.__class__=cU;var dq=nape.phys.Compound=function(){this.zpp_inner=null;a6.call(this);this.zpp_inner=new cQ();this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;this.zpp_inner.insert_cbtype(db.ANY_COMPOUND.zpp_inner)};dq.__name__=["nape","phys","Compound"];dq.__super__=a6;dq.prototype=Object.create(a6.prototype);dq.prototype.zpp_inner=null;dq.prototype.get_bodies=function(){return this.zpp_inner.wrap_bodies};dq.prototype.get_constraints=function(){return this.zpp_inner.wrap_constraints};dq.prototype.get_compounds=function(){return this.zpp_inner.wrap_compounds};dq.prototype.get_compound=function(){if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};dq.prototype.set_compound=function(ea){this.zpp_inner.immutable_midstep("Compound::compound");if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=ea){if((this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer)!=null){(this.zpp_inner.compound==null?null:this.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_compounds;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.compound==null){return null}else{return this.zpp_inner.compound.outer}};dq.prototype.get_space=function(){if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};dq.prototype.set_space=function(ea){this.zpp_inner.immutable_midstep("Compound::space");if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=ea){if((this.zpp_inner.space==null?null:this.zpp_inner.space.outer)!=null){(this.zpp_inner.space==null?null:this.zpp_inner.space.outer).zpp_inner.wrap_compounds.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_compounds;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.space==null){return null}else{return this.zpp_inner.space.outer}};dq.prototype.toString=function(){return"Compound"+this.zpp_inner_i.id};dq.prototype.copy=function(){return this.zpp_inner.copy()};dq.prototype.breakApart=function(){this.zpp_inner.breakApart()};dq.prototype.visitBodies=function(eh){var eg=this.zpp_inner.wrap_bodies;eg.zpp_inner.valmod();var ee=aX.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=aX.zpp_pool;aX.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitBodies(eh)}};dq.prototype.visitConstraints=function(eh){var eg=this.zpp_inner.wrap_constraints;eg.zpp_inner.valmod();var ee=bO.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=bO.zpp_pool;bO.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitConstraints(eh)}};dq.prototype.visitCompounds=function(ea){var eg=this.zpp_inner.wrap_compounds;eg.zpp_inner.valmod();var ee=c4.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ed=ee.zpp_inner;ed.zpp_inner.valmod();if(ed.zpp_inner.zip_length){ed.zpp_inner.zip_length=false;ed.zpp_inner.user_length=ed.zpp_inner.inner.length}var ec=ed.zpp_inner.user_length;ee.zpp_critical=true;var eb;if(ee.zpp_i<ec){eb=true}else{ee.zpp_next=c4.zpp_pool;c4.zpp_pool=ee;ee.zpp_inner=null;eb=false}if(!eb){break}ee.zpp_critical=false;var ef=ee.zpp_inner.at(ee.zpp_i++);ea(ef);ef.visitCompounds(ea)}};dq.prototype.COM=function(eb){if(eb==null){eb=false}var ee;if(au.poolVec2==null){ee=new r()}else{ee=au.poolVec2;au.poolVec2=ee.zpp_pool;ee.zpp_pool=null}if(ee.zpp_inner==null){var ei;if(bB.zpp_pool==null){ei=new bB()}else{ei=bB.zpp_pool;bB.zpp_pool=ei.next;ei.next=null}ei.weak=false;ei._immutable=false;ei.x=0;ei.y=0;ee.zpp_inner=ei;ee.zpp_inner.outer=ee}else{var ea;var ec=ee.zpp_inner;if(ec._validate!=null){ec._validate()}if(ee.zpp_inner.x==0){var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}ea=ee.zpp_inner.y==0}else{ea=false}if(!ea){ee.zpp_inner.x=0;ee.zpp_inner.y=0;var ed=ee.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}ee.zpp_inner.weak=eb;var eg=ee;var eh=0;this.visitBodies(function(er){if(er.zpp_inner.wrap_shapes.zpp_inner.inner.head!=null){if(er.zpp_inner.wrap_worldCOM==null){var es=er.zpp_inner.worldCOMx;var eq=er.zpp_inner.worldCOMy;var ep;if(au.poolVec2==null){ep=new r()}else{ep=au.poolVec2;au.poolVec2=ep.zpp_pool;ep.zpp_pool=null}if(ep.zpp_inner==null){var eo;if(bB.zpp_pool==null){eo=new bB()}else{eo=bB.zpp_pool;bB.zpp_pool=eo.next;eo.next=null}eo.weak=false;eo._immutable=false;eo.x=es;eo.y=eq;ep.zpp_inner=eo;ep.zpp_inner.outer=ep}else{var ek;var en=ep.zpp_inner;if(en._validate!=null){en._validate()}if(ep.zpp_inner.x==es){var em=ep.zpp_inner;if(em._validate!=null){em._validate()}ek=ep.zpp_inner.y==eq}else{ek=false}if(!ek){ep.zpp_inner.x=es;ep.zpp_inner.y=eq;var el=ep.zpp_inner;if(el._invalidate!=null){el._invalidate(el)}}}ep.zpp_inner.weak=false;er.zpp_inner.wrap_worldCOM=ep;er.zpp_inner.wrap_worldCOM.zpp_inner._inuse=true;er.zpp_inner.wrap_worldCOM.zpp_inner._immutable=true;er.zpp_inner.wrap_worldCOM.zpp_inner._validate=(bo=er.zpp_inner,dX(bo,bo.getworldCOM))}var ej=er.zpp_inner.wrap_worldCOM;er.zpp_inner.validate_mass();eg.addeq(ej.mul(er.zpp_inner.cmass,true));er.zpp_inner.validate_mass();eh+=er.zpp_inner.cmass}});eg.muleq(1/eh);return eg};dq.prototype.translate=function(ed){var eb=ed.zpp_inner.weak;ed.zpp_inner.weak=false;this.visitBodies(function(ee){if(ee.zpp_inner.wrap_pos==null){ee.zpp_inner.setupPosition()}ee.zpp_inner.wrap_pos.addeq(ed)});ed.zpp_inner.weak=eb;if(ed.zpp_inner.weak){var ea=ed.zpp_inner;ed.zpp_inner.outer=null;ed.zpp_inner=null;var ec=ed;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};dq.prototype.rotate=function(eb,ee){var ec=eb.zpp_inner.weak;eb.zpp_inner.weak=false;this.visitBodies(function(ef){ef.rotate(eb,ee)});eb.zpp_inner.weak=ec;if(eb.zpp_inner.weak){var ea=eb.zpp_inner;eb.zpp_inner.outer=null;eb.zpp_inner=null;var ed=eb;ed.zpp_pool=au.poolVec2;au.poolVec2=ed;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};Object.defineProperty(dq.prototype,"bodies",{get:dq.prototype.get_bodies});Object.defineProperty(dq.prototype,"constraints",{get:dq.prototype.get_constraints});Object.defineProperty(dq.prototype,"compounds",{get:dq.prototype.get_compounds});Object.defineProperty(dq.prototype,"compound",{get:dq.prototype.get_compound,set:dq.prototype.set_compound});Object.defineProperty(dq.prototype,"space",{get:dq.prototype.get_space,set:dq.prototype.set_space});dq.prototype.__class__=dq;var c4=nape.phys.CompoundIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};c4.__name__=["nape","phys","CompoundIterator"];c4.get=function(ec){var ea;if(c4.zpp_pool==null){bj.internal=true;var ed=new c4();bj.internal=false;ea=ed}else{var eb=c4.zpp_pool;c4.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};c4.prototype.zpp_inner=null;c4.prototype.zpp_i=null;c4.prototype.zpp_critical=null;c4.prototype.zpp_next=null;c4.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=c4.zpp_pool;c4.zpp_pool=this;this.zpp_inner=null;return false}};c4.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};c4.prototype.__class__=c4;var cB=nape.phys.CompoundList=function(){this.zpp_inner=null;this.zpp_inner=new bj();this.zpp_inner.outer=this};cB.__name__=["nape","phys","CompoundList"];cB.fromArray=function(ed){var ea=new cB();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};cB.prototype.zpp_inner=null;cB.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};cB.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};cB.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};cB.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cB.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cB.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};cB.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};cB.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};cB.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};cB.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};cB.prototype.empty=function(){return this.zpp_inner.inner.head==null};cB.prototype.iterator=function(){this.zpp_inner.valmod();return c4.get(this)};cB.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new cB();this.zpp_inner.valmod();var ef=c4.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=c4.zpp_pool;c4.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};cB.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=c4.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=c4.zpp_pool;c4.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};cB.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=c4.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=c4.zpp_pool;c4.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};cB.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=c4.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=c4.zpp_pool;c4.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=c4.zpp_pool;c4.zpp_pool=ec;ec.zpp_inner=null;break}}return this};cB.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(cB.prototype,"length",{get:cB.prototype.get_length});cB.prototype.__class__=cB;var aM=nape.phys.FluidProperties=function(ea,eb){if(eb==null){eb=1}if(ea==null){ea=1}this.zpp_inner=null;if(b6.zpp_pool==null){this.zpp_inner=new b6()}else{this.zpp_inner=b6.zpp_pool;b6.zpp_pool=this.zpp_inner.next;this.zpp_inner.next=null}this.zpp_inner.outer=this;if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate()}if(eb!=this.zpp_inner.viscosity){this.zpp_inner.viscosity=eb/1;this.zpp_inner.invalidate()}};aM.__name__=["nape","phys","FluidProperties"];aM.prototype.zpp_inner=null;aM.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};aM.prototype.get_shapes=function(){if(this.zpp_inner.wrap_shapes==null){this.zpp_inner.wrap_shapes=aI.get(this.zpp_inner.shapes,true)}return this.zpp_inner.wrap_shapes};aM.prototype.copy=function(){var ei=new aM(this.zpp_inner.density*1000,this.zpp_inner.viscosity);if(this.zpp_inner.userData!=null){ei.zpp_inner.userData=bm.copy(this.zpp_inner.userData)}var em=this.zpp_inner.wrap_gravity;if(em==null){if(ei.zpp_inner.wrap_gravity!=null){ei.zpp_inner.wrap_gravity.zpp_inner._inuse=false;var ef=ei.zpp_inner.wrap_gravity;var en=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(en.outer!=null){en.outer.zpp_inner=null;en.outer=null}en._isimmutable=null;en._validate=null;en._invalidate=null;en.next=bB.zpp_pool;bB.zpp_pool=en;ei.zpp_inner.wrap_gravity=null}}else{if(ei.zpp_inner.wrap_gravity==null){ei.zpp_inner.getgravity()}var ej=ei.zpp_inner.wrap_gravity;var eh=em.zpp_inner;if(eh._validate!=null){eh._validate()}var el=em.zpp_inner.x;var eg=em.zpp_inner;if(eg._validate!=null){eg._validate()}var ek=em.zpp_inner.y;var ec;var ee=ej.zpp_inner;if(ee._validate!=null){ee._validate()}if(ej.zpp_inner.x==el){var ed=ej.zpp_inner;if(ed._validate!=null){ed._validate()}ec=ej.zpp_inner.y==ek}else{ec=false}if(!ec){ej.zpp_inner.x=el;ej.zpp_inner.y=ek;var eb=ej.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(em.zpp_inner.weak){var ea=em.zpp_inner;em.zpp_inner.outer=null;em.zpp_inner=null;em.zpp_pool=au.poolVec2;au.poolVec2=em;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}}return ei};aM.prototype.get_density=function(){return this.zpp_inner.density*1000};aM.prototype.set_density=function(ea){if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate()}return this.zpp_inner.density*1000};aM.prototype.get_viscosity=function(){return this.zpp_inner.viscosity};aM.prototype.set_viscosity=function(ea){if(ea!=this.zpp_inner.viscosity){this.zpp_inner.viscosity=ea/1;this.zpp_inner.invalidate()}return this.zpp_inner.viscosity};aM.prototype.get_gravity=function(){return this.zpp_inner.wrap_gravity};aM.prototype.set_gravity=function(el){if(el==null){if(this.zpp_inner.wrap_gravity!=null){this.zpp_inner.wrap_gravity.zpp_inner._inuse=false;var ef=this.zpp_inner.wrap_gravity;var em=ef.zpp_inner;ef.zpp_inner.outer=null;ef.zpp_inner=null;ef.zpp_pool=au.poolVec2;au.poolVec2=ef;if(em.outer!=null){em.outer.zpp_inner=null;em.outer=null}em._isimmutable=null;em._validate=null;em._invalidate=null;em.next=bB.zpp_pool;bB.zpp_pool=em;this.zpp_inner.wrap_gravity=null}}else{if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}var ei=this.zpp_inner.wrap_gravity;var eh=el.zpp_inner;if(eh._validate!=null){eh._validate()}var ek=el.zpp_inner.x;var eg=el.zpp_inner;if(eg._validate!=null){eg._validate()}var ej=el.zpp_inner.y;var ec;var ee=ei.zpp_inner;if(ee._validate!=null){ee._validate()}if(ei.zpp_inner.x==ek){var ed=ei.zpp_inner;if(ed._validate!=null){ed._validate()}ec=ei.zpp_inner.y==ej}else{ec=false}if(!ec){ei.zpp_inner.x=ek;ei.zpp_inner.y=ej;var eb=ei.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(el.zpp_inner.weak){var ea=el.zpp_inner;el.zpp_inner.outer=null;el.zpp_inner=null;el.zpp_pool=au.poolVec2;au.poolVec2=el;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}}return this.zpp_inner.wrap_gravity};aM.prototype.toString=function(){return"{ density: "+this.zpp_inner.density*1000+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+ag.string(this.zpp_inner.wrap_gravity)+" }"};Object.defineProperty(aM.prototype,"userData",{get:aM.prototype.get_userData});Object.defineProperty(aM.prototype,"shapes",{get:aM.prototype.get_shapes});Object.defineProperty(aM.prototype,"density",{get:aM.prototype.get_density,set:aM.prototype.set_density});Object.defineProperty(aM.prototype,"viscosity",{get:aM.prototype.get_viscosity,set:aM.prototype.set_viscosity});Object.defineProperty(aM.prototype,"gravity",{get:aM.prototype.get_gravity,set:aM.prototype.set_gravity});aM.prototype.__class__=aM;var cw=nape.phys.GravMassMode=function(){};cw.__name__=["nape","phys","GravMassMode"];cw.DEFAULT=null;cw.get_DEFAULT=function(){if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}return br.GravMassMode_DEFAULT};cw.FIXED=null;cw.get_FIXED=function(){if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}return br.GravMassMode_FIXED};cw.SCALED=null;cw.get_SCALED=function(){if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}return br.GravMassMode_SCALED};cw.prototype.toString=function(){if(br.GravMassMode_DEFAULT==null){br.internal=true;br.GravMassMode_DEFAULT=new cw();br.internal=false}if(this==br.GravMassMode_DEFAULT){return"DEFAULT"}else{if(br.GravMassMode_FIXED==null){br.internal=true;br.GravMassMode_FIXED=new cw();br.internal=false}if(this==br.GravMassMode_FIXED){return"FIXED"}else{if(br.GravMassMode_SCALED==null){br.internal=true;br.GravMassMode_SCALED=new cw();br.internal=false}if(this==br.GravMassMode_SCALED){return"SCALED"}else{return""}}}};Object.defineProperty(cw,"DEFAULT",{get:cw.get_DEFAULT});Object.defineProperty(cw,"FIXED",{get:cw.get_FIXED});Object.defineProperty(cw,"SCALED",{get:cw.get_SCALED});cw.prototype.__class__=cw;var be=nape.phys.InertiaMode=function(){};be.__name__=["nape","phys","InertiaMode"];be.DEFAULT=null;be.get_DEFAULT=function(){if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}return br.InertiaMode_DEFAULT};be.FIXED=null;be.get_FIXED=function(){if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}return br.InertiaMode_FIXED};be.prototype.toString=function(){if(br.InertiaMode_DEFAULT==null){br.internal=true;br.InertiaMode_DEFAULT=new be();br.internal=false}if(this==br.InertiaMode_DEFAULT){return"DEFAULT"}else{if(br.InertiaMode_FIXED==null){br.internal=true;br.InertiaMode_FIXED=new be();br.internal=false}if(this==br.InertiaMode_FIXED){return"FIXED"}else{return""}}};Object.defineProperty(be,"DEFAULT",{get:be.get_DEFAULT});Object.defineProperty(be,"FIXED",{get:be.get_FIXED});be.prototype.__class__=be;var ap=nape.phys.InteractorIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};ap.__name__=["nape","phys","InteractorIterator"];ap.get=function(ec){var ea;if(ap.zpp_pool==null){i.internal=true;var ed=new ap();i.internal=false;ea=ed}else{var eb=ap.zpp_pool;ap.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};ap.prototype.zpp_inner=null;ap.prototype.zpp_i=null;ap.prototype.zpp_critical=null;ap.prototype.zpp_next=null;ap.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=ap.zpp_pool;ap.zpp_pool=this;this.zpp_inner=null;return false}};ap.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};ap.prototype.__class__=ap;var dd=nape.phys.InteractorList=function(){this.zpp_inner=null;this.zpp_inner=new i();this.zpp_inner.outer=this};dd.__name__=["nape","phys","InteractorList"];dd.fromArray=function(ed){var ea=new dd();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};dd.prototype.zpp_inner=null;dd.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};dd.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner_i)};dd.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer_i};dd.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner_i)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner_i)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};dd.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner_i)}else{this.zpp_inner.inner.add(ec.zpp_inner_i)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};dd.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer_i};dd.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer_i;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer_i};dd.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};dd.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner_i){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner_i)}this.zpp_inner.invalidate()}return ea};dd.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};dd.prototype.empty=function(){return this.zpp_inner.inner.head==null};dd.prototype.iterator=function(){this.zpp_inner.valmod();return ap.get(this)};dd.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new dd();this.zpp_inner.valmod();var ef=ap.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=ap.zpp_pool;ap.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};dd.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=ap.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=ap.zpp_pool;ap.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};dd.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=ap.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=ap.zpp_pool;ap.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};dd.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=ap.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=ap.zpp_pool;ap.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=ap.zpp_pool;ap.zpp_pool=ec;ec.zpp_inner=null;break}}return this};dd.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(dd.prototype,"length",{get:dd.prototype.get_length});dd.prototype.__class__=dd;var by=nape.phys.MassMode=function(){};by.__name__=["nape","phys","MassMode"];by.DEFAULT=null;by.get_DEFAULT=function(){if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}return br.MassMode_DEFAULT};by.FIXED=null;by.get_FIXED=function(){if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}return br.MassMode_FIXED};by.prototype.toString=function(){if(br.MassMode_DEFAULT==null){br.internal=true;br.MassMode_DEFAULT=new by();br.internal=false}if(this==br.MassMode_DEFAULT){return"DEFAULT"}else{if(br.MassMode_FIXED==null){br.internal=true;br.MassMode_FIXED=new by();br.internal=false}if(this==br.MassMode_FIXED){return"FIXED"}else{return""}}};Object.defineProperty(by,"DEFAULT",{get:by.get_DEFAULT});Object.defineProperty(by,"FIXED",{get:by.get_FIXED});by.prototype.__class__=by;var dg=nape.phys.Material=function(ec,eb,ee,ea,ed){if(ed==null){ed=0.001}if(ea==null){ea=1}if(ee==null){ee=2}if(eb==null){eb=1}if(ec==null){ec=0}this.zpp_inner=null;if(cJ.zpp_pool==null){this.zpp_inner=new cJ()}else{this.zpp_inner=cJ.zpp_pool;cJ.zpp_pool=this.zpp_inner.next;this.zpp_inner.next=null}this.zpp_inner.outer=this;if(ec!=this.zpp_inner.elasticity){this.zpp_inner.elasticity=ec/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}if(eb!=this.zpp_inner.dynamicFriction){this.zpp_inner.dynamicFriction=eb/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ANGDRAG|cJ.ARBITERS)}if(ee!=this.zpp_inner.staticFriction){this.zpp_inner.staticFriction=ee/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate(cJ.WAKE|cJ.PROPS)}if(ed!=this.zpp_inner.rollingFriction){this.zpp_inner.rollingFriction=ed/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}};dg.__name__=["nape","phys","Material"];dg.wood=function(){return new dg(0.4,0.2,0.38,0.7,0.005)};dg.steel=function(){return new dg(0.2,0.57,0.74,7.8,0.001)};dg.ice=function(){return new dg(0.3,0.03,0.1,0.9,0.0001)};dg.rubber=function(){return new dg(0.8,1,1.4,1.5,0.01)};dg.glass=function(){return new dg(0.4,0.4,0.94,2.6,0.002)};dg.sand=function(){return new dg(-1,0.45,0.6,1.6,16)};dg.prototype.zpp_inner=null;dg.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};dg.prototype.get_shapes=function(){if(this.zpp_inner.wrap_shapes==null){this.zpp_inner.wrap_shapes=aI.get(this.zpp_inner.shapes,true)}return this.zpp_inner.wrap_shapes};dg.prototype.copy=function(){var ea=new dg(this.zpp_inner.elasticity,this.zpp_inner.dynamicFriction,this.zpp_inner.staticFriction,this.zpp_inner.density*1000,this.zpp_inner.rollingFriction);if(this.zpp_inner.userData!=null){ea.zpp_inner.userData=bm.copy(this.zpp_inner.userData)}return ea};dg.prototype.get_elasticity=function(){return this.zpp_inner.elasticity};dg.prototype.set_elasticity=function(ea){if(ea!=this.zpp_inner.elasticity){this.zpp_inner.elasticity=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}return this.zpp_inner.elasticity};dg.prototype.get_dynamicFriction=function(){return this.zpp_inner.dynamicFriction};dg.prototype.set_dynamicFriction=function(ea){if(ea!=this.zpp_inner.dynamicFriction){this.zpp_inner.dynamicFriction=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ANGDRAG|cJ.ARBITERS)}return this.zpp_inner.dynamicFriction};dg.prototype.get_staticFriction=function(){return this.zpp_inner.staticFriction};dg.prototype.set_staticFriction=function(ea){if(ea!=this.zpp_inner.staticFriction){this.zpp_inner.staticFriction=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}return this.zpp_inner.staticFriction};dg.prototype.get_density=function(){return this.zpp_inner.density*1000};dg.prototype.set_density=function(ea){if(ea!=this.zpp_inner.density*1000){this.zpp_inner.density=ea/1000;this.zpp_inner.invalidate(cJ.WAKE|cJ.PROPS)}return this.zpp_inner.density*1000};dg.prototype.get_rollingFriction=function(){return this.zpp_inner.rollingFriction};dg.prototype.set_rollingFriction=function(ea){if(ea!=this.zpp_inner.rollingFriction){this.zpp_inner.rollingFriction=ea/1;this.zpp_inner.invalidate(cJ.WAKE|cJ.ARBITERS)}return this.zpp_inner.rollingFriction};dg.prototype.toString=function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+this.zpp_inner.density*1000+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"};Object.defineProperty(dg.prototype,"userData",{get:dg.prototype.get_userData});Object.defineProperty(dg.prototype,"shapes",{get:dg.prototype.get_shapes});Object.defineProperty(dg.prototype,"elasticity",{get:dg.prototype.get_elasticity,set:dg.prototype.set_elasticity});Object.defineProperty(dg.prototype,"dynamicFriction",{get:dg.prototype.get_dynamicFriction,set:dg.prototype.set_dynamicFriction});Object.defineProperty(dg.prototype,"staticFriction",{get:dg.prototype.get_staticFriction,set:dg.prototype.set_staticFriction});Object.defineProperty(dg.prototype,"density",{get:dg.prototype.get_density,set:dg.prototype.set_density});Object.defineProperty(dg.prototype,"rollingFriction",{get:dg.prototype.get_rollingFriction,set:dg.prototype.set_rollingFriction});dg.prototype.__class__=dg;var ck=nape.shape.Shape=function(){this.zpp_inner=null;a6.call(this)};ck.__name__=["nape","shape","Shape"];ck.__super__=a6;ck.prototype=Object.create(a6.prototype);ck.prototype.zpp_inner=null;ck.prototype.get_type=function(){return bZ.types[this.zpp_inner.type]};ck.prototype.isCircle=function(){return this.zpp_inner.type==0};ck.prototype.isPolygon=function(){return this.zpp_inner.type==1};ck.prototype.get_body=function(){if(this.zpp_inner.body!=null){return this.zpp_inner.body.outer}else{return null}};ck.prototype.set_body=function(ea){this.zpp_inner.immutable_midstep("Shape::body");if((this.zpp_inner.body!=null?this.zpp_inner.body.outer:null)!=ea){if(this.zpp_inner.body!=null){(this.zpp_inner.body!=null?this.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(this)}if(ea!=null){var eb=ea.zpp_inner.wrap_shapes;if(eb.zpp_inner.reverse_flag){eb.push(this)}else{eb.unshift(this)}}}if(this.zpp_inner.body!=null){return this.zpp_inner.body.outer}else{return null}};ck.prototype.get_castCircle=function(){if(this.zpp_inner.type==0){return this.zpp_inner.circle.outer_zn}else{return null}};ck.prototype.get_castPolygon=function(){if(this.zpp_inner.type==1){return this.zpp_inner.polygon.outer_zn}else{return null}};ck.prototype.get_worldCOM=function(){if(this.zpp_inner.wrap_worldCOM==null){var ea=this.zpp_inner.worldCOMx;var eh=this.zpp_inner.worldCOMy;var eb;if(au.poolVec2==null){eb=new r()}else{eb=au.poolVec2;au.poolVec2=eb.zpp_pool;eb.zpp_pool=null}if(eb.zpp_inner==null){var ef;if(bB.zpp_pool==null){ef=new bB()}else{ef=bB.zpp_pool;bB.zpp_pool=ef.next;ef.next=null}ef.weak=false;ef._immutable=false;ef.x=ea;ef.y=eh;eb.zpp_inner=ef;eb.zpp_inner.outer=eb}else{var ec;var eg=eb.zpp_inner;if(eg._validate!=null){eg._validate()}if(eb.zpp_inner.x==ea){var ee=eb.zpp_inner;if(ee._validate!=null){ee._validate()}ec=eb.zpp_inner.y==eh}else{ec=false}if(!ec){eb.zpp_inner.x=ea;eb.zpp_inner.y=eh;var ed=eb.zpp_inner;if(ed._invalidate!=null){ed._invalidate(ed)}}}eb.zpp_inner.weak=false;this.zpp_inner.wrap_worldCOM=eb;this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=true;this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=true;this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(bo=this.zpp_inner,dX(bo,bo.getworldCOM))}return this.zpp_inner.wrap_worldCOM};ck.prototype.get_localCOM=function(){if(this.zpp_inner.wrap_localCOM==null){if(this.zpp_inner.type==0){this.zpp_inner.circle.setupLocalCOM()}else{this.zpp_inner.polygon.setupLocalCOM()}}return this.zpp_inner.wrap_localCOM};ck.prototype.set_localCOM=function(ea){this.zpp_inner.immutable_midstep("Body::localCOM");if(this.zpp_inner.wrap_localCOM==null){if(this.zpp_inner.type==0){this.zpp_inner.circle.setupLocalCOM()}else{this.zpp_inner.polygon.setupLocalCOM()}}var ee=this.zpp_inner.wrap_localCOM;var eh=ea.zpp_inner;if(eh._validate!=null){eh._validate()}var ej=ea.zpp_inner.x;var eg=ea.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ea.zpp_inner.y;var eb;var ef=ee.zpp_inner;if(ef._validate!=null){ef._validate()}if(ee.zpp_inner.x==ej){var ed=ee.zpp_inner;if(ed._validate!=null){ed._validate()}eb=ee.zpp_inner.y==ei}else{eb=false}if(!eb){ee.zpp_inner.x=ej;ee.zpp_inner.y=ei;var ec=ee.zpp_inner;if(ec._invalidate!=null){ec._invalidate(ec)}}if(ea.zpp_inner.weak){var ek=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_localCOM==null){if(this.zpp_inner.type==0){this.zpp_inner.circle.setupLocalCOM()}else{this.zpp_inner.polygon.setupLocalCOM()}}return this.zpp_inner.wrap_localCOM};ck.prototype.get_area=function(){this.zpp_inner.validate_area_inertia();return this.zpp_inner.area};ck.prototype.get_inertia=function(){this.zpp_inner.validate_area_inertia();return this.zpp_inner.inertia};ck.prototype.get_angDrag=function(){this.zpp_inner.validate_angDrag();return this.zpp_inner.angDrag};ck.prototype.get_material=function(){return this.zpp_inner.material.wrapper()};ck.prototype.set_material=function(ea){this.zpp_inner.immutable_midstep("Shape::material");this.zpp_inner.setMaterial(ea.zpp_inner);return this.zpp_inner.material.wrapper()};ck.prototype.get_filter=function(){return this.zpp_inner.filter.wrapper()};ck.prototype.set_filter=function(ea){this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(ea.zpp_inner);return this.zpp_inner.filter.wrapper()};ck.prototype.get_fluidProperties=function(){this.zpp_inner.immutable_midstep("Shape::fluidProperties");if(this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner)}return this.zpp_inner.fluidProperties.wrapper()};ck.prototype.set_fluidProperties=function(ea){this.zpp_inner.setFluid(ea.zpp_inner);this.zpp_inner.immutable_midstep("Shape::fluidProperties");if(this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner)}return this.zpp_inner.fluidProperties.wrapper()};ck.prototype.get_fluidEnabled=function(){return this.zpp_inner.fluidEnabled};ck.prototype.set_fluidEnabled=function(ea){this.zpp_inner.immutable_midstep("Shape::fluidEnabled");this.zpp_inner.fluidEnabled=ea;if(ea&&this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner);this.zpp_inner.immutable_midstep("Shape::fluidProperties");if(this.zpp_inner.fluidProperties==null){this.zpp_inner.setFluid(new aM().zpp_inner)}this.zpp_inner.fluidProperties.wrapper()}this.zpp_inner.wake();return this.zpp_inner.fluidEnabled};ck.prototype.get_sensorEnabled=function(){return this.zpp_inner.sensorEnabled};ck.prototype.set_sensorEnabled=function(ea){this.zpp_inner.immutable_midstep("Shape::sensorEnabled");this.zpp_inner.sensorEnabled=ea;this.zpp_inner.wake();return this.zpp_inner.sensorEnabled};ck.prototype.get_bounds=function(){return this.zpp_inner.aabb.wrapper()};ck.prototype.translate=function(eh){this.zpp_inner.immutable_midstep("Shape::translate()");if(eh.lsq()>0){if(this.zpp_inner.type==0){var eg=eh.zpp_inner;if(eg._validate!=null){eg._validate()}var eb=eh.zpp_inner.x;var ef=eh.zpp_inner;if(ef._validate!=null){ef._validate()}this.zpp_inner.circle.__translate(eb,eh.zpp_inner.y)}else{var ee=eh.zpp_inner;if(ee._validate!=null){ee._validate()}var ed=eh.zpp_inner.x;var ec=eh.zpp_inner;if(ec._validate!=null){ec._validate()}this.zpp_inner.polygon.__translate(ed,eh.zpp_inner.y)}}if(eh.zpp_inner.weak){var ea=eh.zpp_inner;eh.zpp_inner.outer=null;eh.zpp_inner=null;eh.zpp_pool=au.poolVec2;au.poolVec2=eh;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}return this};ck.prototype.scale=function(eb,ea){this.zpp_inner.immutable_midstep("Shape::scale()");if(this.zpp_inner.type==0){var ec=eb*eb-ea*ea;if(ec*ec<P.epsilon*P.epsilon){this.zpp_inner.circle.__scale(eb,ea)}}else{this.zpp_inner.polygon.__scale(eb,ea)}return this};ck.prototype.rotate=function(ec){this.zpp_inner.immutable_midstep("Shape::rotate()");if(ec%(2*Math.PI)!=0){var eb=Math.cos(ec);var ea=Math.sin(ec);if(this.zpp_inner.type==0){this.zpp_inner.circle.__rotate(ea,eb)}else{this.zpp_inner.polygon.__rotate(ea,eb)}}return this};ck.prototype.transform=function(ea){this.zpp_inner.immutable_midstep("Shape::transform()");if(this.zpp_inner.type==0){if(ea.equiorthogonal()){this.zpp_inner.circle.__transform(ea)}}else{this.zpp_inner.polygon.__transform(ea)}return this};ck.prototype.contains=function(ea){bM.validateShape(this.zpp_inner);var ed=ea.zpp_inner;if(ed._validate!=null){ed._validate()}var ec=b7.shapeContains(this.zpp_inner,ea.zpp_inner);if(ea.zpp_inner.weak){var eb=ea.zpp_inner;ea.zpp_inner.outer=null;ea.zpp_inner=null;ea.zpp_pool=au.poolVec2;au.poolVec2=ea;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}return ec};ck.prototype.copy=function(){return this.zpp_inner.copy()};ck.prototype.toString=function(){return(this.zpp_inner.type==0?"Circle":"Polygon")+"#"+this.zpp_inner_i.id};Object.defineProperty(ck.prototype,"type",{get:ck.prototype.get_type});Object.defineProperty(ck.prototype,"body",{get:ck.prototype.get_body,set:ck.prototype.set_body});Object.defineProperty(ck.prototype,"castCircle",{get:ck.prototype.get_castCircle});Object.defineProperty(ck.prototype,"castPolygon",{get:ck.prototype.get_castPolygon});Object.defineProperty(ck.prototype,"worldCOM",{get:ck.prototype.get_worldCOM});Object.defineProperty(ck.prototype,"localCOM",{get:ck.prototype.get_localCOM,set:ck.prototype.set_localCOM});Object.defineProperty(ck.prototype,"area",{get:ck.prototype.get_area});Object.defineProperty(ck.prototype,"inertia",{get:ck.prototype.get_inertia});Object.defineProperty(ck.prototype,"angDrag",{get:ck.prototype.get_angDrag});Object.defineProperty(ck.prototype,"material",{get:ck.prototype.get_material,set:ck.prototype.set_material});Object.defineProperty(ck.prototype,"filter",{get:ck.prototype.get_filter,set:ck.prototype.set_filter});Object.defineProperty(ck.prototype,"fluidProperties",{get:ck.prototype.get_fluidProperties,set:ck.prototype.set_fluidProperties});Object.defineProperty(ck.prototype,"fluidEnabled",{get:ck.prototype.get_fluidEnabled,set:ck.prototype.set_fluidEnabled});Object.defineProperty(ck.prototype,"sensorEnabled",{get:ck.prototype.get_sensorEnabled,set:ck.prototype.set_sensorEnabled});Object.defineProperty(ck.prototype,"bounds",{get:ck.prototype.get_bounds});ck.prototype.__class__=ck;var ds=nape.shape.Circle=function(ea,ec,ee,ed){this.zpp_inner_zn=null;ck.call(this);this.zpp_inner_zn=new di();this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i=this.zpp_inner;this.zpp_inner_i.outer_i=this;this.zpp_inner.immutable_midstep("Circle::radius");if(ea!=this.zpp_inner_zn.radius){this.zpp_inner_zn.radius=ea;this.zpp_inner_zn.invalidate_radius()}if(ec==null){this.zpp_inner.localCOMx=0;this.zpp_inner.localCOMy=0}else{var eg=ec.zpp_inner;if(eg._validate!=null){eg._validate()}this.zpp_inner.localCOMx=ec.zpp_inner.x;var ef=ec.zpp_inner;if(ef._validate!=null){ef._validate()}this.zpp_inner.localCOMy=ec.zpp_inner.y;if(ec.zpp_inner.weak){var eb=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb}}if(ee==null){if(cJ.zpp_pool==null){this.zpp_inner.material=new cJ()}else{this.zpp_inner.material=cJ.zpp_pool;cJ.zpp_pool=this.zpp_inner.material.next;this.zpp_inner.material.next=null}}else{this.zpp_inner.immutable_midstep("Shape::material");this.zpp_inner.setMaterial(ee.zpp_inner);this.zpp_inner.material.wrapper()}if(ed==null){if(cA.zpp_pool==null){this.zpp_inner.filter=new cA()}else{this.zpp_inner.filter=cA.zpp_pool;cA.zpp_pool=this.zpp_inner.filter.next;this.zpp_inner.filter.next=null}}else{this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(ed.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(db.ANY_SHAPE.zpp_inner)};ds.__name__=["nape","shape","Circle"];ds.__super__=ck;ds.prototype=Object.create(ck.prototype);ds.prototype.zpp_inner_zn=null;ds.prototype.get_radius=function(){return this.zpp_inner_zn.radius};ds.prototype.set_radius=function(ea){this.zpp_inner.immutable_midstep("Circle::radius");if(ea!=this.zpp_inner_zn.radius){this.zpp_inner_zn.radius=ea;this.zpp_inner_zn.invalidate_radius()}return this.zpp_inner_zn.radius};Object.defineProperty(ds.prototype,"radius",{get:ds.prototype.get_radius,set:ds.prototype.set_radius});ds.prototype.__class__=ds;var ba=nape.shape.Edge=function(){this.zpp_inner=null};ba.__name__=["nape","shape","Edge"];ba.prototype.zpp_inner=null;ba.prototype.get_polygon=function(){return this.zpp_inner.polygon.outer_zn};ba.prototype.get_localNormal=function(){if(this.zpp_inner.wrap_lnorm==null){this.zpp_inner.getlnorm()}return this.zpp_inner.wrap_lnorm};ba.prototype.get_worldNormal=function(){if(this.zpp_inner.wrap_gnorm==null){this.zpp_inner.getgnorm()}return this.zpp_inner.wrap_gnorm};ba.prototype.get_length=function(){this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.length};ba.prototype.get_localProjection=function(){this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.lprojection};ba.prototype.get_worldProjection=function(){var ee=this.zpp_inner.polygon;if(ee.zip_gaxi){if(ee.body!=null){ee.zip_gaxi=false;ee.validate_laxi();var eh=ee.body;if(eh.zip_axis){eh.zip_axis=false;eh.axisx=Math.sin(eh.rot);eh.axisy=Math.cos(eh.rot)}if(ee.zip_gverts){if(ee.body!=null){ee.zip_gverts=false;ee.validate_lverts();var eg=ee.body;if(eg.zip_axis){eg.zip_axis=false;eg.axisx=Math.sin(eg.rot);eg.axisy=Math.cos(eg.rot)}var el=ee.lverts.next;var eb=ee.gverts.next;while(eb!=null){var ed=eb;var ec=el;el=el.next;ed.x=ee.body.posx+(ee.body.axisy*ec.x-ee.body.axisx*ec.y);ed.y=ee.body.posy+(ec.x*ee.body.axisx+ec.y*ee.body.axisy);eb=eb.next}}}var ea=ee.edges.head;var ej=ee.gverts.next;var em=ej;ej=ej.next;while(ej!=null){var ek=ej;var ef=ea.elt;ea=ea.next;ef.gp0=em;ef.gp1=ek;ef.gnormx=ee.body.axisy*ef.lnormx-ee.body.axisx*ef.lnormy;ef.gnormy=ef.lnormx*ee.body.axisx+ef.lnormy*ee.body.axisy;ef.gprojection=ee.body.posx*ef.gnormx+ee.body.posy*ef.gnormy+ef.lprojection;if(ef.wrap_gnorm!=null){ef.wrap_gnorm.zpp_inner.x=ef.gnormx;ef.wrap_gnorm.zpp_inner.y=ef.gnormy}ef.tp0=ef.gp0.y*ef.gnormx-ef.gp0.x*ef.gnormy;ef.tp1=ef.gp1.y*ef.gnormx-ef.gp1.x*ef.gnormy;em=ek;ej=ej.next}var ei=ea.elt;ei.gp0=em;ei.gp1=ee.gverts.next;ei.gnormx=ee.body.axisy*ei.lnormx-ee.body.axisx*ei.lnormy;ei.gnormy=ei.lnormx*ee.body.axisx+ei.lnormy*ee.body.axisy;ei.gprojection=ee.body.posx*ei.gnormx+ee.body.posy*ei.gnormy+ei.lprojection;if(ei.wrap_gnorm!=null){ei.wrap_gnorm.zpp_inner.x=ei.gnormx;ei.wrap_gnorm.zpp_inner.y=ei.gnormy}ei.tp0=ei.gp0.y*ei.gnormx-ei.gp0.x*ei.gnormy;ei.tp1=ei.gp1.y*ei.gnormx-ei.gp1.x*ei.gnormy}}return this.zpp_inner.gprojection};ba.prototype.get_localVertex1=function(){this.zpp_inner.polygon.validate_laxi();var eb=this.zpp_inner.lp0;if(eb.outer==null){eb.outer=new r();var ea=eb.outer.zpp_inner;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;eb.outer.zpp_inner=eb}return eb.outer};ba.prototype.get_localVertex2=function(){this.zpp_inner.polygon.validate_laxi();var eb=this.zpp_inner.lp1;if(eb.outer==null){eb.outer=new r();var ea=eb.outer.zpp_inner;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea;eb.outer.zpp_inner=eb}return eb.outer};ba.prototype.get_worldVertex1=function(){var eg=this.zpp_inner.polygon;if(eg.zip_gaxi){if(eg.body!=null){eg.zip_gaxi=false;eg.validate_laxi();var ej=eg.body;if(ej.zip_axis){ej.zip_axis=false;ej.axisx=Math.sin(ej.rot);ej.axisy=Math.cos(ej.rot)}if(eg.zip_gverts){if(eg.body!=null){eg.zip_gverts=false;eg.validate_lverts();var ei=eg.body;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var en=eg.lverts.next;var ec=eg.gverts.next;while(ec!=null){var ee=ec;var ed=en;en=en.next;ee.x=eg.body.posx+(eg.body.axisy*ed.x-eg.body.axisx*ed.y);ee.y=eg.body.posy+(ed.x*eg.body.axisx+ed.y*eg.body.axisy);ec=ec.next}}}var ea=eg.edges.head;var el=eg.gverts.next;var eo=el;el=el.next;while(el!=null){var em=el;var eh=ea.elt;ea=ea.next;eh.gp0=eo;eh.gp1=em;eh.gnormx=eg.body.axisy*eh.lnormx-eg.body.axisx*eh.lnormy;eh.gnormy=eh.lnormx*eg.body.axisx+eh.lnormy*eg.body.axisy;eh.gprojection=eg.body.posx*eh.gnormx+eg.body.posy*eh.gnormy+eh.lprojection;if(eh.wrap_gnorm!=null){eh.wrap_gnorm.zpp_inner.x=eh.gnormx;eh.wrap_gnorm.zpp_inner.y=eh.gnormy}eh.tp0=eh.gp0.y*eh.gnormx-eh.gp0.x*eh.gnormy;eh.tp1=eh.gp1.y*eh.gnormx-eh.gp1.x*eh.gnormy;eo=em;el=el.next}var ek=ea.elt;ek.gp0=eo;ek.gp1=eg.gverts.next;ek.gnormx=eg.body.axisy*ek.lnormx-eg.body.axisx*ek.lnormy;ek.gnormy=ek.lnormx*eg.body.axisx+ek.lnormy*eg.body.axisy;ek.gprojection=eg.body.posx*ek.gnormx+eg.body.posy*ek.gnormy+ek.lprojection;if(ek.wrap_gnorm!=null){ek.wrap_gnorm.zpp_inner.x=ek.gnormx;ek.wrap_gnorm.zpp_inner.y=ek.gnormy}ek.tp0=ek.gp0.y*ek.gnormx-ek.gp0.x*ek.gnormy;ek.tp1=ek.gp1.y*ek.gnormx-ek.gp1.x*ek.gnormy}}var ef=this.zpp_inner.gp0;if(ef.outer==null){ef.outer=new r();var eb=ef.outer.zpp_inner;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ef.outer.zpp_inner=ef}return ef.outer};ba.prototype.get_worldVertex2=function(){var eg=this.zpp_inner.polygon;if(eg.zip_gaxi){if(eg.body!=null){eg.zip_gaxi=false;eg.validate_laxi();var ej=eg.body;if(ej.zip_axis){ej.zip_axis=false;ej.axisx=Math.sin(ej.rot);ej.axisy=Math.cos(ej.rot)}if(eg.zip_gverts){if(eg.body!=null){eg.zip_gverts=false;eg.validate_lverts();var ei=eg.body;if(ei.zip_axis){ei.zip_axis=false;ei.axisx=Math.sin(ei.rot);ei.axisy=Math.cos(ei.rot)}var en=eg.lverts.next;var ec=eg.gverts.next;while(ec!=null){var ee=ec;var ed=en;en=en.next;ee.x=eg.body.posx+(eg.body.axisy*ed.x-eg.body.axisx*ed.y);ee.y=eg.body.posy+(ed.x*eg.body.axisx+ed.y*eg.body.axisy);ec=ec.next}}}var ea=eg.edges.head;var el=eg.gverts.next;var eo=el;el=el.next;while(el!=null){var em=el;var eh=ea.elt;ea=ea.next;eh.gp0=eo;eh.gp1=em;eh.gnormx=eg.body.axisy*eh.lnormx-eg.body.axisx*eh.lnormy;eh.gnormy=eh.lnormx*eg.body.axisx+eh.lnormy*eg.body.axisy;eh.gprojection=eg.body.posx*eh.gnormx+eg.body.posy*eh.gnormy+eh.lprojection;if(eh.wrap_gnorm!=null){eh.wrap_gnorm.zpp_inner.x=eh.gnormx;eh.wrap_gnorm.zpp_inner.y=eh.gnormy}eh.tp0=eh.gp0.y*eh.gnormx-eh.gp0.x*eh.gnormy;eh.tp1=eh.gp1.y*eh.gnormx-eh.gp1.x*eh.gnormy;eo=em;el=el.next}var ek=ea.elt;ek.gp0=eo;ek.gp1=eg.gverts.next;ek.gnormx=eg.body.axisy*ek.lnormx-eg.body.axisx*ek.lnormy;ek.gnormy=ek.lnormx*eg.body.axisx+ek.lnormy*eg.body.axisy;ek.gprojection=eg.body.posx*ek.gnormx+eg.body.posy*ek.gnormy+ek.lprojection;if(ek.wrap_gnorm!=null){ek.wrap_gnorm.zpp_inner.x=ek.gnormx;ek.wrap_gnorm.zpp_inner.y=ek.gnormy}ek.tp0=ek.gp0.y*ek.gnormx-ek.gp0.x*ek.gnormy;ek.tp1=ek.gp1.y*ek.gnormx-ek.gp1.x*ek.gnormy}}var ef=this.zpp_inner.gp1;if(ef.outer==null){ef.outer=new r();var eb=ef.outer.zpp_inner;if(eb.outer!=null){eb.outer.zpp_inner=null;eb.outer=null}eb._isimmutable=null;eb._validate=null;eb._invalidate=null;eb.next=bB.zpp_pool;bB.zpp_pool=eb;ef.outer.zpp_inner=ef}return ef.outer};ba.prototype.toString=function(){if(this.zpp_inner.polygon==null){return"Edge(object-pooled)"}else{if(this.zpp_inner.polygon.body==null){this.zpp_inner.polygon.validate_laxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }"}else{var ee=this.zpp_inner.polygon;if(ee.zip_gaxi){if(ee.body!=null){ee.zip_gaxi=false;ee.validate_laxi();var eh=ee.body;if(eh.zip_axis){eh.zip_axis=false;eh.axisx=Math.sin(eh.rot);eh.axisy=Math.cos(eh.rot)}if(ee.zip_gverts){if(ee.body!=null){ee.zip_gverts=false;ee.validate_lverts();var eg=ee.body;if(eg.zip_axis){eg.zip_axis=false;eg.axisx=Math.sin(eg.rot);eg.axisy=Math.cos(eg.rot)}var el=ee.lverts.next;var eb=ee.gverts.next;while(eb!=null){var ed=eb;var ec=el;el=el.next;ed.x=ee.body.posx+(ee.body.axisy*ec.x-ee.body.axisx*ec.y);ed.y=ee.body.posy+(ec.x*ee.body.axisx+ec.y*ee.body.axisy);eb=eb.next}}}var ea=ee.edges.head;var ej=ee.gverts.next;var em=ej;ej=ej.next;while(ej!=null){var ek=ej;var ef=ea.elt;ea=ea.next;ef.gp0=em;ef.gp1=ek;ef.gnormx=ee.body.axisy*ef.lnormx-ee.body.axisx*ef.lnormy;ef.gnormy=ef.lnormx*ee.body.axisx+ef.lnormy*ee.body.axisy;ef.gprojection=ee.body.posx*ef.gnormx+ee.body.posy*ef.gnormy+ef.lprojection;if(ef.wrap_gnorm!=null){ef.wrap_gnorm.zpp_inner.x=ef.gnormx;ef.wrap_gnorm.zpp_inner.y=ef.gnormy}ef.tp0=ef.gp0.y*ef.gnormx-ef.gp0.x*ef.gnormy;ef.tp1=ef.gp1.y*ef.gnormx-ef.gp1.x*ef.gnormy;em=ek;ej=ej.next}var ei=ea.elt;ei.gp0=em;ei.gp1=ee.gverts.next;ei.gnormx=ee.body.axisy*ei.lnormx-ee.body.axisx*ei.lnormy;ei.gnormy=ei.lnormx*ee.body.axisx+ei.lnormy*ee.body.axisy;ei.gprojection=ee.body.posx*ei.gnormx+ee.body.posy*ei.gnormy+ei.lprojection;if(ei.wrap_gnorm!=null){ei.wrap_gnorm.zpp_inner.x=ei.gnormx;ei.wrap_gnorm.zpp_inner.y=ei.gnormy}ei.tp0=ei.gp0.y*ei.gnormx-ei.gp0.x*ei.gnormy;ei.tp1=ei.gp1.y*ei.gnormx-ei.gp1.x*ei.gnormy}}return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" }")+" }"}}};Object.defineProperty(ba.prototype,"polygon",{get:ba.prototype.get_polygon});Object.defineProperty(ba.prototype,"localNormal",{get:ba.prototype.get_localNormal});Object.defineProperty(ba.prototype,"worldNormal",{get:ba.prototype.get_worldNormal});Object.defineProperty(ba.prototype,"length",{get:ba.prototype.get_length});Object.defineProperty(ba.prototype,"localProjection",{get:ba.prototype.get_localProjection});Object.defineProperty(ba.prototype,"worldProjection",{get:ba.prototype.get_worldProjection});Object.defineProperty(ba.prototype,"localVertex1",{get:ba.prototype.get_localVertex1});Object.defineProperty(ba.prototype,"localVertex2",{get:ba.prototype.get_localVertex2});Object.defineProperty(ba.prototype,"worldVertex1",{get:ba.prototype.get_worldVertex1});Object.defineProperty(ba.prototype,"worldVertex2",{get:ba.prototype.get_worldVertex2});ba.prototype.__class__=ba;var dJ=nape.shape.EdgeIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};dJ.__name__=["nape","shape","EdgeIterator"];dJ.get=function(ec){var ea;if(dJ.zpp_pool==null){aw.internal=true;var ed=new dJ();aw.internal=false;ea=ed}else{var eb=dJ.zpp_pool;dJ.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};dJ.prototype.zpp_inner=null;dJ.prototype.zpp_i=null;dJ.prototype.zpp_critical=null;dJ.prototype.zpp_next=null;dJ.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=dJ.zpp_pool;dJ.zpp_pool=this;this.zpp_inner=null;return false}};dJ.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};dJ.prototype.__class__=dJ;var a2=nape.shape.EdgeList=function(){this.zpp_inner=null;this.zpp_inner=new aw();this.zpp_inner.outer=this};a2.__name__=["nape","shape","EdgeList"];a2.fromArray=function(ed){var ea=new a2();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};a2.prototype.zpp_inner=null;a2.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};a2.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};a2.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(ea==this.zpp_inner.user_length-1){ea=ea}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-2-ea}}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.wrapper()};a2.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a2.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};a2.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.wrapper()};a2.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.wrapper();if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.wrapper()};a2.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};a2.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};a2.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};a2.prototype.empty=function(){return this.zpp_inner.inner.head==null};a2.prototype.iterator=function(){this.zpp_inner.valmod();return dJ.get(this)};a2.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new a2();this.zpp_inner.valmod();var ef=dJ.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};a2.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=dJ.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};a2.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=dJ.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};a2.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=dJ.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=dJ.zpp_pool;dJ.zpp_pool=ec;ec.zpp_inner=null;break}}return this};a2.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(a2.prototype,"length",{get:a2.prototype.get_length});a2.prototype.__class__=a2;var Z=nape.shape.Polygon=function(eG,fn,eF){this.zpp_inner_zn=null;ck.call(this);this.zpp_inner_zn=new dQ();this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i=this.zpp_inner;this.zpp_inner_i.outer_i=this;if((eG instanceof Array)&&eG.__enum__==null){var fm=eG;var ea=0;while(ea<fm.length){var eT=fm[ea];++ea;var eI=eT;if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}var ec=this.zpp_inner_zn.wrap_lverts;var ev=eI.zpp_inner;if(ev._validate!=null){ev._validate()}var eD=eI.zpp_inner.x;var eV=eI.zpp_inner;if(eV._validate!=null){eV._validate()}var eH=eI.zpp_inner.y;var eP;if(au.poolVec2==null){eP=new r()}else{eP=au.poolVec2;au.poolVec2=eP.zpp_pool;eP.zpp_pool=null}if(eP.zpp_inner==null){var fk;if(bB.zpp_pool==null){fk=new bB()}else{fk=bB.zpp_pool;bB.zpp_pool=fk.next;fk.next=null}fk.weak=false;fk._immutable=false;fk.x=eD;fk.y=eH;eP.zpp_inner=fk;eP.zpp_inner.outer=eP}else{var ep;var eU=eP.zpp_inner;if(eU._validate!=null){eU._validate()}if(eP.zpp_inner.x==eD){var eS=eP.zpp_inner;if(eS._validate!=null){eS._validate()}ep=eP.zpp_inner.y==eH}else{ep=false}if(!ep){eP.zpp_inner.x=eD;eP.zpp_inner.y=eH;var eR=eP.zpp_inner;if(eR._invalidate!=null){eR._invalidate(eR)}}}eP.zpp_inner.weak=false;ec.push(eP)}}else{if(dc.__instanceof(eG,aN)){var et=eG;var eb=et.iterator();while(true){eb.zpp_inner.zpp_inner.valmod();var ed=eb.zpp_inner.zpp_gl();eb.zpp_critical=true;var eo;if(eb.zpp_i<ed){eo=true}else{eb.zpp_next=dW.zpp_pool;dW.zpp_pool=eb;eb.zpp_inner=null;eo=false}if(!eo){break}eb.zpp_critical=false;var eC=eb.zpp_inner.at(eb.zpp_i++);if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}var en=this.zpp_inner_zn.wrap_lverts;var eQ=eC.zpp_inner;if(eQ._validate!=null){eQ._validate()}var eB=eC.zpp_inner.x;var eO=eC.zpp_inner;if(eO._validate!=null){eO._validate()}var eg=eC.zpp_inner.y;var fi;if(au.poolVec2==null){fi=new r()}else{fi=au.poolVec2;au.poolVec2=fi.zpp_pool;fi.zpp_pool=null}if(fi.zpp_inner==null){var fg;if(bB.zpp_pool==null){fg=new bB()}else{fg=bB.zpp_pool;bB.zpp_pool=fg.next;fg.next=null}fg.weak=false;fg._immutable=false;fg.x=eB;fg.y=eg;fi.zpp_inner=fg;fi.zpp_inner.outer=fi}else{var em;var eM=fi.zpp_inner;if(eM._validate!=null){eM._validate()}if(fi.zpp_inner.x==eB){var eL=fi.zpp_inner;if(eL._validate!=null){eL._validate()}em=fi.zpp_inner.y==eg}else{em=false}if(!em){fi.zpp_inner.x=eB;fi.zpp_inner.y=eg;var eK=fi.zpp_inner;if(eK._invalidate!=null){eK._invalidate(eK)}}}fi.zpp_inner.weak=false;en.push(fi)}}else{if(dc.__instanceof(eG,a7)){var es=eG;var eJ=es.zpp_inner.vertices;if(eJ!=null){var eu=eJ;while(true){var eA=eu.x;var ef=eu.y;var ff;if(au.poolVec2==null){ff=new r()}else{ff=au.poolVec2;au.poolVec2=ff.zpp_pool;ff.zpp_pool=null}if(ff.zpp_inner==null){var fd;if(bB.zpp_pool==null){fd=new bB()}else{fd=bB.zpp_pool;bB.zpp_pool=fd.next;fd.next=null}fd.weak=false;fd._immutable=false;fd.x=eA;fd.y=ef;ff.zpp_inner=fd;ff.zpp_inner.outer=ff}else{var ek;var e6=ff.zpp_inner;if(e6._validate!=null){e6._validate()}if(ff.zpp_inner.x==eA){var e5=ff.zpp_inner;if(e5._validate!=null){e5._validate()}ek=ff.zpp_inner.y==ef}else{ek=false}if(!ek){ff.zpp_inner.x=eA;ff.zpp_inner.y=ef;var e4=ff.zpp_inner;if(e4._invalidate!=null){e4._invalidate(e4)}}}ff.zpp_inner.weak=false;var ez=ff;eu=eu.next;if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}var ej=this.zpp_inner_zn.wrap_lverts;var e3=ez.zpp_inner;if(e3._validate!=null){e3._validate()}var ex=ez.zpp_inner.x;var e2=ez.zpp_inner;if(e2._validate!=null){e2._validate()}var ee=ez.zpp_inner.y;var fb;if(au.poolVec2==null){fb=new r()}else{fb=au.poolVec2;au.poolVec2=fb.zpp_pool;fb.zpp_pool=null}if(fb.zpp_inner==null){var fa;if(bB.zpp_pool==null){fa=new bB()}else{fa=bB.zpp_pool;bB.zpp_pool=fa.next;fa.next=null}fa.weak=false;fa._immutable=false;fa.x=ex;fa.y=ee;fb.zpp_inner=fa;fb.zpp_inner.outer=fb}else{var ei;var e1=fb.zpp_inner;if(e1._validate!=null){e1._validate()}if(fb.zpp_inner.x==ex){var e0=fb.zpp_inner;if(e0._validate!=null){e0._validate()}ei=fb.zpp_inner.y==ee}else{ei=false}if(!ei){fb.zpp_inner.x=ex;fb.zpp_inner.y=ee;var eZ=fb.zpp_inner;if(eZ._invalidate!=null){eZ._invalidate(eZ)}}}fb.zpp_inner.weak=false;ej.push(fb);var e9=ez.zpp_inner;ez.zpp_inner.outer=null;ez.zpp_inner=null;var eN=ez;eN.zpp_pool=au.poolVec2;au.poolVec2=eN;var fl=e9;if(fl.outer!=null){fl.outer.zpp_inner=null;fl.outer=null}fl._isimmutable=null;fl._validate=null;fl._invalidate=null;fl.next=bB.zpp_pool;bB.zpp_pool=fl;if(eu==eJ){break}}}}}}if((eG instanceof Array)&&eG.__enum__==null){var er=eG;var eW=0;while(eW<er.length){var eE=er[eW];var eh;if(eE.zpp_inner.weak){var e8=eE.zpp_inner;eE.zpp_inner.outer=null;eE.zpp_inner=null;var fj=eE;fj.zpp_pool=au.poolVec2;au.poolVec2=fj;var fh=e8;if(fh.outer!=null){fh.outer.zpp_inner=null;fh.outer=null}fh._isimmutable=null;fh._validate=null;fh._invalidate=null;fh.next=bB.zpp_pool;bB.zpp_pool=fh;eh=true}else{eh=false}if(eh){er.splice(eW,1);continue}++eW}}else{if(dc.__instanceof(eG,aN)){var eq=eG;if(eq.zpp_inner._validate!=null){eq.zpp_inner._validate()}var ey=eq.zpp_inner.inner;var eX=null;var el=ey.head;while(el!=null){var ew=el.elt;if(ew.outer.zpp_inner.weak){el=ey.erase(eX);if(ew.outer.zpp_inner.weak){var eY=ew.outer;var e7=eY.zpp_inner;eY.zpp_inner.outer=null;eY.zpp_inner=null;var fe=eY;fe.zpp_pool=au.poolVec2;au.poolVec2=fe;var fc=e7;if(fc.outer!=null){fc.outer.zpp_inner=null;fc.outer=null}fc._isimmutable=null;fc._validate=null;fc._invalidate=null;fc.next=bB.zpp_pool;bB.zpp_pool=fc}}else{eX=el;el=el.next}}}}if(fn==null){if(cJ.zpp_pool==null){this.zpp_inner.material=new cJ()}else{this.zpp_inner.material=cJ.zpp_pool;cJ.zpp_pool=this.zpp_inner.material.next;this.zpp_inner.material.next=null}}else{this.zpp_inner.immutable_midstep("Shape::material");this.zpp_inner.setMaterial(fn.zpp_inner);this.zpp_inner.material.wrapper()}if(eF==null){if(cA.zpp_pool==null){this.zpp_inner.filter=new cA()}else{this.zpp_inner.filter=cA.zpp_pool;cA.zpp_pool=this.zpp_inner.filter.next;this.zpp_inner.filter.next=null}}else{this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(eF.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(db.ANY_SHAPE.zpp_inner)};Z.__name__=["nape","shape","Polygon"];Z.__super__=ck;Z.prototype=Object.create(ck.prototype);Z.rect=function(et,eq,ea,eb,ef){if(ef==null){ef=false}var eg;if(au.poolVec2==null){eg=new r()}else{eg=au.poolVec2;au.poolVec2=eg.zpp_pool;eg.zpp_pool=null}if(eg.zpp_inner==null){var eu;if(bB.zpp_pool==null){eu=new bB()}else{eu=bB.zpp_pool;bB.zpp_pool=eu.next;eu.next=null}eu.weak=false;eu._immutable=false;eu.x=et;eu.y=eq;eg.zpp_inner=eu;eg.zpp_inner.outer=eg}else{var ez;var ec=eg.zpp_inner;if(ec._validate!=null){ec._validate()}if(eg.zpp_inner.x==et){var ey=eg.zpp_inner;if(ey._validate!=null){ey._validate()}ez=eg.zpp_inner.y==eq}else{ez=false}if(!ez){eg.zpp_inner.x=et;eg.zpp_inner.y=eq;var ex=eg.zpp_inner;if(ex._invalidate!=null){ex._invalidate(ex)}}}eg.zpp_inner.weak=ef;var eH=eg;var ee=et+ea;var er;if(au.poolVec2==null){er=new r()}else{er=au.poolVec2;au.poolVec2=er.zpp_pool;er.zpp_pool=null}if(er.zpp_inner==null){var eo;if(bB.zpp_pool==null){eo=new bB()}else{eo=bB.zpp_pool;bB.zpp_pool=eo.next;eo.next=null}eo.weak=false;eo._immutable=false;eo.x=ee;eo.y=eq;er.zpp_inner=eo;er.zpp_inner.outer=er}else{var eG;var ew=er.zpp_inner;if(ew._validate!=null){ew._validate()}if(er.zpp_inner.x==ee){var ev=er.zpp_inner;if(ev._validate!=null){ev._validate()}eG=er.zpp_inner.y==eq}else{eG=false}if(!eG){er.zpp_inner.x=ee;er.zpp_inner.y=eq;var es=er.zpp_inner;if(es._invalidate!=null){es._invalidate(es)}}}er.zpp_inner.weak=ef;var eE=er;var ed=et+ea;var eJ=eq+eb;var em;if(au.poolVec2==null){em=new r()}else{em=au.poolVec2;au.poolVec2=em.zpp_pool;em.zpp_pool=null}if(em.zpp_inner==null){var ek;if(bB.zpp_pool==null){ek=new bB()}else{ek=bB.zpp_pool;bB.zpp_pool=ek.next;ek.next=null}ek.weak=false;ek._immutable=false;ek.x=ed;ek.y=eJ;em.zpp_inner=ek;em.zpp_inner.outer=em}else{var eC;var ep=em.zpp_inner;if(ep._validate!=null){ep._validate()}if(em.zpp_inner.x==ed){var en=em.zpp_inner;if(en._validate!=null){en._validate()}eC=em.zpp_inner.y==eJ}else{eC=false}if(!eC){em.zpp_inner.x=ed;em.zpp_inner.y=eJ;var el=em.zpp_inner;if(el._invalidate!=null){el._invalidate(el)}}}em.zpp_inner.weak=ef;var eB=em;var eI=eq+eb;var ei;if(au.poolVec2==null){ei=new r()}else{ei=au.poolVec2;au.poolVec2=ei.zpp_pool;ei.zpp_pool=null}if(ei.zpp_inner==null){var eh;if(bB.zpp_pool==null){eh=new bB()}else{eh=bB.zpp_pool;bB.zpp_pool=eh.next;eh.next=null}eh.weak=false;eh._immutable=false;eh.x=et;eh.y=eI;ei.zpp_inner=eh;ei.zpp_inner.outer=ei}else{var eA;var ej=ei.zpp_inner;if(ej._validate!=null){ej._validate()}if(ei.zpp_inner.x==et){var eF=ei.zpp_inner;if(eF._validate!=null){eF._validate()}eA=ei.zpp_inner.y==eI}else{eA=false}if(!eA){ei.zpp_inner.x=et;ei.zpp_inner.y=eI;var eD=ei.zpp_inner;if(eD._invalidate!=null){eD._invalidate(eD)}}}ei.zpp_inner.weak=ef;return[eH,eE,eB,ei]};Z.box=function(eb,ea,ec){if(ec==null){ec=false}return Z.rect(-eb/2,-ea/2,eb,ea,ec)};Z.regular=function(ep,ee,ea,eb,ef){if(ef==null){ef=false}if(eb==null){eb=0}var ei=[];var eq=Math.PI*2/ea;var el=0;while(el<ea){var ec=el++*eq+eb;var eo=Math.cos(ec)*ep;var en=Math.sin(ec)*ee;var em;if(au.poolVec2==null){em=new r()}else{em=au.poolVec2;au.poolVec2=em.zpp_pool;em.zpp_pool=null}if(em.zpp_inner==null){var ek;if(bB.zpp_pool==null){ek=new bB()}else{ek=bB.zpp_pool;bB.zpp_pool=ek.next;ek.next=null}ek.weak=false;ek._immutable=false;ek.x=eo;ek.y=en;em.zpp_inner=ek;em.zpp_inner.outer=em}else{var ed;var eg=em.zpp_inner;if(eg._validate!=null){eg._validate()}if(em.zpp_inner.x==eo){var ej=em.zpp_inner;if(ej._validate!=null){ej._validate()}ed=em.zpp_inner.y==en}else{ed=false}if(!ed){em.zpp_inner.x=eo;em.zpp_inner.y=en;var eh=em.zpp_inner;if(eh._invalidate!=null){eh._invalidate(eh)}}}em.zpp_inner.weak=ef;ei.push(em)}return ei};Z.prototype.zpp_inner_zn=null;Z.prototype.get_localVerts=function(){if(this.zpp_inner_zn.wrap_lverts==null){this.zpp_inner_zn.getlverts()}return this.zpp_inner_zn.wrap_lverts};Z.prototype.get_worldVerts=function(){if(this.zpp_inner_zn.wrap_gverts==null){this.zpp_inner_zn.getgverts()}return this.zpp_inner_zn.wrap_gverts};Z.prototype.get_edges=function(){if(this.zpp_inner_zn.wrap_edges==null){this.zpp_inner_zn.getedges()}return this.zpp_inner_zn.wrap_edges};Z.prototype.validity=function(){return this.zpp_inner_zn.valid()};Object.defineProperty(Z.prototype,"localVerts",{get:Z.prototype.get_localVerts});Object.defineProperty(Z.prototype,"worldVerts",{get:Z.prototype.get_worldVerts});Object.defineProperty(Z.prototype,"edges",{get:Z.prototype.get_edges});Z.prototype.__class__=Z;var bC=nape.shape.ShapeIterator=function(){this.zpp_next=null;this.zpp_critical=false;this.zpp_i=0;this.zpp_inner=null};bC.__name__=["nape","shape","ShapeIterator"];bC.get=function(ec){var ea;if(bC.zpp_pool==null){aI.internal=true;var ed=new bC();aI.internal=false;ea=ed}else{var eb=bC.zpp_pool;bC.zpp_pool=eb.zpp_next;ea=eb}ea.zpp_i=0;ea.zpp_inner=ec;ea.zpp_critical=false;return ea};bC.prototype.zpp_inner=null;bC.prototype.zpp_i=null;bC.prototype.zpp_critical=null;bC.prototype.zpp_next=null;bC.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var eb=this.zpp_inner;eb.zpp_inner.valmod();if(eb.zpp_inner.zip_length){eb.zpp_inner.zip_length=false;eb.zpp_inner.user_length=eb.zpp_inner.inner.length}var ea=eb.zpp_inner.user_length;this.zpp_critical=true;if(this.zpp_i<ea){return true}else{this.zpp_next=bC.zpp_pool;bC.zpp_pool=this;this.zpp_inner=null;return false}};bC.prototype.next=function(){this.zpp_critical=false;return this.zpp_inner.at(this.zpp_i++)};bC.prototype.__class__=bC;var cZ=nape.shape.ShapeList=function(){this.zpp_inner=null;this.zpp_inner=new aI();this.zpp_inner.outer=this};cZ.__name__=["nape","shape","ShapeList"];cZ.fromArray=function(ed){var ea=new cZ();var ec=0;while(ec<ed.length){var eb=ed[ec];++ec;ea.push(eb)}return ea};cZ.prototype.zpp_inner=null;cZ.prototype.get_length=function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}return this.zpp_inner.user_length};cZ.prototype.has=function(ea){this.zpp_inner.valmod();return this.zpp_inner.inner.has(ea.zpp_inner)};cZ.prototype.at=function(ea){this.zpp_inner.valmod();if(this.zpp_inner.reverse_flag){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ea=this.zpp_inner.user_length-1-ea}if(ea<this.zpp_inner.at_index||this.zpp_inner.at_ite==null){this.zpp_inner.at_index=ea;this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(ea)}else{while(this.zpp_inner.at_index!=ea){this.zpp_inner.at_index++;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.elt.outer};cZ.prototype.push=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){this.zpp_inner.inner.add(ec.zpp_inner)}else{if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cZ.prototype.unshift=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea=this.zpp_inner.adder!=null?this.zpp_inner.adder(ec):true;if(ea){if(this.zpp_inner.reverse_flag){if(this.zpp_inner.push_ite==null){var eb;if(this.zpp_inner.inner.head==null){eb=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}eb=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=eb}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,ec.zpp_inner)}else{this.zpp_inner.inner.add(ec.zpp_inner)}this.zpp_inner.invalidate();if(this.zpp_inner.post_adder!=null){this.zpp_inner.post_adder(ec)}}return ea};cZ.prototype.pop=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){eb=this.zpp_inner.inner.head.elt;var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}else{if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}this.zpp_inner.invalidate();return eb.outer};cZ.prototype.shift=function(){this.zpp_inner.modify_test();this.zpp_inner.valmod();var eb=null;if(this.zpp_inner.reverse_flag){if(this.zpp_inner.at_ite!=null&&this.zpp_inner.at_ite.next==null){this.zpp_inner.at_ite=null}var ec;this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(this.zpp_inner.user_length==1){ec=null}else{this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}ec=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}if(ec==null){eb=this.zpp_inner.inner.head.elt}else{eb=ec.next.elt}var ea=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ea)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.erase(ec)}}else{eb=this.zpp_inner.inner.head.elt;var ed=eb.outer;if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ed)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.pop()}}this.zpp_inner.invalidate();return eb.outer};cZ.prototype.add=function(ea){if(this.zpp_inner.reverse_flag){return this.push(ea)}else{return this.unshift(ea)}};cZ.prototype.remove=function(ec){this.zpp_inner.modify_test();this.zpp_inner.valmod();var ea;ea=false;var eb=this.zpp_inner.inner.head;while(eb!=null){if(eb.elt==ec.zpp_inner){ea=true;break}eb=eb.next}if(ea){if(this.zpp_inner.subber!=null){this.zpp_inner.subber(ec)}if(!this.zpp_inner.dontremove){this.zpp_inner.inner.remove(ec.zpp_inner)}this.zpp_inner.invalidate()}return ea};cZ.prototype.clear=function(){if(this.zpp_inner.reverse_flag){while(this.zpp_inner.inner.head!=null){this.pop()}}else{while(this.zpp_inner.inner.head!=null){this.shift()}}};cZ.prototype.empty=function(){return this.zpp_inner.inner.head==null};cZ.prototype.iterator=function(){this.zpp_inner.valmod();return bC.get(this)};cZ.prototype.copy=function(ea){if(ea==null){ea=false}var eb=new cZ();this.zpp_inner.valmod();var ef=bC.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bC.zpp_pool;bC.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);eb.push(ea?null:ec)}return eb};cZ.prototype.merge=function(eb){eb.zpp_inner.valmod();var ee=bC.get(eb);while(true){ee.zpp_inner.zpp_inner.valmod();var ef=ee.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ee.zpp_critical=true;var ec;if(ee.zpp_i<ed){ec=true}else{ee.zpp_next=bC.zpp_pool;bC.zpp_pool=ee;ee.zpp_inner=null;ec=false}if(!ec){break}ee.zpp_critical=false;var ea=ee.zpp_inner.at(ee.zpp_i++);if(!this.has(ea)){if(this.zpp_inner.reverse_flag){this.push(ea)}else{this.unshift(ea)}}}};cZ.prototype.toString=function(){var eb="[";var ea=true;this.zpp_inner.valmod();var ef=bC.get(this);while(true){ef.zpp_inner.zpp_inner.valmod();var eg=ef.zpp_inner;eg.zpp_inner.valmod();if(eg.zpp_inner.zip_length){eg.zpp_inner.zip_length=false;eg.zpp_inner.user_length=eg.zpp_inner.inner.length}var ee=eg.zpp_inner.user_length;ef.zpp_critical=true;var ed;if(ef.zpp_i<ee){ed=true}else{ef.zpp_next=bC.zpp_pool;bC.zpp_pool=ef;ef.zpp_inner=null;ed=false}if(!ed){break}ef.zpp_critical=false;var ec=ef.zpp_inner.at(ef.zpp_i++);if(!ea){eb+=","}eb+=ec==null?"NULL":ec.toString();ea=false}return eb+"]"};cZ.prototype.foreach=function(ea){this.zpp_inner.valmod();var ec=bC.get(this);while(true){ec.zpp_inner.zpp_inner.valmod();var ef=ec.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ed=ef.zpp_inner.user_length;ec.zpp_critical=true;var eb;if(ec.zpp_i<ed){eb=true}else{ec.zpp_next=bC.zpp_pool;bC.zpp_pool=ec;ec.zpp_inner=null;eb=false}if(!eb){break}try{ec.zpp_critical=false;ea(ec.zpp_inner.at(ec.zpp_i++))}catch(ee){ec.zpp_next=bC.zpp_pool;bC.zpp_pool=ec;ec.zpp_inner=null;break}}return this};cZ.prototype.filter=function(eb){var ec=0;while(true){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=false;this.zpp_inner.user_length=this.zpp_inner.inner.length}if(!(ec<this.zpp_inner.user_length)){break}var ea=this.at(ec);try{if(eb(ea)){++ec}else{this.remove(ea)}}catch(ed){break}}return this};Object.defineProperty(cZ.prototype,"length",{get:cZ.prototype.get_length});cZ.prototype.__class__=cZ;var H=nape.shape.ShapeType=function(){};H.__name__=["nape","shape","ShapeType"];H.CIRCLE=null;H.get_CIRCLE=function(){if(br.ShapeType_CIRCLE==null){br.internal=true;br.ShapeType_CIRCLE=new H();br.internal=false}return br.ShapeType_CIRCLE};H.POLYGON=null;H.get_POLYGON=function(){if(br.ShapeType_POLYGON==null){br.internal=true;br.ShapeType_POLYGON=new H();br.internal=false}return br.ShapeType_POLYGON};H.prototype.toString=function(){if(br.ShapeType_CIRCLE==null){br.internal=true;br.ShapeType_CIRCLE=new H();br.internal=false}if(this==br.ShapeType_CIRCLE){return"CIRCLE"}else{if(br.ShapeType_POLYGON==null){br.internal=true;br.ShapeType_POLYGON=new H();br.internal=false}if(this==br.ShapeType_POLYGON){return"POLYGON"}else{return""}}};Object.defineProperty(H,"CIRCLE",{get:H.get_CIRCLE});Object.defineProperty(H,"POLYGON",{get:H.get_POLYGON});H.prototype.__class__=H;var al=nape.shape.ValidationResult=function(){};al.__name__=["nape","shape","ValidationResult"];al.VALID=null;al.get_VALID=function(){if(br.ValidationResult_VALID==null){br.internal=true;br.ValidationResult_VALID=new al();br.internal=false}return br.ValidationResult_VALID};al.DEGENERATE=null;al.get_DEGENERATE=function(){if(br.ValidationResult_DEGENERATE==null){br.internal=true;br.ValidationResult_DEGENERATE=new al();br.internal=false}return br.ValidationResult_DEGENERATE};al.CONCAVE=null;al.get_CONCAVE=function(){if(br.ValidationResult_CONCAVE==null){br.internal=true;br.ValidationResult_CONCAVE=new al();br.internal=false}return br.ValidationResult_CONCAVE};al.SELF_INTERSECTING=null;al.get_SELF_INTERSECTING=function(){if(br.ValidationResult_SELF_INTERSECTING==null){br.internal=true;br.ValidationResult_SELF_INTERSECTING=new al();br.internal=false}return br.ValidationResult_SELF_INTERSECTING};al.prototype.toString=function(){if(br.ValidationResult_VALID==null){br.internal=true;br.ValidationResult_VALID=new al();br.internal=false}if(this==br.ValidationResult_VALID){return"VALID"}else{if(br.ValidationResult_DEGENERATE==null){br.internal=true;br.ValidationResult_DEGENERATE=new al();br.internal=false}if(this==br.ValidationResult_DEGENERATE){return"DEGENERATE"}else{if(br.ValidationResult_CONCAVE==null){br.internal=true;br.ValidationResult_CONCAVE=new al();br.internal=false}if(this==br.ValidationResult_CONCAVE){return"CONCAVE"}else{if(br.ValidationResult_SELF_INTERSECTING==null){br.internal=true;br.ValidationResult_SELF_INTERSECTING=new al();br.internal=false}if(this==br.ValidationResult_SELF_INTERSECTING){return"SELF_INTERSECTING"}else{return""}}}}};Object.defineProperty(al,"VALID",{get:al.get_VALID});Object.defineProperty(al,"DEGENERATE",{get:al.get_DEGENERATE});Object.defineProperty(al,"CONCAVE",{get:al.get_CONCAVE});Object.defineProperty(al,"SELF_INTERSECTING",{get:al.get_SELF_INTERSECTING});al.prototype.__class__=al;var aQ=nape.space.Broadphase=function(){};aQ.__name__=["nape","space","Broadphase"];aQ.DYNAMIC_AABB_TREE=null;aQ.get_DYNAMIC_AABB_TREE=function(){if(br.Broadphase_DYNAMIC_AABB_TREE==null){br.internal=true;br.Broadphase_DYNAMIC_AABB_TREE=new aQ();br.internal=false}return br.Broadphase_DYNAMIC_AABB_TREE};aQ.SWEEP_AND_PRUNE=null;aQ.get_SWEEP_AND_PRUNE=function(){if(br.Broadphase_SWEEP_AND_PRUNE==null){br.internal=true;br.Broadphase_SWEEP_AND_PRUNE=new aQ();br.internal=false}return br.Broadphase_SWEEP_AND_PRUNE};aQ.prototype.toString=function(){if(br.Broadphase_DYNAMIC_AABB_TREE==null){br.internal=true;br.Broadphase_DYNAMIC_AABB_TREE=new aQ();br.internal=false}if(this==br.Broadphase_DYNAMIC_AABB_TREE){return"DYNAMIC_AABB_TREE"}else{if(br.Broadphase_SWEEP_AND_PRUNE==null){br.internal=true;br.Broadphase_SWEEP_AND_PRUNE=new aQ();br.internal=false}if(this==br.Broadphase_SWEEP_AND_PRUNE){return"SWEEP_AND_PRUNE"}else{return""}}};Object.defineProperty(aQ,"DYNAMIC_AABB_TREE",{get:aQ.get_DYNAMIC_AABB_TREE});Object.defineProperty(aQ,"SWEEP_AND_PRUNE",{get:aQ.get_SWEEP_AND_PRUNE});aQ.prototype.__class__=aQ;var bk=nape.space.Space=function(ec,eb){this.zpp_inner=null;this.zpp_inner=new a3(ec==null?null:ec.zpp_inner,eb);this.zpp_inner.outer=this;if(ec!=null){if(ec.zpp_inner.weak){var ea=ec.zpp_inner;ec.zpp_inner.outer=null;ec.zpp_inner=null;ec.zpp_pool=au.poolVec2;au.poolVec2=ec;if(ea.outer!=null){ea.outer.zpp_inner=null;ea.outer=null}ea._isimmutable=null;ea._validate=null;ea._invalidate=null;ea.next=bB.zpp_pool;bB.zpp_pool=ea}}};bk.__name__=["nape","space","Space"];bk.prototype.zpp_inner=null;bk.prototype.get_userData=function(){if(this.zpp_inner.userData==null){this.zpp_inner.userData={}}return this.zpp_inner.userData};bk.prototype.get_gravity=function(){if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}return this.zpp_inner.wrap_gravity};bk.prototype.set_gravity=function(ej){if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}var ed=this.zpp_inner.wrap_gravity;var eg=ej.zpp_inner;if(eg._validate!=null){eg._validate()}var ei=ej.zpp_inner.x;var ef=ej.zpp_inner;if(ef._validate!=null){ef._validate()}var eh=ej.zpp_inner.y;var ea;var ee=ed.zpp_inner;if(ee._validate!=null){ee._validate()}if(ed.zpp_inner.x==ei){var ec=ed.zpp_inner;if(ec._validate!=null){ec._validate()}ea=ed.zpp_inner.y==eh}else{ea=false}if(!ea){ed.zpp_inner.x=ei;ed.zpp_inner.y=eh;var eb=ed.zpp_inner;if(eb._invalidate!=null){eb._invalidate(eb)}}if(ej.zpp_inner.weak){var ek=ej.zpp_inner;ej.zpp_inner.outer=null;ej.zpp_inner=null;ej.zpp_pool=au.poolVec2;au.poolVec2=ej;if(ek.outer!=null){ek.outer.zpp_inner=null;ek.outer=null}ek._isimmutable=null;ek._validate=null;ek._invalidate=null;ek.next=bB.zpp_pool;bB.zpp_pool=ek}if(this.zpp_inner.wrap_gravity==null){this.zpp_inner.getgravity()}return this.zpp_inner.wrap_gravity};bk.prototype.get_broadphase=function(){if(this.zpp_inner.bphase.is_sweep){if(br.Broadphase_SWEEP_AND_PRUNE==null){br.internal=true;br.Broadphase_SWEEP_AND_PRUNE=new aQ();br.internal=false}return br.Broadphase_SWEEP_AND_PRUNE}else{if(br.Broadphase_DYNAMIC_AABB_TREE==null){br.internal=true;br.Broadphase_DYNAMIC_AABB_TREE=new aQ();br.internal=false}return br.Broadphase_DYNAMIC_AABB_TREE}};bk.prototype.get_sortContacts=function(){return this.zpp_inner.sortcontacts};bk.prototype.set_sortContacts=function(ea){this.zpp_inner.sortcontacts=ea;return this.zpp_inner.sortcontacts};bk.prototype.get_worldAngularDrag=function(){return this.zpp_inner.global_ang_drag};bk.prototype.set_worldAngularDrag=function(ea){this.zpp_inner.global_ang_drag=ea;return this.zpp_inner.global_ang_drag};bk.prototype.get_worldLinearDrag=function(){return this.zpp_inner.global_lin_drag};bk.prototype.set_worldLinearDrag=function(ea){this.zpp_inner.global_lin_drag=ea;return this.zpp_inner.global_lin_drag};bk.prototype.get_compounds=function(){return this.zpp_inner.wrap_compounds};bk.prototype.get_bodies=function(){return this.zpp_inner.wrap_bodies};bk.prototype.get_liveBodies=function(){return this.zpp_inner.wrap_live};bk.prototype.get_constraints=function(){return this.zpp_inner.wrap_constraints};bk.prototype.get_liveConstraints=function(){return this.zpp_inner.wrap_livecon};bk.prototype.visitBodies=function(eh){var eg=this.zpp_inner.wrap_bodies;eg.zpp_inner.valmod();var ee=aX.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=aX.zpp_pool;aX.zpp_pool=ee;ee.zpp_inner=null;ed=false}if(!ed){break}ee.zpp_critical=false;eh(ee.zpp_inner.at(ee.zpp_i++))}var ei=this.zpp_inner.wrap_compounds;ei.zpp_inner.valmod();var ek=c4.get(ei);while(true){ek.zpp_inner.zpp_inner.valmod();var ef=ek.zpp_inner;ef.zpp_inner.valmod();if(ef.zpp_inner.zip_length){ef.zpp_inner.zip_length=false;ef.zpp_inner.user_length=ef.zpp_inner.inner.length}var ea=ef.zpp_inner.user_length;ek.zpp_critical=true;var ec;if(ek.zpp_i<ea){ec=true}else{ek.zpp_next=c4.zpp_pool;c4.zpp_pool=ek;ek.zpp_inner=null;ec=false}if(!ec){break}ek.zpp_critical=false;ek.zpp_inner.at(ek.zpp_i++).visitBodies(eh)}};bk.prototype.visitConstraints=function(eh){var eg=this.zpp_inner.wrap_constraints;eg.zpp_inner.valmod();var ee=bO.get(eg);while(true){ee.zpp_inner.zpp_inner.valmod();var ej=ee.zpp_inner;ej.zpp_inner.valmod();if(ej.zpp_inner.zip_length){ej.zpp_inner.zip_length=false;ej.zpp_inner.user_length=ej.zpp_inner.inner.length}var eb=ej.zpp_inner.user_length;ee.zpp_critical=true;var ed;if(ee.zpp_i<eb){ed=true}else{ee.zpp_next=bO.zpp_pool